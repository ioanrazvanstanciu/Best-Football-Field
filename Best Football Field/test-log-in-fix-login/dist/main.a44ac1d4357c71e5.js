(self.webpackChunkproiect_isi=self.webpackChunkproiect_isi||[]).push([[179],{2011:(ft,Pe,M)=>{"use strict";M.d(Pe,{Dh:()=>_e,GT:()=>he,cc:()=>Te,hO:()=>Oe,on:()=>z,pX:()=>me,xv:()=>ye});var g=M(4650),j=M(127),k=M(880);ft=M.hmd(ft);const oe=["ngOnDestroy"],me=(xe,ke,Ne,Ve={})=>new Proxy(xe,{get:(Ue,ae)=>Ne.runOutsideAngular(()=>{var De;if(xe[ae])return!(null===(De=Ve?.spy)||void 0===De)&&De.get&&Ve.spy.get(ae,xe[ae]),xe[ae];if(oe.indexOf(ae)>-1)return()=>{};const q=ke.toPromise().then(se=>{const Ee=se&&se[ae];return"function"==typeof Ee?Ee.bind(se):Ee&&Ee.then?Ee.then(Q=>Ne.run(()=>Q)):Ne.run(()=>Ee)});return new Proxy(()=>{},{get:(se,Ee)=>q[Ee],apply:(se,Ee,Q)=>q.then(X=>{var fe;const ue=X&&X(...Q);return!(null===(fe=Ve?.spy)||void 0===fe)&&fe.apply&&Ve.spy.apply(ae,Q,ue),ue})})})}),he=(xe,ke)=>{ke.forEach(Ne=>{Object.getOwnPropertyNames(Ne.prototype||Ne).forEach(Ve=>{Object.defineProperty(xe.prototype,Ve,Object.getOwnPropertyDescriptor(Ne.prototype||Ne,Ve))})})};class we{constructor(ke){return ke}}const _e=new g.OlP("angularfire2.app.options"),ye=new g.OlP("angularfire2.app.name");function z(xe,ke,Ne){const Ue="object"==typeof Ne&&Ne||{};Ue.name=Ue.name||"string"==typeof Ne&&Ne||"[DEFAULT]";const De=j.Z.apps.filter(q=>q&&q.name===Ue.name)[0]||ke.runOutsideAngular(()=>j.Z.initializeApp(xe,Ue));try{JSON.stringify(xe)!==JSON.stringify(De.options)&&H("error",`${De.name} Firebase App already initialized with different options${ft.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch{}return new we(De)}const H=(xe,...ke)=>{(0,g.X6Q)()&&typeof console<"u"&&console[xe](...ke)},te={provide:we,useFactory:z,deps:[_e,g.R0b,[new g.FiY,ye]]};let Oe=(()=>{class xe{constructor(Ne){j.Z.registerVersion("angularfire",k.q4.full,"core"),j.Z.registerVersion("angularfire",k.q4.full,"app-compat"),j.Z.registerVersion("angular",g.q4F.full,Ne.toString())}static initializeApp(Ne,Ve){return{ngModule:xe,providers:[{provide:_e,useValue:Ne},{provide:ye,useValue:Ve}]}}}return xe.\u0275fac=function(Ne){return new(Ne||xe)(g.LFG(g.Lbi))},xe.\u0275mod=g.oAB({type:xe}),xe.\u0275inj=g.cJS({providers:[te]}),xe})();function Te(xe,ke,Ne,Ve,Ue){const[,ae,De]=globalThis.\u0275AngularfireInstanceCache.find(q=>q[0]===xe)||[];if(ae)return function Ke(xe,ke){try{return xe.toString()===ke.toString()}catch{return xe===ke}}(Ue,De)||(ve("error",`${ke} was already initialized on the ${Ne} Firebase App with different settings.${Xe?" You may need to reload as Firebase is not HMR aware.":""}`),ve("warn",{is:Ue,was:De})),ae;{const q=Ve();return globalThis.\u0275AngularfireInstanceCache.push([xe,q,Ue]),q}}const Xe=!!ft.hot,ve=(xe,...ke)=>{(0,g.X6Q)()&&typeof console<"u"&&console[xe](...ke)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},880:(ft,Pe,M)=>{"use strict";M.d(Pe,{q4:()=>nc,iC:()=>$a,fc:()=>lc,HU:()=>qo,vb:()=>bp,JM:()=>ac});var g=M(4650),j=M(5867),k=M(5861),oe=M(9681),me=M(2090),he=M(4859),we=M(1877);M(2833);const ye="@firebase/remote-config",z="0.3.11",Te=new me.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class ut{constructor(P,Z,pe,Fe){this.client=P,this.storage=Z,this.storageCache=pe,this.logger=Fe}isCachedDataFresh(P,Z){if(!Z)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const pe=Date.now()-Z,Fe=pe<=P;return this.logger.debug(`Config fetch cache check. Cache age millis: ${pe}. Cache max age millis (minimumFetchIntervalMillis setting): ${P}. Is cache hit: ${Fe}.`),Fe}fetch(P){var Z=this;return(0,k.Z)(function*(){const[pe,Fe]=yield Promise.all([Z.storage.getLastSuccessfulFetchTimestampMillis(),Z.storage.getLastSuccessfulFetchResponse()]);if(Fe&&Z.isCachedDataFresh(P.cacheMaxAgeMillis,pe))return Fe;P.eTag=Fe&&Fe.eTag;const Je=yield Z.client.fetch(P),It=[Z.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===Je.status&&It.push(Z.storage.setLastSuccessfulFetchResponse(Je)),yield Promise.all(It),Je})()}}function Zt(O=navigator){return O.languages&&O.languages[0]||O.language}class rn{constructor(P,Z,pe,Fe,Je,It){this.firebaseInstallations=P,this.sdkVersion=Z,this.namespace=pe,this.projectId=Fe,this.apiKey=Je,this.appId=It}fetch(P){var Z=this;return(0,k.Z)(function*(){var pe,Fe,Je;const[It,$t]=yield Promise.all([Z.firebaseInstallations.getId(),Z.firebaseInstallations.getToken()]),Xr=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${Z.projectId}/namespaces/${Z.namespace}:fetch?key=${Z.apiKey}`,Dn={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":P.eTag||"*"},Ht={sdk_version:Z.sdkVersion,app_instance_id:It,app_instance_id_token:$t,app_id:Z.appId,language_code:Zt()},Ar={method:"POST",headers:Dn,body:JSON.stringify(Ht)},Ko=fetch(Xr,Ar),Ts=new Promise((Ss,zs)=>{P.signal.addEventListener(()=>{const Gn=new Error("The operation was aborted.");Gn.name="AbortError",zs(Gn)})});let kt;try{yield Promise.race([Ko,Ts]),kt=yield Ko}catch(Ss){let zs="fetch-client-network";throw"AbortError"===(null===(pe=Ss)||void 0===pe?void 0:pe.name)&&(zs="fetch-timeout"),Te.create(zs,{originalErrorMessage:null===(Fe=Ss)||void 0===Fe?void 0:Fe.message})}let rs=kt.status;const Qd=kt.headers.get("ETag")||void 0;let Zo,Yo;if(200===kt.status){let Ss;try{Ss=yield kt.json()}catch(zs){throw Te.create("fetch-client-parse",{originalErrorMessage:null===(Je=zs)||void 0===Je?void 0:Je.message})}Zo=Ss.entries,Yo=Ss.state}if("INSTANCE_STATE_UNSPECIFIED"===Yo?rs=500:"NO_CHANGE"===Yo?rs=304:("NO_TEMPLATE"===Yo||"EMPTY_CONFIG"===Yo)&&(Zo={}),304!==rs&&200!==rs)throw Te.create("fetch-status",{httpStatus:rs});return{status:rs,eTag:Qd,config:Zo}})()}}class xt{constructor(P,Z){this.client=P,this.storage=Z}fetch(P){var Z=this;return(0,k.Z)(function*(){const pe=(yield Z.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return Z.attemptFetch(P,pe)})()}attemptFetch(P,{throttleEndTimeMillis:Z,backoffCount:pe}){var Fe=this;return(0,k.Z)(function*(){yield function pt(O,P){return new Promise((Z,pe)=>{const Fe=Math.max(P-Date.now(),0),Je=setTimeout(Z,Fe);O.addEventListener(()=>{clearTimeout(Je),pe(Te.create("fetch-throttle",{throttleEndTimeMillis:P}))})})}(P.signal,Z);try{const Je=yield Fe.client.fetch(P);return yield Fe.storage.deleteThrottleMetadata(),Je}catch(Je){if(!function Ut(O){if(!(O instanceof me.ZR&&O.customData))return!1;const P=Number(O.customData.httpStatus);return 429===P||500===P||503===P||504===P}(Je))throw Je;const It={throttleEndTimeMillis:Date.now()+(0,me.$s)(pe),backoffCount:pe+1};return yield Fe.storage.setThrottleMetadata(It),Fe.attemptFetch(P,It)}})()}}class Vt{constructor(P,Z,pe,Fe,Je){this.app=P,this._client=Z,this._storageCache=pe,this._storage=Fe,this._logger=Je,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function at(O,P){var Z;const pe=O.target.error||void 0;return Te.create(P,{originalErrorMessage:pe&&(null===(Z=pe)||void 0===Z?void 0:Z.message)})}const Nn="app_namespace_store";class qn{constructor(P,Z,pe,Fe=function Tn(){return new Promise((O,P)=>{var Z;try{const pe=indexedDB.open("firebase_remote_config",1);pe.onerror=Fe=>{P(at(Fe,"storage-open"))},pe.onsuccess=Fe=>{O(Fe.target.result)},pe.onupgradeneeded=Fe=>{0===Fe.oldVersion&&Fe.target.result.createObjectStore(Nn,{keyPath:"compositeKey"})}}catch(pe){P(Te.create("storage-open",{originalErrorMessage:null===(Z=pe)||void 0===Z?void 0:Z.message}))}})}()){this.appId=P,this.appName=Z,this.namespace=pe,this.openDbPromise=Fe}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(P){return this.set("last_fetch_status",P)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(P){return this.set("last_successful_fetch_timestamp_millis",P)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(P){return this.set("last_successful_fetch_response",P)}getActiveConfig(){return this.get("active_config")}setActiveConfig(P){return this.set("active_config",P)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(P){return this.set("active_config_etag",P)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(P){return this.set("throttle_metadata",P)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(P){var Z=this;return(0,k.Z)(function*(){const pe=yield Z.openDbPromise;return new Promise((Fe,Je)=>{var It;const dn=pe.transaction([Nn],"readonly").objectStore(Nn),Xr=Z.createCompositeKey(P);try{const Dn=dn.get(Xr);Dn.onerror=Ht=>{Je(at(Ht,"storage-get"))},Dn.onsuccess=Ht=>{const Ar=Ht.target.result;Fe(Ar?Ar.value:void 0)}}catch(Dn){Je(Te.create("storage-get",{originalErrorMessage:null===(It=Dn)||void 0===It?void 0:It.message}))}})})()}set(P,Z){var pe=this;return(0,k.Z)(function*(){const Fe=yield pe.openDbPromise;return new Promise((Je,It)=>{var $t;const Xr=Fe.transaction([Nn],"readwrite").objectStore(Nn),Dn=pe.createCompositeKey(P);try{const Ht=Xr.put({compositeKey:Dn,value:Z});Ht.onerror=Ar=>{It(at(Ar,"storage-set"))},Ht.onsuccess=()=>{Je()}}catch(Ht){It(Te.create("storage-set",{originalErrorMessage:null===($t=Ht)||void 0===$t?void 0:$t.message}))}})})()}delete(P){var Z=this;return(0,k.Z)(function*(){const pe=yield Z.openDbPromise;return new Promise((Fe,Je)=>{var It;const dn=pe.transaction([Nn],"readwrite").objectStore(Nn),Xr=Z.createCompositeKey(P);try{const Dn=dn.delete(Xr);Dn.onerror=Ht=>{Je(at(Ht,"storage-delete"))},Dn.onsuccess=()=>{Fe()}}catch(Dn){Je(Te.create("storage-delete",{originalErrorMessage:null===(It=Dn)||void 0===It?void 0:It.message}))}})})()}createCompositeKey(P){return[this.appId,this.appName,this.namespace,P].join()}}class zr{constructor(P){this.storage=P}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var P=this;return(0,k.Z)(function*(){const Z=P.storage.getLastFetchStatus(),pe=P.storage.getLastSuccessfulFetchTimestampMillis(),Fe=P.storage.getActiveConfig(),Je=yield Z;Je&&(P.lastFetchStatus=Je);const It=yield pe;It&&(P.lastSuccessfulFetchTimestampMillis=It);const $t=yield Fe;$t&&(P.activeConfig=$t)})()}setLastFetchStatus(P){return this.lastFetchStatus=P,this.storage.setLastFetchStatus(P)}setLastSuccessfulFetchTimestampMillis(P){return this.lastSuccessfulFetchTimestampMillis=P,this.storage.setLastSuccessfulFetchTimestampMillis(P)}setActiveConfig(P){return this.activeConfig=P,this.storage.setActiveConfig(P)}}function Dr(){return yn.apply(this,arguments)}function yn(){return(yn=(0,k.Z)(function*(){if(!(0,me.hl)())return!1;try{return yield(0,me.eu)()}catch{return!1}})).apply(this,arguments)}!function gr(){(0,oe._registerComponent)(new he.wA("remote-config",function O(P,{instanceIdentifier:Z}){const pe=P.getProvider("app").getImmediate(),Fe=P.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw Te.create("registration-window");if(!(0,me.hl)())throw Te.create("indexed-db-unavailable");const{projectId:Je,apiKey:It,appId:$t}=pe.options;if(!Je)throw Te.create("registration-project-id");if(!It)throw Te.create("registration-api-key");if(!$t)throw Te.create("registration-app-id");const dn=new qn($t,pe.name,Z=Z||"firebase"),Xr=new zr(dn),Dn=new we.Yd(ye);Dn.logLevel=we.in.ERROR;const Ht=new rn(Fe,oe.SDK_VERSION,Z,Je,It,$t),Ar=new xt(Ht,dn),Ko=new ut(Ar,dn,Xr,Dn),Ts=new Vt(pe,Ko,Xr,dn,Dn);return function De(O){const P=(0,me.m9)(O);P._initializePromise||(P._initializePromise=P._storageCache.loadFromStorage().then(()=>{P._isInitializationComplete=!0}))}(Ts),Ts},"PUBLIC").setMultipleInstances(!0)),(0,oe.registerVersion)(ye,z),(0,oe.registerVersion)(ye,z,"esm2017")}();var bn=M(8766);const rt="/firebase-messaging-sw.js",Pn="/firebase-cloud-messaging-push-scope",ar="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Bn="google.c.a.c_id",Tr="google.c.a.c_l",bt="google.c.a.ts",lt="google.c.a.e";var Yt=(()=>{return(O=Yt||(Yt={})).PUSH_RECEIVED="push-received",O.NOTIFICATION_CLICKED="notification-clicked",Yt;var O})();function on(O){const P=new Uint8Array(O);return btoa(String.fromCharCode(...P)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Kn(O){const Z=(O+"=".repeat((4-O.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),pe=atob(Z),Fe=new Uint8Array(pe.length);for(let Je=0;Je<pe.length;++Je)Fe[Je]=pe.charCodeAt(Je);return Fe}const ur="fcm_token_details_db",Sr="fcm_token_object_Store";function Pt(O){return mr.apply(this,arguments)}function mr(){return mr=(0,k.Z)(function*(O){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(Je=>Je.name).includes(ur))return null;let P=null;return(yield(0,bn.X3)(ur,5,{upgrade:(pe=(0,k.Z)(function*(Fe,Je,It,$t){var dn;if(Je<2||!Fe.objectStoreNames.contains(Sr))return;const Xr=$t.objectStore(Sr),Dn=yield Xr.index("fcmSenderId").get(O);if(yield Xr.clear(),Dn)if(2===Je){const Ht=Dn;if(!Ht.auth||!Ht.p256dh||!Ht.endpoint)return;P={token:Ht.fcmToken,createTime:null!==(dn=Ht.createTime)&&void 0!==dn?dn:Date.now(),subscriptionOptions:{auth:Ht.auth,p256dh:Ht.p256dh,endpoint:Ht.endpoint,swScope:Ht.swScope,vapidKey:"string"==typeof Ht.vapidKey?Ht.vapidKey:on(Ht.vapidKey)}}}else if(3===Je){const Ht=Dn;P={token:Ht.fcmToken,createTime:Ht.createTime,subscriptionOptions:{auth:on(Ht.auth),p256dh:on(Ht.p256dh),endpoint:Ht.endpoint,swScope:Ht.swScope,vapidKey:on(Ht.vapidKey)}}}else if(4===Je){const Ht=Dn;P={token:Ht.fcmToken,createTime:Ht.createTime,subscriptionOptions:{auth:on(Ht.auth),p256dh:on(Ht.p256dh),endpoint:Ht.endpoint,swScope:Ht.swScope,vapidKey:on(Ht.vapidKey)}}}}),function(Je,It,$t,dn){return pe.apply(this,arguments)})})).close(),yield(0,bn.Lj)(ur),yield(0,bn.Lj)("fcm_vapid_details_db"),yield(0,bn.Lj)("undefined"),Nt(P)?P:null;var pe}),mr.apply(this,arguments)}function Nt(O){if(!O||!O.subscriptionOptions)return!1;const{subscriptionOptions:P}=O;return"number"==typeof O.createTime&&O.createTime>0&&"string"==typeof O.token&&O.token.length>0&&"string"==typeof P.auth&&P.auth.length>0&&"string"==typeof P.p256dh&&P.p256dh.length>0&&"string"==typeof P.endpoint&&P.endpoint.length>0&&"string"==typeof P.swScope&&P.swScope.length>0&&"string"==typeof P.vapidKey&&P.vapidKey.length>0}const B="firebase-messaging-store";let W=null;function K(){return W||(W=(0,bn.X3)("firebase-messaging-database",1,{upgrade:(O,P)=>{0===P&&O.createObjectStore(B)}})),W}function Me(O){return Qe.apply(this,arguments)}function Qe(){return(Qe=(0,k.Z)(function*(O){const P=U(O),pe=yield(yield K()).transaction(B).objectStore(B).get(P);if(pe)return pe;{const Fe=yield Pt(O.appConfig.senderId);if(Fe)return yield gt(O,Fe),Fe}})).apply(this,arguments)}function gt(O,P){return en.apply(this,arguments)}function en(){return(en=(0,k.Z)(function*(O,P){const Z=U(O),Fe=(yield K()).transaction(B,"readwrite");return yield Fe.objectStore(B).put(P,Z),yield Fe.done,P})).apply(this,arguments)}function an(O){return de.apply(this,arguments)}function de(){return(de=(0,k.Z)(function*(O){const P=U(O),pe=(yield K()).transaction(B,"readwrite");yield pe.objectStore(B).delete(P),yield pe.done})).apply(this,arguments)}function U({appConfig:O}){return O.appId}const F=new me.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function ie(O,P){return be.apply(this,arguments)}function be(){return(be=(0,k.Z)(function*(O,P){var Z;const pe=yield Ln(O),Fe=wn(P),Je={method:"POST",headers:pe,body:JSON.stringify(Fe)};let It;try{It=yield(yield fetch(cn(O.appConfig),Je)).json()}catch($t){throw F.create("token-subscribe-failed",{errorInfo:null===(Z=$t)||void 0===Z?void 0:Z.toString()})}if(It.error)throw F.create("token-subscribe-failed",{errorInfo:It.error.message});if(!It.token)throw F.create("token-subscribe-no-token");return It.token})).apply(this,arguments)}function Ze(O,P){return ze.apply(this,arguments)}function ze(){return(ze=(0,k.Z)(function*(O,P){var Z;const pe=yield Ln(O),Fe=wn(P.subscriptionOptions),Je={method:"PATCH",headers:pe,body:JSON.stringify(Fe)};let It;try{It=yield(yield fetch(`${cn(O.appConfig)}/${P.token}`,Je)).json()}catch($t){throw F.create("token-update-failed",{errorInfo:null===(Z=$t)||void 0===Z?void 0:Z.toString()})}if(It.error)throw F.create("token-update-failed",{errorInfo:It.error.message});if(!It.token)throw F.create("token-update-no-token");return It.token})).apply(this,arguments)}function dt(O,P){return Rt.apply(this,arguments)}function Rt(){return(Rt=(0,k.Z)(function*(O,P){var Z;const Fe={method:"DELETE",headers:yield Ln(O)};try{const It=yield(yield fetch(`${cn(O.appConfig)}/${P}`,Fe)).json();if(It.error)throw F.create("token-unsubscribe-failed",{errorInfo:It.error.message})}catch(Je){throw F.create("token-unsubscribe-failed",{errorInfo:null===(Z=Je)||void 0===Z?void 0:Z.toString()})}})).apply(this,arguments)}function cn({projectId:O}){return`https://fcmregistrations.googleapis.com/v1/projects/${O}/registrations`}function Ln(O){return Tt.apply(this,arguments)}function Tt(){return(Tt=(0,k.Z)(function*({appConfig:O,installations:P}){const Z=yield P.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":O.apiKey,"x-goog-firebase-installations-auth":`FIS ${Z}`})})).apply(this,arguments)}function wn({p256dh:O,auth:P,endpoint:Z,vapidKey:pe}){const Fe={web:{endpoint:Z,auth:P,p256dh:O}};return pe!==ar&&(Fe.web.applicationPubKey=pe),Fe}const js=6048e5;function Es(O){return Bo.apply(this,arguments)}function Bo(){return(Bo=(0,k.Z)(function*(O){const P=yield Cn(O.swRegistration,O.vapidKey),Z={vapidKey:O.vapidKey,swScope:O.swRegistration.scope,endpoint:P.endpoint,auth:on(P.getKey("auth")),p256dh:on(P.getKey("p256dh"))},pe=yield Me(O.firebaseDependencies);if(pe){if(nn(pe.subscriptionOptions,Z))return Date.now()>=pe.createTime+js?re(O,{token:pe.token,createTime:Date.now(),subscriptionOptions:Z}):pe.token;try{yield dt(O.firebaseDependencies,pe.token)}catch(Fe){console.warn(Fe)}return We(O.firebaseDependencies,Z)}return We(O.firebaseDependencies,Z)})).apply(this,arguments)}function jo(O){return Zn.apply(this,arguments)}function Zn(){return(Zn=(0,k.Z)(function*(O){const P=yield Me(O.firebaseDependencies);P&&(yield dt(O.firebaseDependencies,P.token),yield an(O.firebaseDependencies));const Z=yield O.swRegistration.pushManager.getSubscription();return!Z||Z.unsubscribe()})).apply(this,arguments)}function re(O,P){return Se.apply(this,arguments)}function Se(){return(Se=(0,k.Z)(function*(O,P){try{const Z=yield Ze(O.firebaseDependencies,P),pe=Object.assign(Object.assign({},P),{token:Z,createTime:Date.now()});return yield gt(O.firebaseDependencies,pe),Z}catch(Z){throw yield jo(O),Z}})).apply(this,arguments)}function We(O,P){return Ct.apply(this,arguments)}function Ct(){return(Ct=(0,k.Z)(function*(O,P){const pe={token:yield ie(O,P),createTime:Date.now(),subscriptionOptions:P};return yield gt(O,pe),pe.token})).apply(this,arguments)}function Cn(O,P){return yt.apply(this,arguments)}function yt(){return(yt=(0,k.Z)(function*(O,P){return(yield O.pushManager.getSubscription())||O.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Kn(P)})})).apply(this,arguments)}function nn(O,P){return P.vapidKey===O.vapidKey&&P.endpoint===O.endpoint&&P.auth===O.auth&&P.p256dh===O.p256dh}function vn(O){const P={from:O.from,collapseKey:O.collapse_key,messageId:O.fcmMessageId};return function Wr(O,P){if(!P.notification)return;O.notification={};const Z=P.notification.title;Z&&(O.notification.title=Z);const pe=P.notification.body;pe&&(O.notification.body=pe);const Fe=P.notification.image;Fe&&(O.notification.image=Fe)}(P,O),function Sn(O,P){!P.data||(O.data=P.data)}(P,O),function ci(O,P){var Z,pe,Fe,Je,It;if(!(P.fcmOptions||null!==(Z=P.notification)&&void 0!==Z&&Z.click_action))return;O.fcmOptions={};const $t=null!==(Fe=null===(pe=P.fcmOptions)||void 0===pe?void 0:pe.link)&&void 0!==Fe?Fe:null===(Je=P.notification)||void 0===Je?void 0:Je.click_action;$t&&(O.fcmOptions.link=$t);const dn=null===(It=P.fcmOptions)||void 0===It?void 0:It.analytics_label;dn&&(O.fcmOptions.analyticsLabel=dn)}(P,O),P}function st(O){return"object"==typeof O&&!!O&&Bn in O}function Ot(O,P){const Z=[];for(let pe=0;pe<O.length;pe++)Z.push(O.charAt(pe)),pe<P.length&&Z.push(P.charAt(pe));return Z.join("")}function qr(O){return F.create("missing-app-config-values",{valueName:O})}Ot("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Ot("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Ui{constructor(P,Z,pe){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const Fe=function jn(O){if(!O||!O.options)throw qr("App Configuration Object");if(!O.name)throw qr("App Name");const P=["projectId","apiKey","appId","messagingSenderId"],{options:Z}=O;for(const pe of P)if(!Z[pe])throw qr(pe);return{appName:O.name,projectId:Z.projectId,apiKey:Z.apiKey,appId:Z.appId,senderId:Z.messagingSenderId}}(P);this.firebaseDependencies={app:P,appConfig:Fe,installations:Z,analyticsProvider:pe}}_delete(){return Promise.resolve()}}function er(O){return Is.apply(this,arguments)}function Is(){return(Is=(0,k.Z)(function*(O){var P;try{O.swRegistration=yield navigator.serviceWorker.register(rt,{scope:Pn}),O.swRegistration.update().catch(()=>{})}catch(Z){throw F.create("failed-service-worker-registration",{browserErrorMessage:null===(P=Z)||void 0===P?void 0:P.message})}})).apply(this,arguments)}function Fn(O,P){return uo.apply(this,arguments)}function uo(){return(uo=(0,k.Z)(function*(O,P){if(!P&&!O.swRegistration&&(yield er(O)),P||!O.swRegistration){if(!(P instanceof ServiceWorkerRegistration))throw F.create("invalid-sw-registration");O.swRegistration=P}})).apply(this,arguments)}function $s(O,P){return Bt.apply(this,arguments)}function Bt(){return(Bt=(0,k.Z)(function*(O,P){P?O.vapidKey=P:O.vapidKey||(O.vapidKey=ar)})).apply(this,arguments)}function Hs(){return(Hs=(0,k.Z)(function*(O,P){if(!navigator)throw F.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw F.create("permission-blocked");return yield $s(O,P?.vapidKey),yield Fn(O,P?.serviceWorkerRegistration),Es(O)})).apply(this,arguments)}function Na(O,P,Z){return Gs.apply(this,arguments)}function Gs(){return(Gs=(0,k.Z)(function*(O,P,Z){const pe=lr(P);(yield O.firebaseDependencies.analyticsProvider.get()).logEvent(pe,{message_id:Z[Bn],message_name:Z[Tr],message_time:Z[bt],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function lr(O){switch(O){case Yt.NOTIFICATION_CLICKED:return"notification_open";case Yt.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function Vi(){return(Vi=(0,k.Z)(function*(O,P){const Z=P.data;if(!Z.isFirebaseMessaging)return;O.onMessageHandler&&Z.messageType===Yt.PUSH_RECEIVED&&("function"==typeof O.onMessageHandler?O.onMessageHandler(vn(Z)):O.onMessageHandler.next(vn(Z)));const pe=Z.data;st(pe)&&"1"===pe[lt]&&(yield Na(O,Z.messageType,pe))})).apply(this,arguments)}const Kr="@firebase/messaging",ni=O=>{const P=new Ui(O.getProvider("app").getImmediate(),O.getProvider("installations-internal").getImmediate(),O.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",Z=>function $o(O,P){return Vi.apply(this,arguments)}(P,Z)),P},kn=O=>{const P=O.getProvider("messaging").getImmediate();return{getToken:pe=>function bs(O,P){return Hs.apply(this,arguments)}(P,pe)}};function Oa(){return lo.apply(this,arguments)}function lo(){return(lo=(0,k.Z)(function*(){try{yield(0,me.eu)()}catch{return!1}return typeof window<"u"&&(0,me.hl)()&&(0,me.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function Ji(){(0,oe._registerComponent)(new he.wA("messaging",ni,"PUBLIC")),(0,oe._registerComponent)(new he.wA("messaging-internal",kn,"PRIVATE")),(0,oe.registerVersion)(Kr,"0.9.16"),(0,oe.registerVersion)(Kr,"0.9.16","esm2017")}();var Ho=M(6148),Fa=M(4408),vp=M(7565);const es=new class tc extends vp.v{}(class Yr extends Fa.o{constructor(P,Z){super(P,Z),this.scheduler=P,this.work=Z}schedule(P,Z=0){return Z>0?super.schedule(P,Z):(this.delay=Z,this.state=P,this.scheduler.flush(this),this)}execute(P,Z){return Z>0||this.closed?super.execute(P,Z):this._execute(P,Z)}requestAsyncId(P,Z,pe=0){return null!=pe&&pe>0||null==pe&&this.delay>0?super.requestAsyncId(P,Z,pe):(P.flush(this),0)}});var zo=M(4986),wp=M(8505),Yd=M(5363),Ep=M(9468);const nc=new g.GfV("7.5.0"),ts="__angularfire_symbol__analyticsIsSupportedValue",rc="__angularfire_symbol__analyticsIsSupported",Ua="__angularfire_symbol__remoteConfigIsSupportedValue",ic="__angularfire_symbol__remoteConfigIsSupported",Va="__angularfire_symbol__messagingIsSupportedValue",Ba="__angularfire_symbol__messagingIsSupported";function ac(O,P,Z){if(P){if(1===P.length)return P[0];const Je=P.filter(It=>It.app===Z);if(1===Je.length)return Je[0]}return Z.container.getProvider(O).getImmediate({optional:!0})}globalThis[rc]||(globalThis[rc]=(0,Ho.Gb)().then(O=>globalThis[ts]=O).catch(()=>globalThis[ts]=!1)),globalThis[Ba]||(globalThis[Ba]=Oa().then(O=>globalThis[Va]=O).catch(()=>globalThis[Va]=!1)),globalThis[ic]||(globalThis[ic]=Dr().then(O=>globalThis[Ua]=O).catch(()=>globalThis[Ua]=!1));const bp=(O,P)=>{const Z=P?[P]:(0,j.C6)(),pe=[];return Z.forEach(Fe=>{Fe.container.getProvider(O).instances.forEach(It=>{pe.includes(It)||pe.push(It)})}),pe};function wi(){}class uc{constructor(P,Z=es){this.zone=P,this.delegate=Z}now(){return this.delegate.now()}schedule(P,Z,pe){const Fe=this.zone;return this.delegate.schedule(function(It){Fe.runGuarded(()=>{P.apply(this,[It])})},Z,pe)}}class Wo{constructor(P){this.zone=P,this.task=null}call(P,Z){const pe=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",wi,{},wi,wi)),Z.pipe((0,wp.b)({next:pe,complete:pe,error:pe})).subscribe(P).add(pe)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let qo=(()=>{class O{constructor(Z){this.ngZone=Z,this.outsideAngular=Z.runOutsideAngular(()=>new uc(Zone.current)),this.insideAngular=Z.run(()=>new uc(Zone.current,zo.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return O.\u0275fac=function(Z){return new(Z||O)(g.LFG(g.R0b))},O.\u0275prov=g.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"}),O})();function ns(){const O=globalThis.\u0275AngularFireScheduler;if(!O)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return O}function lc(O){return O.pipe((0,Yd.Q)(ns().outsideAngular))}function $a(O){return ns(),function Vu(O){return function(Z){return(Z=Z.lift(new Wo(O.ngZone))).pipe((0,Ep.R)(O.outsideAngular),(0,Yd.Q)(O.insideAngular))}}(ns())(O)}},6457:(ft,Pe,M)=>{"use strict";M.d(Pe,{$:()=>It,A:()=>H,B:()=>Te,G:()=>Se,H:()=>nn,J:()=>Ji,L:()=>en,M:()=>tc,N:()=>wp,P:()=>mD,Q:()=>Yd,R:()=>$p,T:()=>Ep,U:()=>zo,V:()=>Ua,W:()=>ic,X:()=>Ip,Y:()=>Qr,Z:()=>O,_:()=>Z,a:()=>go,a0:()=>Ht,a1:()=>Ko,a2:()=>kt,a3:()=>Qd,a4:()=>Yo,a5:()=>zs,a6:()=>ww,a7:()=>je,a8:()=>i_,a9:()=>s_,aA:()=>Ja,aB:()=>ph,aC:()=>zp,aD:()=>b_,aE:()=>Zn,aI:()=>Wa,aL:()=>ts,aa:()=>Ws,ab:()=>dc,ac:()=>Ew,af:()=>o_,ag:()=>Rs,ah:()=>Iw,ak:()=>uc,al:()=>Ap,an:()=>Rw,ao:()=>po,ap:()=>cn,aq:()=>Ee,ar:()=>Rt,as:()=>Ze,at:()=>Ne,au:()=>Cc,av:()=>eu,aw:()=>Ve,ax:()=>q,ay:()=>X,az:()=>an,b:()=>Pp,c:()=>ch,d:()=>E_,e:()=>Uw,f:()=>wc,g:()=>qp,h:()=>At,i:()=>Fp,j:()=>Kp,k:()=>Ih,l:()=>Ow,m:()=>Eo,o:()=>_e,r:()=>m_,s:()=>yo,u:()=>Lw});var g=M(5861),j=M(2090),k=M(9681),oe=M(655),me=M(1877),he=M(4859);const _e={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},H={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const Te=function te(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},Ke=function Oe(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Xe=new j.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),xe=new me.Yd("@firebase/auth");function ke(w,...p){xe.logLevel<=me.in.ERROR&&xe.error(`Auth (${k.SDK_VERSION}): ${w}`,...p)}function Ne(w,...p){throw De(w,...p)}function Ve(w,...p){return De(w,...p)}function Ue(w,p,_){const I=Object.assign(Object.assign({},Ke()),{[p]:_});return new j.LL("auth","Firebase",I).create(p,{appName:w.name})}function ae(w,p,_){if(!(p instanceof _))throw _.name!==p.constructor.name&&Ne(w,"argument-error"),Ue(w,"argument-error",`Type of ${p.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function De(w,...p){if("string"!=typeof w){const _=p[0],I=[...p.slice(1)];return I[0]&&(I[0].appName=w.name),w._errorFactory.create(_,...I)}return Xe.create(w,...p)}function q(w,p,..._){if(!w)throw De(p,..._)}function se(w){const p="INTERNAL ASSERTION FAILED: "+w;throw ke(p),new Error(p)}function Ee(w,p){w||se(p)}const Q=new Map;function X(w){Ee(w instanceof Function,"Expected a class definition");let p=Q.get(w);return p?(Ee(p instanceof w,"Instance stored in cache mismatched with class"),p):(p=new w,Q.set(w,p),p)}function $e(){var w;return typeof self<"u"&&(null===(w=self.location)||void 0===w?void 0:w.href)||""}function He(){return"http:"===ut()||"https:"===ut()}function ut(){var w;return typeof self<"u"&&(null===(w=self.location)||void 0===w?void 0:w.protocol)||null}class pt{constructor(p,_){this.shortDelay=p,this.longDelay=_,Ee(_>p,"Short delay should be less than long delay!"),this.isMobile=(0,j.uI)()||(0,j.b$)()}get(){return function Zt(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(He()||(0,j.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Ut(w,p){Ee(w.emulator,"Emulator should always be set here");const{url:_}=w.emulator;return p?`${_}${p.startsWith("/")?p.slice(1):p}`:_}class xt{static initialize(p,_,I){this.fetchImpl=p,_&&(this.headersImpl=_),I&&(this.responseImpl=I)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void se("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void se("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void se("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const ln={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},Wn=new pt(3e4,6e4);function Vt(w,p){return w.tenantId&&!p.tenantId?Object.assign(Object.assign({},p),{tenantId:w.tenantId}):p}function at(w,p,_,I){return Nn.apply(this,arguments)}function Nn(){return(Nn=(0,g.Z)(function*(w,p,_,I,S={}){return Gr(w,S,(0,g.Z)(function*(){let R={},le={};I&&("GET"===p?le=I:R={body:JSON.stringify(I)});const Le=(0,j.xO)(Object.assign({key:w.config.apiKey},le)).slice(1),et=yield w._getAdditionalHeaders();return et["Content-Type"]="application/json",w.languageCode&&(et["X-Firebase-Locale"]=w.languageCode),xt.fetch()(zr(w,w.config.apiHost,_,Le),Object.assign({method:p,headers:et,referrerPolicy:"no-referrer"},R))}))})).apply(this,arguments)}function Gr(w,p,_){return pr.apply(this,arguments)}function pr(){return(pr=(0,g.Z)(function*(w,p,_){w._canInitEmulator=!1;const I=Object.assign(Object.assign({},ln),p);try{const S=new gr(w),R=yield Promise.race([_(),S.promise]);S.clearNetworkTimeout();const le=yield R.json();if("needConfirmation"in le)throw Hn(w,"account-exists-with-different-credential",le);if(R.ok&&!("errorMessage"in le))return le;{const Le=R.ok?le.errorMessage:le.error.message,[et,St]=Le.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===et)throw Hn(w,"credential-already-in-use",le);if("EMAIL_EXISTS"===et)throw Hn(w,"email-already-in-use",le);if("USER_DISABLED"===et)throw Hn(w,"user-disabled",le);const jt=I[et]||et.toLowerCase().replace(/[_\s]+/g,"-");if(St)throw Ue(w,jt,St);Ne(w,jt)}}catch(S){if(S instanceof j.ZR)throw S;Ne(w,"network-request-failed")}})).apply(this,arguments)}function Tn(w,p,_,I){return qn.apply(this,arguments)}function qn(){return(qn=(0,g.Z)(function*(w,p,_,I,S={}){const R=yield at(w,p,_,I,S);return"mfaPendingCredential"in R&&Ne(w,"multi-factor-auth-required",{_serverResponse:R}),R})).apply(this,arguments)}function zr(w,p,_,I){const S=`${p}${_}?${I}`;return w.config.emulator?Ut(w.config,S):`${w.config.apiScheme}://${S}`}class gr{constructor(p){this.auth=p,this.timer=null,this.promise=new Promise((_,I)=>{this.timer=setTimeout(()=>I(Ve(this.auth,"network-request-failed")),Wn.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Hn(w,p,_){const I={appName:w.name};_.email&&(I.email=_.email),_.phoneNumber&&(I.phoneNumber=_.phoneNumber);const S=Ve(w,p,I);return S.customData._tokenResponse=_,S}function Dr(){return(Dr=(0,g.Z)(function*(w,p){return at(w,"POST","/v1/accounts:delete",p)})).apply(this,arguments)}function yn(w,p){return bn.apply(this,arguments)}function bn(){return(bn=(0,g.Z)(function*(w,p){return at(w,"POST","/v1/accounts:update",p)})).apply(this,arguments)}function rt(w,p){return Pn.apply(this,arguments)}function Pn(){return(Pn=(0,g.Z)(function*(w,p){return at(w,"POST","/v1/accounts:lookup",p)})).apply(this,arguments)}function ar(w){if(w)try{const p=new Date(Number(w));if(!isNaN(p.getTime()))return p.toUTCString()}catch{}}function Tr(){return(Tr=(0,g.Z)(function*(w,p=!1){const _=(0,j.m9)(w),I=yield _.getIdToken(p),S=lt(I);q(S&&S.exp&&S.auth_time&&S.iat,_.auth,"internal-error");const R="object"==typeof S.firebase?S.firebase:void 0,le=R?.sign_in_provider;return{claims:S,token:I,authTime:ar(bt(S.auth_time)),issuedAtTime:ar(bt(S.iat)),expirationTime:ar(bt(S.exp)),signInProvider:le||null,signInSecondFactor:R?.sign_in_second_factor||null}})).apply(this,arguments)}function bt(w){return 1e3*Number(w)}function lt(w){var p;const[_,I,S]=w.split(".");if(void 0===_||void 0===I||void 0===S)return ke("JWT malformed, contained fewer than 3 sections"),null;try{const R=(0,j.tV)(I);return R?JSON.parse(R):(ke("Failed to decode base64 JWT payload"),null)}catch(R){return ke("Caught error parsing JWT payload as JSON",null===(p=R)||void 0===p?void 0:p.toString()),null}}function Yt(w,p){return on.apply(this,arguments)}function on(){return(on=(0,g.Z)(function*(w,p,_=!1){if(_)return p;try{return yield p}catch(I){throw I instanceof j.ZR&&Kn(I)&&w.auth.currentUser===w&&(yield w.auth.signOut()),I}})).apply(this,arguments)}function Kn({code:w}){return"auth/user-disabled"===w||"auth/user-token-expired"===w}class ur{constructor(p){this.user=p,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(p){var _;if(p){const I=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),I}{this.errorBackoff=3e4;const S=(null!==(_=this.user.stsTokenManager.expirationTime)&&void 0!==_?_:0)-Date.now()-3e5;return Math.max(0,S)}}schedule(p=!1){var _=this;if(!this.isRunning)return;const I=this.getInterval(p);this.timerId=setTimeout((0,g.Z)(function*(){yield _.iteration()}),I)}iteration(){var p=this;return(0,g.Z)(function*(){var _;try{yield p.user.getIdToken(!0)}catch(I){return void("auth/network-request-failed"===(null===(_=I)||void 0===_?void 0:_.code)&&p.schedule(!0))}p.schedule()})()}}class On{constructor(p,_){this.createdAt=p,this.lastLoginAt=_,this._initializeTime()}_initializeTime(){this.lastSignInTime=ar(this.lastLoginAt),this.creationTime=ar(this.createdAt)}_copy(p){this.createdAt=p.createdAt,this.lastLoginAt=p.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Sr(w){return Pt.apply(this,arguments)}function Pt(){return(Pt=(0,g.Z)(function*(w){var p;const _=w.auth,I=yield w.getIdToken(),S=yield Yt(w,rt(_,{idToken:I}));q(S?.users.length,_,"internal-error");const R=S.users[0];w._notifyReloadListener(R);const le=null!==(p=R.providerUserInfo)&&void 0!==p&&p.length?G(R.providerUserInfo):[],Le=J(w.providerData,le),jt=!!w.isAnonymous&&!(w.email&&R.passwordHash||Le?.length),xn={uid:R.localId,displayName:R.displayName||null,photoURL:R.photoUrl||null,email:R.email||null,emailVerified:R.emailVerified||!1,phoneNumber:R.phoneNumber||null,tenantId:R.tenantId||null,providerData:Le,metadata:new On(R.createdAt,R.lastLoginAt),isAnonymous:jt};Object.assign(w,xn)})).apply(this,arguments)}function Nt(){return(Nt=(0,g.Z)(function*(w){const p=(0,j.m9)(w);yield Sr(p),yield p.auth._persistUserIfCurrent(p),p.auth._notifyListenersIfCurrent(p)})).apply(this,arguments)}function J(w,p){return[...w.filter(I=>!p.some(S=>S.providerId===I.providerId)),...p]}function G(w){return w.map(p=>{var{providerId:_}=p,I=(0,oe._T)(p,["providerId"]);return{providerId:_,uid:I.rawId||"",displayName:I.displayName||null,email:I.email||null,phoneNumber:I.phoneNumber||null,photoURL:I.photoUrl||null}})}function W(){return(W=(0,g.Z)(function*(w,p){const _=yield Gr(w,{},(0,g.Z)(function*(){const I=(0,j.xO)({grant_type:"refresh_token",refresh_token:p}).slice(1),{tokenApiHost:S,apiKey:R}=w.config,le=zr(w,S,"/v1/token",`key=${R}`),Le=yield w._getAdditionalHeaders();return Le["Content-Type"]="application/x-www-form-urlencoded",xt.fetch()(le,{method:"POST",headers:Le,body:I})}));return{accessToken:_.access_token,expiresIn:_.expires_in,refreshToken:_.refresh_token}})).apply(this,arguments)}class K{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(p){q(p.idToken,"internal-error"),q(typeof p.idToken<"u","internal-error"),q(typeof p.refreshToken<"u","internal-error");const _="expiresIn"in p&&typeof p.expiresIn<"u"?Number(p.expiresIn):function Dt(w){const p=lt(w);return q(p,"internal-error"),q(typeof p.exp<"u","internal-error"),q(typeof p.iat<"u","internal-error"),Number(p.exp)-Number(p.iat)}(p.idToken);this.updateTokensAndExpiration(p.idToken,p.refreshToken,_)}getToken(p,_=!1){var I=this;return(0,g.Z)(function*(){return q(!I.accessToken||I.refreshToken,p,"user-token-expired"),_||!I.accessToken||I.isExpired?I.refreshToken?(yield I.refresh(p,I.refreshToken),I.accessToken):null:I.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(p,_){var I=this;return(0,g.Z)(function*(){const{accessToken:S,refreshToken:R,expiresIn:le}=yield function B(w,p){return W.apply(this,arguments)}(p,_);I.updateTokensAndExpiration(S,R,Number(le))})()}updateTokensAndExpiration(p,_,I){this.refreshToken=_||null,this.accessToken=p||null,this.expirationTime=Date.now()+1e3*I}static fromJSON(p,_){const{refreshToken:I,accessToken:S,expirationTime:R}=_,le=new K;return I&&(q("string"==typeof I,"internal-error",{appName:p}),le.refreshToken=I),S&&(q("string"==typeof S,"internal-error",{appName:p}),le.accessToken=S),R&&(q("number"==typeof R,"internal-error",{appName:p}),le.expirationTime=R),le}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(p){this.accessToken=p.accessToken,this.refreshToken=p.refreshToken,this.expirationTime=p.expirationTime}_clone(){return Object.assign(new K,this.toJSON())}_performRefresh(){return se("not implemented")}}function Me(w,p){q("string"==typeof w||typeof w>"u","internal-error",{appName:p})}class Qe{constructor(p){var{uid:_,auth:I,stsTokenManager:S}=p,R=(0,oe._T)(p,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ur(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=_,this.auth=I,this.stsTokenManager=S,this.accessToken=S.accessToken,this.displayName=R.displayName||null,this.email=R.email||null,this.emailVerified=R.emailVerified||!1,this.phoneNumber=R.phoneNumber||null,this.photoURL=R.photoURL||null,this.isAnonymous=R.isAnonymous||!1,this.tenantId=R.tenantId||null,this.providerData=R.providerData?[...R.providerData]:[],this.metadata=new On(R.createdAt||void 0,R.lastLoginAt||void 0)}getIdToken(p){var _=this;return(0,g.Z)(function*(){const I=yield Yt(_,_.stsTokenManager.getToken(_.auth,p));return q(I,_.auth,"internal-error"),_.accessToken!==I&&(_.accessToken=I,yield _.auth._persistUserIfCurrent(_),_.auth._notifyListenersIfCurrent(_)),I})()}getIdTokenResult(p){return function Bn(w){return Tr.apply(this,arguments)}(this,p)}reload(){return function mr(w){return Nt.apply(this,arguments)}(this)}_assign(p){this!==p&&(q(this.uid===p.uid,this.auth,"internal-error"),this.displayName=p.displayName,this.photoURL=p.photoURL,this.email=p.email,this.emailVerified=p.emailVerified,this.phoneNumber=p.phoneNumber,this.isAnonymous=p.isAnonymous,this.tenantId=p.tenantId,this.providerData=p.providerData.map(_=>Object.assign({},_)),this.metadata._copy(p.metadata),this.stsTokenManager._assign(p.stsTokenManager))}_clone(p){return new Qe(Object.assign(Object.assign({},this),{auth:p,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(p){q(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=p,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(p){this.reloadListener?this.reloadListener(p):this.reloadUserInfo=p}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(p,_=!1){var I=this;return(0,g.Z)(function*(){let S=!1;p.idToken&&p.idToken!==I.stsTokenManager.accessToken&&(I.stsTokenManager.updateFromServerResponse(p),S=!0),_&&(yield Sr(I)),yield I.auth._persistUserIfCurrent(I),S&&I.auth._notifyListenersIfCurrent(I)})()}delete(){var p=this;return(0,g.Z)(function*(){const _=yield p.getIdToken();return yield Yt(p,function Jn(w,p){return Dr.apply(this,arguments)}(p.auth,{idToken:_})),p.stsTokenManager.clearRefreshToken(),p.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(p=>Object.assign({},p)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(p,_){var I,S,R,le,Le,et,St,jt;const xn=null!==(I=_.displayName)&&void 0!==I?I:void 0,Ms=null!==(S=_.email)&&void 0!==S?S:void 0,pi=null!==(R=_.phoneNumber)&&void 0!==R?R:void 0,Io=null!==(le=_.photoURL)&&void 0!==le?le:void 0,Ch=null!==(Le=_.tenantId)&&void 0!==Le?Le:void 0,bo=null!==(et=_._redirectEventId)&&void 0!==et?et:void 0,Ac=null!==(St=_.createdAt)&&void 0!==St?St:void 0,rl=null!==(jt=_.lastLoginAt)&&void 0!==jt?jt:void 0,{uid:os,emailVerified:il,isAnonymous:Rc,providerData:Dh,stsTokenManager:xc}=_;q(os&&xc,p,"internal-error");const R_=K.fromJSON(this.name,xc);q("string"==typeof os,p,"internal-error"),Me(xn,p.name),Me(Ms,p.name),q("boolean"==typeof il,p,"internal-error"),q("boolean"==typeof Rc,p,"internal-error"),Me(pi,p.name),Me(Io,p.name),Me(Ch,p.name),Me(bo,p.name),Me(Ac,p.name),Me(rl,p.name);const su=new Qe({uid:os,auth:p,email:Ms,emailVerified:il,displayName:xn,isAnonymous:Rc,photoURL:Io,phoneNumber:pi,tenantId:Ch,stsTokenManager:R_,createdAt:Ac,lastLoginAt:rl});return Dh&&Array.isArray(Dh)&&(su.providerData=Dh.map(x_=>Object.assign({},x_))),bo&&(su._redirectEventId=bo),su}static _fromIdTokenResponse(p,_,I=!1){return(0,g.Z)(function*(){const S=new K;S.updateFromServerResponse(_);const R=new Qe({uid:_.localId,auth:p,stsTokenManager:S,isAnonymous:I});return yield Sr(R),R})()}}const en=(()=>{class w{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,g.Z)(function*(){return!0})()}_set(_,I){var S=this;return(0,g.Z)(function*(){S.storage[_]=I})()}_get(_){var I=this;return(0,g.Z)(function*(){const S=I.storage[_];return void 0===S?null:S})()}_remove(_){var I=this;return(0,g.Z)(function*(){delete I.storage[_]})()}_addListener(_,I){}_removeListener(_,I){}}return w.type="NONE",w})();function an(w,p,_){return`firebase:${w}:${p}:${_}`}class de{constructor(p,_,I){this.persistence=p,this.auth=_,this.userKey=I;const{config:S,name:R}=this.auth;this.fullUserKey=an(this.userKey,S.apiKey,R),this.fullPersistenceKey=an("persistence",S.apiKey,R),this.boundEventHandler=_._onStorageEvent.bind(_),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(p){return this.persistence._set(this.fullUserKey,p.toJSON())}getCurrentUser(){var p=this;return(0,g.Z)(function*(){const _=yield p.persistence._get(p.fullUserKey);return _?Qe._fromJSON(p.auth,_):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(p){var _=this;return(0,g.Z)(function*(){if(_.persistence===p)return;const I=yield _.getCurrentUser();return yield _.removeCurrentUser(),_.persistence=p,I?_.setCurrentUser(I):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(p,_,I="authUser"){return(0,g.Z)(function*(){if(!_.length)return new de(X(en),p,I);const S=(yield Promise.all(_.map(function(){var St=(0,g.Z)(function*(jt){if(yield jt._isAvailable())return jt});return function(jt){return St.apply(this,arguments)}}()))).filter(St=>St);let R=S[0]||X(en);const le=an(I,p.config.apiKey,p.name);let Le=null;for(const St of _)try{const jt=yield St._get(le);if(jt){const xn=Qe._fromJSON(p,jt);St!==R&&(Le=xn),R=St;break}}catch{}const et=S.filter(St=>St._shouldAllowMigration);return R._shouldAllowMigration&&et.length?(R=et[0],Le&&(yield R._set(le,Le.toJSON())),yield Promise.all(_.map(function(){var St=(0,g.Z)(function*(jt){if(jt!==R)try{yield jt._remove(le)}catch{}});return function(jt){return St.apply(this,arguments)}}())),new de(R,p,I)):new de(R,p,I)})()}}function U(w){const p=w.toLowerCase();if(p.includes("opera/")||p.includes("opr/")||p.includes("opios/"))return"Opera";if(be(p))return"IEMobile";if(p.includes("msie")||p.includes("trident/"))return"IE";if(p.includes("edge/"))return"Edge";if(L(p))return"Firefox";if(p.includes("silk/"))return"Silk";if(ze(p))return"Blackberry";if(dt(p))return"Webos";if(F(p))return"Safari";if((p.includes("chrome/")||ie(p))&&!p.includes("edge/"))return"Chrome";if(Ze(p))return"Android";{const I=w.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===I?.length)return I[1]}return"Other"}function L(w=(0,j.z$)()){return/firefox\//i.test(w)}function F(w=(0,j.z$)()){const p=w.toLowerCase();return p.includes("safari/")&&!p.includes("chrome/")&&!p.includes("crios/")&&!p.includes("android")}function ie(w=(0,j.z$)()){return/crios\//i.test(w)}function be(w=(0,j.z$)()){return/iemobile/i.test(w)}function Ze(w=(0,j.z$)()){return/android/i.test(w)}function ze(w=(0,j.z$)()){return/blackberry/i.test(w)}function dt(w=(0,j.z$)()){return/webos/i.test(w)}function Rt(w=(0,j.z$)()){return/iphone|ipad|ipod/i.test(w)||/macintosh/i.test(w)&&/mobile/i.test(w)}function cn(w=(0,j.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(w)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(w)}function wn(w=(0,j.z$)()){return Rt(w)||Ze(w)||dt(w)||ze(w)||/windows phone/i.test(w)||be(w)}function Es(w,p=[]){let _;switch(w){case"Browser":_=U((0,j.z$)());break;case"Worker":_=`${U((0,j.z$)())}-${w}`;break;default:_=w}const I=p.length?p.join(","):"FirebaseCore-web";return`${_}/JsCore/${k.SDK_VERSION}/${I}`}class Bo{constructor(p){this.auth=p,this.queue=[]}pushCallback(p,_){const I=R=>new Promise((le,Le)=>{try{le(p(R))}catch(et){Le(et)}});I.onAbort=_,this.queue.push(I);const S=this.queue.length-1;return()=>{this.queue[S]=()=>Promise.resolve()}}runMiddleware(p){var _=this;return(0,g.Z)(function*(){var I;if(_.auth.currentUser===p)return;const S=[];try{for(const R of _.queue)yield R(p),R.onAbort&&S.push(R.onAbort)}catch(R){S.reverse();for(const le of S)try{le()}catch{}throw _.auth._errorFactory.create("login-blocked",{originalMessage:null===(I=R)||void 0===I?void 0:I.message})}})()}}class jo{constructor(p,_,I){this.app=p,this.heartbeatServiceProvider=_,this.config=I,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new re(this),this.idTokenSubscription=new re(this),this.beforeStateQueue=new Bo(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Xe,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=p.name,this.clientVersion=I.sdkClientVersion}_initializeWithPersistence(p,_){var I=this;return _&&(this._popupRedirectResolver=X(_)),this._initializationPromise=this.queue((0,g.Z)(function*(){var S,R;if(!I._deleted&&(I.persistenceManager=yield de.create(I,p),!I._deleted)){if(null!==(S=I._popupRedirectResolver)&&void 0!==S&&S._shouldInitProactively)try{yield I._popupRedirectResolver._initialize(I)}catch{}yield I.initializeCurrentUser(_),I.lastNotifiedUid=(null===(R=I.currentUser)||void 0===R?void 0:R.uid)||null,!I._deleted&&(I._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var p=this;return(0,g.Z)(function*(){if(p._deleted)return;const _=yield p.assertedPersistence.getCurrentUser();if(p.currentUser||_){if(p.currentUser&&_&&p.currentUser.uid===_.uid)return p._currentUser._assign(_),void(yield p.currentUser.getIdToken());yield p._updateCurrentUser(_,!0)}})()}initializeCurrentUser(p){var _=this;return(0,g.Z)(function*(){var I;const S=yield _.assertedPersistence.getCurrentUser();let R=S,le=!1;if(p&&_.config.authDomain){yield _.getOrInitRedirectPersistenceManager();const Le=null===(I=_.redirectUser)||void 0===I?void 0:I._redirectEventId,et=R?._redirectEventId,St=yield _.tryRedirectSignIn(p);(!Le||Le===et)&&St?.user&&(R=St.user,le=!0)}if(!R)return _.directlySetCurrentUser(null);if(!R._redirectEventId){if(le)try{yield _.beforeStateQueue.runMiddleware(R)}catch(Le){R=S,_._popupRedirectResolver._overrideRedirectResult(_,()=>Promise.reject(Le))}return R?_.reloadAndSetCurrentUserOrClear(R):_.directlySetCurrentUser(null)}return q(_._popupRedirectResolver,_,"argument-error"),yield _.getOrInitRedirectPersistenceManager(),_.redirectUser&&_.redirectUser._redirectEventId===R._redirectEventId?_.directlySetCurrentUser(R):_.reloadAndSetCurrentUserOrClear(R)})()}tryRedirectSignIn(p){var _=this;return(0,g.Z)(function*(){let I=null;try{I=yield _._popupRedirectResolver._completeRedirectFn(_,p,!0)}catch{yield _._setRedirectUser(null)}return I})()}reloadAndSetCurrentUserOrClear(p){var _=this;return(0,g.Z)(function*(){var I;try{yield Sr(p)}catch(S){if("auth/network-request-failed"!==(null===(I=S)||void 0===I?void 0:I.code))return _.directlySetCurrentUser(null)}return _.directlySetCurrentUser(p)})()}useDeviceLanguage(){this.languageCode=function rn(){if(typeof navigator>"u")return null;const w=navigator;return w.languages&&w.languages[0]||w.language||null}()}_delete(){var p=this;return(0,g.Z)(function*(){p._deleted=!0})()}updateCurrentUser(p){var _=this;return(0,g.Z)(function*(){const I=p?(0,j.m9)(p):null;return I&&q(I.auth.config.apiKey===_.config.apiKey,_,"invalid-user-token"),_._updateCurrentUser(I&&I._clone(_))})()}_updateCurrentUser(p,_=!1){var I=this;return(0,g.Z)(function*(){if(!I._deleted)return p&&q(I.tenantId===p.tenantId,I,"tenant-id-mismatch"),_||(yield I.beforeStateQueue.runMiddleware(p)),I.queue((0,g.Z)(function*(){yield I.directlySetCurrentUser(p),I.notifyAuthListeners()}))})()}signOut(){var p=this;return(0,g.Z)(function*(){return yield p.beforeStateQueue.runMiddleware(null),(p.redirectPersistenceManager||p._popupRedirectResolver)&&(yield p._setRedirectUser(null)),p._updateCurrentUser(null,!0)})()}setPersistence(p){var _=this;return this.queue((0,g.Z)(function*(){yield _.assertedPersistence.setPersistence(X(p))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(p){this._errorFactory=new j.LL("auth","Firebase",p())}onAuthStateChanged(p,_,I){return this.registerStateListener(this.authStateSubscription,p,_,I)}beforeAuthStateChanged(p,_){return this.beforeStateQueue.pushCallback(p,_)}onIdTokenChanged(p,_,I){return this.registerStateListener(this.idTokenSubscription,p,_,I)}toJSON(){var p;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(p=this._currentUser)||void 0===p?void 0:p.toJSON()}}_setRedirectUser(p,_){var I=this;return(0,g.Z)(function*(){const S=yield I.getOrInitRedirectPersistenceManager(_);return null===p?S.removeCurrentUser():S.setCurrentUser(p)})()}getOrInitRedirectPersistenceManager(p){var _=this;return(0,g.Z)(function*(){if(!_.redirectPersistenceManager){const I=p&&X(p)||_._popupRedirectResolver;q(I,_,"argument-error"),_.redirectPersistenceManager=yield de.create(_,[X(I._redirectPersistence)],"redirectUser"),_.redirectUser=yield _.redirectPersistenceManager.getCurrentUser()}return _.redirectPersistenceManager})()}_redirectUserForId(p){var _=this;return(0,g.Z)(function*(){var I,S;return _._isInitialized&&(yield _.queue((0,g.Z)(function*(){}))),(null===(I=_._currentUser)||void 0===I?void 0:I._redirectEventId)===p?_._currentUser:(null===(S=_.redirectUser)||void 0===S?void 0:S._redirectEventId)===p?_.redirectUser:null})()}_persistUserIfCurrent(p){var _=this;return(0,g.Z)(function*(){if(p===_.currentUser)return _.queue((0,g.Z)(function*(){return _.directlySetCurrentUser(p)}))})()}_notifyListenersIfCurrent(p){p===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var p,_;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const I=null!==(_=null===(p=this.currentUser)||void 0===p?void 0:p.uid)&&void 0!==_?_:null;this.lastNotifiedUid!==I&&(this.lastNotifiedUid=I,this.authStateSubscription.next(this.currentUser))}registerStateListener(p,_,I,S){if(this._deleted)return()=>{};const R="function"==typeof _?_:_.next.bind(_),le=this._isInitialized?Promise.resolve():this._initializationPromise;return q(le,this,"internal-error"),le.then(()=>R(this.currentUser)),"function"==typeof _?p.addObserver(_,I,S):p.addObserver(_)}directlySetCurrentUser(p){var _=this;return(0,g.Z)(function*(){_.currentUser&&_.currentUser!==p&&(_._currentUser._stopProactiveRefresh(),p&&_.isProactiveRefreshEnabled&&p._startProactiveRefresh()),_.currentUser=p,p?yield _.assertedPersistence.setCurrentUser(p):yield _.assertedPersistence.removeCurrentUser()})()}queue(p){return this.operations=this.operations.then(p,p),this.operations}get assertedPersistence(){return q(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(p){!p||this.frameworks.includes(p)||(this.frameworks.push(p),this.frameworks.sort(),this.clientVersion=Es(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var p=this;return(0,g.Z)(function*(){var _;const I={"X-Client-Version":p.clientVersion};p.app.options.appId&&(I["X-Firebase-gmpid"]=p.app.options.appId);const S=yield null===(_=p.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===_?void 0:_.getHeartbeatsHeader();return S&&(I["X-Firebase-Client"]=S),I})()}}function Zn(w){return(0,j.m9)(w)}class re{constructor(p){this.auth=p,this.observer=null,this.addObserver=(0,j.ne)(_=>this.observer=_)}get next(){return q(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Se(w,p,_){const I=Zn(w);q(I._canInitEmulator,I,"emulator-config-failed"),q(/^https?:\/\//.test(p),I,"invalid-emulator-scheme");const S=!!_?.disableWarnings,R=We(p),{host:le,port:Le}=function Ct(w){const p=We(w),_=/(\/\/)?([^?#/]+)/.exec(w.substr(p.length));if(!_)return{host:"",port:null};const I=_[2].split("@").pop()||"",S=/^(\[[^\]]+\])(:|$)/.exec(I);if(S){const R=S[1];return{host:R,port:Cn(I.substr(R.length+1))}}{const[R,le]=I.split(":");return{host:R,port:Cn(le)}}}(p);I.config.emulator={url:`${R}//${le}${null===Le?"":`:${Le}`}/`},I.settings.appVerificationDisabledForTesting=!0,I.emulatorConfig=Object.freeze({host:le,port:Le,protocol:R.replace(":",""),options:Object.freeze({disableWarnings:S})}),S||function yt(){function w(){const p=document.createElement("p"),_=p.style;p.innerText="Running in emulator mode. Do not use with production credentials.",_.position="fixed",_.width="100%",_.backgroundColor="#ffffff",_.border=".1em solid #000000",_.color="#b50000",_.bottom="0px",_.left="0px",_.margin="0px",_.zIndex="10000",_.textAlign="center",p.classList.add("firebase-emulator-warning"),document.body.appendChild(p)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",w):w())}()}function We(w){const p=w.indexOf(":");return p<0?"":w.substr(0,p+1)}function Cn(w){if(!w)return null;const p=Number(w);return isNaN(p)?null:p}class nn{constructor(p,_){this.providerId=p,this.signInMethod=_}toJSON(){return se("not implemented")}_getIdTokenResponse(p){return se("not implemented")}_linkToIdToken(p,_){return se("not implemented")}_getReauthenticationResolver(p){return se("not implemented")}}function vn(w,p){return Wr.apply(this,arguments)}function Wr(){return(Wr=(0,g.Z)(function*(w,p){return at(w,"POST","/v1/accounts:resetPassword",Vt(w,p))})).apply(this,arguments)}function Sn(w,p){return ci.apply(this,arguments)}function ci(){return(ci=(0,g.Z)(function*(w,p){return at(w,"POST","/v1/accounts:update",p)})).apply(this,arguments)}function st(w,p){return Ot.apply(this,arguments)}function Ot(){return(Ot=(0,g.Z)(function*(w,p){return at(w,"POST","/v1/accounts:update",Vt(w,p))})).apply(this,arguments)}function qr(){return(qr=(0,g.Z)(function*(w,p){return Tn(w,"POST","/v1/accounts:signInWithPassword",Vt(w,p))})).apply(this,arguments)}function Ui(w,p){return er.apply(this,arguments)}function er(){return(er=(0,g.Z)(function*(w,p){return at(w,"POST","/v1/accounts:sendOobCode",Vt(w,p))})).apply(this,arguments)}function Is(w,p){return Fn.apply(this,arguments)}function Fn(){return(Fn=(0,g.Z)(function*(w,p){return Ui(w,p)})).apply(this,arguments)}function uo(w,p){return $s.apply(this,arguments)}function $s(){return($s=(0,g.Z)(function*(w,p){return Ui(w,p)})).apply(this,arguments)}function Bt(w,p){return bs.apply(this,arguments)}function bs(){return(bs=(0,g.Z)(function*(w,p){return Ui(w,p)})).apply(this,arguments)}function Hs(w,p){return Na.apply(this,arguments)}function Na(){return(Na=(0,g.Z)(function*(w,p){return Ui(w,p)})).apply(this,arguments)}function lr(){return(lr=(0,g.Z)(function*(w,p){return Tn(w,"POST","/v1/accounts:signInWithEmailLink",Vt(w,p))})).apply(this,arguments)}function Vi(){return(Vi=(0,g.Z)(function*(w,p){return Tn(w,"POST","/v1/accounts:signInWithEmailLink",Vt(w,p))})).apply(this,arguments)}class Kr extends nn{constructor(p,_,I,S=null){super("password",I),this._email=p,this._password=_,this._tenantId=S}static _fromEmailAndPassword(p,_){return new Kr(p,_,"password")}static _fromEmailAndCode(p,_,I=null){return new Kr(p,_,"emailLink",I)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(p){const _="string"==typeof p?JSON.parse(p):p;if(_?.email&&_?.password){if("password"===_.signInMethod)return this._fromEmailAndPassword(_.email,_.password);if("emailLink"===_.signInMethod)return this._fromEmailAndCode(_.email,_.password,_.tenantId)}return null}_getIdTokenResponse(p){var _=this;return(0,g.Z)(function*(){switch(_.signInMethod){case"password":return function jn(w,p){return qr.apply(this,arguments)}(p,{returnSecureToken:!0,email:_._email,password:_._password});case"emailLink":return function Gs(w,p){return lr.apply(this,arguments)}(p,{email:_._email,oobCode:_._password});default:Ne(p,"internal-error")}})()}_linkToIdToken(p,_){var I=this;return(0,g.Z)(function*(){switch(I.signInMethod){case"password":return Sn(p,{idToken:_,returnSecureToken:!0,email:I._email,password:I._password});case"emailLink":return function $o(w,p){return Vi.apply(this,arguments)}(p,{idToken:_,email:I._email,oobCode:I._password});default:Ne(p,"internal-error")}})()}_getReauthenticationResolver(p){return this._getIdTokenResponse(p)}}function di(w,p){return ni.apply(this,arguments)}function ni(){return(ni=(0,g.Z)(function*(w,p){return Tn(w,"POST","/v1/accounts:signInWithIdp",Vt(w,p))})).apply(this,arguments)}class Ji extends nn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(p){const _=new Ji(p.providerId,p.signInMethod);return p.idToken||p.accessToken?(p.idToken&&(_.idToken=p.idToken),p.accessToken&&(_.accessToken=p.accessToken),p.nonce&&!p.pendingToken&&(_.nonce=p.nonce),p.pendingToken&&(_.pendingToken=p.pendingToken)):p.oauthToken&&p.oauthTokenSecret?(_.accessToken=p.oauthToken,_.secret=p.oauthTokenSecret):Ne("argument-error"),_}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(p){const _="string"==typeof p?JSON.parse(p):p,{providerId:I,signInMethod:S}=_,R=(0,oe._T)(_,["providerId","signInMethod"]);if(!I||!S)return null;const le=new Ji(I,S);return le.idToken=R.idToken||void 0,le.accessToken=R.accessToken||void 0,le.secret=R.secret,le.nonce=R.nonce,le.pendingToken=R.pendingToken||null,le}_getIdTokenResponse(p){return di(p,this.buildRequest())}_linkToIdToken(p,_){const I=this.buildRequest();return I.idToken=_,di(p,I)}_getReauthenticationResolver(p){const _=this.buildRequest();return _.autoCreate=!1,di(p,_)}buildRequest(){const p={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)p.pendingToken=this.pendingToken;else{const _={};this.idToken&&(_.id_token=this.idToken),this.accessToken&&(_.access_token=this.accessToken),this.secret&&(_.oauth_token_secret=this.secret),_.providerId=this.providerId,this.nonce&&!this.pendingToken&&(_.nonce=this.nonce),p.postBody=(0,j.xO)(_)}return p}}function Oa(w,p){return lo.apply(this,arguments)}function lo(){return(lo=(0,g.Z)(function*(w,p){return at(w,"POST","/v1/accounts:sendVerificationCode",Vt(w,p))})).apply(this,arguments)}function Cs(){return(Cs=(0,g.Z)(function*(w,p){return Tn(w,"POST","/v1/accounts:signInWithPhoneNumber",Vt(w,p))})).apply(this,arguments)}function Fr(){return(Fr=(0,g.Z)(function*(w,p){const _=yield Tn(w,"POST","/v1/accounts:signInWithPhoneNumber",Vt(w,p));if(_.temporaryProof)throw Hn(w,"account-exists-with-different-credential",_);return _})).apply(this,arguments)}const r_={USER_NOT_FOUND:"user-not-found"};function vi(){return(vi=(0,g.Z)(function*(w,p){return Tn(w,"POST","/v1/accounts:signInWithPhoneNumber",Vt(w,Object.assign(Object.assign({},p),{operation:"REAUTH"})),r_)})).apply(this,arguments)}class Ds extends nn{constructor(p){super("phone","phone"),this.params=p}static _fromVerification(p,_){return new Ds({verificationId:p,verificationCode:_})}static _fromTokenResponse(p,_){return new Ds({phoneNumber:p,temporaryProof:_})}_getIdTokenResponse(p){return function La(w,p){return Cs.apply(this,arguments)}(p,this._makeVerificationRequest())}_linkToIdToken(p,_){return function co(w,p){return Fr.apply(this,arguments)}(p,Object.assign({idToken:_},this._makeVerificationRequest()))}_getReauthenticationResolver(p){return function Zr(w,p){return vi.apply(this,arguments)}(p,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:p,phoneNumber:_,verificationId:I,verificationCode:S}=this.params;return p&&_?{temporaryProof:p,phoneNumber:_}:{sessionInfo:I,code:S}}toJSON(){const p={providerId:this.providerId};return this.params.phoneNumber&&(p.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(p.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(p.verificationCode=this.params.verificationCode),this.params.verificationId&&(p.verificationId=this.params.verificationId),p}static fromJSON(p){"string"==typeof p&&(p=JSON.parse(p));const{verificationId:_,verificationCode:I,phoneNumber:S,temporaryProof:R}=p;return I||_||S||R?new Ds({verificationId:_,verificationCode:I,phoneNumber:S,temporaryProof:R}):null}}class Yr{constructor(p){var _,I,S,R,le,Le;const et=(0,j.zd)((0,j.pd)(p)),St=null!==(_=et.apiKey)&&void 0!==_?_:null,jt=null!==(I=et.oobCode)&&void 0!==I?I:null,xn=function Ho(w){switch(w){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(S=et.mode)&&void 0!==S?S:null);q(St&&jt&&xn,"argument-error"),this.apiKey=St,this.operation=xn,this.code=jt,this.continueUrl=null!==(R=et.continueUrl)&&void 0!==R?R:null,this.languageCode=null!==(le=et.languageCode)&&void 0!==le?le:null,this.tenantId=null!==(Le=et.tenantId)&&void 0!==Le?Le:null}static parseLink(p){const _=function Fa(w){const p=(0,j.zd)((0,j.pd)(w)).link,_=p?(0,j.zd)((0,j.pd)(p)).deep_link_id:null,I=(0,j.zd)((0,j.pd)(w)).deep_link_id;return(I?(0,j.zd)((0,j.pd)(I)).link:null)||I||_||p||w}(p);try{return new Yr(_)}catch{return null}}}let tc=(()=>{class w{constructor(){this.providerId=w.PROVIDER_ID}static credential(_,I){return Kr._fromEmailAndPassword(_,I)}static credentialWithLink(_,I){const S=Yr.parseLink(I);return q(S,"argument-error"),Kr._fromEmailAndCode(_,S.code,S.tenantId)}}return w.PROVIDER_ID="password",w.EMAIL_PASSWORD_SIGN_IN_METHOD="password",w.EMAIL_LINK_SIGN_IN_METHOD="emailLink",w})();class es{constructor(p){this.providerId=p,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(p){this.defaultLanguageCode=p}setCustomParameters(p){return this.customParameters=p,this}getCustomParameters(){return this.customParameters}}class Go extends es{constructor(){super(...arguments),this.scopes=[]}addScope(p){return this.scopes.includes(p)||this.scopes.push(p),this}getScopes(){return[...this.scopes]}}class zo extends Go{static credentialFromJSON(p){const _="string"==typeof p?JSON.parse(p):p;return q("providerId"in _&&"signInMethod"in _,"argument-error"),Ji._fromParams(_)}credential(p){return this._credential(Object.assign(Object.assign({},p),{nonce:p.rawNonce}))}_credential(p){return q(p.idToken||p.accessToken,"argument-error"),Ji._fromParams(Object.assign(Object.assign({},p),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(p){return zo.oauthCredentialFromTaggedObject(p)}static credentialFromError(p){return zo.oauthCredentialFromTaggedObject(p.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:p}){if(!p)return null;const{oauthIdToken:_,oauthAccessToken:I,oauthTokenSecret:S,pendingToken:R,nonce:le,providerId:Le}=p;if(!I&&!S&&!_&&!R||!Le)return null;try{return new zo(Le)._credential({idToken:_,accessToken:I,nonce:le,pendingToken:R})}catch{return null}}}let wp=(()=>{class w extends Go{constructor(){super("facebook.com")}static credential(_){return Ji._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.FACEBOOK_SIGN_IN_METHOD,accessToken:_})}static credentialFromResult(_){return w.credentialFromTaggedObject(_)}static credentialFromError(_){return w.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_||!("oauthAccessToken"in _)||!_.oauthAccessToken)return null;try{return w.credential(_.oauthAccessToken)}catch{return null}}}return w.FACEBOOK_SIGN_IN_METHOD="facebook.com",w.PROVIDER_ID="facebook.com",w})(),Yd=(()=>{class w extends Go{constructor(){super("google.com"),this.addScope("profile")}static credential(_,I){return Ji._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.GOOGLE_SIGN_IN_METHOD,idToken:_,accessToken:I})}static credentialFromResult(_){return w.credentialFromTaggedObject(_)}static credentialFromError(_){return w.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_)return null;const{oauthIdToken:I,oauthAccessToken:S}=_;if(!I&&!S)return null;try{return w.credential(I,S)}catch{return null}}}return w.GOOGLE_SIGN_IN_METHOD="google.com",w.PROVIDER_ID="google.com",w})(),Ep=(()=>{class w extends Go{constructor(){super("github.com")}static credential(_){return Ji._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.GITHUB_SIGN_IN_METHOD,accessToken:_})}static credentialFromResult(_){return w.credentialFromTaggedObject(_)}static credentialFromError(_){return w.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_||!("oauthAccessToken"in _)||!_.oauthAccessToken)return null;try{return w.credential(_.oauthAccessToken)}catch{return null}}}return w.GITHUB_SIGN_IN_METHOD="github.com",w.PROVIDER_ID="github.com",w})();class ts extends nn{constructor(p,_){super(p,p),this.pendingToken=_}_getIdTokenResponse(p){return di(p,this.buildRequest())}_linkToIdToken(p,_){const I=this.buildRequest();return I.idToken=_,di(p,I)}_getReauthenticationResolver(p){const _=this.buildRequest();return _.autoCreate=!1,di(p,_)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(p){const _="string"==typeof p?JSON.parse(p):p,{providerId:I,signInMethod:S,pendingToken:R}=_;return I&&S&&R&&I===S?new ts(I,R):null}static _create(p,_){return new ts(p,_)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Ua extends es{constructor(p){q(p.startsWith("saml."),"argument-error"),super(p)}static credentialFromResult(p){return Ua.samlCredentialFromTaggedObject(p)}static credentialFromError(p){return Ua.samlCredentialFromTaggedObject(p.customData||{})}static credentialFromJSON(p){const _=ts.fromJSON(p);return q(_,"argument-error"),_}static samlCredentialFromTaggedObject({_tokenResponse:p}){if(!p)return null;const{pendingToken:_,providerId:I}=p;if(!_||!I)return null;try{return ts._create(I,_)}catch{return null}}}let ic=(()=>{class w extends Go{constructor(){super("twitter.com")}static credential(_,I){return Ji._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.TWITTER_SIGN_IN_METHOD,oauthToken:_,oauthTokenSecret:I})}static credentialFromResult(_){return w.credentialFromTaggedObject(_)}static credentialFromError(_){return w.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_)return null;const{oauthAccessToken:I,oauthTokenSecret:S}=_;if(!I||!S)return null;try{return w.credential(I,S)}catch{return null}}}return w.TWITTER_SIGN_IN_METHOD="twitter.com",w.PROVIDER_ID="twitter.com",w})();function Va(w,p){return Ba.apply(this,arguments)}function Ba(){return(Ba=(0,g.Z)(function*(w,p){return Tn(w,"POST","/v1/accounts:signUp",Vt(w,p))})).apply(this,arguments)}class hi{constructor(p){this.user=p.user,this.providerId=p.providerId,this._tokenResponse=p._tokenResponse,this.operationType=p.operationType}static _fromIdTokenResponse(p,_,I,S=!1){return(0,g.Z)(function*(){const R=yield Qe._fromIdTokenResponse(p,I,S),le=sc(I);return new hi({user:R,providerId:le,_tokenResponse:I,operationType:_})})()}static _forOperation(p,_,I){return(0,g.Z)(function*(){yield p._updateTokensIfNecessary(I,!0);const S=sc(I);return new hi({user:p,providerId:S,_tokenResponse:I,operationType:_})})()}}function sc(w){return w.providerId?w.providerId:"phoneNumber"in w?"phone":null}function Ip(w){return oc.apply(this,arguments)}function oc(){return(oc=(0,g.Z)(function*(w){var p;const _=Zn(w);if(yield _._initializationPromise,null!==(p=_.currentUser)&&void 0!==p&&p.isAnonymous)return new hi({user:_.currentUser,providerId:null,operationType:"signIn"});const I=yield Va(_,{returnSecureToken:!0}),S=yield hi._fromIdTokenResponse(_,"signIn",I,!0);return yield _._updateCurrentUser(S.user),S})).apply(this,arguments)}class ac extends j.ZR{constructor(p,_,I,S){var R;super(_.code,_.message),this.operationType=I,this.user=S,Object.setPrototypeOf(this,ac.prototype),this.customData={appName:p.name,tenantId:null!==(R=p.tenantId)&&void 0!==R?R:void 0,_serverResponse:_.customData._serverResponse,operationType:I}}static _fromErrorAndOperation(p,_,I,S){return new ac(p,_,I,S)}}function bp(w,p,_,I){return("reauthenticate"===p?_._getReauthenticationResolver(w):_._getIdTokenResponse(w)).catch(R=>{throw"auth/multi-factor-auth-required"===R.code?ac._fromErrorAndOperation(w,R,p,I):R})}function wi(w){return new Set(w.map(({providerId:p})=>p).filter(p=>!!p))}function uc(w,p){return Wo.apply(this,arguments)}function Wo(){return(Wo=(0,g.Z)(function*(w,p){const _=(0,j.m9)(w);yield Uu(!0,_,p);const{providerUserInfo:I}=yield yn(_.auth,{idToken:yield _.getIdToken(),deleteProvider:[p]}),S=wi(I||[]);return _.providerData=_.providerData.filter(R=>S.has(R.providerId)),S.has("phone")||(_.phoneNumber=null),yield _.auth._persistUserIfCurrent(_),_})).apply(this,arguments)}function qo(w,p){return ns.apply(this,arguments)}function ns(){return(ns=(0,g.Z)(function*(w,p,_=!1){const I=yield Yt(w,p._linkToIdToken(w.auth,yield w.getIdToken()),_);return hi._forOperation(w,"link",I)})).apply(this,arguments)}function Uu(w,p,_){return Bi.apply(this,arguments)}function Bi(){return(Bi=(0,g.Z)(function*(w,p,_){yield Sr(p);const S=!1===w?"provider-already-linked":"no-such-provider";q(wi(p.providerData).has(_)===w,p.auth,S)})).apply(this,arguments)}function lc(w,p){return ja.apply(this,arguments)}function ja(){return(ja=(0,g.Z)(function*(w,p,_=!1){var I;const{auth:S}=w,R="reauthenticate";try{const le=yield Yt(w,bp(S,R,p,w),_);q(le.idToken,S,"internal-error");const Le=lt(le.idToken);q(Le,S,"internal-error");const{sub:et}=Le;return q(w.uid===et,S,"user-mismatch"),hi._forOperation(w,R,le)}catch(le){throw"auth/user-not-found"===(null===(I=le)||void 0===I?void 0:I.code)&&Ne(S,"user-mismatch"),le}})).apply(this,arguments)}function $a(w,p){return Vu.apply(this,arguments)}function Vu(){return(Vu=(0,g.Z)(function*(w,p,_=!1){const I="signIn",S=yield bp(w,I,p),R=yield hi._fromIdTokenResponse(w,I,S);return _||(yield w._updateCurrentUser(R.user)),R})).apply(this,arguments)}function Qr(w,p){return Bu.apply(this,arguments)}function Bu(){return(Bu=(0,g.Z)(function*(w,p){return $a(Zn(w),p)})).apply(this,arguments)}function O(w,p){return P.apply(this,arguments)}function P(){return(P=(0,g.Z)(function*(w,p){const _=(0,j.m9)(w);return yield Uu(!1,_,p.providerId),qo(_,p)})).apply(this,arguments)}function Z(w,p){return pe.apply(this,arguments)}function pe(){return(pe=(0,g.Z)(function*(w,p){return lc((0,j.m9)(w),p)})).apply(this,arguments)}function Fe(w,p){return Je.apply(this,arguments)}function Je(){return(Je=(0,g.Z)(function*(w,p){return Tn(w,"POST","/v1/accounts:signInWithCustomToken",Vt(w,p))})).apply(this,arguments)}function It(w,p){return $t.apply(this,arguments)}function $t(){return($t=(0,g.Z)(function*(w,p){const _=Zn(w),I=yield Fe(_,{token:p,returnSecureToken:!0}),S=yield hi._fromIdTokenResponse(_,"signIn",I);return yield _._updateCurrentUser(S.user),S})).apply(this,arguments)}class dn{constructor(p,_){this.factorId=p,this.uid=_.mfaEnrollmentId,this.enrollmentTime=new Date(_.enrolledAt).toUTCString(),this.displayName=_.displayName}static _fromServerResponse(p,_){return"phoneInfo"in _?Xr._fromServerResponse(p,_):Ne(p,"internal-error")}}class Xr extends dn{constructor(p){super("phone",p),this.phoneNumber=p.phoneInfo}static _fromServerResponse(p,_){return new Xr(_)}}function Dn(w,p,_){var I;q((null===(I=_.url)||void 0===I?void 0:I.length)>0,w,"invalid-continue-uri"),q(typeof _.dynamicLinkDomain>"u"||_.dynamicLinkDomain.length>0,w,"invalid-dynamic-link-domain"),p.continueUrl=_.url,p.dynamicLinkDomain=_.dynamicLinkDomain,p.canHandleCodeInApp=_.handleCodeInApp,_.iOS&&(q(_.iOS.bundleId.length>0,w,"missing-ios-bundle-id"),p.iOSBundleId=_.iOS.bundleId),_.android&&(q(_.android.packageName.length>0,w,"missing-android-pkg-name"),p.androidInstallApp=_.android.installApp,p.androidMinimumVersionCode=_.android.minimumVersion,p.androidPackageName=_.android.packageName)}function Ht(w,p,_){return Ar.apply(this,arguments)}function Ar(){return(Ar=(0,g.Z)(function*(w,p,_){const I=(0,j.m9)(w),S={requestType:"PASSWORD_RESET",email:p};_&&Dn(I,S,_),yield uo(I,S)})).apply(this,arguments)}function Ko(w,p,_){return Ts.apply(this,arguments)}function Ts(){return(Ts=(0,g.Z)(function*(w,p,_){yield vn((0,j.m9)(w),{oobCode:p,newPassword:_})})).apply(this,arguments)}function kt(w,p){return rs.apply(this,arguments)}function rs(){return(rs=(0,g.Z)(function*(w,p){yield st((0,j.m9)(w),{oobCode:p})})).apply(this,arguments)}function Qd(w,p){return Zo.apply(this,arguments)}function Zo(){return(Zo=(0,g.Z)(function*(w,p){const _=(0,j.m9)(w),I=yield vn(_,{oobCode:p}),S=I.requestType;switch(q(S,_,"internal-error"),S){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":q(I.newEmail,_,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":q(I.mfaInfo,_,"internal-error");default:q(I.email,_,"internal-error")}let R=null;return I.mfaInfo&&(R=dn._fromServerResponse(Zn(_),I.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===I.requestType?I.newEmail:I.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===I.requestType?I.email:I.newEmail)||null,multiFactorInfo:R},operation:S}})).apply(this,arguments)}function Yo(w,p){return Ss.apply(this,arguments)}function Ss(){return(Ss=(0,g.Z)(function*(w,p){const{data:_}=yield Qd((0,j.m9)(w),p);return _.email})).apply(this,arguments)}function zs(w,p,_){return Gn.apply(this,arguments)}function Gn(){return(Gn=(0,g.Z)(function*(w,p,_){const I=Zn(w),S=yield Va(I,{returnSecureToken:!0,email:p,password:_}),R=yield hi._fromIdTokenResponse(I,"signIn",S);return yield I._updateCurrentUser(R.user),R})).apply(this,arguments)}function ww(w,p,_){return Qr((0,j.m9)(w),tc.credential(p,_))}function je(w,p,_){return hn.apply(this,arguments)}function hn(){return(hn=(0,g.Z)(function*(w,p,_){const I=(0,j.m9)(w),S={requestType:"EMAIL_SIGNIN",email:p};q(_.handleCodeInApp,I,"argument-error"),_&&Dn(I,S,_),yield Bt(I,S)})).apply(this,arguments)}function i_(w,p){return"EMAIL_SIGNIN"===Yr.parseLink(p)?.operation}function s_(w,p,_){return Ur.apply(this,arguments)}function Ur(){return(Ur=(0,g.Z)(function*(w,p,_){const I=(0,j.m9)(w),S=tc.credentialWithLink(p,_||$e());return q(S._tenantId===(I.tenantId||null),I,"tenant-id-mismatch"),Qr(I,S)})).apply(this,arguments)}function Cp(w,p){return Ha.apply(this,arguments)}function Ha(){return(Ha=(0,g.Z)(function*(w,p){return at(w,"POST","/v1/accounts:createAuthUri",Vt(w,p))})).apply(this,arguments)}function Ws(w,p){return cc.apply(this,arguments)}function cc(){return(cc=(0,g.Z)(function*(w,p){const I={identifier:p,continueUri:He()?$e():"http://localhost"},{signinMethods:S}=yield Cp((0,j.m9)(w),I);return S||[]})).apply(this,arguments)}function dc(w,p){return Xd.apply(this,arguments)}function Xd(){return(Xd=(0,g.Z)(function*(w,p){const _=(0,j.m9)(w),S={requestType:"VERIFY_EMAIL",idToken:yield w.getIdToken()};p&&Dn(_.auth,S,p);const{email:R}=yield Is(_.auth,S);R!==w.email&&(yield w.reload())})).apply(this,arguments)}function Ew(w,p,_){return Ga.apply(this,arguments)}function Ga(){return(Ga=(0,g.Z)(function*(w,p,_){const I=(0,j.m9)(w),R={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield w.getIdToken(),newEmail:p};_&&Dn(I.auth,R,_);const{email:le}=yield Hs(I.auth,R);le!==w.email&&(yield w.reload())})).apply(this,arguments)}function Rr(w,p){return As.apply(this,arguments)}function As(){return(As=(0,g.Z)(function*(w,p){return at(w,"POST","/v1/accounts:update",p)})).apply(this,arguments)}function o_(w,p){return qs.apply(this,arguments)}function qs(){return(qs=(0,g.Z)(function*(w,{displayName:p,photoURL:_}){if(void 0===p&&void 0===_)return;const I=(0,j.m9)(w),R={idToken:yield I.getIdToken(),displayName:p,photoUrl:_,returnSecureToken:!0},le=yield Yt(I,Rr(I.auth,R));I.displayName=le.displayName||null,I.photoURL=le.photoUrl||null;const Le=I.providerData.find(({providerId:et})=>"password"===et);Le&&(Le.displayName=I.displayName,Le.photoURL=I.photoURL),yield I._updateTokensIfNecessary(le)})).apply(this,arguments)}function Rs(w,p){return Dp((0,j.m9)(w),p,null)}function Iw(w,p){return Dp((0,j.m9)(w),null,p)}function Dp(w,p,_){return Jd.apply(this,arguments)}function Jd(){return(Jd=(0,g.Z)(function*(w,p,_){const{auth:I}=w,R={idToken:yield w.getIdToken(),returnSecureToken:!0};p&&(R.email=p),_&&(R.password=_);const le=yield Yt(w,Sn(I,R));yield w._updateTokensIfNecessary(le,!0)})).apply(this,arguments)}class Qo{constructor(p,_,I={}){this.isNewUser=p,this.providerId=_,this.profile=I}}class eh extends Qo{constructor(p,_,I,S){super(p,_,I),this.username=S}}class a_ extends Qo{constructor(p,_){super(p,"facebook.com",_)}}class Sp extends eh{constructor(p,_){super(p,"github.com",_,"string"==typeof _?.login?_?.login:null)}}class bw extends Qo{constructor(p,_){super(p,"google.com",_)}}class u_ extends eh{constructor(p,_,I){super(p,"twitter.com",_,I)}}function Ap(w){const{user:p,_tokenResponse:_}=w;return p.isAnonymous&&!_?{providerId:null,isNewUser:!1,profile:null}:function Tp(w){var p,_;if(!w)return null;const{providerId:I}=w,S=w.rawUserInfo?JSON.parse(w.rawUserInfo):{},R=w.isNewUser||"identitytoolkit#SignupNewUserResponse"===w.kind;if(!I&&w?.idToken){const le=null===(_=null===(p=lt(w.idToken))||void 0===p?void 0:p.firebase)||void 0===_?void 0:_.sign_in_provider;if(le)return new Qo(R,"anonymous"!==le&&"custom"!==le?le:null)}if(!I)return null;switch(I){case"facebook.com":return new a_(R,S);case"github.com":return new Sp(R,S);case"google.com":return new bw(R,S);case"twitter.com":return new u_(R,S,w.screenName||null);case"custom":case"anonymous":return new Qo(R,null);default:return new Qo(R,I,S)}}(_)}class An{constructor(p,_){this.type=p,this.credential=_}static _fromIdtoken(p){return new An("enroll",p)}static _fromMfaPendingCredential(p){return new An("signin",p)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(p){var _,I;if(p?.multiFactorSession){if(null!==(_=p.multiFactorSession)&&void 0!==_&&_.pendingCredential)return An._fromMfaPendingCredential(p.multiFactorSession.pendingCredential);if(null!==(I=p.multiFactorSession)&&void 0!==I&&I.idToken)return An._fromIdtoken(p.multiFactorSession.idToken)}return null}}class Rp{constructor(p,_,I){this.session=p,this.hints=_,this.signInResolver=I}static _fromError(p,_){const I=Zn(p),S=_.customData._serverResponse,R=(S.mfaInfo||[]).map(Le=>dn._fromServerResponse(I,Le));q(S.mfaPendingCredential,I,"internal-error");const le=An._fromMfaPendingCredential(S.mfaPendingCredential);return new Rp(le,R,function(){var Le=(0,g.Z)(function*(et){const St=yield et._process(I,le);delete S.mfaInfo,delete S.mfaPendingCredential;const jt=Object.assign(Object.assign({},S),{idToken:St.idToken,refreshToken:St.refreshToken});switch(_.operationType){case"signIn":const xn=yield hi._fromIdTokenResponse(I,_.operationType,jt);return yield I._updateCurrentUser(xn.user),xn;case"reauthenticate":return q(_.user,I,"internal-error"),hi._forOperation(_.user,_.operationType,jt);default:Ne(I,"internal-error")}});return function(et){return Le.apply(this,arguments)}}())}resolveSignIn(p){var _=this;return(0,g.Z)(function*(){return _.signInResolver(p)})()}}function Rw(w,p){var _;const I=(0,j.m9)(w),S=p;return q(p.customData.operationType,I,"argument-error"),q(null===(_=S.customData._serverResponse)||void 0===_?void 0:_.mfaPendingCredential,I,"argument-error"),Rp._fromError(I,S)}function xw(w,p){return at(w,"POST","/v2/accounts/mfaEnrollment:start",Vt(w,p))}class th{constructor(p){this.user=p,this.enrolledFactors=[],p._onReload(_=>{_.mfaInfo&&(this.enrolledFactors=_.mfaInfo.map(I=>dn._fromServerResponse(p.auth,I)))})}static _fromUser(p){return new th(p)}getSession(){var p=this;return(0,g.Z)(function*(){return An._fromIdtoken(yield p.user.getIdToken())})()}enroll(p,_){var I=this;return(0,g.Z)(function*(){const S=p,R=yield I.getSession(),le=yield Yt(I.user,S._process(I.user.auth,R,_));return yield I.user._updateTokensIfNecessary(le),I.user.reload()})()}unenroll(p){var _=this;return(0,g.Z)(function*(){var I;const S="string"==typeof p?p:p.uid,R=yield _.user.getIdToken(),le=yield Yt(_.user,function Pw(w,p){return at(w,"POST","/v2/accounts/mfaEnrollment:withdraw",Vt(w,p))}(_.user.auth,{idToken:R,mfaEnrollmentId:S}));_.enrolledFactors=_.enrolledFactors.filter(({uid:Le})=>Le!==S),yield _.user._updateTokensIfNecessary(le);try{yield _.user.reload()}catch(Le){if("auth/user-token-expired"!==(null===(I=Le)||void 0===I?void 0:I.code))throw Le}})()}}const fo=new WeakMap;function po(w){const p=(0,j.m9)(w);return fo.has(p)||fo.set(p,th._fromUser(p)),fo.get(p)}const Xo="__sak";class Jo{constructor(p,_){this.storageRetriever=p,this.type=_}_isAvailable(){try{return this.storage?(this.storage.setItem(Xo,"1"),this.storage.removeItem(Xo),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(p,_){return this.storage.setItem(p,JSON.stringify(_)),Promise.resolve()}_get(p){const _=this.storage.getItem(p);return Promise.resolve(_?JSON.parse(_):null)}_remove(p){return this.storage.removeItem(p),Promise.resolve()}get storage(){return this.storageRetriever()}}const Pp=(()=>{class w extends Jo{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(_,I)=>this.onStorageEvent(_,I),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function xp(){const w=(0,j.z$)();return F(w)||Rt(w)}()&&function js(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=wn(),this._shouldAllowMigration=!0}forAllChangedKeys(_){for(const I of Object.keys(this.listeners)){const S=this.storage.getItem(I),R=this.localCache[I];S!==R&&_(I,R,S)}}onStorageEvent(_,I=!1){if(!_.key)return void this.forAllChangedKeys((Le,et,St)=>{this.notifyListeners(Le,St)});const S=_.key;if(I?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const Le=this.storage.getItem(S);if(_.newValue!==Le)null!==_.newValue?this.storage.setItem(S,_.newValue):this.storage.removeItem(S);else if(this.localCache[S]===_.newValue&&!I)return}const R=()=>{const Le=this.storage.getItem(S);!I&&this.localCache[S]===Le||this.notifyListeners(S,Le)},le=this.storage.getItem(S);!function Tt(){return(0,j.w1)()&&10===document.documentMode}()||le===_.newValue||_.newValue===_.oldValue?R():setTimeout(R,10)}notifyListeners(_,I){this.localCache[_]=I;const S=this.listeners[_];if(S)for(const R of Array.from(S))R(I&&JSON.parse(I))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((_,I,S)=>{this.onStorageEvent(new StorageEvent("storage",{key:_,oldValue:I,newValue:S}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(_,I){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[_]||(this.listeners[_]=new Set,this.localCache[_]=this.storage.getItem(_)),this.listeners[_].add(I)}_removeListener(_,I){this.listeners[_]&&(this.listeners[_].delete(I),0===this.listeners[_].size&&delete this.listeners[_]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(_,I){var S=()=>super._set,R=this;return(0,g.Z)(function*(){yield S().call(R,_,I),R.localCache[_]=JSON.stringify(I)})()}_get(_){var I=()=>super._get,S=this;return(0,g.Z)(function*(){const R=yield I().call(S,_);return S.localCache[_]=JSON.stringify(R),R})()}_remove(_){var I=()=>super._remove,S=this;return(0,g.Z)(function*(){yield I().call(S,_),delete S.localCache[_]})()}}return w.type="LOCAL",w})(),go=(()=>{class w extends Jo{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(_,I){}_removeListener(_,I){}}return w.type="SESSION",w})();let kp=(()=>{class w{constructor(_){this.eventTarget=_,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(_){const I=this.receivers.find(R=>R.isListeningto(_));if(I)return I;const S=new w(_);return this.receivers.push(S),S}isListeningto(_){return this.eventTarget===_}handleEvent(_){var I=this;return(0,g.Z)(function*(){const S=_,{eventId:R,eventType:le,data:Le}=S.data,et=I.handlersMap[le];if(!et?.size)return;S.ports[0].postMessage({status:"ack",eventId:R,eventType:le});const St=Array.from(et).map(function(){var xn=(0,g.Z)(function*(Ms){return Ms(S.origin,Le)});return function(Ms){return xn.apply(this,arguments)}}()),jt=yield function nh(w){return Promise.all(w.map(function(){var p=(0,g.Z)(function*(_){try{return{fulfilled:!0,value:yield _}}catch(I){return{fulfilled:!1,reason:I}}});return function(_){return p.apply(this,arguments)}}()))}(St);S.ports[0].postMessage({status:"done",eventId:R,eventType:le,response:jt})})()}_subscribe(_,I){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[_]||(this.handlersMap[_]=new Set),this.handlersMap[_].add(I)}_unsubscribe(_,I){this.handlersMap[_]&&I&&this.handlersMap[_].delete(I),(!I||0===this.handlersMap[_].size)&&delete this.handlersMap[_],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return w.receivers=[],w})();function Wa(w="",p=10){let _="";for(let I=0;I<p;I++)_+=Math.floor(10*Math.random());return w+_}class fc{constructor(p){this.target=p,this.handlers=new Set}removeMessageHandler(p){p.messageChannel&&(p.messageChannel.port1.removeEventListener("message",p.onMessage),p.messageChannel.port1.close()),this.handlers.delete(p)}_send(p,_,I=50){var S=this;return(0,g.Z)(function*(){const R=typeof MessageChannel<"u"?new MessageChannel:null;if(!R)throw new Error("connection_unavailable");let le,Le;return new Promise((et,St)=>{const jt=Wa("",20);R.port1.start();const xn=setTimeout(()=>{St(new Error("unsupported_event"))},I);Le={messageChannel:R,onMessage(Ms){const pi=Ms;if(pi.data.eventId===jt)switch(pi.data.status){case"ack":clearTimeout(xn),le=setTimeout(()=>{St(new Error("timeout"))},3e3);break;case"done":clearTimeout(le),et(pi.data.response);break;default:clearTimeout(xn),clearTimeout(le),St(new Error("invalid_response"))}}},S.handlers.add(Le),R.port1.addEventListener("message",Le.onMessage),S.target.postMessage({eventType:p,eventId:jt,data:_},[R.port2])}).finally(()=>{Le&&S.removeMessageHandler(Le)})})()}}function xr(){return window}function qa(){return typeof xr().WorkerGlobalScope<"u"&&"function"==typeof xr().importScripts}function mo(){return(mo=(0,g.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const $u="firebaseLocalStorageDb",Ks="firebaseLocalStorage",Hu="fbase_key";class ea{constructor(p){this.request=p}toPromise(){return new Promise((p,_)=>{this.request.addEventListener("success",()=>{p(this.request.result)}),this.request.addEventListener("error",()=>{_(this.request.error)})})}}function Gu(w,p){return w.transaction([Ks],p?"readwrite":"readonly").objectStore(Ks)}function gc(){const w=indexedDB.open($u,1);return new Promise((p,_)=>{w.addEventListener("error",()=>{_(w.error)}),w.addEventListener("upgradeneeded",()=>{const I=w.result;try{I.createObjectStore(Ks,{keyPath:Hu})}catch(S){_(S)}}),w.addEventListener("success",(0,g.Z)(function*(){const I=w.result;I.objectStoreNames.contains(Ks)?p(I):(I.close(),yield function pc(){const w=indexedDB.deleteDatabase($u);return new ea(w).toPromise()}(),p(yield gc()))}))})}function ih(w,p,_){return Mi.apply(this,arguments)}function Mi(){return(Mi=(0,g.Z)(function*(w,p,_){const I=Gu(w,!0).put({[Hu]:p,value:_});return new ea(I).toPromise()})).apply(this,arguments)}function Ka(){return(Ka=(0,g.Z)(function*(w,p){const _=Gu(w,!1).get(p),I=yield new ea(_).toPromise();return void 0===I?null:I.value})).apply(this,arguments)}function mc(w,p){const _=Gu(w,!0).delete(p);return new ea(_).toPromise()}const Fp=(()=>{class w{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var _=this;return(0,g.Z)(function*(){return _.db||(_.db=yield gc()),_.db})()}_withRetries(_){var I=this;return(0,g.Z)(function*(){let S=0;for(;;)try{const R=yield I._openDb();return yield _(R)}catch(R){if(S++>3)throw R;I.db&&(I.db.close(),I.db=void 0)}})()}initializeServiceWorkerMessaging(){var _=this;return(0,g.Z)(function*(){return qa()?_.initializeReceiver():_.initializeSender()})()}initializeReceiver(){var _=this;return(0,g.Z)(function*(){_.receiver=kp._getInstance(function Op(){return qa()?self:null}()),_.receiver._subscribe("keyChanged",function(){var I=(0,g.Z)(function*(S,R){return{keyProcessed:(yield _._poll()).includes(R.key)}});return function(S,R){return I.apply(this,arguments)}}()),_.receiver._subscribe("ping",function(){var I=(0,g.Z)(function*(S,R){return["keyChanged"]});return function(S,R){return I.apply(this,arguments)}}())})()}initializeSender(){var _=this;return(0,g.Z)(function*(){var I,S;if(_.activeServiceWorker=yield function rh(){return mo.apply(this,arguments)}(),!_.activeServiceWorker)return;_.sender=new fc(_.activeServiceWorker);const R=yield _.sender._send("ping",{},800);!R||(null===(I=R[0])||void 0===I?void 0:I.fulfilled)&&(null===(S=R[0])||void 0===S?void 0:S.value.includes("keyChanged"))&&(_.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(_){var I=this;return(0,g.Z)(function*(){if(I.sender&&I.activeServiceWorker&&function Np(){var w;return(null===(w=navigator?.serviceWorker)||void 0===w?void 0:w.controller)||null}()===I.activeServiceWorker)try{yield I.sender._send("keyChanged",{key:_},I.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,g.Z)(function*(){try{if(!indexedDB)return!1;const _=yield gc();return yield ih(_,Xo,"1"),yield mc(_,Xo),!0}catch{}return!1})()}_withPendingWrite(_){var I=this;return(0,g.Z)(function*(){I.pendingWrites++;try{yield _()}finally{I.pendingWrites--}})()}_set(_,I){var S=this;return(0,g.Z)(function*(){return S._withPendingWrite((0,g.Z)(function*(){return yield S._withRetries(R=>ih(R,_,I)),S.localCache[_]=I,S.notifyServiceWorker(_)}))})()}_get(_){var I=this;return(0,g.Z)(function*(){const S=yield I._withRetries(R=>function h_(w,p){return Ka.apply(this,arguments)}(R,_));return I.localCache[_]=S,S})()}_remove(_){var I=this;return(0,g.Z)(function*(){return I._withPendingWrite((0,g.Z)(function*(){return yield I._withRetries(S=>mc(S,_)),delete I.localCache[_],I.notifyServiceWorker(_)}))})()}_poll(){var _=this;return(0,g.Z)(function*(){const I=yield _._withRetries(le=>{const Le=Gu(le,!1).getAll();return new ea(Le).toPromise()});if(!I)return[];if(0!==_.pendingWrites)return[];const S=[],R=new Set;for(const{fbase_key:le,value:Le}of I)R.add(le),JSON.stringify(_.localCache[le])!==JSON.stringify(Le)&&(_.notifyListeners(le,Le),S.push(le));for(const le of Object.keys(_.localCache))_.localCache[le]&&!R.has(le)&&(_.notifyListeners(le,null),S.push(le));return S})()}notifyListeners(_,I){this.localCache[_]=I;const S=this.listeners[_];if(S)for(const R of Array.from(S))R(I)}startPolling(){var _=this;this.stopPolling(),this.pollTimer=setInterval((0,g.Z)(function*(){return _._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(_,I){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[_]||(this.listeners[_]=new Set,this._get(_)),this.listeners[_].add(I)}_removeListener(_,I){this.listeners[_]&&(this.listeners[_].delete(I),0===this.listeners[_].size&&delete this.listeners[_]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return w.type="LOCAL",w})();function _c(w,p){return at(w,"POST","/v2/accounts/mfaSignIn:start",Vt(w,p))}function zu(){return(zu=(0,g.Z)(function*(w){return(yield at(w,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Wu(w){return new Promise((p,_)=>{const I=document.createElement("script");I.setAttribute("src",w),I.onload=p,I.onerror=S=>{const R=Ve("internal-error");R.customData=S,_(R)},I.type="text/javascript",I.charset="UTF-8",function kw(){var w,p;return null!==(p=null===(w=document.getElementsByTagName("head"))||void 0===w?void 0:w[0])&&void 0!==p?p:document}().appendChild(I)})}function _o(w){return`__${w}${Math.floor(1e6*Math.random())}`}const qu=1e12;class ta{constructor(p){this.auth=p,this.counter=qu,this._widgets=new Map}render(p,_){const I=this.counter;return this._widgets.set(I,new Up(p,this.auth.name,_||{})),this.counter++,I}reset(p){var _;const I=p||qu;null===(_=this._widgets.get(I))||void 0===_||_.delete(),this._widgets.delete(I)}getResponse(p){var _;return(null===(_=this._widgets.get(p||qu))||void 0===_?void 0:_.getResponse())||""}execute(p){var _=this;return(0,g.Z)(function*(){var I;return null===(I=_._widgets.get(p||qu))||void 0===I||I.execute(),""})()}}class Up{constructor(p,_,I){this.params=I,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const S="string"==typeof p?document.getElementById(p):p;q(S,"argument-error",{appName:_}),this.container=S,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function uh(w){const p=[],_="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let I=0;I<w;I++)p.push(_.charAt(Math.floor(Math.random()*_.length)));return p.join("")}(50);const{callback:p,"expired-callback":_}=this.params;if(p)try{p(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,_)try{_()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Ku=_o("rcb"),Nw=new pt(3e4,6e4);class Bp{constructor(){var p;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(p=xr().grecaptcha)||void 0===p||!p.render)}load(p,_=""){return q(function Za(w){return w.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(w)}(_),p,"argument-error"),this.shouldResolveImmediately(_)?Promise.resolve(xr().grecaptcha):new Promise((I,S)=>{const R=xr().setTimeout(()=>{S(Ve(p,"network-request-failed"))},Nw.get());xr()[Ku]=()=>{xr().clearTimeout(R),delete xr()[Ku];const Le=xr().grecaptcha;if(!Le)return void S(Ve(p,"internal-error"));const et=Le.render;Le.render=(St,jt)=>{const xn=et(St,jt);return this.counter++,xn},this.hostLanguage=_,I(Le)},Wu(`https://www.google.com/recaptcha/api.js??${(0,j.xO)({onload:Ku,render:"explicit",hl:_})}`).catch(()=>{clearTimeout(R),S(Ve(p,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(p){var _;return!(null===(_=xr().grecaptcha)||void 0===_||!_.render)&&(p===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class na{load(p){return(0,g.Z)(function*(){return new ta(p)})()}clearedOneInstance(){}}const ra="recaptcha",jp={theme:"light",type:"image"};class $p{constructor(p,_=Object.assign({},jp),I){this.parameters=_,this.type=ra,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Zn(I),this.isInvisible="invisible"===this.parameters.size,q(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const S="string"==typeof p?document.getElementById(p):p;q(S,this.auth,"argument-error"),this.container=S,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new na:new Bp,this.validateStartingState()}verify(){var p=this;return(0,g.Z)(function*(){p.assertNotDestroyed();const _=yield p.render(),I=p.getAssertedRecaptcha();return I.getResponse(_)||new Promise(R=>{const le=Le=>{!Le||(p.tokenChangeListeners.delete(le),R(Le))};p.tokenChangeListeners.add(le),p.isInvisible&&I.execute(_)})})()}render(){try{this.assertNotDestroyed()}catch(p){return Promise.reject(p)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(p=>{throw this.renderPromise=null,p})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(p=>{this.container.removeChild(p)})}validateStartingState(){q(!this.parameters.sitekey,this.auth,"argument-error"),q(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),q(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(p){return _=>{if(this.tokenChangeListeners.forEach(I=>I(_)),"function"==typeof p)p(_);else if("string"==typeof p){const I=xr()[p];"function"==typeof I&&I(_)}}}assertNotDestroyed(){q(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var p=this;return(0,g.Z)(function*(){if(yield p.init(),!p.widgetId){let _=p.container;if(!p.isInvisible){const I=document.createElement("div");_.appendChild(I),_=I}p.widgetId=p.getAssertedRecaptcha().render(_,p.parameters)}return p.widgetId})()}init(){var p=this;return(0,g.Z)(function*(){q(He()&&!qa(),p.auth,"internal-error"),yield function Zu(){let w=null;return new Promise(p=>{"complete"!==document.readyState?(w=()=>p(),window.addEventListener("load",w)):p()}).catch(p=>{throw w&&window.removeEventListener("load",w),p})}(),p.recaptcha=yield p._recaptchaLoader.load(p.auth,p.auth.languageCode||void 0);const _=yield function p_(w){return zu.apply(this,arguments)}(p.auth);q(_,p.auth,"internal-error"),p.parameters.sitekey=_})()}getAssertedRecaptcha(){return q(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class lh{constructor(p,_){this.verificationId=p,this.onConfirmation=_}confirm(p){const _=Ds._fromVerification(this.verificationId,p);return this.onConfirmation(_)}}function yo(w,p,_){return Rn.apply(this,arguments)}function Rn(){return(Rn=(0,g.Z)(function*(w,p,_){const I=Zn(w),S=yield Hp(I,p,(0,j.m9)(_));return new lh(S,R=>Qr(I,R))})).apply(this,arguments)}function Ow(w,p,_){return yc.apply(this,arguments)}function yc(){return(yc=(0,g.Z)(function*(w,p,_){const I=(0,j.m9)(w);yield Uu(!1,I,"phone");const S=yield Hp(I.auth,p,(0,j.m9)(_));return new lh(S,R=>O(I,R))})).apply(this,arguments)}function m_(w,p,_){return __.apply(this,arguments)}function __(){return(__=(0,g.Z)(function*(w,p,_){const I=(0,j.m9)(w),S=yield Hp(I.auth,p,(0,j.m9)(_));return new lh(S,R=>Z(I,R))})).apply(this,arguments)}function Hp(w,p,_){return y_.apply(this,arguments)}function y_(){return(y_=(0,g.Z)(function*(w,p,_){var I;const S=yield _.verify();try{let R;if(q("string"==typeof S,w,"argument-error"),q(_.type===ra,w,"argument-error"),R="string"==typeof p?{phoneNumber:p}:p,"session"in R){const le=R.session;if("phoneNumber"in R)return q("enroll"===le.type,w,"internal-error"),(yield xw(w,{idToken:le.credential,phoneEnrollmentInfo:{phoneNumber:R.phoneNumber,recaptchaToken:S}})).phoneSessionInfo.sessionInfo;{q("signin"===le.type,w,"internal-error");const Le=(null===(I=R.multiFactorHint)||void 0===I?void 0:I.uid)||R.multiFactorUid;return q(Le,w,"missing-multi-factor-info"),(yield _c(w,{mfaPendingCredential:le.credential,mfaEnrollmentId:Le,phoneSignInInfo:{recaptchaToken:S}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:le}=yield Oa(w,{phoneNumber:R.phoneNumber,recaptchaToken:S});return le}}finally{_._reset()}})).apply(this,arguments)}function Lw(w,p){return Ya.apply(this,arguments)}function Ya(){return(Ya=(0,g.Z)(function*(w,p){yield qo((0,j.m9)(w),p)})).apply(this,arguments)}let mD=(()=>{class w{constructor(_){this.providerId=w.PROVIDER_ID,this.auth=Zn(_)}verifyPhoneNumber(_,I){return Hp(this.auth,_,(0,j.m9)(I))}static credential(_,I){return Ds._fromVerification(_,I)}static credentialFromResult(_){return w.credentialFromTaggedObject(_)}static credentialFromError(_){return w.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_)return null;const{phoneNumber:I,temporaryProof:S}=_;return I&&S?Ds._fromTokenResponse(I,S):null}}return w.PROVIDER_ID="phone",w.PHONE_SIGN_IN_METHOD="phone",w})();function Yu(w,p){return p?X(p):(q(w._popupRedirectResolver,w,"argument-error"),w._popupRedirectResolver)}class _r extends nn{constructor(p){super("custom","custom"),this.params=p}_getIdTokenResponse(p){return di(p,this._buildIdpRequest())}_linkToIdToken(p,_){return di(p,this._buildIdpRequest(_))}_getReauthenticationResolver(p){return di(p,this._buildIdpRequest())}_buildIdpRequest(p){const _={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return p&&(_.idToken=p),_}}function Gp(w){return $a(w.auth,new _r(w),w.bypassAuthState)}function Qu(w){const{auth:p,user:_}=w;return q(_,p,"internal-error"),lc(_,new _r(w),w.bypassAuthState)}function Fw(w){return Pi.apply(this,arguments)}function Pi(){return(Pi=(0,g.Z)(function*(w){const{auth:p,user:_}=w;return q(_,p,"internal-error"),qo(_,new _r(w),w.bypassAuthState)})).apply(this,arguments)}class ia{constructor(p,_,I,S,R=!1){this.auth=p,this.resolver=I,this.user=S,this.bypassAuthState=R,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(_)?_:[_]}execute(){var p=this;return new Promise(function(){var _=(0,g.Z)(function*(I,S){p.pendingPromise={resolve:I,reject:S};try{p.eventManager=yield p.resolver._initialize(p.auth),yield p.onExecution(),p.eventManager.registerConsumer(p)}catch(R){p.reject(R)}});return function(I,S){return _.apply(this,arguments)}}())}onAuthEvent(p){var _=this;return(0,g.Z)(function*(){const{urlResponse:I,sessionId:S,postBody:R,tenantId:le,error:Le,type:et}=p;if(Le)return void _.reject(Le);const St={auth:_.auth,requestUri:I,sessionId:S,tenantId:le||void 0,postBody:R||void 0,user:_.user,bypassAuthState:_.bypassAuthState};try{_.resolve(yield _.getIdpTask(et)(St))}catch(jt){_.reject(jt)}})()}onError(p){this.reject(p)}getIdpTask(p){switch(p){case"signInViaPopup":case"signInViaRedirect":return Gp;case"linkViaPopup":case"linkViaRedirect":return Fw;case"reauthViaPopup":case"reauthViaRedirect":return Qu;default:Ne(this.auth,"internal-error")}}resolve(p){Ee(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(p),this.unregisterAndCleanUp()}reject(p){Ee(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(p),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const v_=new pt(2e3,1e4);function ch(w,p,_){return Qa.apply(this,arguments)}function Qa(){return(Qa=(0,g.Z)(function*(w,p,_){const I=Zn(w);ae(w,p,es);const S=Yu(I,_);return new qt(I,"signInViaPopup",p,S).executeNotNull()})).apply(this,arguments)}function Uw(w,p,_){return w_.apply(this,arguments)}function w_(){return(w_=(0,g.Z)(function*(w,p,_){const I=(0,j.m9)(w);ae(I.auth,p,es);const S=Yu(I.auth,_);return new qt(I.auth,"reauthViaPopup",p,S,I).executeNotNull()})).apply(this,arguments)}function E_(w,p,_){return I_.apply(this,arguments)}function I_(){return(I_=(0,g.Z)(function*(w,p,_){const I=(0,j.m9)(w);ae(I.auth,p,es);const S=Yu(I.auth,_);return new qt(I.auth,"linkViaPopup",p,S,I).executeNotNull()})).apply(this,arguments)}let qt=(()=>{class w extends ia{constructor(_,I,S,R,le){super(_,I,R,le),this.provider=S,this.authWindow=null,this.pollId=null,w.currentPopupAction&&w.currentPopupAction.cancel(),w.currentPopupAction=this}executeNotNull(){var _=this;return(0,g.Z)(function*(){const I=yield _.execute();return q(I,_.auth,"internal-error"),I})()}onExecution(){var _=this;return(0,g.Z)(function*(){Ee(1===_.filter.length,"Popup operations only handle one event");const I=Wa();_.authWindow=yield _.resolver._openPopup(_.auth,_.provider,_.filter[0],I),_.authWindow.associatedEvent=I,_.resolver._originValidation(_.auth).catch(S=>{_.reject(S)}),_.resolver._isIframeWebStorageSupported(_.auth,S=>{S||_.reject(Ve(_.auth,"web-storage-unsupported"))}),_.pollUserCancellation()})()}get eventId(){var _;return(null===(_=this.authWindow)||void 0===_?void 0:_.associatedEvent)||null}cancel(){this.reject(Ve(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,w.currentPopupAction=null}pollUserCancellation(){const _=()=>{var I,S;this.pollId=null!==(S=null===(I=this.authWindow)||void 0===I?void 0:I.window)&&void 0!==S&&S.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Ve(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(_,v_.get())};_()}}return w.currentPopupAction=null,w})();const ot=new Map;class sa extends ia{constructor(p,_,I=!1){super(p,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],_,void 0,I),this.eventId=null}execute(){var p=()=>super.execute,_=this;return(0,g.Z)(function*(){let I=ot.get(_.auth._key());if(!I){try{const R=(yield function ji(w,p){return dh.apply(this,arguments)}(_.resolver,_.auth))?yield p().call(_):null;I=()=>Promise.resolve(R)}catch(S){I=()=>Promise.reject(S)}ot.set(_.auth._key(),I)}return _.bypassAuthState||ot.set(_.auth._key(),()=>Promise.resolve(null)),I()})()}onAuthEvent(p){var _=()=>super.onAuthEvent,I=this;return(0,g.Z)(function*(){if("signInViaRedirect"===p.type)return _().call(I,p);if("unknown"!==p.type){if(p.eventId){const S=yield I.auth._redirectUserForId(p.eventId);if(S)return I.user=S,_().call(I,p);I.resolve(null)}}else I.resolve(null)})()}onExecution(){return(0,g.Z)(function*(){})()}cleanUp(){}}function dh(){return(dh=(0,g.Z)(function*(w,p){const _=vc(p),I=Wp(w);if(!(yield I._isAvailable()))return!1;const S="true"===(yield I._get(_));return yield I._remove(_),S})).apply(this,arguments)}function Xa(w,p){return $i.apply(this,arguments)}function $i(){return($i=(0,g.Z)(function*(w,p){return Wp(w)._set(vc(p),"true")})).apply(this,arguments)}function b_(){ot.clear()}function zp(w,p){ot.set(w._key(),p)}function Wp(w){return X(w._redirectPersistence)}function vc(w){return an("pendingRedirect",w.config.apiKey,w.name)}function wc(w,p,_){return function hh(w,p,_){return Hi.apply(this,arguments)}(w,p,_)}function Hi(){return(Hi=(0,g.Z)(function*(w,p,_){const I=Zn(w);ae(w,p,es);const S=Yu(I,_);return yield Xa(S,I),S._openRedirect(I,p,"signInViaRedirect")})).apply(this,arguments)}function At(w,p,_){return function Xu(w,p,_){return fh.apply(this,arguments)}(w,p,_)}function fh(){return(fh=(0,g.Z)(function*(w,p,_){const I=(0,j.m9)(w);ae(I.auth,p,es);const S=Yu(I.auth,_);yield Xa(S,I.auth);const R=yield xs(I);return S._openRedirect(I.auth,p,"reauthViaRedirect",R)})).apply(this,arguments)}function qp(w,p,_){return function Ju(w,p,_){return zn.apply(this,arguments)}(w,p,_)}function zn(){return(zn=(0,g.Z)(function*(w,p,_){const I=(0,j.m9)(w);ae(I.auth,p,es);const S=Yu(I.auth,_);yield Uu(!1,I,p.providerId),yield Xa(S,I.auth);const R=yield xs(I);return S._openRedirect(I.auth,p,"linkViaRedirect",R)})).apply(this,arguments)}function Kp(w,p){return Ec.apply(this,arguments)}function Ec(){return(Ec=(0,g.Z)(function*(w,p){return yield Zn(w)._initializationPromise,ph(w,p,!1)})).apply(this,arguments)}function ph(w,p){return Zs.apply(this,arguments)}function Zs(){return(Zs=(0,g.Z)(function*(w,p,_=!1){const I=Zn(w),S=Yu(I,p),le=yield new sa(I,S,_).execute();return le&&!_&&(delete le.user._redirectEventId,yield I._persistUserIfCurrent(le.user),yield I._setRedirectUser(null,p)),le})).apply(this,arguments)}function xs(w){return gh.apply(this,arguments)}function gh(){return(gh=(0,g.Z)(function*(w){const p=Wa(`${w.uid}:::`);return w._redirectEventId=p,yield w.auth._setRedirectUser(w),yield w.auth._persistUserIfCurrent(w),p})).apply(this,arguments)}class Ja{constructor(p){this.auth=p,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(p){this.consumers.add(p),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,p)&&(this.sendToConsumer(this.queuedRedirectEvent,p),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(p){this.consumers.delete(p)}onEvent(p){if(this.hasEventBeenHandled(p))return!1;let _=!1;return this.consumers.forEach(I=>{this.isEventForConsumer(p,I)&&(_=!0,this.sendToConsumer(p,I),this.saveEventToCache(p))}),this.hasHandledPotentialRedirect||!function _h(w){switch(w.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return C_(w);default:return!1}}(p)||(this.hasHandledPotentialRedirect=!0,_||(this.queuedRedirectEvent=p,_=!0)),_}sendToConsumer(p,_){var I;if(p.error&&!C_(p)){const S=(null===(I=p.error.code)||void 0===I?void 0:I.split("auth/")[1])||"internal-error";_.onError(Ve(this.auth,S))}else _.onAuthEvent(p)}isEventForConsumer(p,_){const I=null===_.eventId||!!p.eventId&&p.eventId===_.eventId;return _.filter.includes(p.type)&&I}hasEventBeenHandled(p){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(mh(p))}saveEventToCache(p){this.cachedEventUids.add(mh(p)),this.lastProcessedEventTime=Date.now()}}function mh(w){return[w.type,w.eventId,w.sessionId,w.tenantId].filter(p=>p).join("-")}function C_({type:w,error:p}){return"unknown"===w&&"auth/no-auth-event"===p?.code}function eu(w){return Ys.apply(this,arguments)}function Ys(){return(Ys=(0,g.Z)(function*(w,p={}){return at(w,"GET","/v1/projects",p)})).apply(this,arguments)}const el=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Mr=/^https?/;function tl(){return(tl=(0,g.Z)(function*(w){if(w.config.emulator)return;const{authorizedDomains:p}=yield eu(w);for(const _ of p)try{if(yr(_))return}catch{}Ne(w,"unauthorized-domain")})).apply(this,arguments)}function yr(w){const p=$e(),{protocol:_,hostname:I}=new URL(p);if(w.startsWith("chrome-extension://")){const le=new URL(w);return""===le.hostname&&""===I?"chrome-extension:"===_&&w.replace("chrome-extension://","")===p.replace("chrome-extension://",""):"chrome-extension:"===_&&le.hostname===I}if(!Mr.test(_))return!1;if(el.test(w))return I===w;const S=w.replace(/\./g,"\\.");return new RegExp("^(.+\\."+S+"|"+S+")$","i").test(I)}const tu=new pt(3e4,6e4);function Ic(){const w=xr().___jsl;if(w?.H)for(const p of Object.keys(w.H))if(w.H[p].r=w.H[p].r||[],w.H[p].L=w.H[p].L||[],w.H[p].r=[...w.H[p].L],w.CP)for(let _=0;_<w.CP.length;_++)w.CP[_]=null}let Vr=null;function nu(w){return Vr=Vr||function is(w){return new Promise((p,_)=>{var I,S,R;function le(){Ic(),gapi.load("gapi.iframes",{callback:()=>{p(gapi.iframes.getContext())},ontimeout:()=>{Ic(),_(Ve(w,"network-request-failed"))},timeout:tu.get()})}if(null!==(S=null===(I=xr().gapi)||void 0===I?void 0:I.iframes)&&void 0!==S&&S.Iframe)p(gapi.iframes.getContext());else{if(null===(R=xr().gapi)||void 0===R||!R.load){const Le=_o("iframefcb");return xr()[Le]=()=>{gapi.load?le():_(Ve(w,"network-request-failed"))},Wu(`https://apis.google.com/js/api.js?onload=${Le}`).catch(et=>_(et))}le()}}).catch(p=>{throw Vr=null,p})}(w),Vr}const D_=new pt(5e3,15e3),ru={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},fi=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function oa(w){const p=w.config;q(p.authDomain,w,"auth-domain-config-required");const _=p.emulator?Ut(p,"emulator/auth/iframe"):`https://${w.config.authDomain}/__/auth/iframe`,I={apiKey:p.apiKey,appName:w.name,v:k.SDK_VERSION},S=fi.get(w.config.apiHost);S&&(I.eid=S);const R=w._getFrameworks();return R.length&&(I.fw=R.join(",")),`${_}?${(0,j.xO)(I).slice(1)}`}function wo(){return wo=(0,g.Z)(function*(w){const p=yield nu(w),_=xr().gapi;return q(_,w,"internal-error"),p.open({where:document.body,url:oa(w),messageHandlersFilter:_.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ru,dontclear:!0},I=>new Promise(function(){var S=(0,g.Z)(function*(R,le){yield I.restyle({setHideOnLeave:!1});const Le=Ve(w,"network-request-failed"),et=xr().setTimeout(()=>{le(Le)},D_.get());function St(){xr().clearTimeout(et),R(I)}I.ping(St).then(St,()=>{le(Le)})});return function(R,le){return S.apply(this,arguments)}}()))}),wo.apply(this,arguments)}const vh={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Qt{constructor(p){this.window=p,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Cc(w,p,_,I,S,R){q(w.config.authDomain,w,"auth-domain-config-required"),q(w.config.apiKey,w,"invalid-api-key");const le={apiKey:w.config.apiKey,appName:w.name,authType:_,redirectUrl:I,v:k.SDK_VERSION,eventId:S};if(p instanceof es){p.setDefaultLanguage(w.languageCode),le.providerId=p.providerId||"",(0,j.xb)(p.getCustomParameters())||(le.customParameters=JSON.stringify(p.getCustomParameters()));for(const[et,St]of Object.entries(R||{}))le[et]=St}if(p instanceof Go){const et=p.getScopes().filter(St=>""!==St);et.length>0&&(le.scopes=et.join(","))}w.tenantId&&(le.tid=w.tenantId);const Le=le;for(const et of Object.keys(Le))void 0===Le[et]&&delete Le[et];return`${function Gi({config:w}){return w.emulator?Ut(w,"emulator/auth/handler"):`https://${w.authDomain}/__/auth/handler`}(w)}?${(0,j.xO)(Le).slice(1)}`}const Dc="webStorageSupport",Ih=class Qp{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=go,this._completeRedirectFn=ph,this._overrideRedirectResult=zp}_openPopup(p,_,I,S){var R=this;return(0,g.Z)(function*(){var le;Ee(null===(le=R.eventManagers[p._key()])||void 0===le?void 0:le.manager,"_initialize() not called before _openPopup()");const Le=Cc(p,_,I,$e(),S);return function Ei(w,p,_,I=500,S=600){const R=Math.max((window.screen.availHeight-S)/2,0).toString(),le=Math.max((window.screen.availWidth-I)/2,0).toString();let Le="";const et=Object.assign(Object.assign({},vh),{width:I.toString(),height:S.toString(),top:R,left:le}),St=(0,j.z$)().toLowerCase();_&&(Le=ie(St)?"_blank":_),L(St)&&(p=p||"http://localhost",et.scrollbars="yes");const jt=Object.entries(et).reduce((Ms,[pi,Io])=>`${Ms}${pi}=${Io},`,"");if(function Ln(w=(0,j.z$)()){var p;return Rt(w)&&!(null===(p=window.navigator)||void 0===p||!p.standalone)}(St)&&"_self"!==Le)return function T_(w,p){const _=document.createElement("a");_.href=w,_.target=p;const I=document.createEvent("MouseEvent");I.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),_.dispatchEvent(I)}(p||"",Le),new Qt(null);const xn=window.open(p||"",Le,jt);q(xn,w,"popup-blocked");try{xn.focus()}catch{}return new Qt(xn)}(p,Le,Wa())})()}_openRedirect(p,_,I,S){var R=this;return(0,g.Z)(function*(){return yield R._originValidation(p),function ju(w){xr().location.href=w}(Cc(p,_,I,$e(),S)),new Promise(()=>{})})()}_initialize(p){const _=p._key();if(this.eventManagers[_]){const{manager:S,promise:R}=this.eventManagers[_];return S?Promise.resolve(S):(Ee(R,"If manager is not set, promise should be"),R)}const I=this.initAndGetManager(p);return this.eventManagers[_]={promise:I},I.catch(()=>{delete this.eventManagers[_]}),I}initAndGetManager(p){var _=this;return(0,g.Z)(function*(){const I=yield function Bw(w){return wo.apply(this,arguments)}(p),S=new Ja(p);return I.register("authEvent",R=>(q(R?.authEvent,p,"invalid-auth-event"),{status:S.onEvent(R.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),_.eventManagers[p._key()]={manager:S},_.iframes[p._key()]=I,S})()}_isIframeWebStorageSupported(p,_){this.iframes[p._key()].send(Dc,{type:Dc},S=>{var R;const le=null===(R=S?.[0])||void 0===R?void 0:R[Dc];void 0!==le&&_(!!le),Ne(p,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(p){const _=p._key();return this.originValidationPromises[_]||(this.originValidationPromises[_]=function yh(w){return tl.apply(this,arguments)}(p)),this.originValidationPromises[_]}get _shouldInitProactively(){return wn()||F()||Rt()}};class A_{constructor(p){this.factorId=p}_process(p,_,I){switch(_.type){case"enroll":return this._finalizeEnroll(p,_.credential,I);case"signin":return this._finalizeSignIn(p,_.credential);default:return se("unexpected MultiFactorSessionType")}}}class Pr extends A_{constructor(p){super("phone"),this.credential=p}static _fromCredential(p){return new Pr(p)}_finalizeEnroll(p,_,I){return function Mw(w,p){return at(w,"POST","/v2/accounts/mfaEnrollment:finalize",Vt(w,p))}(p,{idToken:_,displayName:I,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(p,_){return function f_(w,p){return at(w,"POST","/v2/accounts/mfaSignIn:finalize",Vt(w,p))}(p,{mfaPendingCredential:_,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let Eo=(()=>{class w{constructor(){}static assertion(_){return Pr._fromCredential(_)}}return w.FACTOR_ID="phone",w})();var Br="@firebase/auth";class bh{constructor(p){this.auth=p,this.internalListeners=new Map}getUid(){var p;return this.assertAuthConfigured(),(null===(p=this.auth.currentUser)||void 0===p?void 0:p.uid)||null}getToken(p){var _=this;return(0,g.Z)(function*(){return _.assertAuthConfigured(),yield _.auth._initializationPromise,_.auth.currentUser?{accessToken:yield _.auth.currentUser.getIdToken(p)}:null})()}addAuthTokenListener(p){if(this.assertAuthConfigured(),this.internalListeners.has(p))return;const _=this.auth.onIdTokenChanged(I=>{var S;p((null===(S=I)||void 0===S?void 0:S.stsTokenManager.accessToken)||null)});this.internalListeners.set(p,_),this.updateProactiveRefresh()}removeAuthTokenListener(p){this.assertAuthConfigured();const _=this.internalListeners.get(p);!_||(this.internalListeners.delete(p),_(),this.updateProactiveRefresh())}assertAuthConfigured(){q(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}!function ri(w){(0,k._registerComponent)(new he.wA("auth",(p,{options:_})=>{const I=p.getProvider("app").getImmediate(),S=p.getProvider("heartbeat"),{apiKey:R,authDomain:le}=I.options;return((Le,et)=>{q(R&&!R.includes(":"),"invalid-api-key",{appName:Le.name}),q(!le?.includes(":"),"argument-error",{appName:Le.name});const St={apiKey:R,authDomain:le,clientPlatform:w,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Es(w)},jt=new jo(Le,et,St);return function ue(w,p){const _=p?.persistence||[],I=(Array.isArray(_)?_:[_]).map(X);p?.errorMap&&w._updateErrorMap(p.errorMap),w._initializeWithPersistence(I,p?.popupRedirectResolver)}(jt,_),jt})(I,S)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((p,_,I)=>{p.getProvider("auth-internal").initialize()})),(0,k._registerComponent)(new he.wA("auth-internal",p=>{const _=Zn(p.getProvider("auth").getImmediate());return new bh(_)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,k.registerVersion)(Br,"0.20.5",function Sc(w){switch(w){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(w)),(0,k.registerVersion)(Br,"0.20.5","esm2017")}("Browser")},2090:(ft,Pe,M)=>{"use strict";M.d(Pe,{$s:()=>Sr,BH:()=>Oe,DV:()=>at,Dv:()=>ar,G6:()=>q,GJ:()=>Wn,L:()=>_e,LL:()=>$e,Mn:()=>ae,Pz:()=>rn,Sg:()=>Te,UG:()=>ve,UI:()=>Gr,US:()=>he,Wj:()=>Tr,Yr:()=>De,ZB:()=>H,ZR:()=>ue,b$:()=>Ne,cI:()=>Zt,d:()=>Ve,dS:()=>lt,eu:()=>Ee,g5:()=>k,gK:()=>gn,gQ:()=>Jn,h$:()=>we,hl:()=>se,hu:()=>j,jU:()=>xe,lb:()=>bt,m9:()=>Nt,ne:()=>Dr,p$:()=>z,pd:()=>Hn,r3:()=>Vt,ru:()=>ke,tV:()=>ye,uI:()=>Xe,ug:()=>Dt,vZ:()=>pr,w1:()=>Ue,w9:()=>ln,xO:()=>zr,xb:()=>Nn,z$:()=>Ke,zI:()=>Q,zd:()=>gr});const j=function(J,G){if(!J)throw k(G)},k=function(J){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+J)},oe=function(J){const G=[];let B=0;for(let W=0;W<J.length;W++){let K=J.charCodeAt(W);K<128?G[B++]=K:K<2048?(G[B++]=K>>6|192,G[B++]=63&K|128):55296==(64512&K)&&W+1<J.length&&56320==(64512&J.charCodeAt(W+1))?(K=65536+((1023&K)<<10)+(1023&J.charCodeAt(++W)),G[B++]=K>>18|240,G[B++]=K>>12&63|128,G[B++]=K>>6&63|128,G[B++]=63&K|128):(G[B++]=K>>12|224,G[B++]=K>>6&63|128,G[B++]=63&K|128)}return G},he={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(J,G){if(!Array.isArray(J))throw Error("encodeByteArray takes an array as a parameter");this.init_();const B=G?this.byteToCharMapWebSafe_:this.byteToCharMap_,W=[];for(let K=0;K<J.length;K+=3){const Me=J[K],Qe=K+1<J.length,gt=Qe?J[K+1]:0,en=K+2<J.length,an=en?J[K+2]:0;let L=(15&gt)<<2|an>>6,F=63&an;en||(F=64,Qe||(L=64)),W.push(B[Me>>2],B[(3&Me)<<4|gt>>4],B[L],B[F])}return W.join("")},encodeString(J,G){return this.HAS_NATIVE_SUPPORT&&!G?btoa(J):this.encodeByteArray(oe(J),G)},decodeString(J,G){return this.HAS_NATIVE_SUPPORT&&!G?atob(J):function(J){const G=[];let B=0,W=0;for(;B<J.length;){const K=J[B++];if(K<128)G[W++]=String.fromCharCode(K);else if(K>191&&K<224){const Me=J[B++];G[W++]=String.fromCharCode((31&K)<<6|63&Me)}else if(K>239&&K<365){const en=((7&K)<<18|(63&J[B++])<<12|(63&J[B++])<<6|63&J[B++])-65536;G[W++]=String.fromCharCode(55296+(en>>10)),G[W++]=String.fromCharCode(56320+(1023&en))}else{const Me=J[B++],Qe=J[B++];G[W++]=String.fromCharCode((15&K)<<12|(63&Me)<<6|63&Qe)}}return G.join("")}(this.decodeStringToByteArray(J,G))},decodeStringToByteArray(J,G){this.init_();const B=G?this.charToByteMapWebSafe_:this.charToByteMap_,W=[];for(let K=0;K<J.length;){const Me=B[J.charAt(K++)],gt=K<J.length?B[J.charAt(K)]:0;++K;const an=K<J.length?B[J.charAt(K)]:64;++K;const U=K<J.length?B[J.charAt(K)]:64;if(++K,null==Me||null==gt||null==an||null==U)throw Error();W.push(Me<<2|gt>>4),64!==an&&(W.push(gt<<4&240|an>>2),64!==U&&W.push(an<<6&192|U))}return W},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let J=0;J<this.ENCODED_VALS.length;J++)this.byteToCharMap_[J]=this.ENCODED_VALS.charAt(J),this.charToByteMap_[this.byteToCharMap_[J]]=J,this.byteToCharMapWebSafe_[J]=this.ENCODED_VALS_WEBSAFE.charAt(J),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[J]]=J,J>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(J)]=J,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(J)]=J)}}},we=function(J){const G=oe(J);return he.encodeByteArray(G,!0)},_e=function(J){return we(J).replace(/\./g,"")},ye=function(J){try{return he.decodeString(J,!0)}catch(G){console.error("base64Decode failed: ",G)}return null};function z(J){return H(void 0,J)}function H(J,G){if(!(G instanceof Object))return G;switch(G.constructor){case Date:return new Date(G.getTime());case Object:void 0===J&&(J={});break;case Array:J=[];break;default:return G}for(const B in G)!G.hasOwnProperty(B)||!te(B)||(J[B]=H(J[B],G[B]));return J}function te(J){return"__proto__"!==J}class Oe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((G,B)=>{this.resolve=G,this.reject=B})}wrapCallback(G){return(B,W)=>{B?this.reject(B):this.resolve(W),"function"==typeof G&&(this.promise.catch(()=>{}),1===G.length?G(B):G(B,W))}}}function Te(J,G){if(J.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const W=G||"demo-project",K=J.iat||0,Me=J.sub||J.user_id;if(!Me)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const Qe=Object.assign({iss:`https://securetoken.google.com/${W}`,aud:W,iat:K,exp:K+3600,auth_time:K,sub:Me,user_id:Me,firebase:{sign_in_provider:"custom",identities:{}}},J);return[_e(JSON.stringify({alg:"none",type:"JWT"})),_e(JSON.stringify(Qe)),""].join(".")}function Ke(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Xe(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ke())}function ve(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function xe(){return"object"==typeof self&&self.self===self}function ke(){const J="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof J&&void 0!==J.id}function Ne(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Ve(){return Ke().indexOf("Electron/")>=0}function Ue(){const J=Ke();return J.indexOf("MSIE ")>=0||J.indexOf("Trident/")>=0}function ae(){return Ke().indexOf("MSAppHost/")>=0}function De(){return!1}function q(){return!ve()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function se(){return"object"==typeof indexedDB}function Ee(){return new Promise((J,G)=>{try{let B=!0;const W="validate-browser-context-for-indexeddb-analytics-module",K=self.indexedDB.open(W);K.onsuccess=()=>{K.result.close(),B||self.indexedDB.deleteDatabase(W),J(!0)},K.onupgradeneeded=()=>{B=!1},K.onerror=()=>{var Me;G((null===(Me=K.error)||void 0===Me?void 0:Me.message)||"")}}catch(B){G(B)}})}function Q(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class ue extends Error{constructor(G,B,W){super(B),this.code=G,this.customData=W,this.name="FirebaseError",Object.setPrototypeOf(this,ue.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$e.prototype.create)}}class $e{constructor(G,B,W){this.service=G,this.serviceName=B,this.errors=W}create(G,...B){const W=B[0]||{},K=`${this.service}/${G}`,Me=this.errors[G],Qe=Me?function He(J,G){return J.replace(ut,(B,W)=>{const K=G[W];return null!=K?String(K):`<${W}?>`})}(Me,W):"Error";return new ue(K,`${this.serviceName}: ${Qe} (${K}).`,W)}}const ut=/\{\$([^}]+)}/g;function Zt(J){return JSON.parse(J)}function rn(J){return JSON.stringify(J)}const pt=function(J){let G={},B={},W={},K="";try{const Me=J.split(".");G=Zt(ye(Me[0])||""),B=Zt(ye(Me[1])||""),K=Me[2],W=B.d||{},delete B.d}catch{}return{header:G,claims:B,data:W,signature:K}},ln=function(J){const B=pt(J).claims;return!!B&&"object"==typeof B&&B.hasOwnProperty("iat")},Wn=function(J){const G=pt(J).claims;return"object"==typeof G&&!0===G.admin};function Vt(J,G){return Object.prototype.hasOwnProperty.call(J,G)}function at(J,G){if(Object.prototype.hasOwnProperty.call(J,G))return J[G]}function Nn(J){for(const G in J)if(Object.prototype.hasOwnProperty.call(J,G))return!1;return!0}function Gr(J,G,B){const W={};for(const K in J)Object.prototype.hasOwnProperty.call(J,K)&&(W[K]=G.call(B,J[K],K,J));return W}function pr(J,G){if(J===G)return!0;const B=Object.keys(J),W=Object.keys(G);for(const K of B){if(!W.includes(K))return!1;const Me=J[K],Qe=G[K];if(Tn(Me)&&Tn(Qe)){if(!pr(Me,Qe))return!1}else if(Me!==Qe)return!1}for(const K of W)if(!B.includes(K))return!1;return!0}function Tn(J){return null!==J&&"object"==typeof J}function zr(J){const G=[];for(const[B,W]of Object.entries(J))Array.isArray(W)?W.forEach(K=>{G.push(encodeURIComponent(B)+"="+encodeURIComponent(K))}):G.push(encodeURIComponent(B)+"="+encodeURIComponent(W));return G.length?"&"+G.join("&"):""}function gr(J){const G={};return J.replace(/^\?/,"").split("&").forEach(W=>{if(W){const[K,Me]=W.split("=");G[decodeURIComponent(K)]=decodeURIComponent(Me)}}),G}function Hn(J){const G=J.indexOf("?");if(!G)return"";const B=J.indexOf("#",G);return J.substring(G,B>0?B:void 0)}class Jn{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let G=1;G<this.blockSize;++G)this.pad_[G]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(G,B){B||(B=0);const W=this.W_;if("string"==typeof G)for(let U=0;U<16;U++)W[U]=G.charCodeAt(B)<<24|G.charCodeAt(B+1)<<16|G.charCodeAt(B+2)<<8|G.charCodeAt(B+3),B+=4;else for(let U=0;U<16;U++)W[U]=G[B]<<24|G[B+1]<<16|G[B+2]<<8|G[B+3],B+=4;for(let U=16;U<80;U++){const L=W[U-3]^W[U-8]^W[U-14]^W[U-16];W[U]=4294967295&(L<<1|L>>>31)}let an,de,K=this.chain_[0],Me=this.chain_[1],Qe=this.chain_[2],gt=this.chain_[3],en=this.chain_[4];for(let U=0;U<80;U++){U<40?U<20?(an=gt^Me&(Qe^gt),de=1518500249):(an=Me^Qe^gt,de=1859775393):U<60?(an=Me&Qe|gt&(Me|Qe),de=2400959708):(an=Me^Qe^gt,de=3395469782);const L=(K<<5|K>>>27)+an+en+de+W[U]&4294967295;en=gt,gt=Qe,Qe=4294967295&(Me<<30|Me>>>2),Me=K,K=L}this.chain_[0]=this.chain_[0]+K&4294967295,this.chain_[1]=this.chain_[1]+Me&4294967295,this.chain_[2]=this.chain_[2]+Qe&4294967295,this.chain_[3]=this.chain_[3]+gt&4294967295,this.chain_[4]=this.chain_[4]+en&4294967295}update(G,B){if(null==G)return;void 0===B&&(B=G.length);const W=B-this.blockSize;let K=0;const Me=this.buf_;let Qe=this.inbuf_;for(;K<B;){if(0===Qe)for(;K<=W;)this.compress_(G,K),K+=this.blockSize;if("string"==typeof G){for(;K<B;)if(Me[Qe]=G.charCodeAt(K),++Qe,++K,Qe===this.blockSize){this.compress_(Me),Qe=0;break}}else for(;K<B;)if(Me[Qe]=G[K],++Qe,++K,Qe===this.blockSize){this.compress_(Me),Qe=0;break}}this.inbuf_=Qe,this.total_+=B}digest(){const G=[];let B=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let K=this.blockSize-1;K>=56;K--)this.buf_[K]=255&B,B/=256;this.compress_(this.buf_);let W=0;for(let K=0;K<5;K++)for(let Me=24;Me>=0;Me-=8)G[W]=this.chain_[K]>>Me&255,++W;return G}}function Dr(J,G){const B=new yn(J,G);return B.subscribe.bind(B)}class yn{constructor(G,B){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=B,this.task.then(()=>{G(this)}).catch(W=>{this.error(W)})}next(G){this.forEachObserver(B=>{B.next(G)})}error(G){this.forEachObserver(B=>{B.error(G)}),this.close(G)}complete(){this.forEachObserver(G=>{G.complete()}),this.close()}subscribe(G,B,W){let K;if(void 0===G&&void 0===B&&void 0===W)throw new Error("Missing Observer.");K=function rt(J,G){if("object"!=typeof J||null===J)return!1;for(const B of G)if(B in J&&"function"==typeof J[B])return!0;return!1}(G,["next","error","complete"])?G:{next:G,error:B,complete:W},void 0===K.next&&(K.next=Pn),void 0===K.error&&(K.error=Pn),void 0===K.complete&&(K.complete=Pn);const Me=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?K.error(this.finalError):K.complete()}catch{}}),this.observers.push(K),Me}unsubscribeOne(G){void 0===this.observers||void 0===this.observers[G]||(delete this.observers[G],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(G){if(!this.finalized)for(let B=0;B<this.observers.length;B++)this.sendOne(B,G)}sendOne(G,B){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[G])try{B(this.observers[G])}catch(W){typeof console<"u"&&console.error&&console.error(W)}})}close(G){this.finalized||(this.finalized=!0,void 0!==G&&(this.finalError=G),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Pn(){}const ar=function(J,G,B,W){let K;if(W<G?K="at least "+G:W>B&&(K=0===B?"none":"no more than "+B),K)throw new Error(J+" failed: Was called with "+W+(1===W?" argument.":" arguments.")+" Expects "+K+".")};function gn(J,G){return`${J} failed: ${G} argument `}function Tr(J,G,B,W){if((!W||B)&&"function"!=typeof B)throw new Error(gn(J,G)+"must be a valid function.")}function bt(J,G,B,W){if((!W||B)&&("object"!=typeof B||null===B))throw new Error(gn(J,G)+"must be a valid context object.")}const lt=function(J){const G=[];let B=0;for(let W=0;W<J.length;W++){let K=J.charCodeAt(W);if(K>=55296&&K<=56319){const Me=K-55296;W++,j(W<J.length,"Surrogate pair missing trail surrogate."),K=65536+(Me<<10)+(J.charCodeAt(W)-56320)}K<128?G[B++]=K:K<2048?(G[B++]=K>>6|192,G[B++]=63&K|128):K<65536?(G[B++]=K>>12|224,G[B++]=K>>6&63|128,G[B++]=63&K|128):(G[B++]=K>>18|240,G[B++]=K>>12&63|128,G[B++]=K>>6&63|128,G[B++]=63&K|128)}return G},Dt=function(J){let G=0;for(let B=0;B<J.length;B++){const W=J.charCodeAt(B);W<128?G++:W<2048?G+=2:W>=55296&&W<=56319?(G+=4,B++):G+=3}return G};function Sr(J,G=1e3,B=2){const W=G*Math.pow(B,J),K=Math.round(.5*W*(Math.random()-.5)*2);return Math.min(144e5,W+K)}function Nt(J){return J&&J._delegate?J._delegate:J}},3123:(ft,Pe,M)=>{"use strict";var g=M(4650);let j=null;function k(){return j}class me{}const he=new g.OlP("DocumentToken");let we=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=g.Yz7({token:n,factory:function(){return function _e(){return(0,g.LFG)(z)}()},providedIn:"platform"}),n})();const ye=new g.OlP("Location Initialized");let z=(()=>{class n extends we{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return k().getBaseHref(this._doc)}onPopState(t){const r=k().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){const r=k().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,r,i){H()?this._history.pushState(t,r,i):this.location.hash=i}replaceState(t,r,i){H()?this._history.replaceState(t,r,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(he))},n.\u0275prov=g.Yz7({token:n,factory:function(){return function te(){return new z((0,g.LFG)(he))}()},providedIn:"platform"}),n})();function H(){return!!window.history.pushState}function Oe(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function Te(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Ke(n){return n&&"?"!==n[0]?"?"+n:n}let Xe=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=g.Yz7({token:n,factory:function(){return(0,g.f3M)(xe)},providedIn:"root"}),n})();const ve=new g.OlP("appBaseHref");let xe=(()=>{class n extends Xe{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??(0,g.f3M)(he).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Oe(this._baseHref,t)}path(t=!1){const r=this._platformLocation.pathname+Ke(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,a){const l=this.prepareExternalUrl(i+Ke(a));this._platformLocation.pushState(t,r,l)}replaceState(t,r,i,a){const l=this.prepareExternalUrl(i+Ke(a));this._platformLocation.replaceState(t,r,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(we),g.LFG(ve,8))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),ke=(()=>{class n extends Xe{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(t){const r=Oe(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,a){let l=this.prepareExternalUrl(i+Ke(a));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.pushState(t,r,l)}replaceState(t,r,i,a){let l=this.prepareExternalUrl(i+Ke(a));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(we),g.LFG(ve,8))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})(),Ne=(()=>{class n{constructor(t){this._subject=new g.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const r=this._locationStrategy.getBaseHref();this._basePath=function De(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(Te(ae(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Ke(r))}normalize(t){return n.stripTrailingSlash(function Ue(n,e){return n&&e.startsWith(n)?e.substring(n.length):e}(this._basePath,ae(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ke(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ke(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}}return n.normalizeQueryParams=Ke,n.joinWithSlash=Oe,n.stripTrailingSlash=Te,n.\u0275fac=function(t){return new(t||n)(g.LFG(Xe))},n.\u0275prov=g.Yz7({token:n,factory:function(){return function Ve(){return new Ne((0,g.LFG)(Xe))}()},providedIn:"root"}),n})();function ae(n){return n.replace(/\/index.html$/,"")}let Fn=(()=>{class n{constructor(t,r){this._viewContainer=t,this._context=new uo,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){$s("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){$s("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(g.Y36(g.s_b),g.Y36(g.Rgc))},n.\u0275dir=g.lG2({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class uo{constructor(){this.$implicit=null,this.ngIf=null}}function $s(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${(0,g.AaK)(e)}'.`)}let ic=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({}),n})();function oc(n){return"server"===n}let uc=(()=>{class n{}return n.\u0275prov=(0,g.Yz7)({token:n,providedIn:"root",factory:()=>new Wo((0,g.LFG)(he),window)}),n})();class Wo{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function ns(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const a=i.shadowRoot;if(a){const l=a.getElementById(e)||a.querySelector(`[name="${e}"]`);if(l)return l}i=r.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,a=this.offset();this.window.scrollTo(r-a[0],i-a[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=qo(this.window.history)||qo(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function qo(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class th extends me{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class fo extends th{static makeCurrent(){!function oe(n){j||(j=n)}(new fo)}onAndCancel(e,t,r){return e.addEventListener(t,r,!1),()=>{e.removeEventListener(t,r,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function Xo(){return po=po||document.querySelector("base"),po?po.getAttribute("href"):null}();return null==t?null:function xp(n){Jo=Jo||document.createElement("a"),Jo.setAttribute("href",n);const e=Jo.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){po=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function Sn(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const r=t.indexOf("="),[i,a]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(a)}return null}(document.cookie,e)}}let Jo,po=null;const Mp=new g.OlP("TRANSITION_ID"),hc=[{provide:g.ip1,useFactory:function za(n,e,t){return()=>{t.get(g.CZH).donePromise.then(()=>{const r=k(),i=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let a=0;a<i.length;a++)r.remove(i[a])})}},deps:[Mp,he,g.zs3],multi:!0}];let gD=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})();const go=new g.OlP("EventManagerPlugins");let nh=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>i.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}addGlobalEventListener(t,r,i){return this._findPluginFor(r).addGlobalEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){const r=this._eventNameToPlugin.get(t);if(r)return r;const i=this._plugins;for(let a=0;a<i.length;a++){const l=i[a];if(l.supports(t))return this._eventNameToPlugin.set(t,l),l}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(go),g.LFG(g.R0b))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})();class kp{constructor(e){this._doc=e}addGlobalEventListener(e,t,r){const i=k().getGlobalEventTarget(this._doc,e);if(!i)throw new Error(`Unsupported event target ${i} for event ${t}`);return this.addEventListener(i,t,r)}}let Wa=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const r=new Set;t.forEach(i=>{this._stylesSet.has(i)||(this._stylesSet.add(i),r.add(i))}),this.onStylesAdded(r)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})(),fc=(()=>{class n extends Wa{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,r,i){t.forEach(a=>{const l=this._doc.createElement("style");l.textContent=a,i.push(r.appendChild(l))})}addHost(t){const r=[];this._addStylesToHost(this._stylesSet,t,r),this._hostNodes.set(t,r)}removeHost(t){const r=this._hostNodes.get(t);r&&r.forEach(xr),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((r,i)=>{this._addStylesToHost(t,i,r)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(xr))}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(he))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})();function xr(n){k().remove(n)}const ju={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},qa=/%COMP%/g;function Ks(n,e){return e.flat(100).map(t=>t.replace(qa,n))}function Hu(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let Gu=(()=>{class n{constructor(t,r,i){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new pc(t)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;switch(r.encapsulation){case g.ifc.Emulated:{let i=this.rendererByCompId.get(r.id);return i||(i=new h_(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,i)),i.applyToHost(t),i}case 1:case g.ifc.ShadowDom:return new Ka(this.eventManager,this.sharedStylesHost,t,r);default:if(!this.rendererByCompId.has(r.id)){const i=Ks(r.id,r.styles);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(nh),g.LFG(fc),g.LFG(g.AFp))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})();class pc{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(ju[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(Mi(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(Mi(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;const a=ju[i];a?e.setAttributeNS(a,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){const i=ju[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(g.JOm.DashCase|g.JOm.Important)?e.style.setProperty(t,r,i&g.JOm.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&g.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e[t]=r}setValue(e,t){e.nodeValue=t}listen(e,t,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,Hu(r)):this.eventManager.addEventListener(e,t,Hu(r))}}function Mi(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class h_ extends pc{constructor(e,t,r,i){super(e),this.component=r;const a=Ks(i+"-"+r.id,r.styles);t.addStyles(a),this.contentAttr=function $u(n){return"_ngcontent-%COMP%".replace(qa,n)}(i+"-"+r.id),this.hostAttr=function d_(n){return"_nghost-%COMP%".replace(qa,n)}(i+"-"+r.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}}class Ka extends pc{constructor(e,t,r,i){super(e),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const a=Ks(i.id,i.styles);for(let l=0;l<a.length;l++){const h=document.createElement("style");h.textContent=a[l],this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let mc=(()=>{class n extends kp{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(he))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})();const sh=["alt","control","meta","shift"],oh={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Lp={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let Fp=(()=>{class n extends kp{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,r,i){const a=n.parseEventName(r),l=n.eventCallback(a.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>k().onAndCancel(t,a.domEventName,l))}static parseEventName(t){const r=t.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const a=n._normalizeKey(r.pop());let l="",h=r.indexOf("code");if(h>-1&&(r.splice(h,1),l="code."),sh.forEach(v=>{const C=r.indexOf(v);C>-1&&(r.splice(C,1),l+=v+".")}),l+=a,0!=r.length||0===a.length)return null;const m={};return m.domEventName=i,m.fullKey=l,m}static matchEventFullKeyCode(t,r){let i=oh[t.key]||t.key,a="";return r.indexOf("code.")>-1&&(i=t.code,a="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),sh.forEach(l=>{l!==i&&(0,Lp[l])(t)&&(a+=l+".")}),a+=i,a===r)}static eventCallback(t,r,i){return a=>{n.matchEventFullKeyCode(a,t)&&i.runGuarded(()=>r(a))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(he))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})();const qu=(0,g.eFA)(g._c5,"browser",[{provide:g.Lbi,useValue:"browser"},{provide:g.g9A,useValue:function Wu(){fo.makeCurrent()},multi:!0},{provide:he,useFactory:function g_(){return(0,g.RDi)(document),document},deps:[]}]),ta=new g.OlP(""),Up=[{provide:g.rWj,useClass:class Pp{addToWindow(e){g.dqk.getAngularTestability=(r,i=!0)=>{const a=e.findTestabilityInTree(r,i);if(null==a)throw new Error("Could not find testability for element.");return a},g.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),g.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),g.dqk.frameworkStabilizers||(g.dqk.frameworkStabilizers=[]),g.dqk.frameworkStabilizers.push(r=>{const i=g.dqk.getAllAngularTestabilities();let a=i.length,l=!1;const h=function(m){l=l||m,a--,0==a&&r(l)};i.forEach(function(m){m.whenStable(h)})})}findTestabilityInTree(e,t,r){return null==t?null:e.getTestability(t)??(r?k().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:g.lri,useClass:g.dDg,deps:[g.R0b,g.eoX,g.rWj]},{provide:g.dDg,useClass:g.dDg,deps:[g.R0b,g.eoX,g.rWj]}],uh=[{provide:g.zSh,useValue:"root"},{provide:g.qLn,useFactory:function _o(){return new g.qLn},deps:[]},{provide:go,useClass:mc,multi:!0,deps:[he,g.R0b,g.Lbi]},{provide:go,useClass:Fp,multi:!0,deps:[he]},{provide:Gu,useClass:Gu,deps:[nh,fc,g.AFp]},{provide:g.FYo,useExisting:Gu},{provide:Wa,useExisting:fc},{provide:fc,useClass:fc,deps:[he]},{provide:nh,useClass:nh,deps:[go,g.R0b]},{provide:class Bi{},useClass:gD,deps:[]},[]];let Ku=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:g.AFp,useValue:t.appId},{provide:Mp,useExisting:g.AFp},hc]}}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(ta,12))},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({providers:[...uh,...Up],imports:[ic,g.hGG]}),n})(),na=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(he))},n.\u0275prov=g.Yz7({token:n,factory:function(t){let r=null;return r=t?new t:function Za(){return new na((0,g.LFG)(he))}(),r},providedIn:"root"}),n})();typeof window<"u"&&window;var qt=M(8996),vo=M(7669);function ot(...n){const e=(0,vo.yG)(n);return(0,qt.D)(n,e)}var sa=M(7579);class ji extends sa.x{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}const Xa=(0,M(3888).d)(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});var $i=M(9751);const{isArray:b_}=Array,{getPrototypeOf:zp,prototype:Wp,keys:vc}=Object;var Hi=M(4671),At=M(4004);const{isArray:Xu}=Array;var zn=M(5403),Kp=M(9672);function Ec(...n){const e=(0,vo.yG)(n),t=(0,vo.jO)(n),{args:r,keys:i}=function wc(n){if(1===n.length){const e=n[0];if(b_(e))return{args:e,keys:null};if(function hh(n){return n&&"object"==typeof n&&zp(n)===Wp}(e)){const t=vc(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}(n);if(0===r.length)return(0,qt.D)([],e);const a=new $i.y(function ph(n,e,t=Hi.y){return r=>{Zs(e,()=>{const{length:i}=n,a=new Array(i);let l=i,h=i;for(let m=0;m<i;m++)Zs(e,()=>{const v=(0,qt.D)(n[m],e);let C=!1;v.subscribe((0,zn.x)(r,T=>{a[m]=T,C||(C=!0,h--),h||r.next(t(a.slice()))},()=>{--l||r.complete()}))},r)},r)}}(r,e,i?l=>function Ju(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}(i,l):Hi.y));return t?a.pipe(function qp(n){return(0,At.U)(e=>function fh(n,e){return Xu(e)?n(...e):n(e)}(n,e))}(t)):a}function Zs(n,e,t){n?(0,Kp.f)(t,n,e):e()}var xs=M(8189);function Zp(...n){return function gh(){return(0,xs.J)(1)}()((0,qt.D)(n,(0,vo.yG)(n)))}var Ja=M(8421);function mh(n){return new $i.y(e=>{(0,Ja.Xf)(n()).subscribe(e)})}var C_=M(9635),_h=M(576);function eu(n,e){const t=(0,_h.m)(n)?n:()=>n,r=i=>i.error(t());return new $i.y(e?i=>e.schedule(r,0,i):r)}var Ys=M(515),el=M(727),Mr=M(4482);function yh(){return(0,Mr.e)((n,e)=>{let t=null;n._refCount++;const r=(0,zn.x)(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const i=n._connection,a=t;t=null,i&&(!a||i===a)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}class tl extends $i.y{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,(0,Mr.A)(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new el.w0;const t=this.getSubject();e.add(this.source.subscribe((0,zn.x)(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=el.w0.EMPTY)}return e}refCount(){return yh()(this)}}function yr(n,e){return(0,Mr.e)((t,r)=>{let i=null,a=0,l=!1;const h=()=>l&&!i&&r.complete();t.subscribe((0,zn.x)(r,m=>{i?.unsubscribe();let v=0;const C=a++;(0,Ja.Xf)(n(m,C)).subscribe(i=(0,zn.x)(r,T=>r.next(e?e(m,T,C,v++):T),()=>{i=null,h()}))},()=>{l=!0,h()}))})}function tu(n){return n<=0?()=>Ys.E:(0,Mr.e)((e,t)=>{let r=0;e.subscribe((0,zn.x)(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Ic(...n){const e=(0,vo.yG)(n);return(0,Mr.e)((t,r)=>{(e?Zp(n,t,e):Zp(n,t)).subscribe(r)})}function is(n,e){return(0,Mr.e)((t,r)=>{let i=0;t.subscribe((0,zn.x)(r,a=>n.call(e,a,i++)&&r.next(a)))})}var Vr=M(5577);function nu(n){return(0,Mr.e)((e,t)=>{let r=!1;e.subscribe((0,zn.x)(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function D_(n=Vw){return(0,Mr.e)((e,t)=>{let r=!1;e.subscribe((0,zn.x)(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function Vw(){return new Xa}function ss(n,e){const t=arguments.length>=2;return r=>r.pipe(n?is((i,a)=>n(i,a,r)):Hi.y,tu(1),t?nu(e):D_(()=>new Xa))}function ru(n,e){return(0,_h.m)(e)?(0,Vr.z)(n,e,1):(0,Vr.z)(n,1)}var fi=M(8505);function oa(n){return(0,Mr.e)((e,t)=>{let a,r=null,i=!1;r=e.subscribe((0,zn.x)(t,void 0,void 0,l=>{a=(0,Ja.Xf)(n(l,oa(n)(e))),r?(r.unsubscribe(),r=null,a.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,a.subscribe(t))})}function Bw(n,e,t,r,i){return(a,l)=>{let h=t,m=e,v=0;a.subscribe((0,zn.x)(l,C=>{const T=v++;m=h?n(m,C,T):(h=!0,C),r&&l.next(m)},i&&(()=>{h&&l.next(m),l.complete()})))}}function wo(n,e){return(0,Mr.e)(Bw(n,e,arguments.length>=2,!0))}function vh(n){return n<=0?()=>Ys.E:(0,Mr.e)((e,t)=>{let r=[];e.subscribe((0,zn.x)(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(const i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function wh(n,e){const t=arguments.length>=2;return r=>r.pipe(n?is((i,a)=>n(i,a,r)):Hi.y,vh(1),t?nu(e):D_(()=>new Xa))}function bc(n){return(0,Mr.e)((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const Qt="primary",Ei=Symbol("RouteTitle");class T_{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function iu(n){return new T_(n)}function S_(n,e,t){const r=t.path.split("/");if(r.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||r.length<n.length))return null;const i={};for(let a=0;a<r.length;a++){const l=r[a],h=n[a];if(l.startsWith(":"))i[l.substring(1)]=h;else if(l!==h.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function Gi(n,e){const t=n?Object.keys(n):void 0,r=e?Object.keys(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let a=0;a<t.length;a++)if(i=t[a],!Dc(n[i],e[i]))return!1;return!0}function Dc(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),r=[...e].sort();return t.every((i,a)=>r[a]===i)}return n===e}function Qp(n){return Array.prototype.concat.apply([],n)}function Ih(n){return n.length>0?n[n.length-1]:null}function Pr(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function Eo(n){return(0,g.CqO)(n)?n:(0,g.QGY)(n)?(0,qt.D)(Promise.resolve(n)):ot(n)}const Br=!1,Tc={exact:function nl(n,e,t){if(!et(n.segments,e.segments)||!I(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!n.children[r]||!nl(n.children[r],e.children[r],t))return!1;return!0},subset:p},bh={exact:function ri(n,e){return Gi(n,e)},subset:function w(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Dc(n[t],e[t]))},ignored:()=>!0};function Sc(n,e,t){return Tc[t.paths](n.root,e.root,t.matrixParams)&&bh[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function p(n,e,t){return _(n,e,e.segments,t)}function _(n,e,t,r){if(n.segments.length>t.length){const i=n.segments.slice(0,t.length);return!(!et(i,t)||e.hasChildren()||!I(i,t,r))}if(n.segments.length===t.length){if(!et(n.segments,t)||!I(n.segments,t,r))return!1;for(const i in e.children)if(!n.children[i]||!p(n.children[i],e.children[i],r))return!1;return!0}{const i=t.slice(0,n.segments.length),a=t.slice(n.segments.length);return!!(et(n.segments,i)&&I(n.segments,i,r)&&n.children[Qt])&&_(n.children[Qt],e,a,r)}}function I(n,e,t){return e.every((r,i)=>bh[t](n[i].parameters,r.parameters))}class S{constructor(e=new R([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=iu(this.queryParams)),this._queryParamMap}toString(){return Ms.serialize(this)}}class R{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Pr(t,(r,i)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return pi(this)}}class le{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=iu(this.parameters)),this._parameterMap}toString(){return Rc(this)}}function et(n,e){return n.length===e.length&&n.every((t,r)=>t.path===e[r].path)}let jt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=g.Yz7({token:n,factory:function(){return new xn},providedIn:"root"}),n})();class xn{parse(e){const t=new jw(e);return new S(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Io(e.root,!0)}`,r=function xc(n){const e=Object.keys(n).map(t=>{const r=n[t];return Array.isArray(r)?r.map(i=>`${bo(t)}=${bo(i)}`).join("&"):`${bo(t)}=${bo(r)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${r}${"string"==typeof e.fragment?`#${function Ac(n){return encodeURI(n)}(e.fragment)}`:""}`}}const Ms=new xn;function pi(n){return n.segments.map(e=>Rc(e)).join("/")}function Io(n,e){if(!n.hasChildren())return pi(n);if(e){const t=n.children[Qt]?Io(n.children[Qt],!1):"",r=[];return Pr(n.children,(i,a)=>{a!==Qt&&r.push(`${a}:${Io(i,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}{const t=function St(n,e){let t=[];return Pr(n.children,(r,i)=>{i===Qt&&(t=t.concat(e(r,i)))}),Pr(n.children,(r,i)=>{i!==Qt&&(t=t.concat(e(r,i)))}),t}(n,(r,i)=>i===Qt?[Io(n.children[Qt],!1)]:[`${i}:${Io(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Qt]?`${pi(n)}/${t[0]}`:`${pi(n)}/(${t.join("//")})`}}function Ch(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function bo(n){return Ch(n).replace(/%3B/gi,";")}function rl(n){return Ch(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function os(n){return decodeURIComponent(n)}function il(n){return os(n.replace(/\+/g,"%20"))}function Rc(n){return`${rl(n.path)}${function Dh(n){return Object.keys(n).map(e=>`;${rl(e)}=${rl(n[e])}`).join("")}(n.parameters)}`}const R_=/^[^\/()?;=#]+/;function su(n){const e=n.match(R_);return e?e[0]:""}const x_=/^[^=?&#]+/,yD=/^[^&#]+/;class jw{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new R([],{}):new R([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[Qt]=new R(e,t)),r}parseSegment(){const e=su(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new g.vHH(4009,Br);return this.capture(e),new le(os(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=su(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const i=su(this.remaining);i&&(r=i,this.capture(r))}e[os(t)]=os(r)}parseQueryParam(e){const t=function _D(n){const e=n.match(x_);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const l=function vD(n){const e=n.match(yD);return e?e[0]:""}(this.remaining);l&&(r=l,this.capture(r))}const i=il(t),a=il(r);if(e.hasOwnProperty(i)){let l=e[i];Array.isArray(l)||(l=[l],e[i]=l),l.push(a)}else e[i]=a}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=su(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new g.vHH(4010,Br);let a;r.indexOf(":")>-1?(a=r.slice(0,r.indexOf(":")),this.capture(a),this.capture(":")):e&&(a=Qt);const l=this.parseChildren();t[a]=1===Object.keys(l).length?l[Qt]:new R([],l),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new g.vHH(4011,Br)}}function Th(n){return n.segments.length>0?new R([],{[Qt]:n}):n}function Sh(n){const e={};for(const r of Object.keys(n.children)){const a=Sh(n.children[r]);(a.segments.length>0||a.hasChildren())&&(e[r]=a)}return function M_(n){if(1===n.numberOfChildren&&n.children[Qt]){const e=n.children[Qt];return new R(n.segments.concat(e.segments),e.children)}return n}(new R(n.segments,e))}function sl(n){return n instanceof S}function Hw(n,e,t,r,i){if(0===t.length)return Rh(e.root,e.root,e.root,r,i);const a=function k_(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new Gw(!0,0,n);let e=0,t=!1;const r=n.reduce((i,a,l)=>{if("object"==typeof a&&null!=a){if(a.outlets){const h={};return Pr(a.outlets,(m,v)=>{h[v]="string"==typeof m?m.split("/"):m}),[...i,{outlets:h}]}if(a.segmentPath)return[...i,a.segmentPath]}return"string"!=typeof a?[...i,a]:0===l?(a.split("/").forEach((h,m)=>{0==m&&"."===h||(0==m&&""===h?t=!0:".."===h?e++:""!=h&&i.push(h))}),i):[...i,a]},[]);return new Gw(t,e,r)}(t);return a.toRoot()?Rh(e.root,e.root,new R([],{}),r,i):function l(m){const v=function N_(n,e,t,r){if(n.isAbsolute)return new al(e.root,!0,0);if(-1===r)return new al(t,t===e.root,0);return function O_(n,e,t){let r=n,i=e,a=t;for(;a>i;){if(a-=i,r=r.parent,!r)throw new g.vHH(4005,!1);i=r.segments.length}return new al(r,!1,i-a)}(t,r+(Mc(n.commands[0])?0:1),n.numberOfDoubleDots)}(a,e,n.snapshot?._urlSegment,m),C=v.processChildren?kc(v.segmentGroup,v.index,a.commands):Pc(v.segmentGroup,v.index,a.commands);return Rh(e.root,v.segmentGroup,C,r,i)}(n.snapshot?._lastPathIndex)}function Mc(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function Ah(n){return"object"==typeof n&&null!=n&&n.outlets}function Rh(n,e,t,r,i){let l,a={};r&&Pr(r,(m,v)=>{a[v]=Array.isArray(m)?m.map(C=>`${C}`):`${m}`}),l=n===e?t:xh(n,e,t);const h=Th(Sh(l));return new S(h,a,i)}function xh(n,e,t){const r={};return Pr(n.children,(i,a)=>{r[a]=i===e?t:xh(i,e,t)}),new R(n.segments,r)}class Gw{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Mc(r[0]))throw new g.vHH(4003,!1);const i=r.find(Ah);if(i&&i!==Ih(r))throw new g.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class al{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}}function Pc(n,e,t){if(n||(n=new R([],{})),0===n.segments.length&&n.hasChildren())return kc(n,e,t);const r=function L_(n,e,t){let r=0,i=e;const a={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return a;const l=n.segments[i],h=t[r];if(Ah(h))break;const m=`${h}`,v=r<t.length-1?t[r+1]:null;if(i>0&&void 0===m)break;if(m&&v&&"object"==typeof v&&void 0===v.outlets){if(!Ww(m,v,l))return a;r+=2}else{if(!Ww(m,{},l))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const a=new R(n.segments.slice(0,r.pathIndex),{});return a.children[Qt]=new R(n.segments.slice(r.pathIndex),n.children),kc(a,0,i)}return r.match&&0===i.length?new R(n.segments,{}):r.match&&!n.hasChildren()?Mh(n,e,t):r.match?kc(n,0,i):Mh(n,e,t)}function kc(n,e,t){if(0===t.length)return new R(n.segments,{});{const r=function Xp(n){return Ah(n[0])?n[0].outlets:{[Qt]:n}}(t),i={};return Pr(r,(a,l)=>{"string"==typeof a&&(a=[a]),null!==a&&(i[l]=Pc(n.children[l],e,a))}),Pr(n.children,(a,l)=>{void 0===r[l]&&(i[l]=a)}),new R(n.segments,i)}}function Mh(n,e,t){const r=n.segments.slice(0,e);let i=0;for(;i<t.length;){const a=t[i];if(Ah(a)){const m=F_(a.outlets);return new R(r,m)}if(0===i&&Mc(t[0])){r.push(new le(n.segments[e].path,Nc(t[0]))),i++;continue}const l=Ah(a)?a.outlets[Qt]:`${a}`,h=i<t.length-1?t[i+1]:null;l&&h&&Mc(h)?(r.push(new le(l,Nc(h))),i+=2):(r.push(new le(l,{})),i++)}return new R(r,{})}function F_(n){const e={};return Pr(n,(t,r)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[r]=Mh(new R([],{}),0,t))}),e}function Nc(n){const e={};return Pr(n,(t,r)=>e[r]=`${t}`),e}function Ww(n,e,t){return n==t.path&&Gi(e,t.parameters)}class Co{constructor(e,t){this.id=e,this.url=t}}class U_ extends Co{constructor(e,t,r="imperative",i=null){super(e,t),this.type=0,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class ul extends Co{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Jp extends Co{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class V_ extends Co{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class qw extends Co{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class eg extends Co{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class B_ extends Co{constructor(e,t,r,i,a){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=a,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class ll extends Co{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ED extends Co{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ID{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Qx{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class bD{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class j_{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class CD{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Kw{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ph{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let Zw=(()=>{class n{createUrlTree(t,r,i,a,l,h){return Hw(t||r.root,i,a,l,h)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})(),Yw=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=g.Yz7({token:n,factory:function(e){return Zw.\u0275fac(e)},providedIn:"root"}),n})();class Qw{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=H_(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){const t=H_(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=G_(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return G_(e,this._root).map(t=>t.value)}}function H_(n,e){if(n===e.value)return e;for(const t of e.children){const r=H_(n,t);if(r)return r}return null}function G_(n,e){if(n===e.value)return[e];for(const t of e.children){const r=G_(n,t);if(r.length)return r.unshift(e),r}return[]}class aa{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Oc(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class ua extends Qw{constructor(e,t){super(e),this.snapshot=t,tg(this,e)}toString(){return this.snapshot.toString()}}function Lc(n,e){const t=function SD(n,e){const l=new z_([],{},{},"",{},Qt,e,null,n.root,-1,{});return new RD("",new aa(l,[]))}(n,e),r=new ji([new le("",{})]),i=new ji({}),a=new ji({}),l=new ji({}),h=new ji(""),m=new kh(r,i,l,h,a,Qt,e,t.root);return m.snapshot=t.root,new ua(new aa(m,[]),t)}class kh{constructor(e,t,r,i,a,l,h,m){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=l,this.component=h,this.title=this.data?.pipe((0,At.U)(v=>v[Ei]))??ot(void 0),this._futureSnapshot=m}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,At.U)(e=>iu(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,At.U)(e=>iu(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function AD(n,e="emptyOnly"){const t=n.pathFromRoot;let r=0;if("always"!==e)for(r=t.length-1;r>=1;){const i=t[r],a=t[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(a.component)break;r--}}return function Xx(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(r))}class z_{constructor(e,t,r,i,a,l,h,m,v,C,T){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=l,this.component=h,this.routeConfig=m,this._urlSegment=v,this._lastPathIndex=C,this._resolve=T}get title(){return this.data?.[Ei]}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=iu(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=iu(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class RD extends Qw{constructor(e,t){super(t),this.url=e,tg(this,t)}toString(){return Xw(this._root)}}function tg(n,e){e.value._routerState=n,e.children.forEach(t=>tg(n,t))}function Xw(n){const e=n.children.length>0?` { ${n.children.map(Xw).join(", ")} } `:"";return`${n.value}${e}`}function W_(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Gi(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),Gi(e.params,t.params)||n.params.next(t.params),function Cc(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Gi(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),Gi(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function q_(n,e){const t=Gi(n.params,e.params)&&function Le(n,e){return et(n,e)&&n.every((t,r)=>Gi(t.parameters,e[r].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||q_(n.parent,e.parent))}function cl(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const r=t.value;r._futureSnapshot=e.value;const i=function la(n,e,t){return e.children.map(r=>{for(const i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return cl(n,r,i);return cl(n,r)})}(n,e,t);return new aa(r,i)}{if(n.shouldAttach(e.value)){const a=n.retrieve(e.value);if(null!==a){const l=a.route;return l.value._futureSnapshot=e.value,l.children=e.children.map(h=>cl(n,h)),l}}const r=function Nh(n){return new kh(new ji(n.url),new ji(n.params),new ji(n.queryParams),new ji(n.fragment),new ji(n.data),n.outlet,n.component,n)}(e.value),i=e.children.map(a=>cl(n,a));return new aa(r,i)}}const ng="ngNavigationCancelingError";function K_(n,e){const{redirectTo:t,navigationBehaviorOptions:r}=sl(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=Z_(!1,0,e);return i.url=t,i.navigationBehaviorOptions=r,i}function Z_(n,e,t){const r=new Error("NavigationCancelingError: "+(n||""));return r[ng]=!0,r.cancellationCode=e,t&&(r.url=t),r}function MD(n){return PD(n)&&sl(n.url)}function PD(n){return n&&n[ng]}class Jx{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new dl,this.attachRef=null}}let dl=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,r){const i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){const r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Jx,this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Fc=!1;let Jw=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=Qt,this.activateEvents=new g.vpe,this.deactivateEvents=new g.vpe,this.attachEvents=new g.vpe,this.detachEvents=new g.vpe,this.parentContexts=(0,g.f3M)(dl),this.location=(0,g.f3M)(g.s_b),this.changeDetector=(0,g.f3M)(g.sBO),this.environmentInjector=(0,g.f3M)(g.lqb)}ngOnChanges(t){if(t.name){const{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new g.vHH(4012,Fc);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new g.vHH(4012,Fc);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new g.vHH(4012,Fc);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new g.vHH(4013,Fc);this._activatedRoute=t;const i=this.location,l=t.snapshot.component,h=this.parentContexts.getOrCreateContext(this.name).children,m=new eM(t,h,i.injector);if(r&&function eE(n){return!!n.resolveComponentFactory}(r)){const v=r.resolveComponentFactory(l);this.activated=i.createComponent(v,i.length,m)}else this.activated=i.createComponent(l,{index:i.length,injector:m,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=g.lG2({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[g.TTD]}),n})();class eM{constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===kh?this.route:e===dl?this.childContexts:this.parent.get(e,t)}}let Y_=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=g.Xpm({type:n,selectors:[["ng-component"]],standalone:!0,features:[g.jDz],decls:1,vars:0,template:function(t,r){1&t&&g._UZ(0,"router-outlet")},dependencies:[Jw],encapsulation:2}),n})();function tE(n,e){return n.providers&&!n._injector&&(n._injector=(0,g.MMx)(n.providers,e,`Route: ${n.path}`)),n._injector??e}function ey(n){const e=n.children&&n.children.map(ey),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Qt&&(t.component=Y_),t}function Ps(n){return n.outlet||Qt}function rg(n,e){const t=n.filter(r=>Ps(r)===e);return t.push(...n.filter(r=>Ps(r)!==e)),t}function Uc(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class LD{constructor(e,t,r,i){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i}activate(e){const t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),W_(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){const i=Oc(t);e.children.forEach(a=>{const l=a.value.outlet;this.deactivateRoutes(a,i[l],r),delete i[l]}),Pr(i,(a,l)=>{this.deactivateRouteAndItsChildren(a,r)})}deactivateRoutes(e,t,r){const i=e.value,a=t?t.value:null;if(i===a)if(i.component){const l=r.getContext(i.outlet);l&&this.deactivateChildRoutes(e,t,l.children)}else this.deactivateChildRoutes(e,t,r);else a&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,a=Oc(e);for(const l of Object.keys(a))this.deactivateRouteAndItsChildren(a[l],i);if(r&&r.outlet){const l=r.outlet.detach(),h=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:l,route:e,contexts:h})}}deactivateRouteAndOutlet(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,a=Oc(e);for(const l of Object.keys(a))this.deactivateRouteAndItsChildren(a[l],i);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(e,t,r){const i=Oc(t);e.children.forEach(a=>{this.activateRoutes(a,i[a.value.outlet],r),this.forwardEvent(new Kw(a.value.snapshot))}),e.children.length&&this.forwardEvent(new j_(e.value.snapshot))}activateRoutes(e,t,r){const i=e.value,a=t?t.value:null;if(W_(i),i===a)if(i.component){const l=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,l.children)}else this.activateChildRoutes(e,t,r);else if(i.component){const l=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const h=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),l.children.onOutletReAttached(h.contexts),l.attachRef=h.componentRef,l.route=h.route.value,l.outlet&&l.outlet.attach(h.componentRef,h.route.value),W_(h.route.value),this.activateChildRoutes(e,null,l.children)}else{const h=Uc(i.snapshot),m=h?.get(g._Vd)??null;l.attachRef=null,l.route=i,l.resolver=m,l.injector=h,l.outlet&&l.outlet.activateWith(i,l.injector),this.activateChildRoutes(e,null,l.children)}}else this.activateChildRoutes(e,null,r)}}class nE{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class ig{constructor(e,t){this.component=e,this.route=t}}function rE(n,e,t){const r=n._root;return ca(r,e?e._root:null,t,[r.value])}function Oh(n,e){const t=Symbol(),r=e.get(n,t);return r===t?"function"!=typeof n||(0,g.Z0I)(n)?e.get(n):n:r}function ca(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const a=Oc(e);return n.children.forEach(l=>{(function ty(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const a=n.value,l=e?e.value:null,h=t?t.getContext(n.value.outlet):null;if(l&&a.routeConfig===l.routeConfig){const m=function iE(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!et(n.url,e.url);case"pathParamsOrQueryParamsChange":return!et(n.url,e.url)||!Gi(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!q_(n,e)||!Gi(n.queryParams,e.queryParams);default:return!q_(n,e)}}(l,a,a.routeConfig.runGuardsAndResolvers);m?i.canActivateChecks.push(new nE(r)):(a.data=l.data,a._resolvedData=l._resolvedData),ca(n,e,a.component?h?h.children:null:t,r,i),m&&h&&h.outlet&&h.outlet.isActivated&&i.canDeactivateChecks.push(new ig(h.outlet.component,l))}else l&&Vc(e,h,i),i.canActivateChecks.push(new nE(r)),ca(n,null,a.component?h?h.children:null:t,r,i)})(l,a[l.value.outlet],t,r.concat([l.value]),i),delete a[l.value.outlet]}),Pr(a,(l,h)=>Vc(l,t.getContext(h),i)),i}function Vc(n,e,t){const r=Oc(n),i=n.value;Pr(r,(a,l)=>{Vc(a,i.component?e?e.children.getContext(l):null:e,t)}),t.canDeactivateChecks.push(new ig(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function Bc(n){return"function"==typeof n}function Lh(n){return n instanceof Xa||"EmptyError"===n?.name}const Fh=Symbol("INITIAL_VALUE");function hl(){return yr(n=>Ec(n.map(e=>e.pipe(tu(1),Ic(Fh)))).pipe((0,At.U)(e=>{for(const t of e)if(!0!==t){if(t===Fh)return Fh;if(!1===t||t instanceof S)return t}return!0}),is(e=>e!==Fh),tu(1)))}function ag(n){return(0,C_.z)((0,fi.b)(e=>{if(sl(e))throw K_(0,e)}),(0,At.U)(e=>!0===e))}const sy={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function oy(n,e,t,r,i){const a=ou(n,e,t);return a.matched?function jD(n,e,t,r){const i=e.canMatch;return i&&0!==i.length?ot(i.map(l=>{const h=Oh(l,n);return Eo(function sM(n){return n&&Bc(n.canMatch)}(h)?h.canMatch(e,t):n.runInContext(()=>h(e,t)))})).pipe(hl(),ag()):ot(!0)}(r=tE(e,r),e,t).pipe((0,At.U)(l=>!0===l?a:{...sy})):ot(a)}function ou(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...sy}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const i=(e.matcher||S_)(t,n,e);if(!i)return{...sy};const a={};Pr(i.posParams,(h,m)=>{a[m]=h.path});const l=i.consumed.length>0?{...a,...i.consumed[i.consumed.length-1].parameters}:a;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:l,positionalParamSegments:i.posParams??{}}}function ug(n,e,t,r){if(t.length>0&&function ay(n,e,t){return t.some(r=>Uh(n,e,r)&&Ps(r)!==Qt)}(n,t,r)){const a=new R(e,function HD(n,e,t,r){const i={};i[Qt]=r,r._sourceSegment=n,r._segmentIndexShift=e.length;for(const a of t)if(""===a.path&&Ps(a)!==Qt){const l=new R([],{});l._sourceSegment=n,l._segmentIndexShift=e.length,i[Ps(a)]=l}return i}(n,e,r,new R(t,n.children)));return a._sourceSegment=n,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:[]}}if(0===t.length&&function GD(n,e,t){return t.some(r=>Uh(n,e,r))}(n,t,r)){const a=new R(n.segments,function $D(n,e,t,r,i){const a={};for(const l of r)if(Uh(n,t,l)&&!i[Ps(l)]){const h=new R([],{});h._sourceSegment=n,h._segmentIndexShift=e.length,a[Ps(l)]=h}return{...i,...a}}(n,e,t,r,n.children));return a._sourceSegment=n,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:t}}const i=new R(n.segments,n.children);return i._sourceSegment=n,i._segmentIndexShift=e.length,{segmentGroup:i,slicedSegments:t}}function Uh(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function lE(n,e,t,r){return!!(Ps(n)===r||r!==Qt&&Uh(e,t,n))&&("**"===n.path||ou(e,n,t).matched)}function uy(n,e,t){return 0===e.length&&!n.children[t]}const ly=!1;class lg{constructor(e){this.segmentGroup=e||null}}class jc{constructor(e){this.urlTree=e}}function Vh(n){return eu(new lg(n))}function gl(n){return eu(new jc(n))}class WD{constructor(e,t,r,i,a){this.injector=e,this.configLoader=t,this.urlSerializer=r,this.urlTree=i,this.config=a,this.allowRedirects=!0}apply(){const e=ug(this.urlTree.root,[],[],this.config).segmentGroup,t=new R(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,Qt).pipe((0,At.U)(a=>this.createUrlTree(Sh(a),this.urlTree.queryParams,this.urlTree.fragment))).pipe(oa(a=>{if(a instanceof jc)return this.allowRedirects=!1,this.match(a.urlTree);throw a instanceof lg?this.noMatchError(a):a}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,Qt).pipe((0,At.U)(i=>this.createUrlTree(Sh(i),e.queryParams,e.fragment))).pipe(oa(i=>{throw i instanceof lg?this.noMatchError(i):i}))}noMatchError(e){return new g.vHH(4002,ly)}createUrlTree(e,t,r){const i=Th(e);return new S(i,t,r)}expandSegmentGroup(e,t,r,i){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(e,t,r).pipe((0,At.U)(a=>new R([],a))):this.expandSegment(e,r,t,r.segments,i,!0)}expandChildren(e,t,r){const i=[];for(const a of Object.keys(r.children))"primary"===a?i.unshift(a):i.push(a);return(0,qt.D)(i).pipe(ru(a=>{const l=r.children[a],h=rg(t,a);return this.expandSegmentGroup(e,h,l,a).pipe((0,At.U)(m=>({segment:m,outlet:a})))}),wo((a,l)=>(a[l.outlet]=l.segment,a),{}),wh())}expandSegment(e,t,r,i,a,l){return(0,qt.D)(r).pipe(ru(h=>this.expandSegmentAgainstRoute(e,t,r,h,i,a,l).pipe(oa(v=>{if(v instanceof lg)return ot(null);throw v}))),ss(h=>!!h),oa((h,m)=>{if(Lh(h))return uy(t,i,a)?ot(new R([],{})):Vh(t);throw h}))}expandSegmentAgainstRoute(e,t,r,i,a,l,h){return lE(i,t,a,l)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,t,i,a,l):h&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l):Vh(t):Vh(t)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,i,l):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,r,i){const a=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?gl(a):this.lineralizeSegments(r,a).pipe((0,Vr.z)(l=>{const h=new R(l,{});return this.expandSegment(e,h,t,l,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l){const{matched:h,consumedSegments:m,remainingSegments:v,positionalParamSegments:C}=ou(t,i,a);if(!h)return Vh(t);const T=this.applyRedirectCommands(m,i.redirectTo,C);return i.redirectTo.startsWith("/")?gl(T):this.lineralizeSegments(i,T).pipe((0,Vr.z)(x=>this.expandSegment(e,t,r,x.concat(v),l,!1)))}matchSegmentAgainstRoute(e,t,r,i,a){return"**"===r.path?(e=tE(r,e),r.loadChildren?(r._loadedRoutes?ot({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(e,r)).pipe((0,At.U)(h=>(r._loadedRoutes=h.routes,r._loadedInjector=h.injector,new R(i,{})))):ot(new R(i,{}))):oy(t,r,i,e).pipe(yr(({matched:l,consumedSegments:h,remainingSegments:m})=>l?this.getChildConfig(e=r._injector??e,r,i).pipe((0,Vr.z)(C=>{const T=C.injector??e,x=C.routes,{segmentGroup:$,slicedSegments:Y}=ug(t,h,m,x),Ie=new R($.segments,$.children);if(0===Y.length&&Ie.hasChildren())return this.expandChildren(T,x,Ie).pipe((0,At.U)(vt=>new R(h,vt)));if(0===x.length&&0===Y.length)return ot(new R(h,{}));const Re=Ps(r)===a;return this.expandSegment(T,Ie,x,Y,Re?Qt:a,!0).pipe((0,At.U)(Et=>new R(h.concat(Et.segments),Et.children)))})):Vh(t)))}getChildConfig(e,t,r){return t.children?ot({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?ot({routes:t._loadedRoutes,injector:t._loadedInjector}):function uE(n,e,t,r){const i=e.canLoad;return void 0===i||0===i.length?ot(!0):ot(i.map(l=>{const h=Oh(l,n);return Eo(function FD(n){return n&&Bc(n.canLoad)}(h)?h.canLoad(e,t):n.runInContext(()=>h(e,t)))})).pipe(hl(),ag())}(e,t,r).pipe((0,Vr.z)(i=>i?this.configLoader.loadChildren(e,t).pipe((0,fi.b)(a=>{t._loadedRoutes=a.routes,t._loadedInjector=a.injector})):function zD(n){return eu(Z_(ly,3))}())):ot({routes:[],injector:e})}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return ot(r);if(i.numberOfChildren>1||!i.children[Qt])return eu(new g.vHH(4e3,ly));i=i.children[Qt]}}applyRedirectCommands(e,t,r){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r)}applyRedirectCreateUrlTree(e,t,r,i){const a=this.createSegmentGroup(e,t.root,r,i);return new S(a,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const r={};return Pr(e,(i,a)=>{if("string"==typeof i&&i.startsWith(":")){const h=i.substring(1);r[a]=t[h]}else r[a]=i}),r}createSegmentGroup(e,t,r,i){const a=this.createSegments(e,t.segments,r,i);let l={};return Pr(t.children,(h,m)=>{l[m]=this.createSegmentGroup(e,h,r,i)}),new R(a,l)}createSegments(e,t,r,i){return t.map(a=>a.path.startsWith(":")?this.findPosParam(e,a,i):this.findOrReturn(a,r))}findPosParam(e,t,r){const i=r[t.path.substring(1)];if(!i)throw new g.vHH(4001,ly);return i}findOrReturn(e,t){let r=0;for(const i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}}class hE{}class dy{constructor(e,t,r,i,a,l,h){this.injector=e,this.rootComponentType=t,this.config=r,this.urlTree=i,this.url=a,this.paramsInheritanceStrategy=l,this.urlSerializer=h}recognize(){const e=ug(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,Qt).pipe((0,At.U)(t=>{if(null===t)return null;const r=new z_([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Qt,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new aa(r,t),a=new RD(this.url,i);return this.inheritParamsAndData(a._root),a}))}inheritParamsAndData(e){const t=e.value,r=AD(t,this.paramsInheritanceStrategy);t.params=Object.freeze(r.params),t.data=Object.freeze(r.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,r,i){return 0===r.segments.length&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i)}processChildren(e,t,r){return(0,qt.D)(Object.keys(r.children)).pipe(ru(i=>{const a=r.children[i],l=rg(t,i);return this.processSegmentGroup(e,l,a,i)}),wo((i,a)=>i&&a?(i.push(...a),i):null),function Eh(n,e=!1){return(0,Mr.e)((t,r)=>{let i=0;t.subscribe((0,zn.x)(r,a=>{const l=n(a,i++);(l||e)&&r.next(a),!l&&r.complete()}))})}(i=>null!==i),nu(null),wh(),(0,At.U)(i=>{if(null===i)return null;const a=pE(i);return function KD(n){n.sort((e,t)=>e.value.outlet===Qt?-1:t.value.outlet===Qt?1:e.value.outlet.localeCompare(t.value.outlet))}(a),a}))}processSegment(e,t,r,i,a){return(0,qt.D)(t).pipe(ru(l=>this.processSegmentAgainstRoute(l._injector??e,l,r,i,a)),ss(l=>!!l),oa(l=>{if(Lh(l))return uy(r,i,a)?ot([]):ot(null);throw l}))}processSegmentAgainstRoute(e,t,r,i,a){if(t.redirectTo||!lE(t,r,i,a))return ot(null);let l;if("**"===t.path){const h=i.length>0?Ih(i).parameters:{},m=mE(r)+i.length;l=ot({snapshot:new z_(i,h,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,_E(t),Ps(t),t.component??t._loadedComponent??null,t,gE(r),m,yE(t)),consumedSegments:[],remainingSegments:[]})}else l=oy(r,t,i,e).pipe((0,At.U)(({matched:h,consumedSegments:m,remainingSegments:v,parameters:C})=>{if(!h)return null;const T=mE(r)+m.length;return{snapshot:new z_(m,C,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,_E(t),Ps(t),t.component??t._loadedComponent??null,t,gE(r),T,yE(t)),consumedSegments:m,remainingSegments:v}}));return l.pipe(yr(h=>{if(null===h)return ot(null);const{snapshot:m,consumedSegments:v,remainingSegments:C}=h;e=t._injector??e;const T=t._loadedInjector??e,x=function hy(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(t),{segmentGroup:$,slicedSegments:Y}=ug(r,v,C,x.filter(Re=>void 0===Re.redirectTo));if(0===Y.length&&$.hasChildren())return this.processChildren(T,x,$).pipe((0,At.U)(Re=>null===Re?null:[new aa(m,Re)]));if(0===x.length&&0===Y.length)return ot([new aa(m,[])]);const Ie=Ps(t)===a;return this.processSegment(T,x,$,Y,Ie?Qt:a).pipe((0,At.U)(Re=>null===Re?null:[new aa(m,Re)]))}))}}function jh(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function pE(n){const e=[],t=new Set;for(const r of n){if(!jh(r)){e.push(r);continue}const i=e.find(a=>r.value.routeConfig===a.value.routeConfig);void 0!==i?(i.children.push(...r.children),t.add(i)):e.push(r)}for(const r of t){const i=pE(r.children);e.push(new aa(r.value,i))}return e.filter(r=>!t.has(r))}function gE(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function mE(n){let e=n,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function _E(n){return n.data||{}}function yE(n){return n.resolve||{}}function fy(n){return"string"==typeof n.title||null===n.title}function vE(n){return yr(e=>{const t=n(e);return t?(0,qt.D)(t).pipe((0,At.U)(()=>e)):ot(e)})}const Hc=new g.OlP("ROUTES");let cg=(()=>{class n{constructor(t,r){this.injector=t,this.compiler=r,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return ot(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const r=Eo(t.loadComponent()).pipe((0,At.U)(EE),(0,fi.b)(a=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=a}),bc(()=>{this.componentLoaders.delete(t)})),i=new tl(r,()=>new sa.x).pipe(yh());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return ot({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const a=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe((0,At.U)(h=>{this.onLoadEndListener&&this.onLoadEndListener(r);let m,v,C=!1;Array.isArray(h)?v=h:(m=h.create(t).injector,v=Qp(m.get(Hc,[],g.XFs.Self|g.XFs.Optional)));return{routes:v.map(ey),injector:m}}),bc(()=>{this.childrenLoaders.delete(r)})),l=new tl(a,()=>new sa.x).pipe(yh());return this.childrenLoaders.set(r,l),l}loadModuleFactoryOrRoutes(t){return Eo(t()).pipe((0,At.U)(EE),(0,Vr.z)(i=>i instanceof g.YKP||Array.isArray(i)?ot(i):(0,qt.D)(this.compiler.compileModuleAsync(i))))}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(g.zs3),g.LFG(g.Sil))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function EE(n){return function XD(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let gy=(()=>{class n{constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new sa.x,this.configLoader=(0,g.f3M)(cg),this.environmentInjector=(0,g.f3M)(g.lqb),this.urlSerializer=(0,g.f3M)(jt),this.rootContexts=(0,g.f3M)(dl),this.navigationId=0,this.configLoader.onLoadEndListener=i=>this.events.next(new Qx(i)),this.configLoader.onLoadStartListener=i=>this.events.next(new ID(i))}get hasRequestedNavigation(){return 0!==this.navigationId}complete(){this.transitions?.complete()}handleNavigationRequest(t){const r=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:r})}setupNavigations(t){return this.transitions=new ji({id:0,targetPageId:0,currentUrlTree:t.currentUrlTree,currentRawUrl:t.currentUrlTree,extractedUrl:t.urlHandlingStrategy.extract(t.currentUrlTree),urlAfterRedirects:t.urlHandlingStrategy.extract(t.currentUrlTree),rawUrl:t.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:t.routerState.snapshot,targetSnapshot:null,currentRouterState:t.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(is(r=>0!==r.id),(0,At.U)(r=>({...r,extractedUrl:t.urlHandlingStrategy.extract(r.rawUrl)})),yr(r=>{let i=!1,a=!1;return ot(r).pipe((0,fi.b)(l=>{this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),yr(l=>{const h=t.browserUrlTree.toString(),m=!t.navigated||l.extractedUrl.toString()!==h||h!==t.currentUrlTree.toString();if(("reload"===t.onSameUrlNavigation||m)&&t.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return my(l.source)&&(t.browserUrlTree=l.extractedUrl),ot(l).pipe(yr(C=>{const T=this.transitions?.getValue();return this.events.next(new U_(C.id,this.urlSerializer.serialize(C.extractedUrl),C.source,C.restoredState)),T!==this.transitions?.getValue()?Ys.E:Promise.resolve(C)}),function qD(n,e,t,r){return yr(i=>function cE(n,e,t,r,i){return new WD(n,e,t,r,i).apply()}(n,e,t,i.extractedUrl,r).pipe((0,At.U)(a=>({...i,urlAfterRedirects:a}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,t.config),(0,fi.b)(C=>{this.currentNavigation={...this.currentNavigation,finalUrl:C.urlAfterRedirects},r.urlAfterRedirects=C.urlAfterRedirects}),function $c(n,e,t,r,i){return(0,Vr.z)(a=>function cy(n,e,t,r,i,a,l="emptyOnly"){return new dy(n,e,t,r,i,l,a).recognize().pipe(yr(h=>null===h?function fE(n){return new $i.y(e=>e.error(n))}(new hE):ot(h)))}(n,e,t,a.urlAfterRedirects,r.serialize(a.urlAfterRedirects),r,i).pipe((0,At.U)(l=>({...a,targetSnapshot:l}))))}(this.environmentInjector,t.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),(0,fi.b)(C=>{if(r.targetSnapshot=C.targetSnapshot,"eager"===t.urlUpdateStrategy){if(!C.extras.skipLocationChange){const x=t.urlHandlingStrategy.merge(C.urlAfterRedirects,C.rawUrl);t.setBrowserUrl(x,C)}t.browserUrlTree=C.urlAfterRedirects}const T=new qw(C.id,this.urlSerializer.serialize(C.extractedUrl),this.urlSerializer.serialize(C.urlAfterRedirects),C.targetSnapshot);this.events.next(T)}));if(m&&t.rawUrlTree&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){const{id:T,extractedUrl:x,source:$,restoredState:Y,extras:Ie}=l,Re=new U_(T,this.urlSerializer.serialize(x),$,Y);this.events.next(Re);const _t=Lc(x,t.rootComponentType).snapshot;return ot(r={...l,targetSnapshot:_t,urlAfterRedirects:x,extras:{...Ie,skipLocationChange:!1,replaceUrl:!1}})}return t.rawUrlTree=l.rawUrl,l.resolve(null),Ys.E}),(0,fi.b)(l=>{const h=new eg(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}),(0,At.U)(l=>r={...l,guards:rE(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),function fl(n,e){return(0,Vr.z)(t=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:a,canDeactivateChecks:l}}=t;return 0===l.length&&0===a.length?ot({...t,guardsResult:!0}):function VD(n,e,t,r){return(0,qt.D)(n).pipe((0,Vr.z)(i=>function pl(n,e,t,r,i){const a=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return a&&0!==a.length?ot(a.map(h=>{const m=Uc(e)??i,v=Oh(h,m);return Eo(function ny(n){return n&&Bc(n.canDeactivate)}(v)?v.canDeactivate(n,e,t,r):m.runInContext(()=>v(n,e,t,r))).pipe(ss())})).pipe(hl()):ot(!0)}(i.component,i.route,t,e,r)),ss(i=>!0!==i,!0))}(l,r,i,n).pipe((0,Vr.z)(h=>h&&function iM(n){return"boolean"==typeof n}(h)?function ry(n,e,t,r){return(0,qt.D)(e).pipe(ru(i=>Zp(function BD(n,e){return null!==n&&e&&e(new bD(n)),ot(!0)}(i.route.parent,r),function sg(n,e){return null!==n&&e&&e(new CD(n)),ot(!0)}(i.route,r),function og(n,e,t){const r=e[e.length-1],a=e.slice(0,e.length-1).reverse().map(l=>function rM(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(l)).filter(l=>null!==l).map(l=>mh(()=>ot(l.guards.map(m=>{const v=Uc(l.node)??t,C=Oh(m,v);return Eo(function oE(n){return n&&Bc(n.canActivateChild)}(C)?C.canActivateChild(r,n):v.runInContext(()=>C(r,n))).pipe(ss())})).pipe(hl())));return ot(a).pipe(hl())}(n,i.path,t),function iy(n,e,t){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return ot(!0);const i=r.map(a=>mh(()=>{const l=Uc(e)??t,h=Oh(a,l);return Eo(function sE(n){return n&&Bc(n.canActivate)}(h)?h.canActivate(e,n):l.runInContext(()=>h(e,n))).pipe(ss())}));return ot(i).pipe(hl())}(n,i.route,t))),ss(i=>!0!==i,!0))}(r,a,n,e):ot(h)),(0,At.U)(h=>({...t,guardsResult:h})))})}(this.environmentInjector,l=>this.events.next(l)),(0,fi.b)(l=>{if(r.guardsResult=l.guardsResult,sl(l.guardsResult))throw K_(0,l.guardsResult);const h=new B_(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(h)}),is(l=>!!l.guardsResult||(t.restoreHistory(l),this.cancelNavigationTransition(l,"",3,t),!1)),vE(l=>{if(l.guards.canActivateChecks.length)return ot(l).pipe((0,fi.b)(h=>{const m=new ll(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(m)}),yr(h=>{let m=!1;return ot(h).pipe(function da(n,e){return(0,Vr.z)(t=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return ot(t);let a=0;return(0,qt.D)(i).pipe(ru(l=>function YD(n,e,t,r){const i=n.routeConfig,a=n._resolve;return void 0!==i?.title&&!fy(i)&&(a[Ei]=i.title),function QD(n,e,t,r){const i=function aM(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===i.length)return ot({});const a={};return(0,qt.D)(i).pipe((0,Vr.z)(l=>function uM(n,e,t,r){const i=Uc(e)??r,a=Oh(n,i);return Eo(a.resolve?a.resolve(e,t):i.runInContext(()=>a(e,t)))}(n[l],e,t,r).pipe(ss(),(0,fi.b)(h=>{a[l]=h}))),vh(1),function Yp(n){return(0,At.U)(()=>n)}(a),oa(l=>Lh(l)?Ys.E:eu(l)))}(a,n,e,r).pipe((0,At.U)(l=>(n._resolvedData=l,n.data=AD(n,t).resolve,i&&fy(i)&&(n.data[Ei]=i.title),null)))}(l.route,r,n,e)),(0,fi.b)(()=>a++),vh(1),(0,Vr.z)(l=>a===i.length?ot(t):Ys.E))})}(t.paramsInheritanceStrategy,this.environmentInjector),(0,fi.b)({next:()=>m=!0,complete:()=>{m||(t.restoreHistory(h),this.cancelNavigationTransition(h,"",2,t))}}))}),(0,fi.b)(h=>{const m=new ED(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(m)}))}),vE(l=>{const h=m=>{const v=[];m.routeConfig?.loadComponent&&!m.routeConfig._loadedComponent&&v.push(this.configLoader.loadComponent(m.routeConfig).pipe((0,fi.b)(C=>{m.component=C}),(0,At.U)(()=>{})));for(const C of m.children)v.push(...h(C));return v};return Ec(h(l.targetSnapshot.root)).pipe(nu(),tu(1))}),vE(()=>t.afterPreactivation()),(0,At.U)(l=>{const h=function xD(n,e,t){const r=cl(n,e._root,t?t._root:void 0);return new ua(r,e)}(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return r={...l,targetRouterState:h}}),(0,fi.b)(l=>{t.currentUrlTree=l.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(l.urlAfterRedirects,l.rawUrl),t.routerState=l.targetRouterState,"deferred"===t.urlUpdateStrategy&&(l.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,l),t.browserUrlTree=l.urlAfterRedirects)}),((n,e,t)=>(0,At.U)(r=>(new LD(e,r.targetRouterState,r.currentRouterState,t).activate(n),r)))(this.rootContexts,t.routeReuseStrategy,l=>this.events.next(l)),(0,fi.b)({next:l=>{i=!0,this.lastSuccessfulNavigation=this.currentNavigation,t.navigated=!0,this.events.next(new ul(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(t.currentUrlTree))),t.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{i=!0}}),bc(()=>{i||a||this.cancelNavigationTransition(r,"",1,t),this.currentNavigation?.id===r.id&&(this.currentNavigation=null)}),oa(l=>{if(a=!0,PD(l)){MD(l)||(t.navigated=!0,t.restoreHistory(r,!0));const h=new Jp(r.id,this.urlSerializer.serialize(r.extractedUrl),l.message,l.cancellationCode);if(this.events.next(h),MD(l)){const m=t.urlHandlingStrategy.merge(l.url,t.rawUrlTree),v={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||my(r.source)};t.scheduleNavigation(m,"imperative",null,v,{resolve:r.resolve,reject:r.reject,promise:r.promise})}else r.resolve(!1)}else{t.restoreHistory(r,!0);const h=new V_(r.id,this.urlSerializer.serialize(r.extractedUrl),l,r.targetSnapshot??void 0);this.events.next(h);try{r.resolve(t.errorHandler(l))}catch(m){r.reject(m)}}return Ys.E}))}))}cancelNavigationTransition(t,r,i,a){const l=new Jp(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(l),t.resolve(!1)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function my(n){return"imperative"!==n}let IE=(()=>{class n{buildTitle(t){let r,i=t.root;for(;void 0!==i;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(a=>a.outlet===Qt);return r}getResolvedTitleForRoute(t){return t.data[Ei]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=g.Yz7({token:n,factory:function(){return(0,g.f3M)(JD)},providedIn:"root"}),n})(),JD=(()=>{class n extends IE{constructor(t){super(),this.title=t}updateTitle(t){const r=this.buildTitle(t);void 0!==r&&this.title.setTitle(r)}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(na))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),eT=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=g.Yz7({token:n,factory:function(){return(0,g.f3M)(bE)},providedIn:"root"}),n})();class tT{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let bE=(()=>{class n extends tT{}return n.\u0275fac=function(){let e;return function(r){return(e||(e=g.n5z(n)))(r||n)}}(),n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const dg=new g.OlP("",{providedIn:"root",factory:()=>({})});let rT=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=g.Yz7({token:n,factory:function(){return(0,g.f3M)(Kt)},providedIn:"root"}),n})(),Kt=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function CE(n){throw n}function DE(n,e,t){return e.parse("/")}const iT={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},sT={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let vr=(()=>{class n{constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,g.f3M)(g.c2e),this.isNgZoneEnabled=!1,this.options=(0,g.f3M)(dg,{optional:!0})||{},this.errorHandler=this.options.errorHandler||CE,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||DE,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>ot(void 0),this.urlHandlingStrategy=(0,g.f3M)(rT),this.routeReuseStrategy=(0,g.f3M)(eT),this.urlCreationStrategy=(0,g.f3M)(Yw),this.titleStrategy=(0,g.f3M)(IE),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=Qp((0,g.f3M)(Hc,{optional:!0})??[]),this.navigationTransitions=(0,g.f3M)(gy),this.urlSerializer=(0,g.f3M)(jt),this.location=(0,g.f3M)(Ne),this.rootComponentType=null,this.isNgZoneEnabled=(0,g.f3M)(g.R0b)instanceof g.R0b&&g.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new S,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=Lc(this.currentUrlTree,this.rootComponentType),this.navigationTransitions.setupNavigations(this).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const r="popstate"===t.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{const i={replaceUrl:!0},a=t.state?.navigationId?t.state:null;if(t.state){const h={...t.state};delete h.navigationId,delete h.\u0275routerPageId,0!==Object.keys(h).length&&(i.state=h)}const l=this.parseUrl(t.url);this.scheduleNavigation(l,r,a,i)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(t){this.config=t.map(ey),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,r={}){const{relativeTo:i,queryParams:a,fragment:l,queryParamsHandling:h,preserveFragment:m}=r,v=m?this.currentUrlTree.fragment:l;let C=null;switch(h){case"merge":C={...this.currentUrlTree.queryParams,...a};break;case"preserve":C=this.currentUrlTree.queryParams;break;default:C=a||null}return null!==C&&(C=this.removeEmptyProps(C)),this.urlCreationStrategy.createUrlTree(i,this.routerState,this.currentUrlTree,t,C,v??null)}navigateByUrl(t,r={skipLocationChange:!1}){const i=sl(t)?t:this.parseUrl(t),a=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(a,"imperative",null,r)}navigate(t,r={skipLocationChange:!1}){return function oT(n){for(let e=0;e<n.length;e++){if(null==n[e])throw new g.vHH(4008,!1)}}(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let r;try{r=this.urlSerializer.parse(t)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,t)}return r}isActive(t,r){let i;if(i=!0===r?{...iT}:!1===r?{...sT}:r,sl(t))return Sc(this.currentUrlTree,t,i);const a=this.parseUrl(t);return Sc(this.currentUrlTree,a,i)}removeEmptyProps(t){return Object.keys(t).reduce((r,i)=>{const a=t[i];return null!=a&&(r[i]=a),r},{})}scheduleNavigation(t,r,i,a,l){if(this.disposed)return Promise.resolve(!1);let h,m,v,C;return l?(h=l.resolve,m=l.reject,v=l.promise):v=new Promise((T,x)=>{h=T,m=x}),"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(i=this.location.getState()),C=i&&i.\u0275routerPageId?i.\u0275routerPageId:a.replaceUrl||a.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):C=0,this.navigationTransitions.handleNavigationRequest({targetPageId:C,source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:a,resolve:h,reject:m,promise:v,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),v.catch(T=>Promise.reject(T))}setBrowserUrl(t,r){const i=this.urlSerializer.serialize(t),a={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl?this.location.replaceState(i,"",a):this.location.go(i,"",a)}restoreHistory(t,r=!1){if("computed"===this.canceledNavigationResolution){const i=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.getCurrentNavigation()?.finalUrl||0===i?this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===i&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(i)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),$h=(()=>{class n{constructor(t,r,i,a,l,h){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=a,this.el=l,this.locationStrategy=h,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new sa.x;const m=l.nativeElement.tagName;this.isAnchorElement="A"===m||"AREA"===m,this.isAnchorElement?this.subscription=t.events.subscribe(v=>{v instanceof ul&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(t){this._preserveFragment=(0,g.D6c)(t)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(t){this._skipLocationChange=(0,g.D6c)(t)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(t){this._replaceUrl=(0,g.D6c)(t)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,r,i,a,l){return!!(null===this.urlTree||this.isAnchorElement&&(0!==t||r||i||a||l||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const t=null===this.href?null:(0,g.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",t)}applyAttributeValue(t,r){const i=this.renderer,a=this.el.nativeElement;null!==r?i.setAttribute(a,t,r):i.removeAttribute(a,t)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(t){return new(t||n)(g.Y36(vr),g.Y36(kh),g.$8M("tabindex"),g.Y36(g.Qsj),g.Y36(g.SBq),g.Y36(Xe))},n.\u0275dir=g.lG2({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(t,r){1&t&&g.NdJ("click",function(a){return r.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),2&t&&g.uIk("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[g.TTD]}),n})();class lT{}let ml=(()=>{class n{constructor(t,r,i,a,l){this.router=t,this.injector=i,this.preloadingStrategy=a,this.loader=l}setUpPreloading(){this.subscription=this.router.events.pipe(is(t=>t instanceof ul),ru(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){const i=[];for(const a of r){a.providers&&!a._injector&&(a._injector=(0,g.MMx)(a.providers,t,`Route: ${a.path}`));const l=a._injector??t,h=a._loadedInjector??l;a.loadChildren&&!a._loadedRoutes&&void 0===a.canLoad||a.loadComponent&&!a._loadedComponent?i.push(this.preloadConfig(l,a)):(a.children||a._loadedRoutes)&&i.push(this.processRoutes(h,a.children??a._loadedRoutes))}return(0,qt.D)(i).pipe((0,xs.J)())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;i=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(t,r):ot(null);const a=i.pipe((0,Vr.z)(l=>null===l?ot(void 0):(r._loadedRoutes=l.routes,r._loadedInjector=l.injector,this.processRoutes(l.injector??t,l.routes))));if(r.loadComponent&&!r._loadedComponent){const l=this.loader.loadComponent(r);return(0,qt.D)([a,l]).pipe((0,xs.J)())}return a})}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(vr),g.LFG(g.Sil),g.LFG(g.lqb),g.LFG(lT),g.LFG(cg))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const yy=new g.OlP("");let hg=(()=>{class n{constructor(t,r,i,a,l={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=i,this.zone=a,this.options=l,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},l.scrollPositionRestoration=l.scrollPositionRestoration||"disabled",l.anchorScrolling=l.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof U_?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof ul&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Ph&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Ph(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return n.\u0275fac=function(t){g.$Z()},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})();function Hh(n,e){return{\u0275kind:n,\u0275providers:e}}function SE(){const n=(0,g.f3M)(g.zs3);return e=>{const t=n.get(g.z2F);if(e!==t.components[0])return;const r=n.get(vr),i=n.get(_l);1===n.get(vy)&&r.initialNavigation(),n.get(wy,null,g.XFs.Optional)?.setUpPreloading(),n.get(yy,null,g.XFs.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.unsubscribe())}}const _l=new g.OlP("",{factory:()=>new sa.x}),vy=new g.OlP("",{providedIn:"root",factory:()=>1});const wy=new g.OlP("");function mT(n){return Hh(0,[{provide:wy,useExisting:ml},{provide:lT,useExisting:n}])}const RE=new g.OlP("ROUTER_FORROOT_GUARD"),xE=[Ne,{provide:jt,useClass:xn},vr,dl,{provide:kh,useFactory:function hT(n){return n.routerState.root},deps:[vr]},cg,[]];function _T(){return new g.PXZ("Router",vr)}let Ey=(()=>{class n{constructor(t){}static forRoot(t,r){return{ngModule:n,providers:[xE,[],{provide:Hc,multi:!0,useValue:t},{provide:RE,useFactory:by,deps:[[vr,new g.FiY,new g.tp0]]},{provide:dg,useValue:r||{}},r?.useHash?{provide:Xe,useClass:ke}:{provide:Xe,useClass:xe},{provide:yy,useFactory:()=>{const n=(0,g.f3M)(uc),e=(0,g.f3M)(g.R0b),t=(0,g.f3M)(dg),r=(0,g.f3M)(gy),i=(0,g.f3M)(jt);return t.scrollOffset&&n.setOffset(t.scrollOffset),new hg(i,r,n,e,t)}},r?.preloadingStrategy?mT(r.preloadingStrategy).\u0275providers:[],{provide:g.PXZ,multi:!0,useFactory:_T},r?.initialNavigation?yT(r):[],[{provide:vT,useFactory:SE},{provide:g.tb,multi:!0,useExisting:vT}]]}}static forChild(t){return{ngModule:n,providers:[{provide:Hc,multi:!0,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(RE,8))},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({imports:[Y_]}),n})();function by(n){return"guarded"}function yT(n){return["disabled"===n.initialNavigation?Hh(3,[{provide:g.ip1,multi:!0,useFactory:()=>{const e=(0,g.f3M)(vr);return()=>{e.setUpLocationChangeListener()}}},{provide:vy,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?Hh(2,[{provide:vy,useValue:0},{provide:g.ip1,multi:!0,deps:[g.zs3],useFactory:e=>{const t=e.get(ye,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const a=e.get(vr),l=e.get(_l);(function r(i){e.get(vr).events.pipe(is(l=>l instanceof ul||l instanceof Jp||l instanceof V_),(0,At.U)(l=>l instanceof ul||l instanceof Jp&&(0===l.code||1===l.code)&&null),is(l=>null!==l),tu(1)).subscribe(()=>{i()})})(()=>{i(!0)}),a.afterPreactivation=()=>(i(!0),l.closed?ot(void 0):l),a.initialNavigation()}))}}]).\u0275providers:[]]}const vT=new g.OlP("");var ET=M(6457),N=M(2090),ki=M(9681),Qs=M(1877),zi=M(4859),uu=M(4986),En=M(880);function yl(){return(0,Mr.e)((n,e)=>{let t,r=!1;n.subscribe((0,zn.x)(e,i=>{const a=t;t=i,r&&e.next([a,i]),r=!0}))})}function pg(n,e=Hi.y){return n=n??gg,(0,Mr.e)((t,r)=>{let i,a=!0;t.subscribe((0,zn.x)(r,l=>{const h=e(l);(a||!n(i,h))&&(a=!1,i=h,r.next(l))}))})}function gg(n,e){return n===e}var ht,$r=M(2011),zh=(M(5881),M(3942)),Ce=M(5861),kE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Xs={},Cy=Cy||{},Gt=kE||self;function mg(){}function _g(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function zc(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var Dy="closure_uid_"+(1e9*Math.random()>>>0),as=0;function NE(n,e,t){return n.call.apply(n.bind,arguments)}function bT(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function Ii(n,e,t){return(Ii=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?NE:bT).apply(null,arguments)}function Wc(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function ii(n,e){function t(){}t.prototype=e.prototype,n.Z=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Vb=function(r,i,a){for(var l=Array(arguments.length-2),h=2;h<arguments.length;h++)l[h-2]=arguments[h];return e.prototype[i].apply(r,l)}}function lu(){this.s=this.s,this.o=this.o}var DT={};lu.prototype.s=!1,lu.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var n=function IT(n){return Object.prototype.hasOwnProperty.call(n,Dy)&&n[Dy]||(n[Dy]=++as)}(this);delete DT[n]}},lu.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Ty=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1},OE=Array.prototype.forEach?function(n,e,t){Array.prototype.forEach.call(n,e,t)}:function(n,e,t){const r=n.length,i="string"==typeof n?n.split(""):n;for(let a=0;a<r;a++)a in i&&e.call(t,i[a],a,n)};function yg(n){return Array.prototype.concat.apply([],arguments)}function Sy(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function vg(n){return/^[\s\xa0]*$/.test(n)}var tr,LE=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function Ni(n,e){return-1!=n.indexOf(e)}function Ay(n,e){return n<e?-1:n>e?1:0}e:{var wg=Gt.navigator;if(wg){var FE=wg.userAgent;if(FE){tr=FE;break e}}tr=""}function Ry(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function xy(n){const e={};for(const t in n)e[t]=n[t];return e}var UE="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function VE(n,e){let t,r;for(let i=1;i<arguments.length;i++){for(t in r=arguments[i],r)n[t]=r[t];for(let a=0;a<UE.length;a++)t=UE[a],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function My(n){return My[" "](n),n}My[" "]=mg;var ky,n,ST=Ni(tr,"Opera"),qc=Ni(tr,"Trident")||Ni(tr,"MSIE"),Wh=Ni(tr,"Edge"),qh=Wh||qc,Kh=Ni(tr,"Gecko")&&!(Ni(tr.toLowerCase(),"webkit")&&!Ni(tr,"Edge"))&&!(Ni(tr,"Trident")||Ni(tr,"MSIE"))&&!Ni(tr,"Edge"),fM=Ni(tr.toLowerCase(),"webkit")&&!Ni(tr,"Edge");function Eg(){var n=Gt.document;return n?n.documentMode:void 0}e:{var Ig="",bg=(n=tr,Kh?/rv:([^\);]+)(\)|;)/.exec(n):Wh?/Edge\/([\d\.]+)/.exec(n):qc?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):fM?/WebKit\/(\S+)/.exec(n):ST?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(bg&&(Ig=bg?bg[1]:""),qc){var Cg=Eg();if(null!=Cg&&Cg>parseFloat(Ig)){ky=String(Cg);break e}}ky=Ig}var BE={};var Dg=Gt.document&&qc&&(Eg()||parseInt(ky,10))||void 0,Yh=function(){if(!Gt.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{Gt.addEventListener("test",mg,e),Gt.removeEventListener("test",mg,e)}catch{}return n}();function bi(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}function Kc(n,e){if(bi.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(Kh){e:{try{My(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:jE[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Kc.Z.h.call(this)}}bi.prototype.h=function(){this.defaultPrevented=!0},ii(Kc,bi);var jE={2:"touch",3:"pen",4:"mouse"};Kc.prototype.h=function(){Kc.Z.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Qh="closure_listenable_"+(1e6*Math.random()|0),AT=0;function Xh(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.ia=i,this.key=++AT,this.ca=this.fa=!1}function Tg(n){n.ca=!0,n.listener=null,n.proxy=null,n.src=null,n.ia=null}function Oy(n){this.src=n,this.g={},this.h=0}function Ly(n,e){var t=e.type;if(t in n.g){var a,r=n.g[t],i=Ty(r,e);(a=0<=i)&&Array.prototype.splice.call(r,i,1),a&&(Tg(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function Fy(n,e,t,r){for(var i=0;i<n.length;++i){var a=n[i];if(!a.ca&&a.listener==e&&a.capture==!!t&&a.ia==r)return i}return-1}Oy.prototype.add=function(n,e,t,r,i){var a=n.toString();(n=this.g[a])||(n=this.g[a]=[],this.h++);var l=Fy(n,e,r,i);return-1<l?(e=n[l],t||(e.fa=!1)):((e=new Xh(e,this.src,a,!!r,i)).fa=t,n.push(e)),e};var Uy="closure_lm_"+(1e6*Math.random()|0),Vy={};function $E(n,e,t,r,i){if(r&&r.once)return By(n,e,t,r,i);if(Array.isArray(e)){for(var a=0;a<e.length;a++)$E(n,e[a],t,r,i);return null}return t=zy(t),n&&n[Qh]?n.N(e,t,zc(r)?!!r.capture:!!r,i):HE(n,e,t,!1,r,i)}function HE(n,e,t,r,i,a){if(!e)throw Error("Invalid event type");var l=zc(i)?!!i.capture:!!i,h=Hy(n);if(h||(n[Uy]=h=new Oy(n)),(t=h.add(e,t,r,l,a)).proxy)return t;if(r=function RT(){var e=xT;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)Yh||(i=l),void 0===i&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(Sg(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function By(n,e,t,r,i){if(Array.isArray(e)){for(var a=0;a<e.length;a++)By(n,e[a],t,r,i);return null}return t=zy(t),n&&n[Qh]?n.O(e,t,zc(r)?!!r.capture:!!r,i):HE(n,e,t,!0,r,i)}function jy(n,e,t,r,i){if(Array.isArray(e))for(var a=0;a<e.length;a++)jy(n,e[a],t,r,i);else r=zc(r)?!!r.capture:!!r,t=zy(t),n&&n[Qh]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=Fy(a=n.g[e],t,r,i))&&(Tg(a[t]),Array.prototype.splice.call(a,t,1),0==a.length&&(delete n.g[e],n.h--))):n&&(n=Hy(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Fy(e,t,r,i)),(t=-1<n?e[n]:null)&&$y(t))}function $y(n){if("number"!=typeof n&&n&&!n.ca){var e=n.src;if(e&&e[Qh])Ly(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(Sg(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=Hy(e))?(Ly(t,n),0==t.h&&(t.src=null,e[Uy]=null)):Tg(n)}}}function Sg(n){return n in Vy?Vy[n]:Vy[n]="on"+n}function xT(n,e){if(n.ca)n=!0;else{e=new Kc(e,this);var t=n.listener,r=n.ia||n.src;n.fa&&$y(n),n=t.call(r,e)}return n}function Hy(n){return(n=n[Uy])instanceof Oy?n:null}var Gy="__closure_events_fn_"+(1e9*Math.random()>>>0);function zy(n){return"function"==typeof n?n:(n[Gy]||(n[Gy]=function(e){return n.handleEvent(e)}),n[Gy])}function si(){lu.call(this),this.i=new Oy(this),this.P=this,this.I=null}function gi(n,e){var t,r=n.I;if(r)for(t=[];r;r=r.I)t.push(r);if(n=n.P,r=e.type||e,"string"==typeof e)e=new bi(e,n);else if(e instanceof bi)e.target=e.target||n;else{var i=e;VE(e=new bi(r,n),i)}if(i=!0,t)for(var a=t.length-1;0<=a;a--){var l=e.g=t[a];i=Ag(l,r,!0,e)&&i}if(i=Ag(l=e.g=n,r,!0,e)&&i,i=Ag(l,r,!1,e)&&i,t)for(a=0;a<t.length;a++)i=Ag(l=e.g=t[a],r,!1,e)&&i}function Ag(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,a=0;a<e.length;++a){var l=e[a];if(l&&!l.ca&&l.capture==t){var h=l.listener,m=l.ia||l.src;l.fa&&Ly(n.i,l),i=!1!==h.call(m,r)&&i}}return i&&!r.defaultPrevented}ii(si,lu),si.prototype[Qh]=!0,si.prototype.removeEventListener=function(n,e,t,r){jy(this,n,e,t,r)},si.prototype.M=function(){if(si.Z.M.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)Tg(t[r]);delete n.g[e],n.h--}}this.I=null},si.prototype.N=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},si.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var Rg=Gt.JSON.stringify;function GE(){var n=qE;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var WE,PT=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new zE,n=>n.reset());class zE{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function xg(n){Gt.setTimeout(()=>{throw n},0)}function ha(n,e){WE||function Jh(){var n=Gt.Promise.resolve(void 0);WE=function(){n.then(qy)}}(),Wy||(WE(),Wy=!0),qE.add(n,e)}var Wy=!1,qE=new class MT{constructor(){this.h=this.g=null}add(e,t){const r=PT.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}};function qy(){for(var n;n=GE();){try{n.h.call(n.g)}catch(t){xg(t)}var e=PT;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}Wy=!1}function Mg(n,e){si.call(this),this.h=n||1,this.g=e||Gt,this.j=Ii(this.kb,this),this.l=Date.now()}function Ns(n){n.da=!1,n.S&&(n.g.clearTimeout(n.S),n.S=null)}function vl(n,e,t){if("function"==typeof n)t&&(n=Ii(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=Ii(n.handleEvent,n)}return 2147483647<Number(e)?-1:Gt.setTimeout(n,e||0)}function mi(n){n.g=vl(()=>{n.g=null,n.i&&(n.i=!1,mi(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}ii(Mg,si),(ht=Mg.prototype).da=!1,ht.S=null,ht.kb=function(){if(this.da){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-n):(this.S&&(this.g.clearTimeout(this.S),this.S=null),gi(this,"tick"),this.da&&(Ns(this),this.start()))}},ht.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},ht.M=function(){Mg.Z.M.call(this),Ns(this),delete this.g};class wl extends lu{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:mi(this)}M(){super.M(),this.g&&(Gt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function cu(n){lu.call(this),this.h=n,this.g={}}ii(cu,lu);var us=[];function Pg(n,e,t,r){Array.isArray(t)||(t&&(us[0]=t.toString()),t=us);for(var i=0;i<t.length;i++){var a=$E(e,t[i],r||n.handleEvent,!1,n.h||n);if(!a)break;n.g[a.key]=a}}function El(n){Ry(n.g,function(e,t){this.g.hasOwnProperty(t)&&$y(e)},n),n.g={}}function fa(){this.g=!0}function eo(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function Xc(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var l=1;l<i.length;l++)i[l]=""}}}return Rg(t)}catch{return e}}(n,t)+(r?" "+r:"")})}cu.prototype.M=function(){cu.Z.M.call(this),El(this)},cu.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fa.prototype.Aa=function(){this.g=!1},fa.prototype.info=function(){};var Os={},Il=null;function ef(){return Il=Il||new si}function Ky(n){bi.call(this,Os.Ma,n)}function Jc(n){const e=ef();gi(e,new Ky(e,n))}function Zy(n,e){bi.call(this,Os.STAT_EVENT,n),this.stat=e}function Ci(n){const e=ef();gi(e,new Zy(e,n))}function Yy(n,e){bi.call(this,Os.Na,n),this.size=e}function ed(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return Gt.setTimeout(function(){n()},e)}Os.Ma="serverreachability",ii(Ky,bi),Os.STAT_EVENT="statevent",ii(Zy,bi),Os.Na="timingevent",ii(Yy,bi);var tf={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Qy={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Xy(){}function Jy(){}Xy.prototype.h=null;var sf,nf={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function kg(){bi.call(this,"d")}function rf(){bi.call(this,"c")}function Ng(){}function du(n,e,t,r){this.l=n,this.j=e,this.m=t,this.X=r||1,this.V=new cu(this),this.P=ev,this.W=new Mg(n=qh?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new af}function af(){this.i=null,this.g="",this.h=!1}ii(kg,bi),ii(rf,bi),ii(Ng,Xy),Ng.prototype.g=function(){return new XMLHttpRequest},Ng.prototype.i=function(){return{}},sf=new Ng;var ev=45e3,tv={},td={};function uf(n,e,t){n.K=1,n.v=pf(Do(e)),n.s=t,n.U=!0,nv(n,null)}function nv(n,e){n.F=Date.now(),nd(n),n.A=Do(n.v);var t=n.A,r=n.X;Array.isArray(r)||(r=[String(r)]),XE(t.h,"t",r),n.C=0,t=n.l.H,n.h=new af,n.g=gI(n.l,t?e:null,!n.s),0<n.O&&(n.L=new wl(Ii(n.Ia,n,n.g),n.O)),Pg(n.V,n.g,"readystatechange",n.gb),e=n.H?xy(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ea(n.A,n.u,n.s,e)):(n.u="GET",n.g.ea(n.A,n.u,null,e)),Jc(1),function Zc(n,e,t,r,i,a){n.info(function(){if(n.g)if(a)for(var l="",h=a.split("&"),m=0;m<h.length;m++){var v=h[m].split("=");if(1<v.length){var C=v[0];v=v[1];var T=C.split("_");l=2<=T.length&&"type"==T[1]?l+(C+"=")+v+"&":l+(C+"=redacted&")}}else l=null;else l=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+t+"\n"+l})}(n.j,n.u,n.A,n.m,n.X,n.s)}function rv(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Ba}function Og(n,e,t){let i,r=!0;for(;!n.I&&n.C<t.length;){if(i=ZE(n,t),i==td){4==e&&(n.o=4,Ci(14),r=!1),eo(n.j,n.m,null,"[Incomplete Response]");break}if(i==tv){n.o=4,Ci(15),eo(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}eo(n.j,n.m,i,null),Fg(n,i)}rv(n)&&i!=td&&i!=tv&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,Ci(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.aa&&(n.aa=!0,(e=n.l).g==n&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+t.length),bv(e),e.L=!0,Ci(11))):(eo(n.j,n.m,t,"[Invalid Chunked Response]"),hu(n),cf(n))}function ZE(n,e){var t=n.C,r=e.indexOf("\n",t);return-1==r?td:(t=Number(e.substring(t,r)),isNaN(t)?tv:(r+=1)+t>e.length?td:(e=e.substr(r,t),n.C=r+t,e))}function nd(n){n.Y=Date.now()+n.P,Lg(n,n.P)}function Lg(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=ed(Ii(n.eb,n),e)}function lf(n){n.B&&(Gt.clearTimeout(n.B),n.B=null)}function cf(n){0==n.l.G||n.I||dI(n.l,n)}function hu(n){lf(n);var e=n.L;e&&"function"==typeof e.na&&e.na(),n.L=null,Ns(n.W),El(n.V),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function Fg(n,e){try{var t=n.l;if(0!=t.G&&(t.g==n||jg(t.i,n)))if(t.I=n.N,!n.J&&jg(t.i,n)&&3==t.G){try{var r=t.Ca.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.F+3e3<n.F))break e;Wg(t),ad(t)}Iv(t),Ci(18)}}else t.ta=i[1],0<t.ta-t.U&&37500>i[2]&&t.N&&0==t.A&&!t.v&&(t.v=ed(Ii(t.ab,t),6e3));if(1>=hv(t.i)&&t.ka){try{t.ka()}catch{}t.ka=void 0}}else Cl(t,11)}else if((n.J||t.g==n)&&Wg(t),!vg(e))for(i=t.Ca.g.parse(e),e=0;e<i.length;e++){let v=i[e];if(t.U=v[0],v=v[1],2==t.G)if("c"==v[0]){t.J=v[1],t.la=v[2];const C=v[3];null!=C&&(t.ma=C,t.h.info("VER="+t.ma));const T=v[4];null!=T&&(t.za=T,t.h.info("SVER="+t.za));const x=v[5];null!=x&&"number"==typeof x&&0<x&&(t.K=r=1.5*x,t.h.info("backChannelRequestTimeoutMs_="+r)),r=t;const $=n.g;if($){const Y=$.g?$.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Y){var a=r.i;!a.g&&(Ni(Y,"spdy")||Ni(Y,"quic")||Ni(Y,"h2"))&&(a.j=a.l,a.g=new Set,a.h&&(_u(a,a.h),a.h=null))}if(r.D){const Ie=$.g?$.g.getResponseHeader("X-HTTP-Session-Id"):null;Ie&&(r.sa=Ie,Yn(r.F,r.D,Ie))}}t.G=3,t.j&&t.j.xa(),t.$&&(t.O=Date.now()-n.F,t.h.info("Handshake RTT: "+t.O+"ms"));var l=n;if((r=t).oa=pI(r,r.H?r.la:null,r.W),l.J){rI(r.i,l);var h=l,m=r.K;m&&h.setTimeout(m),h.B&&(lf(h),nd(h)),r.g=l}else Ev(r);0<t.l.length&&wf(t)}else"stop"!=v[0]&&"close"!=v[0]||Cl(t,7);else 3==t.G&&("stop"==v[0]||"close"==v[0]?"stop"==v[0]?Cl(t,7):vf(t):"noop"!=v[0]&&t.j&&t.j.wa(v),t.A=0)}Jc(4)}catch{}}function iv(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(_g(n)||"string"==typeof n)OE(n,e,void 0);else{if(n.T&&"function"==typeof n.T)var t=n.T();else if(n.R&&"function"==typeof n.R)t=void 0;else if(_g(n)||"string"==typeof n){t=[];for(var r=n.length,i=0;i<r;i++)t.push(i)}else for(i in t=[],r=0,n)t[r++]=i;r=function YE(n){if(n.R&&"function"==typeof n.R)return n.R();if("string"==typeof n)return n.split("");if(_g(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),i=r.length;for(var a=0;a<i;a++)e.call(void 0,r[a],t&&t[a],n)}}function rd(n,e){this.h={},this.g=[],this.i=0;var t=arguments.length;if(1<t){if(t%2)throw Error("Uneven number of arguments");for(var r=0;r<t;r+=2)this.set(arguments[r],arguments[r+1])}else if(n)if(n instanceof rd)for(t=n.T(),r=0;r<t.length;r++)this.set(t[r],n.get(t[r]));else for(r in n)this.set(r,n[r])}function sv(n){if(n.i!=n.g.length){for(var e=0,t=0;e<n.g.length;){var r=n.g[e];bl(n.h,r)&&(n.g[t++]=r),e++}n.g.length=t}if(n.i!=n.g.length){var i={};for(t=e=0;e<n.g.length;)bl(i,r=n.g[e])||(n.g[t++]=r,i[r]=1),e++;n.g.length=t}}function bl(n,e){return Object.prototype.hasOwnProperty.call(n,e)}(ht=du.prototype).setTimeout=function(n){this.P=n},ht.gb=function(n){n=n.target;const e=this.L;e&&3==To(n)?e.l():this.Ia(n)},ht.Ia=function(n){try{if(n==this.g)e:{const C=To(this.g);var e=this.g.Da();const T=this.g.ba();if(!(3>C)&&(3!=C||qh||this.g&&(this.h.h||this.g.ga()||gv(this.g)))){this.I||4!=C||7==e||Jc(8==e||0>=T?3:2),lf(this);var t=this.g.ba();this.N=t;t:if(rv(this)){var r=gv(this.g);n="";var i=r.length,a=4==To(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){hu(this),cf(this);var l="";break t}this.h.i=new Gt.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:a&&e==i-1});r.splice(0,i),this.h.g+=n,this.C=0,l=this.h.g}else l=this.g.ga();if(this.i=200==t,function Yc(n,e,t,r,i,a,l){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+a+" "+l})}(this.j,this.u,this.A,this.m,this.X,C,t),this.i){if(this.$&&!this.J){t:{if(this.g){var h,m=this.g;if((h=m.g?m.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!vg(h)){var v=h;break t}}v=null}if(!(t=v)){this.i=!1,this.o=3,Ci(12),hu(this),cf(this);break e}eo(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Fg(this,t)}this.U?(Og(this,C,l),qh&&this.i&&3==C&&(Pg(this.V,this.W,"tick",this.fb),this.W.start())):(eo(this.j,this.m,l,null),Fg(this,l)),4==C&&hu(this),this.i&&!this.I&&(4==C?dI(this.l,this):(this.i=!1,nd(this)))}else 400==t&&0<l.indexOf("Unknown SID")?(this.o=3,Ci(12)):(this.o=0,Ci(13)),hu(this),cf(this)}}}catch{}},ht.fb=function(){if(this.g){var n=To(this.g),e=this.g.ga();this.C<e.length&&(lf(this),Og(this,n,e),this.i&&4!=n&&nd(this))}},ht.cancel=function(){this.I=!0,hu(this)},ht.eb=function(){this.B=null;const n=Date.now();0<=n-this.Y?(function Qc(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(Jc(3),Ci(17)),hu(this),this.o=2,cf(this)):Lg(this,this.Y-n)},(ht=rd.prototype).R=function(){sv(this);for(var n=[],e=0;e<this.g.length;e++)n.push(this.h[this.g[e]]);return n},ht.T=function(){return sv(this),this.g.concat()},ht.get=function(n,e){return bl(this.h,n)?this.h[n]:e},ht.set=function(n,e){bl(this.h,n)||(this.i++,this.g.push(n)),this.h[n]=e},ht.forEach=function(n,e){for(var t=this.T(),r=0;r<t.length;r++){var i=t[r],a=this.get(i);n.call(e,a,i,this)}};var Ug=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function fu(n,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,n instanceof fu){this.g=void 0!==e?e:n.g,df(this,n.j),this.s=n.s,hf(this,n.i),ff(this,n.m),this.l=n.l,e=n.h;var t=new Bg;t.i=e.i,e.g&&(t.g=new rd(e.g),t.h=e.h),av(this,t),this.o=n.o}else n&&(t=String(n).match(Ug))?(this.g=!!e,df(this,t[1]||"",!0),this.s=gf(t[2]||""),hf(this,t[3]||"",!0),ff(this,t[4]),this.l=gf(t[5]||"",!0),av(this,t[6]||"",!0),this.o=gf(t[7]||"")):(this.g=!!e,this.h=new Bg(null,this.g))}function Do(n){return new fu(n)}function df(n,e,t){n.j=t?gf(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function hf(n,e,t){n.i=t?gf(e,!0):e}function ff(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function av(n,e,t){e instanceof Bg?(n.h=e,function JE(n,e){e&&!n.j&&(mu(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(QE(this,r),XE(this,i,t))},n)),n.j=e}(n.h,n.g)):(t||(e=mf(e,cv)),n.h=new Bg(e,n.g))}function Yn(n,e,t){n.h.set(e,t)}function pf(n){return Yn(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function gf(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function mf(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,uv),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function uv(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}fu.prototype.toString=function(){var n=[],e=this.j;e&&n.push(mf(e,gu,!0),":");var t=this.i;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(mf(e,gu,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.i&&"/"!=t.charAt(0)&&n.push("/"),n.push(mf(t,"/"==t.charAt(0)?kT:lv,!0))),(t=this.h.toString())&&n.push("?",t),(t=this.o)&&n.push("#",mf(t,pM)),n.join("")};var gu=/[#\/\?@]/g,lv=/[#\?:]/g,kT=/[#\?]/g,cv=/[#\?@]/g,pM=/#/g;function Bg(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function mu(n){n.g||(n.g=new rd,n.h=0,n.i&&function ov(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var a=n[t].substring(0,r);i=n[t].substring(r+1)}else a=n[t];e(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function QE(n,e){mu(n),e=nr(n,e),bl(n.g.h,e)&&(n.i=null,n.h-=n.g.get(e).length,bl((n=n.g).h,e)&&(delete n.h[e],n.i--,n.g.length>2*n.i&&sv(n)))}function dv(n,e){return mu(n),e=nr(n,e),bl(n.g.h,e)}function XE(n,e,t){QE(n,e),0<t.length&&(n.i=null,n.g.set(nr(n,e),Sy(t)),n.h+=t.length)}function nr(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function eI(n){this.l=n||tI,n=Gt.PerformanceNavigationTiming?0<(n=Gt.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(Gt.g&&Gt.g.Ea&&Gt.g.Ea()&&Gt.g.Ea().Zb),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(ht=Bg.prototype).add=function(n,e){mu(this),this.i=null,n=nr(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},ht.forEach=function(n,e){mu(this),this.g.forEach(function(t,r){OE(t,function(i){n.call(e,i,r,this)},this)},this)},ht.T=function(){mu(this);for(var n=this.g.R(),e=this.g.T(),t=[],r=0;r<e.length;r++)for(var i=n[r],a=0;a<i.length;a++)t.push(e[r]);return t},ht.R=function(n){mu(this);var e=[];if("string"==typeof n)dv(this,n)&&(e=yg(e,this.g.get(nr(this,n))));else{n=this.g.R();for(var t=0;t<n.length;t++)e=yg(e,n[t])}return e},ht.set=function(n,e){return mu(this),this.i=null,dv(this,n=nr(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},ht.get=function(n,e){return n&&0<(n=this.R(n)).length?String(n[0]):e},ht.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var n=[],e=this.g.T(),t=0;t<e.length;t++){var r=e[t],i=encodeURIComponent(String(r));r=this.R(r);for(var a=0;a<r.length;a++){var l=i;""!==r[a]&&(l+="="+encodeURIComponent(String(r[a]))),n.push(l)}}return this.i=n.join("&")};var tI=10;function nI(n){return!!n.h||!!n.g&&n.g.size>=n.j}function hv(n){return n.h?1:n.g?n.g.size:0}function jg(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function _u(n,e){n.g?n.g.add(e):n.h=e}function rI(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function iI(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return Sy(n.i)}function $g(){}function OT(){this.g=new $g}function sI(n,e,t){const r=t||"";try{iv(n,function(i,a){let l=i;zc(i)&&(l=Rg(i)),e.push(r+a+"="+encodeURIComponent(l))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function _f(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function id(n){this.l=n.$b||null,this.j=n.ib||!1}function ls(n,e){si.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=fv,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}eI.prototype.cancel=function(){if(this.i=iI(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},$g.prototype.stringify=function(n){return Gt.JSON.stringify(n,void 0)},$g.prototype.parse=function(n){return Gt.JSON.parse(n,void 0)},ii(id,Xy),id.prototype.g=function(){return new ls(this.l,this.j)},id.prototype.i=function(n){return function(){return n}}({}),ii(ls,si);var fv=0;function oI(n){n.j.read().then(n.Sa.bind(n)).catch(n.ha.bind(n))}function Wi(n){n.readyState=4,n.l=null,n.j=null,n.A=null,Oi(n)}function Oi(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(ht=ls.prototype).open=function(n,e){if(this.readyState!=fv)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,Oi(this)},ht.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||Gt).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},ht.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Wi(this)),this.readyState=fv},ht.Va=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,Oi(this)),this.g&&(this.readyState=3,Oi(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof Gt.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;oI(this)}else n.text().then(this.Ua.bind(this),this.ha.bind(this))},ht.Sa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?Wi(this):Oi(this),3==this.readyState&&oI(this)}},ht.Ua=function(n){this.g&&(this.response=this.responseText=n,Wi(this))},ht.Ta=function(n){this.g&&(this.response=n,Wi(this))},ht.ha=function(){this.g&&Wi(this)},ht.setRequestHeader=function(n,e){this.v.append(n,e)},ht.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},ht.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(ls.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var to=Gt.JSON.parse;function kr(n){si.call(this),this.headers=new rd,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=pv,this.K=this.L=!1}ii(kr,si);var pv="",LT=/^https?$/i,FT=["POST","PUT"];function VT(n){return"content-type"==n.toLowerCase()}function Hg(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,sd(n),yf(n)}function sd(n){n.D||(n.D=!0,gi(n,"complete"),gi(n,"error"))}function aI(n){if(n.h&&typeof Cy<"u"&&(!n.C[1]||4!=To(n)||2!=n.ba()))if(n.v&&4==To(n))vl(n.Fa,0,n);else if(gi(n,"readystatechange"),4==To(n)){n.h=!1;try{const h=n.ba();e:switch(h){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===h){var i=String(n.H).match(Ug)[1]||null;if(!i&&Gt.self&&Gt.self.location){var a=Gt.self.location.protocol;i=a.substr(0,a.length-1)}r=!LT.test(i?i.toLowerCase():"")}t=r}if(t)gi(n,"complete"),gi(n,"success");else{n.m=6;try{var l=2<To(n)?n.g.statusText:""}catch{l=""}n.j=l+" ["+n.ba()+"]",sd(n)}}finally{yf(n)}}}function yf(n,e){if(n.g){uI(n);const t=n.g,r=n.C[0]?mg:null;n.g=null,n.C=null,e||gi(n,"ready");try{t.onreadystatechange=r}catch{}}}function uI(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(Gt.clearTimeout(n.A),n.A=null)}function To(n){return n.g?n.g.readyState:0}function gv(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case pv:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function mv(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=function Gg(n){let e="";return Ry(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):Yn(n,e,t))}function od(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function _v(n){this.za=0,this.l=[],this.h=new fa,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=od("failFast",!1,n),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=od("baseRetryDelayMs",5e3,n),this.$a=od("retryDelaySeedMs",1e4,n),this.Ya=od("forwardChannelMaxRetries",2,n),this.ra=od("forwardChannelRequestTimeoutMs",2e4,n),this.qa=n&&n.xmlHttpFactory||void 0,this.Ba=n&&n.Yb||!1,this.K=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.J="",this.i=new eI(n&&n.concurrentRequestLimit),this.Ca=new OT,this.ja=n&&n.fastHandshake||!1,this.Ra=n&&n.Wb||!1,n&&n.Aa&&this.h.Aa(),n&&n.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&n&&n.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!n||!1!==n.Xb}function vf(n){if(yv(n),3==n.G){var e=n.V++,t=Do(n.F);Yn(t,"SID",n.J),Yn(t,"RID",e),Yn(t,"TYPE","terminate"),ud(n,t),(e=new du(n,n.h,e,void 0)).K=2,e.v=pf(Do(t)),t=!1,Gt.navigator&&Gt.navigator.sendBeacon&&(t=Gt.navigator.sendBeacon(e.v.toString(),"")),!t&&Gt.Image&&((new Image).src=e.v,t=!0),t||(e.g=gI(e.l,null),e.g.ea(e.v)),e.F=Date.now(),nd(e)}fI(n)}function ad(n){n.g&&(bv(n),n.g.cancel(),n.g=null)}function yv(n){ad(n),n.u&&(Gt.clearTimeout(n.u),n.u=null),Wg(n),n.i.cancel(),n.m&&("number"==typeof n.m&&Gt.clearTimeout(n.m),n.m=null)}function zg(n,e){n.l.push(new class{constructor(n,e){this.h=n,this.g=e}}(n.Za++,e)),3==n.G&&wf(n)}function wf(n){nI(n.i)||n.m||(n.m=!0,ha(n.Ha,n),n.C=0)}function vv(n,e){var t;t=e?e.m:n.V++;const r=Do(n.F);Yn(r,"SID",n.J),Yn(r,"RID",t),Yn(r,"AID",n.U),ud(n,r),n.o&&n.s&&mv(r,n.o,n.s),t=new du(n,n.h,t,n.C+1),null===n.o&&(t.H=n.s),e&&(n.l=e.D.concat(n.l)),e=wv(n,t,1e3),t.setTimeout(Math.round(.5*n.ra)+Math.round(.5*n.ra*Math.random())),_u(n.i,t),uf(t,r,e)}function ud(n,e){n.j&&iv({},function(t,r){Yn(e,r,t)})}function wv(n,e,t){t=Math.min(n.l.length,t);var r=n.j?Ii(n.j.Oa,n.j,n):null;e:{var i=n.l;let a=-1;for(;;){const l=["count="+t];-1==a?0<t?(a=i[0].h,l.push("ofs="+a)):a=0:l.push("ofs="+a);let h=!0;for(let m=0;m<t;m++){let v=i[m].h;const C=i[m].g;if(v-=a,0>v)a=Math.max(0,i[m].h-100),h=!1;else try{sI(C,l,"req"+v+"_")}catch{r&&r(C)}}if(h){r=l.join("&");break e}}}return n=n.l.splice(0,t),e.D=n,r}function Ev(n){n.g||n.u||(n.Y=1,ha(n.Ga,n),n.A=0)}function Iv(n){return!(n.g||n.u||3<=n.A||(n.Y++,n.u=ed(Ii(n.Ga,n),hI(n,n.A)),n.A++,0))}function bv(n){null!=n.B&&(Gt.clearTimeout(n.B),n.B=null)}function cI(n){n.g=new du(n,n.h,"rpc",n.Y),null===n.o&&(n.g.H=n.s),n.g.O=0;var e=Do(n.oa);Yn(e,"RID","rpc"),Yn(e,"SID",n.J),Yn(e,"CI",n.N?"0":"1"),Yn(e,"AID",n.U),ud(n,e),Yn(e,"TYPE","xmlhttp"),n.o&&n.s&&mv(e,n.o,n.s),n.K&&n.g.setTimeout(n.K);var t=n.g;n=n.la,t.K=1,t.v=pf(Do(e)),t.s=null,t.U=!0,nv(t,n)}function Wg(n){null!=n.v&&(Gt.clearTimeout(n.v),n.v=null)}function dI(n,e){var t=null;if(n.g==e){Wg(n),bv(n),n.g=null;var r=2}else{if(!jg(n.i,e))return;t=e.D,rI(n.i,e),r=1}if(n.I=e.N,0!=n.G)if(e.i)if(1==r){t=e.s?e.s.length:0,e=Date.now()-e.F;var i=n.C;gi(r=ef(),new Yy(r,t,e,i)),wf(n)}else Ev(n);else if(3==(i=e.o)||0==i&&0<n.I||!(1==r&&function lI(n,e){return!(hv(n.i)>=n.i.j-(n.m?1:0)||(n.m?(n.l=e.D.concat(n.l),0):1==n.G||2==n.G||n.C>=(n.Xa?0:n.Ya)||(n.m=ed(Ii(n.Ha,n,e),hI(n,n.C)),n.C++,0)))}(n,e)||2==r&&Iv(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),i){case 1:Cl(n,5);break;case 4:Cl(n,10);break;case 3:Cl(n,6);break;default:Cl(n,2)}}function hI(n,e){let t=n.Pa+Math.floor(Math.random()*n.$a);return n.j||(t*=2),t*e}function Cl(n,e){if(n.h.info("Error code "+e),2==e){var t=null;n.j&&(t=null);var r=Ii(n.jb,n);t||(t=new fu("//www.google.com/images/cleardot.gif"),Gt.location&&"http"==Gt.location.protocol||df(t,"https"),pf(t)),function gM(n,e){const t=new fa;if(Gt.Image){const r=new Image;r.onload=Wc(_f,t,r,"TestLoadImage: loaded",!0,e),r.onerror=Wc(_f,t,r,"TestLoadImage: error",!1,e),r.onabort=Wc(_f,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=Wc(_f,t,r,"TestLoadImage: timeout",!1,e),Gt.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else Ci(2);n.G=0,n.j&&n.j.va(e),fI(n),yv(n)}function fI(n){n.G=0,n.I=-1,n.j&&((0!=iI(n.i).length||0!=n.l.length)&&(n.i.i.length=0,Sy(n.l),n.l.length=0),n.j.ua())}function pI(n,e,t){let r=function Vg(n){return n instanceof fu?Do(n):new fu(n,void 0)}(t);if(""!=r.i)e&&hf(r,e+"."+r.i),ff(r,r.m);else{const i=Gt.location;r=function pu(n,e,t,r){var i=new fu(null,void 0);return n&&df(i,n),e&&hf(i,e),t&&ff(i,t),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,t)}return n.aa&&Ry(n.aa,function(i,a){Yn(r,a,i)}),t=n.sa,(e=n.D)&&t&&Yn(r,e,t),Yn(r,"VER",n.ma),ud(n,r),r}function gI(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new kr(t&&n.Ba&&!n.qa?new id({ib:!0}):n.qa)).L=n.H,e}function mI(){}function qg(){if(qc&&!(10<=Number(Dg)))throw Error("Environmental error: no available transport.")}function cs(n,e){si.call(this),this.g=new _v(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.P=n,(n=e&&e.httpHeadersOverwriteParam)&&!vg(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!vg(e)&&(this.g.D=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new ld(this)}function _I(n){kg.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function yI(){rf.call(this),this.status=1}function ld(n){this.g=n}(ht=kr.prototype).ea=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():sf.g(),this.C=function KE(n){return n.h||(n.h=n.i())}(this.u?this.u:sf),this.g.onreadystatechange=Ii(this.Fa,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(a){return void Hg(this,a)}n=t||"";const i=new rd(this.headers);r&&iv(r,function(a,l){i.set(l,a)}),r=function TT(n){e:{var e=VT;const t=n.length,r="string"==typeof n?n.split(""):n;for(let i=0;i<t;i++)if(i in r&&e.call(void 0,r[i],i,n)){e=i;break e}e=-1}return 0>e?null:"string"==typeof n?n.charAt(e):n[e]}(i.T()),t=Gt.FormData&&n instanceof Gt.FormData,!(0<=Ty(FT,e))||r||t||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(a,l){this.g.setRequestHeader(l,a)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{uI(this),0<this.B&&((this.K=function UT(n){return qc&&function Ny(){return function Py(n){var e=BE;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}(function(){let n=0;const e=LE(String(ky)).split("."),t=LE("9").split("."),r=Math.max(e.length,t.length);for(let l=0;0==n&&l<r;l++){var i=e[l]||"",a=t[l]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==i[0].length&&0==a[0].length)break;n=Ay(0==i[1].length?0:parseInt(i[1],10),0==a[1].length?0:parseInt(a[1],10))||Ay(0==i[2].length,0==a[2].length)||Ay(i[2],a[2]),i=i[3],a=a[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ii(this.pa,this)):this.A=vl(this.pa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(a){Hg(this,a)}},ht.pa=function(){typeof Cy<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,gi(this,"timeout"),this.abort(8))},ht.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,gi(this,"complete"),gi(this,"abort"),yf(this))},ht.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),yf(this,!0)),kr.Z.M.call(this)},ht.Fa=function(){this.s||(this.F||this.v||this.l?aI(this):this.cb())},ht.cb=function(){aI(this)},ht.ba=function(){try{return 2<To(this)?this.g.status:-1}catch{return-1}},ht.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}},ht.Qa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),to(e)}},ht.Da=function(){return this.m},ht.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(ht=_v.prototype).ma=8,ht.G=1,ht.hb=function(n){try{this.h.info("Origin Trials invoked: "+n)}catch{}},ht.Ha=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.V=Math.floor(1e5*Math.random()),n=this.V++;const i=new du(this,this.h,n,void 0);let a=this.s;if(this.P&&(a?(a=xy(a),VE(a,this.P)):a=this.P),null===this.o&&(i.H=a),this.ja)e:{for(var e=0,t=0;t<this.l.length;t++){var r=this.l[t];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.l.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=wv(this,i,e),Yn(t=Do(this.F),"RID",n),Yn(t,"CVER",22),this.D&&Yn(t,"X-HTTP-Session-Id",this.D),ud(this,t),this.o&&a&&mv(t,this.o,a),_u(this.i,i),this.Ra&&Yn(t,"TYPE","init"),this.ja?(Yn(t,"$req",e),Yn(t,"SID","null"),i.$=!0,uf(i,t,null)):uf(i,t,e),this.G=2}}else 3==this.G&&(n?vv(this,n):0==this.l.length||nI(this.i)||vv(this))},ht.Ga=function(){if(this.u=null,cI(this),this.$&&!(this.L||null==this.g||0>=this.O)){var n=2*this.O;this.h.info("BP detection timer enabled: "+n),this.B=ed(Ii(this.bb,this),n)}},ht.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Ci(10),ad(this),cI(this))},ht.ab=function(){null!=this.v&&(this.v=null,ad(this),Iv(this),Ci(19))},ht.jb=function(n){n?(this.h.info("Successfully pinged google.com"),Ci(2)):(this.h.info("Failed to ping google.com"),Ci(1))},(ht=mI.prototype).xa=function(){},ht.wa=function(){},ht.va=function(){},ht.ua=function(){},ht.Oa=function(){},qg.prototype.g=function(n,e){return new cs(n,e)},ii(cs,si),cs.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;n.Wa&&(n.h.info("Origin Trials enabled."),ha(Ii(n.hb,n,e))),Ci(0),n.W=e,n.aa=t||{},n.N=n.X,n.F=pI(n,null,n.W),wf(n)},cs.prototype.close=function(){vf(this.g)},cs.prototype.u=function(n){if("string"==typeof n){var e={};e.__data__=n,zg(this.g,e)}else this.v?((e={}).__data__=Rg(n),zg(this.g,e)):zg(this.g,n)},cs.prototype.M=function(){this.g.j=null,delete this.j,vf(this.g),delete this.g,cs.Z.M.call(this)},ii(_I,kg),ii(yI,rf),ii(ld,mI),ld.prototype.xa=function(){gi(this.g,"a")},ld.prototype.wa=function(n){gi(this.g,new _I(n))},ld.prototype.va=function(n){gi(this.g,new yI(n))},ld.prototype.ua=function(){gi(this.g,"b")},qg.prototype.createWebChannel=qg.prototype.g,cs.prototype.send=cs.prototype.u,cs.prototype.open=cs.prototype.m,cs.prototype.close=cs.prototype.close,tf.NO_ERROR=0,tf.TIMEOUT=8,tf.HTTP_ERROR=6,Qy.COMPLETE="complete",Jy.EventType=nf,nf.OPEN="a",nf.CLOSE="b",nf.ERROR="c",nf.MESSAGE="d",si.prototype.listen=si.prototype.N,kr.prototype.listenOnce=kr.prototype.O,kr.prototype.getLastError=kr.prototype.La,kr.prototype.getLastErrorCode=kr.prototype.Da,kr.prototype.getStatus=kr.prototype.ba,kr.prototype.getResponseJson=kr.prototype.Qa,kr.prototype.getResponseText=kr.prototype.ga,kr.prototype.send=kr.prototype.ea;var BT=Xs.createWebChannelTransport=function(){return new qg},jT=Xs.getStatEventTarget=function(){return ef()},Kg=Xs.ErrorCode=tf,vI=Xs.EventType=Qy,wI=Xs.Event=Os,Cv=Xs.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},EI=Xs.FetchXmlHttpFactory=id,Ef=Xs.WebChannel=Jy,II=Xs.XhrIo=kr;const Dv="@firebase/firestore";class Jr{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Jr.UNAUTHENTICATED=new Jr(null),Jr.GOOGLE_CREDENTIALS=new Jr("google-credentials-uid"),Jr.FIRST_PARTY=new Jr("first-party-uid"),Jr.MOCK_USER=new Jr("mock-user");let Dl="9.9.1";const pa=new Qs.Yd("@firebase/firestore");function ga(){return pa.logLevel}function qe(n,...e){if(pa.logLevel<=Qs.in.DEBUG){const t=e.map(If);pa.debug(`Firestore (${Dl}): ${n}`,...t)}}function Qn(n,...e){if(pa.logLevel<=Qs.in.ERROR){const t=e.map(If);pa.error(`Firestore (${Dl}): ${n}`,...t)}}function Zg(n,...e){if(pa.logLevel<=Qs.in.WARN){const t=e.map(If);pa.warn(`Firestore (${Dl}): ${n}`,...t)}}function If(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function mt(n="Unexpected state"){const e=`FIRESTORE (${Dl}) INTERNAL ASSERTION FAILED: `+n;throw Qn(e),new Error(e)}function Lt(n,e){n||mt()}function it(n,e){return n}const ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ge extends N.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class oi{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class CI{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class cd{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Jr.UNAUTHENTICATED))}shutdown(){}}class HT{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Yg{constructor(e){this.t=e,this.currentUser=Jr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let i=this.i;const a=v=>this.i!==i?(i=this.i,t(v)):Promise.resolve();let l=new oi;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new oi,e.enqueueRetryable(()=>a(this.currentUser))};const h=()=>{const v=l;e.enqueueRetryable((0,Ce.Z)(function*(){yield v.promise,yield a(r.currentUser)}))},m=v=>{qe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=v,this.auth.addAuthTokenListener(this.o),h()};this.t.onInit(v=>m(v)),setTimeout(()=>{if(!this.auth){const v=this.t.getImmediate({optional:!0});v?m(v):(qe("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new oi)}},0),h()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(qe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Lt("string"==typeof r.accessToken),new CI(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Lt(null===e||"string"==typeof e),new Jr(e)}}class Qg{constructor(e,t,r){this.type="FirstParty",this.user=Jr.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",t);const i=e.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}}class wr{constructor(e,t,r){this.h=e,this.l=t,this.m=r}getToken(){return Promise.resolve(new Qg(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(Jr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class GT{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class DI{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,t){const r=a=>{null!=a.error&&qe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.p;return this.p=a.token,qe("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>r(a))};const i=a=>{qe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.appCheck.addTokenListener(this.o)};this.g.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.g.getImmediate({optional:!0});a?i(a):qe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Lt("string"==typeof t.token),this.p=t.token,new GT(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function WT(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class Tv{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=WT(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<t&&(r+=e.charAt(i[a]%e.length))}return r}}function Xt(n,e){return n<e?-1:n>e?1:0}function Tl(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function Sv(n){return n+"\0"}class rr{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ge(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ge(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Ge(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ge(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return rr.fromMillis(Date.now())}static fromDate(e){return rr.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new rr(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Xt(this.nanoseconds,e.nanoseconds):Xt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ft{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ft(e)}static min(){return new Ft(new rr(0,0))}static max(){return new Ft(new rr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class bf{constructor(e,t,r){void 0===t?t=0:t>e.length&&mt(),void 0===r?r=e.length-t:r>e.length-t&&mt(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===bf.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof bf?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const a=e.get(i),l=t.get(i);if(a<l)return-1;if(a>l)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class un extends bf{construct(e,t,r){return new un(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Ge(ne.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new un(t)}static emptyPath(){return new un([])}}const qT=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Nr extends bf{construct(e,t,r){return new Nr(e,t,r)}static isValidIdentifier(e){return qT.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Nr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Nr(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const a=()=>{if(0===r.length)throw new Ge(ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let l=!1;for(;i<e.length;){const h=e[i];if("\\"===h){if(i+1===e.length)throw new Ge(ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[i+1];if("\\"!==m&&"."!==m&&"`"!==m)throw new Ge(ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=m,i+=2}else"`"===h?(l=!l,i++):"."!==h||l?(r+=h,i++):(a(),i++)}if(a(),l)throw new Ge(ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Nr(t)}static emptyPath(){return new Nr([])}}class tt{constructor(e){this.path=e}static fromPath(e){return new tt(un.fromString(e))}static fromName(e){return new tt(un.fromString(e).popFirst(5))}static empty(){return new tt(un.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===un.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return un.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new tt(new un(e.slice()))}}class Sl{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function Xg(n){return n.fields.find(e=>2===e.kind)}function yu(n){return n.fields.filter(e=>2!==e.kind)}Sl.UNKNOWN_ID=-1;class Cf{constructor(e,t){this.fieldPath=e,this.kind=t}}class Df{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Df(0,ds.min())}}function dd(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Ft.fromTimestamp(1e9===r?new rr(t+1,0):new rr(t,r));return new ds(i,tt.empty(),e)}function hd(n){return new ds(n.readTime,n.key,-1)}class ds{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ds(Ft.min(),tt.empty(),-1)}static max(){return new ds(Ft.max(),tt.empty(),-1)}}function Av(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=tt.comparator(n.documentKey,e.documentKey),0!==t?t:Xt(n.largestBatchId,e.largestBatchId))}const TI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Rv{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function ma(n){return Jg.apply(this,arguments)}function Jg(){return Jg=(0,Ce.Z)(function*(n){if(n.code!==ne.FAILED_PRECONDITION||n.message!==TI)throw n;qe("LocalStore","Unexpectedly lost primary lease")}),Jg.apply(this,arguments)}class ge{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&mt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ge((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ge?t:ge.resolve(t)}catch(t){return ge.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ge.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ge.reject(t)}static resolve(e){return new ge((t,r)=>{t(e)})}static reject(e){return new ge((t,r)=>{r(e)})}static waitFor(e){return new ge((t,r)=>{let i=0,a=0,l=!1;e.forEach(h=>{++i,h.next(()=>{++a,l&&a===i&&t()},m=>r(m))}),l=!0,a===i&&t()})}static or(e){let t=ge.resolve(!1);for(const r of e)t=t.next(i=>i?ge.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,a)=>{r.push(t.call(this,i,a))}),this.waitFor(r)}static mapArray(e,t){return new ge((r,i)=>{const a=e.length,l=new Array(a);let h=0;for(let m=0;m<a;m++){const v=m;t(e[v]).next(C=>{l[v]=C,++h,h===a&&r(l)},C=>i(C))}})}static doWhile(e,t){return new ge((r,i)=>{const a=()=>{!0===e()?t().next(()=>{a()},i):r()};a()})}}class Tf{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.T=new oi,this.transaction.oncomplete=()=>{this.T.resolve()},this.transaction.onabort=()=>{t.error?this.T.reject(new em(e,t.error)):this.T.resolve()},this.transaction.onerror=r=>{const i=SI(r.target.error);this.T.reject(new em(e,i))}}static open(e,t,r,i){try{return new Tf(t,e.transaction(i,r))}catch(a){throw new em(t,a)}}get A(){return this.T.promise}abort(e){e&&this.T.reject(e),this.aborted||(qe("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}R(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new mM(t)}}class no{constructor(e,t,r){this.name=e,this.version=t,this.P=r,12.2===no.v((0,N.z$)())&&Qn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return qe("SimpleDb","Removing database:",e),fd(window.indexedDB.deleteDatabase(e)).toPromise()}static V(){if(!(0,N.hl)())return!1;if(no.S())return!0;const e=(0,N.z$)(),t=no.v(e),r=0<t&&t<10,i=no.D(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static S(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.C)}static N(e,t){return e.store(t)}static v(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static D(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}k(e){var t=this;return(0,Ce.Z)(function*(){return t.db||(qe("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,i)=>{const a=indexedDB.open(t.name,t.version);a.onsuccess=l=>{r(l.target.result)},a.onblocked=()=>{i(new em(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=l=>{const h=l.target.error;i("VersionError"===h.name?new Ge(ne.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===h.name?new Ge(ne.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+h):new em(e,h))},a.onupgradeneeded=l=>{qe("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',l.oldVersion),t.P.O(l.target.result,a.transaction,l.oldVersion,t.version).next(()=>{qe("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.M&&(t.db.onversionchange=r=>t.M(r)),t.db})()}F(e){this.M=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){var a=this;return(0,Ce.Z)(function*(){const l="readonly"===t;let h=0;for(;;){++h;try{a.db=yield a.k(e);const m=Tf.open(a.db,e,l?"readonly":"readwrite",r),v=i(m).next(C=>(m.R(),C)).catch(C=>(m.abort(C),ge.reject(C))).toPromise();return v.catch(()=>{}),yield m.A,v}catch(m){const v=m,C="FirebaseError"!==v.name&&h<3;if(qe("SimpleDb","Transaction failed with error:",v.message,"Retrying:",C),a.close(),!C)return Promise.reject(v)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class KT{constructor(e){this.$=e,this.B=!1,this.L=null}get isDone(){return this.B}get U(){return this.L}set cursor(e){this.$=e}done(){this.B=!0}q(e){this.L=e}delete(){return fd(this.$.delete())}}class em extends Ge{constructor(e,t){super(ne.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Al(n){return"IndexedDbTransactionError"===n.name}class mM{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(qe("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(qe("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),fd(r)}add(e){return qe("SimpleDb","ADD",this.store.name,e,e),fd(this.store.add(e))}get(e){return fd(this.store.get(e)).next(t=>(void 0===t&&(t=null),qe("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return qe("SimpleDb","DELETE",this.store.name,e),fd(this.store.delete(e))}count(){return qe("SimpleDb","COUNT",this.store.name),fd(this.store.count())}K(e,t){const r=this.options(e,t);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),a=[];return this.G(i,(l,h)=>{a.push(h)}).next(()=>a)}{const i=this.store.getAll(r.range);return new ge((a,l)=>{i.onerror=h=>{l(h.target.error)},i.onsuccess=h=>{a(h.target.result)}})}}j(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new ge((i,a)=>{r.onerror=l=>{a(l.target.error)},r.onsuccess=l=>{i(l.target.result)}})}W(e,t){qe("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const i=this.cursor(r);return this.G(i,(a,l,h)=>h.delete())}J(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.G(i,t)}Y(e){const t=this.cursor({});return new ge((r,i)=>{t.onerror=a=>{const l=SI(a.target.error);i(l)},t.onsuccess=a=>{const l=a.target.result;l?e(l.primaryKey,l.value).next(h=>{h?l.continue():r()}):r()}})}G(e,t){const r=[];return new ge((i,a)=>{e.onerror=l=>{a(l.target.error)},e.onsuccess=l=>{const h=l.target.result;if(!h)return void i();const m=new KT(h),v=t(h.primaryKey,h.value,m);if(v instanceof ge){const C=v.catch(T=>(m.done(),ge.reject(T)));r.push(C)}m.isDone?i():null===m.U?h.continue():h.continue(m.U)}}).next(()=>ge.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function fd(n){return new ge((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const i=SI(r.target.error);t(i)}})}let ZT=!1;function SI(n){const e=no.v((0,N.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Ge("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return ZT||(ZT=!0,setTimeout(()=>{throw r},0)),r}}return n}class AI{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}Z(e){var t=this;qe("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,Ce.Z)(function*(){t.task=null;try{qe("IndexBackiller",`Documents written: ${yield t.X.tt()}`)}catch(r){Al(r)?qe("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield ma(r)}yield t.Z(1)}))}}class tm{constructor(e,t){this.localStore=e,this.persistence=t}tt(e=50){var t=this;return(0,Ce.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>t.et(r,e))})()}et(e,t){const r=new Set;let i=t,a=!0;return ge.doWhile(()=>!0===a&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(l=>{if(null!==l&&!r.has(l))return qe("IndexBackiller",`Processing collection: ${l}`),this.nt(e,l,i).next(h=>{i-=h,r.add(l)});a=!1})).next(()=>t-i)}nt(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next(()=>this.st(i,a)).next(h=>(qe("IndexBackiller",`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h))).next(()=>l.size)}))}st(e,t){let r=e;return t.changes.forEach((i,a)=>{const l=hd(a);Av(l,r)>0&&(r=l)}),new ds(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class qi{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.it(r),this.rt=r=>t.writeSequenceNumber(r))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}function RI(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function vu(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function pd(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}qi.ot=-1;class Er{constructor(e,t){this.comparator=e,this.root=t||_i.EMPTY}insert(e,t){return new Er(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,_i.BLACK,null,null))}remove(e){return new Er(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_i.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new nm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new nm(this.root,e,this.comparator,!1)}getReverseIterator(){return new nm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new nm(this.root,e,this.comparator,!0)}}class nm{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _i{constructor(e,t,r,i,a){this.key=e,this.value=t,this.color=r??_i.RED,this.left=i??_i.EMPTY,this.right=a??_i.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,a){return new _i(e??this.key,t??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===a?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return _i.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return _i.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_i.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_i.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw mt();const e=this.left.check();if(e!==this.right.check())throw mt();return e+(this.isRed()?0:1)}}_i.EMPTY=null,_i.RED=!0,_i.BLACK=!1,_i.EMPTY=new class{constructor(){this.size=0}get key(){throw mt()}get value(){throw mt()}get color(){throw mt()}get left(){throw mt()}get right(){throw mt()}copy(n,e,t,r,i){return this}insert(n,e,t){return new _i(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Un{constructor(e){this.comparator=e,this.data=new Er(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new xI(this.data.getIterator())}getIteratorFrom(e){return new xI(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Un)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Un(this.comparator);return t.data=e,t}}class xI{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Rl(n){return n.hasNext()?n.getNext():void 0}class hs{constructor(e){this.fields=e,e.sort(Nr.comparator)}static empty(){return new hs([])}unionWith(e){let t=new Un(Nr.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new hs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Tl(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class cr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new cr(t)}static fromUint8Array(e){const t=function(r){let i="";for(let a=0;a<r.length;++a)i+=String.fromCharCode(r[a]);return i}(e);return new cr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Xt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}cr.EMPTY_BYTE_STRING=new cr("");const QT=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _a(n){if(Lt(!!n),"string"==typeof n){let e=0;const t=QT.exec(n);if(Lt(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ir(n.seconds),nanos:Ir(n.nanos)}}function Ir(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function wu(n){return"string"==typeof n?cr.fromBase64String(n):cr.fromUint8Array(n)}function xv(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Mv(n){const e=n.mapValue.fields.__previous_value__;return xv(e)?Mv(e):e}function Sf(n){const e=_a(n.mapValue.fields.__local_write_time__.timestampValue);return new rr(e.seconds,e.nanos)}class Pv{constructor(e,t,r,i,a,l,h,m){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=h,this.useFetchStreams=m}}class ya{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new ya("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof ya&&e.projectId===this.projectId&&e.database===this.database}}function gd(n){return null==n}function md(n){return 0===n&&1/n==-1/0}function MI(n){return"number"==typeof n&&Number.isInteger(n)&&!md(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Eu={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},rm={nullValue:"NULL_VALUE"};function va(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?xv(n)?4:NI(n)?9007199254740991:10:mt()}function So(n,e){if(n===e)return!0;const t=va(n);if(t!==va(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Sf(n).isEqual(Sf(e));case 3:return function(r,i){if("string"==typeof r.timestampValue&&"string"==typeof i.timestampValue&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const a=_a(r.timestampValue),l=_a(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return i=e,wu(n.bytesValue).isEqual(wu(i.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return Ir(r.geoPointValue.latitude)===Ir(i.geoPointValue.latitude)&&Ir(r.geoPointValue.longitude)===Ir(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return Ir(r.integerValue)===Ir(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const a=Ir(r.doubleValue),l=Ir(i.doubleValue);return a===l?md(a)===md(l):isNaN(a)&&isNaN(l)}return!1}(n,e);case 9:return Tl(n.arrayValue.values||[],e.arrayValue.values||[],So);case 10:return function(r,i){const a=r.mapValue.fields||{},l=i.mapValue.fields||{};if(RI(a)!==RI(l))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(void 0===l[h]||!So(a[h],l[h])))return!1;return!0}(n,e);default:return mt()}var i}function _d(n,e){return void 0!==(n.values||[]).find(t=>So(t,e))}function Iu(n,e){if(n===e)return 0;const t=va(n),r=va(e);if(t!==r)return Xt(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Xt(n.booleanValue,e.booleanValue);case 2:return function(i,a){const l=Ir(i.integerValue||i.doubleValue),h=Ir(a.integerValue||a.doubleValue);return l<h?-1:l>h?1:l===h?0:isNaN(l)?isNaN(h)?0:-1:1}(n,e);case 3:return PI(n.timestampValue,e.timestampValue);case 4:return PI(Sf(n),Sf(e));case 5:return Xt(n.stringValue,e.stringValue);case 6:return function(i,a){const l=wu(i),h=wu(a);return l.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),h=a.split("/");for(let m=0;m<l.length&&m<h.length;m++){const v=Xt(l[m],h[m]);if(0!==v)return v}return Xt(l.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,a){const l=Xt(Ir(i.latitude),Ir(a.latitude));return 0!==l?l:Xt(Ir(i.longitude),Ir(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(i,a){const l=i.values||[],h=a.values||[];for(let m=0;m<l.length&&m<h.length;++m){const v=Iu(l[m],h[m]);if(v)return v}return Xt(l.length,h.length)}(n.arrayValue,e.arrayValue);case 10:return function(i,a){if(i===Eu.mapValue&&a===Eu.mapValue)return 0;if(i===Eu.mapValue)return 1;if(a===Eu.mapValue)return-1;const l=i.fields||{},h=Object.keys(l),m=a.fields||{},v=Object.keys(m);h.sort(),v.sort();for(let C=0;C<h.length&&C<v.length;++C){const T=Xt(h[C],v[C]);if(0!==T)return T;const x=Iu(l[h[C]],m[v[C]]);if(0!==x)return x}return Xt(h.length,v.length)}(n.mapValue,e.mapValue);default:throw mt()}}function PI(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return Xt(n,e);const t=_a(n),r=_a(e),i=Xt(t.seconds,r.seconds);return 0!==i?i:Xt(t.nanos,r.nanos)}function yd(n){return kv(n)}function kv(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const i=_a(r);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?wu(n.bytesValue).toBase64():"referenceValue"in n?tt.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let i="[",a=!0;for(const l of r.values||[])a?a=!1:i+=",",i+=kv(l);return i+"]"}(n.arrayValue):"mapValue"in n?function(r){const i=Object.keys(r.fields||{}).sort();let a="{",l=!0;for(const h of i)l?l=!1:a+=",",a+=`${h}:${kv(r.fields[h])}`;return a+"}"}(n.mapValue):mt();var e}function xl(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Nv(n){return!!n&&"integerValue"in n}function Af(n){return!!n&&"arrayValue"in n}function kI(n){return!!n&&"nullValue"in n}function Ov(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Rf(n){return!!n&&"mapValue"in n}function xf(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return vu(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=xf(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=xf(n.arrayValue.values[t]);return e}return Object.assign({},n)}function NI(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function OI(n){return"nullValue"in n?rm:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?xl(ya.empty(),tt.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:mt()}function XT(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?xl(ya.empty(),tt.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Eu:mt()}function LI(n,e){const t=Iu(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function FI(n,e){const t=Iu(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class ei{constructor(e){this.value=e}static empty(){return new ei({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Rf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=xf(t)}setAll(e){let t=Nr.emptyPath(),r={},i=[];e.forEach((l,h)=>{if(!t.isImmediateParentOf(h)){const m=this.getFieldsMap(t);this.applyChanges(m,r,i),r={},i=[],t=h.popLast()}l?r[h.lastSegment()]=xf(l):i.push(h.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,r,i)}delete(e){const t=this.field(e.popLast());Rf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return So(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Rf(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){vu(t,(i,a)=>e[i]=a);for(const i of r)delete e[i]}clone(){return new ei(xf(this.value))}}function im(n){const e=[];return vu(n.fields,(t,r)=>{const i=new Nr([t]);if(Rf(r)){const a=im(r.mapValue).fields;if(0===a.length)e.push(i);else for(const l of a)e.push(i.child(l))}else e.push(i)}),new hs(e)}class $n{constructor(e,t,r,i,a,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new $n(e,0,Ft.min(),Ft.min(),ei.empty(),0)}static newFoundDocument(e,t,r){return new $n(e,1,t,Ft.min(),r,0)}static newNoDocument(e,t){return new $n(e,2,t,Ft.min(),ei.empty(),0)}static newUnknownDocument(e,t){return new $n(e,3,t,Ft.min(),ei.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ei.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ei.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ft.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof $n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new $n(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Lv{constructor(e,t=null,r=[],i=[],a=null,l=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=l,this.endAt=h,this.ut=null}}function UI(n,e=null,t=[],r=[],i=null,a=null,l=null){return new Lv(n,e,t,r,i,a,l)}function Ml(n){const e=it(n);if(null===e.ut){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>{return(i=r).field.canonicalString()+i.op.toString()+yd(i.value);var i}).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(i=r).field.canonicalString()+i.dir;var i}).join(","),gd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>yd(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>yd(r)).join(",")),e.ut=t}return e.ut}function Mf(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let i=0;i<n.orderBy.length;i++)if(!HI(n.orderBy[i],e.orderBy[i]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let i=0;i<n.filters.length;i++)if((t=n.filters[i]).op!==(r=e.filters[i]).op||!t.field.isEqual(r.field)||!So(t.value,r.value))return!1;var t,r;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!zI(n.startAt,e.startAt)&&zI(n.endAt,e.endAt)}function sm(n){return tt.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function wa(n,e){return n.filters.filter(t=>t instanceof Di&&t.field.isEqual(e))}function Uv(n,e,t){let r=rm,i=!0;for(const a of wa(n,e)){let l=rm,h=!0;switch(a.op){case"<":case"<=":l=OI(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,h=!1;break;case"!=":case"not-in":l=rm}LI({value:r,inclusive:i},{value:l,inclusive:h})<0&&(r=l,i=h)}if(null!==t)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];LI({value:r,inclusive:i},{value:l,inclusive:t.inclusive})<0&&(r=l,i=t.inclusive);break}return{value:r,inclusive:i}}function VI(n,e,t){let r=Eu,i=!0;for(const a of wa(n,e)){let l=Eu,h=!0;switch(a.op){case">=":case">":l=XT(a.value),h=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,h=!1;break;case"!=":case"not-in":l=Eu}FI({value:r,inclusive:i},{value:l,inclusive:h})>0&&(r=l,i=h)}if(null!==t)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];FI({value:r,inclusive:i},{value:l,inclusive:t.inclusive})>0&&(r=l,i=t.inclusive);break}return{value:r,inclusive:i}}class Di extends class{}{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.ct(e,t,r):new BI(e,t,r):"array-contains"===t?new eS(e,r):"in"===t?new jI(e,r):"not-in"===t?new Bv(e,r):"array-contains-any"===t?new $I(e,r):new Di(e,t,r)}static ct(e,t,r){return"in"===t?new Vv(e,r):new JT(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.at(Iu(t,this.value)):null!==t&&va(this.value)===va(t)&&this.at(Iu(t,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return mt()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class BI extends Di{constructor(e,t,r){super(e,t,r),this.key=tt.fromName(r.referenceValue)}matches(e){const t=tt.comparator(e.key,this.key);return this.at(t)}}class Vv extends Di{constructor(e,t){super(e,"in",t),this.keys=om(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class JT extends Di{constructor(e,t){super(e,"not-in",t),this.keys=om(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function om(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>tt.fromName(r.referenceValue))}class eS extends Di{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Af(t)&&_d(t.arrayValue,this.value)}}class jI extends Di{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&_d(this.value.arrayValue,t)}}class Bv extends Di{constructor(e,t){super(e,"not-in",t)}matches(e){if(_d(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!_d(this.value.arrayValue,t)}}class $I extends Di{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Af(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>_d(this.value.arrayValue,r))}}class Ea{constructor(e,t){this.position=e,this.inclusive=t}}class Pl{constructor(e,t="asc"){this.field=e,this.dir=t}}function HI(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}function GI(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const a=e[i],l=n.position[i];if(r=a.field.isKeyField()?tt.comparator(tt.fromName(l.referenceValue),t.key):Iu(l,t.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function zI(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!So(n.position[t],e.position[t]))return!1;return!0}class Ia{constructor(e,t=null,r=[],i=[],a=null,l="F",h=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=l,this.startAt=h,this.endAt=m,this.lt=null,this.ft=null}}function WI(n,e,t,r,i,a,l,h){return new Ia(n,e,t,r,i,a,l,h)}function kl(n){return new Ia(n)}function am(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function jv(n){for(const e of n.filters)if(e.ht())return e.field;return null}function $v(n){return null!==n.collectionGroup}function Pf(n){const e=it(n);if(null===e.lt){e.lt=[];const t=jv(e),r=am(e);if(null!==t&&null===r)t.isKeyField()||e.lt.push(new Pl(t)),e.lt.push(new Pl(Nr.keyField(),"asc"));else{let i=!1;for(const a of e.explicitOrderBy)e.lt.push(a),a.field.isKeyField()&&(i=!0);if(!i){const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.lt.push(new Pl(Nr.keyField(),a))}}}return e.lt}function Ls(n){const e=it(n);if(!e.ft)if("F"===e.limitType)e.ft=UI(e.path,e.collectionGroup,Pf(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const a of Pf(e))t.push(new Pl(a.field,"desc"===a.dir?"asc":"desc"));const r=e.endAt?new Ea(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new Ea(e.startAt.position,e.startAt.inclusive):null;e.ft=UI(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}return e.ft}function qI(n,e,t){return new Ia(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function kf(n,e){return Mf(Ls(n),Ls(e))&&n.limitType===e.limitType}function KI(n){return`${Ml(Ls(n))}|lt:${n.limitType}`}function Hv(n){return`Query(target=${function Fv(n){let e=n.path.canonicalString();return null!==n.collectionGroup&&(e+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(e+=`, filters: [${n.filters.map(t=>{return`${(r=t).field.canonicalString()} ${r.op} ${yd(r.value)}`;var r}).join(", ")}]`),gd(n.limit)||(e+=", limit: "+n.limit),n.orderBy.length>0&&(e+=`, orderBy: [${n.orderBy.map(t=>{return`${(r=t).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),n.startAt&&(e+=", startAt: ",e+=n.startAt.inclusive?"b:":"a:",e+=n.startAt.position.map(t=>yd(t)).join(",")),n.endAt&&(e+=", endAt: ",e+=n.endAt.inclusive?"a:":"b:",e+=n.endAt.position.map(t=>yd(t)).join(",")),`Target(${e})`}(Ls(n))}; limitType=${n.limitType})`}function Gv(n,e){return e.isFoundDocument()&&function(t,r){const i=r.key.path;return null!==t.collectionGroup?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):tt.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(n,e)&&function(t,r){for(const i of t.explicitOrderBy)if(!i.field.isKeyField()&&null===r.data.field(i.field))return!1;return!0}(n,e)&&function(t,r){for(const i of t.filters)if(!i.matches(r))return!1;return!0}(n,e)&&(r=e,!((t=n).startAt&&!function(i,a,l){const h=GI(i,a,l);return i.inclusive?h<=0:h<0}(t.startAt,Pf(t),r)||t.endAt&&!function(i,a,l){const h=GI(i,a,l);return i.inclusive?h>=0:h>0}(t.endAt,Pf(t),r)));var t,r}function ZI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function YI(n){return(e,t)=>{let r=!1;for(const i of Pf(n)){const a=tS(i,e,t);if(0!==a)return a;r=r||i.field.isKeyField()}return 0}}function tS(n,e,t){const r=n.field.isKeyField()?tt.comparator(e.key,t.key):function(i,a,l){const h=a.data.field(i),m=l.data.field(i);return null!==h&&null!==m?Iu(h,m):mt()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return mt()}}function QI(n,e){if(n.dt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:md(e)?"-0":e}}function XI(n){return{integerValue:""+n}}function JI(n,e){return MI(e)?XI(e):QI(n,e)}class bu{constructor(){this._=void 0}}function eb(n,e,t){return n instanceof Nl?function(r,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&(a.fields.__previous_value__=i),{mapValue:a}}(t,e):n instanceof Cu?nb(n,e):n instanceof Ol?nS(n,e):function(r,i){const a=zv(r,i),l=rb(a)+rb(r._t);return Nv(a)&&Nv(r._t)?XI(l):QI(r.wt,l)}(n,e)}function tb(n,e,t){return n instanceof Cu?nb(n,e):n instanceof Ol?nS(n,e):t}function zv(n,e){return n instanceof vd?Nv(t=e)||(r=t)&&"doubleValue"in r?e:{integerValue:0}:null;var r,t}class Nl extends bu{}class Cu extends bu{constructor(e){super(),this.elements=e}}function nb(n,e){const t=ib(e);for(const r of n.elements)t.some(i=>So(i,r))||t.push(r);return{arrayValue:{values:t}}}class Ol extends bu{constructor(e){super(),this.elements=e}}function nS(n,e){let t=ib(e);for(const r of n.elements)t=t.filter(i=>!So(i,r));return{arrayValue:{values:t}}}class vd extends bu{constructor(e,t){super(),this.wt=e,this._t=t}}function rb(n){return Ir(n.integerValue||n.doubleValue)}function ib(n){return Af(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Nf{constructor(e,t){this.field=e,this.transform=t}}class Of{constructor(e,t){this.version=e,this.transformResults=t}}class dr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new dr}static exists(e){return new dr(void 0,e)}static updateTime(e){return new dr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function wd(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class fs{}function sb(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new Ll(n.key,dr.none()):new Ed(n.key,n.data,dr.none());{const t=n.data,r=ei.empty();let i=new Un(Nr.comparator);for(let a of e.fields)if(!i.has(a)){let l=t.field(a);null===l&&a.length>1&&(a=a.popLast(),l=t.field(a)),null===l?r.delete(a):r.set(a,l),i=i.add(a)}return new Fs(n.key,r,new hs(i.toArray()),dr.none())}}function Wv(n,e,t){n instanceof Ed?function(r,i,a){const l=r.value.clone(),h=ab(r.fieldTransforms,i,a.transformResults);l.setAll(h),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):n instanceof Fs?function(r,i,a){if(!wd(r.precondition,i))return void i.convertToUnknownDocument(a.version);const l=ab(r.fieldTransforms,i,a.transformResults),h=i.data;h.setAll(Lf(r)),h.setAll(l),i.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function ba(n,e,t,r){return n instanceof Ed?function(i,a,l,h){if(!wd(i.precondition,a))return l;const m=i.value.clone(),v=ub(i.fieldTransforms,h,a);return m.setAll(v),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),null}(n,e,t,r):n instanceof Fs?function(i,a,l,h){if(!wd(i.precondition,a))return l;const m=ub(i.fieldTransforms,h,a),v=a.data;return v.setAll(Lf(i)),v.setAll(m),a.convertToFoundDocument(a.version,v).setHasLocalMutations(),null===l?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(C=>C.field))}(n,e,t,r):(l=t,wd(n.precondition,a=e)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l);var a,l}function iS(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),a=zv(r.transform,i||null);null!=a&&(null===t&&(t=ei.empty()),t.set(r.field,a))}return t||null}function ob(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(r=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===r||t&&r&&Tl(t,r,(i,a)=>function rS(n,e){return n.field.isEqual(e.field)&&(r=e.transform,(t=n.transform)instanceof Cu&&r instanceof Cu||t instanceof Ol&&r instanceof Ol?Tl(t.elements,r.elements,So):t instanceof vd&&r instanceof vd?So(t._t,r._t):t instanceof Nl&&r instanceof Nl);var t,r}(i,a))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,r}class Ed extends fs{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Fs extends fs{constructor(e,t,r,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Lf(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function ab(n,e,t){const r=new Map;Lt(n.length===t.length);for(let i=0;i<t.length;i++){const a=n[i],l=a.transform,h=e.data.field(a.field);r.set(a.field,tb(l,h,t[i]))}return r}function ub(n,e,t){const r=new Map;for(const i of n){const a=i.transform,l=t.data.field(i.field);r.set(i.field,eb(a,l,e))}return r}class Ll extends fs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class um extends fs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class qv{constructor(e){this.count=e}}var Or,mn;function lm(n){switch(n){default:return mt();case ne.CANCELLED:case ne.UNKNOWN:case ne.DEADLINE_EXCEEDED:case ne.RESOURCE_EXHAUSTED:case ne.INTERNAL:case ne.UNAVAILABLE:case ne.UNAUTHENTICATED:return!1;case ne.INVALID_ARGUMENT:case ne.NOT_FOUND:case ne.ALREADY_EXISTS:case ne.PERMISSION_DENIED:case ne.FAILED_PRECONDITION:case ne.ABORTED:case ne.OUT_OF_RANGE:case ne.UNIMPLEMENTED:case ne.DATA_LOSS:return!0}}function Kv(n){if(void 0===n)return Qn("GRPC error has no .code"),ne.UNKNOWN;switch(n){case Or.OK:return ne.OK;case Or.CANCELLED:return ne.CANCELLED;case Or.UNKNOWN:return ne.UNKNOWN;case Or.DEADLINE_EXCEEDED:return ne.DEADLINE_EXCEEDED;case Or.RESOURCE_EXHAUSTED:return ne.RESOURCE_EXHAUSTED;case Or.INTERNAL:return ne.INTERNAL;case Or.UNAVAILABLE:return ne.UNAVAILABLE;case Or.UNAUTHENTICATED:return ne.UNAUTHENTICATED;case Or.INVALID_ARGUMENT:return ne.INVALID_ARGUMENT;case Or.NOT_FOUND:return ne.NOT_FOUND;case Or.ALREADY_EXISTS:return ne.ALREADY_EXISTS;case Or.PERMISSION_DENIED:return ne.PERMISSION_DENIED;case Or.FAILED_PRECONDITION:return ne.FAILED_PRECONDITION;case Or.ABORTED:return ne.ABORTED;case Or.OUT_OF_RANGE:return ne.OUT_OF_RANGE;case Or.UNIMPLEMENTED:return ne.UNIMPLEMENTED;case Or.DATA_LOSS:return ne.DATA_LOSS;default:return mt()}}(mn=Or||(Or={}))[mn.OK=0]="OK",mn[mn.CANCELLED=1]="CANCELLED",mn[mn.UNKNOWN=2]="UNKNOWN",mn[mn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",mn[mn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",mn[mn.NOT_FOUND=5]="NOT_FOUND",mn[mn.ALREADY_EXISTS=6]="ALREADY_EXISTS",mn[mn.PERMISSION_DENIED=7]="PERMISSION_DENIED",mn[mn.UNAUTHENTICATED=16]="UNAUTHENTICATED",mn[mn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",mn[mn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",mn[mn.ABORTED=10]="ABORTED",mn[mn.OUT_OF_RANGE=11]="OUT_OF_RANGE",mn[mn.UNIMPLEMENTED=12]="UNIMPLEMENTED",mn[mn.INTERNAL=13]="INTERNAL",mn[mn.UNAVAILABLE=14]="UNAVAILABLE",mn[mn.DATA_LOSS=15]="DATA_LOSS";class Ao{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[i,a]of r)if(this.equalsFn(i,e))return a}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){vu(this.inner,(t,r)=>{for(const[i,a]of r)e(i,a)})}isEmpty(){return pd(this.inner)}size(){return this.innerSize}}const Zv=new Er(tt.comparator);function Ki(){return Zv}const lb=new Er(tt.comparator);function Ff(...n){let e=lb;for(const t of n)e=e.insert(t.key,t);return e}function cb(n){let e=lb;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function ro(){return Id()}function cm(){return Id()}function Id(){return new Ao(n=>n.toString(),(n,e)=>n.isEqual(e))}const db=new Er(tt.comparator),hb=new Un(tt.comparator);function Jt(...n){let e=hb;for(const t of n)e=e.add(t);return e}const sS=new Un(Xt);function Uf(){return sS}class bd{constructor(e,t,r,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t){const r=new Map;return r.set(e,Vf.createSynthesizedTargetChangeForCurrentChange(e,t)),new bd(Ft.min(),r,Uf(),Ki(),Jt())}}class Vf{constructor(e,t,r,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t){return new Vf(cr.EMPTY_BYTE_STRING,t,Jt(),Jt(),Jt())}}class Bf{constructor(e,t,r,i){this.gt=e,this.removedTargetIds=t,this.key=r,this.yt=i}}class fb{constructor(e,t){this.targetId=e,this.It=t}}class Ti{constructor(e,t,r=cr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class Fl{constructor(){this.Tt=0,this.Et=aS(),this.At=cr.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return 0!==this.Tt}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=Jt(),t=Jt(),r=Jt();return this.Et.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:mt()}}),new Vf(this.At,this.Rt,e,t,r)}Dt(){this.bt=!1,this.Et=aS()}Ct(e,t){this.bt=!0,this.Et=this.Et.insert(e,t)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Ot(){this.bt=!0,this.Rt=!0}}class oS{constructor(e){this.Mt=e,this.Ft=new Map,this.$t=Ki(),this.Bt=pb(),this.Lt=new Un(Xt)}Ut(e){for(const t of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(t,e.yt):this.Kt(t,e.key,e.yt);for(const t of e.removedTargetIds)this.Kt(t,e.key,e.yt)}Gt(e){this.forEachTarget(e,t=>{const r=this.Qt(t);switch(e.state){case 0:this.jt(t)&&r.Vt(e.resumeToken);break;case 1:r.kt(),r.Pt||r.Dt(),r.Vt(e.resumeToken);break;case 2:r.kt(),r.Pt||this.removeTarget(t);break;case 3:this.jt(t)&&(r.Ot(),r.Vt(e.resumeToken));break;case 4:this.jt(t)&&(this.Wt(t),r.Vt(e.resumeToken));break;default:mt()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ft.forEach((r,i)=>{this.jt(i)&&t(i)})}zt(e){const t=e.targetId,r=e.It.count,i=this.Ht(t);if(i){const a=i.target;if(sm(a))if(0===r){const l=new tt(a.path);this.Kt(t,l,$n.newNoDocument(l,Ft.min()))}else Lt(1===r);else this.Jt(t)!==r&&(this.Wt(t),this.Lt=this.Lt.add(t))}}Yt(e){const t=new Map;this.Ft.forEach((a,l)=>{const h=this.Ht(l);if(h){if(a.current&&sm(h.target)){const m=new tt(h.target.path);null!==this.$t.get(m)||this.Xt(l,m)||this.Kt(l,m,$n.newNoDocument(m,e))}a.vt&&(t.set(l,a.St()),a.Dt())}});let r=Jt();this.Bt.forEach((a,l)=>{let h=!0;l.forEachWhile(m=>{const v=this.Ht(m);return!v||2===v.purpose||(h=!1,!1)}),h&&(r=r.add(a))}),this.$t.forEach((a,l)=>l.setReadTime(e));const i=new bd(e,t,this.Lt,this.$t,r);return this.$t=Ki(),this.Bt=pb(),this.Lt=new Un(Xt),i}qt(e,t){if(!this.jt(e))return;const r=this.Xt(e,t.key)?2:0;this.Qt(e).Ct(t.key,r),this.$t=this.$t.insert(t.key,t),this.Bt=this.Bt.insert(t.key,this.Zt(t.key).add(e))}Kt(e,t,r){if(!this.jt(e))return;const i=this.Qt(e);this.Xt(e,t)?i.Ct(t,1):i.xt(t),this.Bt=this.Bt.insert(t,this.Zt(t).delete(e)),r&&(this.$t=this.$t.insert(t,r))}removeTarget(e){this.Ft.delete(e)}Jt(e){const t=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let t=this.Ft.get(e);return t||(t=new Fl,this.Ft.set(e,t)),t}Zt(e){let t=this.Bt.get(e);return t||(t=new Un(Xt),this.Bt=this.Bt.insert(e,t)),t}jt(e){const t=null!==this.Ht(e);return t||qe("WatchChangeAggregator","Detected inactive target",e),t}Ht(e){const t=this.Ft.get(e);return t&&t.Pt?null:this.Mt.te(e)}Wt(e){this.Ft.set(e,new Fl),this.Mt.getRemoteKeysForTarget(e).forEach(t=>{this.Kt(e,t,null)})}Xt(e,t){return this.Mt.getRemoteKeysForTarget(e).has(t)}}function pb(){return new Er(tt.comparator)}function aS(){return new Er(tt.comparator)}const yM={asc:"ASCENDING",desc:"DESCENDING"},gb={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class mb{constructor(e,t){this.databaseId=e,this.dt=t}}function Ca(n,e){return n.dt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function _b(n,e){return n.dt?e.toBase64():e.toUint8Array()}function Yv(n,e){return Ca(n,e.toTimestamp())}function ai(n){return Lt(!!n),Ft.fromTimestamp(function(e){const t=_a(e);return new rr(t.seconds,t.nanos)}(n))}function dm(n,e){return(t=n,new un(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function yb(n){const e=un.fromString(n);return Lt(Jv(e)),e}function jf(n,e){return dm(n.databaseId,e.path)}function Ro(n,e){const t=yb(e);if(t.get(1)!==n.databaseId.projectId)throw new Ge(ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ge(ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new tt(Hf(t))}function $f(n,e){return dm(n.databaseId,e)}function Qv(n){const e=yb(n);return 4===e.length?un.emptyPath():Hf(e)}function Cd(n){return new un(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Hf(n){return Lt(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function hm(n,e,t){return{name:jf(n,e),fields:t.value.mapValue.fields}}function uS(n,e,t){const r=Ro(n,e.name),i=ai(e.updateTime),a=new ei({mapValue:{fields:e.fields}}),l=$n.newFoundDocument(r,i,a);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function Dd(n,e){let t;if(e instanceof Ed)t={update:hm(n,e.key,e.value)};else if(e instanceof Ll)t={delete:jf(n,e.key)};else if(e instanceof Fs)t={update:hm(n,e.key,e.data),updateMask:Eb(e.fieldMask)};else{if(!(e instanceof um))return mt();t={verify:jf(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof Nl)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Cu)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Ol)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof vd)return{fieldPath:a.field.canonicalString(),increment:l._t};throw mt()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:Yv(n,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:mt()),t;var i}function Du(n,e){const t=e.currentDocument?void 0!==(i=e.currentDocument).updateTime?dr.updateTime(ai(i.updateTime)):void 0!==i.exists?dr.exists(i.exists):dr.none():dr.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,l){let h=null;"setToServerValue"in l?(Lt("REQUEST_TIME"===l.setToServerValue),h=new Nl):"appendMissingElements"in l?h=new Cu(l.appendMissingElements.values||[]):"removeAllFromArray"in l?h=new Ol(l.removeAllFromArray.values||[]):"increment"in l?h=new vd(a,l.increment):mt();const m=Nr.fromServerFormat(l.fieldPath);return new Nf(m,h)}(n,i)):[];var i;if(e.update){const i=Ro(n,e.update.name),a=new ei({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=new hs((e.updateMask.fieldPaths||[]).map(v=>Nr.fromServerFormat(v)));return new Fs(i,a,l,t,r)}return new Ed(i,a,t,r)}if(e.delete){const i=Ro(n,e.delete);return new Ll(i,t)}if(e.verify){const i=Ro(n,e.verify);return new um(i,t)}return mt()}function Xv(n,e){return{documents:[$f(n,e.path)]}}function fm(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=$f(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=$f(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(m){if(0===m.length)return;const v=m.map(C=>function(T){if("=="===T.op){if(Ov(T.value))return{unaryFilter:{field:Td(T.field),op:"IS_NAN"}};if(kI(T.value))return{unaryFilter:{field:Td(T.field),op:"IS_NULL"}}}else if("!="===T.op){if(Ov(T.value))return{unaryFilter:{field:Td(T.field),op:"IS_NOT_NAN"}};if(kI(T.value))return{unaryFilter:{field:Td(T.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Td(T.field),op:gS(T.op),value:T.value}}}(C));return 1===v.length?v[0]:{compositeFilter:{op:"AND",filters:v}}}(e.filters);i&&(t.structuredQuery.where=i);const a=function(m){if(0!==m.length)return m.map(v=>{return{field:Td((C=v).field),direction:pS(C.dir)};var C})}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const l=(v=e.limit,n.dt||gd(v)?v:{value:v});var v,h,m;return null!==l&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt={before:(h=e.startAt).inclusive,values:h.position}),e.endAt&&(t.structuredQuery.endAt={before:!(m=e.endAt).inclusive,values:m.position}),t}function dS(n){let e=Qv(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Lt(1===r);const C=t.from[0];C.allDescendants?i=C.collectionId:e=e.child(C.collectionId)}let a=[];t.where&&(a=fS(t.where));let l=[];t.orderBy&&(l=t.orderBy.map(C=>{return new Pl(Ul((T=C).field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction));var T}));let h=null;t.limit&&(h=function(C){let T;return T="object"==typeof C?C.value:C,gd(T)?null:T}(t.limit));let m=null;var C;t.startAt&&(m=new Ea((C=t.startAt).values||[],!!C.before));let v=null;return t.endAt&&(v=function(C){return new Ea(C.values||[],!C.before)}(t.endAt)),WI(e,i,l,a,h,"F",m,v)}function fS(n){return n?void 0!==n.unaryFilter?[mS(n)]:void 0!==n.fieldFilter?[wb(n)]:void 0!==n.compositeFilter?n.compositeFilter.filters.map(e=>fS(e)).reduce((e,t)=>e.concat(t)):mt():[]}function pS(n){return yM[n]}function gS(n){return gb[n]}function Td(n){return{fieldPath:n.canonicalString()}}function Ul(n){return Nr.fromServerFormat(n.fieldPath)}function wb(n){return Di.create(Ul(n.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return mt()}}(n.fieldFilter.op),n.fieldFilter.value)}function mS(n){switch(n.unaryFilter.op){case"IS_NAN":const e=Ul(n.unaryFilter.field);return Di.create(e,"==",{doubleValue:NaN});case"IS_NULL":const t=Ul(n.unaryFilter.field);return Di.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Ul(n.unaryFilter.field);return Di.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Ul(n.unaryFilter.field);return Di.create(i,"!=",{nullValue:"NULL_VALUE"});default:return mt()}}function Eb(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Jv(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}function Li(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=e0(e)),e=_S(n.get(t),e);return e0(e)}function _S(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const a=n.charAt(i);switch(a){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=a}}return t}function e0(n){return n+"\x01\x01"}function xo(n){const e=n.length;if(Lt(e>=2),2===e)return Lt("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),un.emptyPath();const t=e-2,r=[];let i="";for(let a=0;a<e;){const l=n.indexOf("\x01",a);switch((l<0||l>t)&&mt(),n.charAt(l+1)){case"\x01":const h=n.substring(a,l);let m;0===i.length?m=h:(i+=h,m=i,i=""),r.push(m);break;case"\x10":i+=n.substring(a,l),i+="\0";break;case"\x11":i+=n.substring(a,l+1);break;default:mt()}a=l+2}return new un(r)}const t0=["userId","batchId"];function Gf(n,e){return[n,Li(e)]}function n0(n,e,t){return[n,Li(e),t]}const Ib={},yS=["prefixPath","collectionGroup","readTime","documentId"],vS=["prefixPath","collectionGroup","documentId"],vM=["collectionGroup","readTime","prefixPath","documentId"],bb=["canonicalId","targetId"],wM=["targetId","path"],EM=["path","targetId"],IM=["collectionId","parent"],bM=["indexId","uid"],CM=["uid","sequenceNumber"],DM=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],TM=["indexId","uid","orderedDocumentKey"],SM=["userId","collectionPath","documentId"],pm=["userId","collectionPath","largestBatchId"],AM=["userId","collectionGroup","largestBatchId"],r0=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],gm=[...r0,"documentOverlays"],s0=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],o0=s0,RM=[...o0,"indexConfiguration","indexState","indexEntries"];class zf extends Rv{constructor(e,t){super(),this.ee=e,this.currentSequenceNumber=t}}function ti(n,e){const t=it(n);return no.N(t.ee,e)}class a0{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&Wv(a,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=ba(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=ba(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=cm();return this.mutations.forEach(i=>{const a=e.get(i.key),l=a.overlayedDocument;let h=this.applyToLocalView(l,a.mutatedFields);h=t.has(i.key)?null:h;const m=sb(l,h);null!==m&&r.set(i.key,m),l.isValidDocument()||l.convertToNoDocument(Ft.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Jt())}isEqual(e){return this.batchId===e.batchId&&Tl(this.mutations,e.mutations,(t,r)=>ob(t,r))&&Tl(this.baseMutations,e.baseMutations,(t,r)=>ob(t,r))}}class mm{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Lt(e.mutations.length===r.length);let i=db;const a=e.mutations;for(let l=0;l<a.length;l++)i=i.insert(a[l].key,r[l].version);return new mm(e,t,r,i)}}class Cb{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Vl{constructor(e,t,r,i,a=Ft.min(),l=Ft.min(),h=cr.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=h}withSequenceNumber(e){return new Vl(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new Vl(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Vl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class Db{constructor(e){this.ne=e}}function Wf(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:_m(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:jf(i=n.ne,(a=e).key),fields:a.data.value.mapValue.fields,updateTime:Ca(i,a.version.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Sd(e.version)};else{if(!e.isUnknownDocument())return mt();r.unknownDocument={path:t.path.toArray(),version:Sd(e.version)}}var i,a;return r}function _m(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Sd(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ad(n){const e=new rr(n.seconds,n.nanoseconds);return Ft.fromTimestamp(e)}function Rd(n,e){const t=(e.baseMutations||[]).map(a=>Du(n.ne,a));for(let a=0;a<e.mutations.length-1;++a){const l=e.mutations[a];a+1<e.mutations.length&&void 0!==e.mutations[a+1].transform&&(l.updateTransforms=e.mutations[a+1].transform.fieldTransforms,e.mutations.splice(a+1,1),++a)}const r=e.mutations.map(a=>Du(n.ne,a)),i=rr.fromMillis(e.localWriteTimeMs);return new a0(e.batchId,i,t,r)}function qf(n){const e=Ad(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?Ad(n.lastLimboFreeSnapshotVersion):Ft.min();let r;var i;return void 0!==n.query.documents?(Lt(1===(i=n.query).documents.length),r=Ls(kl(Qv(i.documents[0])))):r=Ls(dS(n.query)),new Vl(r,n.targetId,0,n.lastListenSequenceNumber,e,t,cr.fromBase64String(n.resumeToken))}function Tb(n,e){const t=Sd(e.snapshotVersion),r=Sd(e.lastLimboFreeSnapshotVersion);let i;i=sm(e.target)?Xv(n.ne,e.target):fm(n.ne,e.target);const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ml(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function u0(n){const e=dS({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?qI(e,e.limit,"L"):e}function Sb(n,e){return new Cb(e.largestBatchId,Du(n.ne,e.overlayMutation))}function Ab(n,e){const t=e.path.lastSegment();return[n,Li(e.path.popLast()),t]}function l0(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:Sd(r.readTime),documentKey:Li(r.documentKey.path),largestBatchId:r.largestBatchId}}class Rb{getBundleMetadata(e,t){return ES(e).get(t).next(r=>{if(r)return{id:(i=r).bundleId,createTime:Ad(i.createTime),version:i.version};var i})}saveBundleMetadata(e,t){return ES(e).put({bundleId:(r=t).id,createTime:Sd(ai(r.createTime)),version:r.version});var r}getNamedQuery(e,t){return Us(e).get(t).next(r=>{if(r)return{name:(i=r).name,query:u0(i.bundledQuery),readTime:Ad(i.readTime)};var i})}saveNamedQuery(e,t){return Us(e).put({name:(r=t).name,readTime:Sd(ai(r.readTime)),bundledQuery:r.bundledQuery});var r}}function ES(n){return ti(n,"bundles")}function Us(n){return ti(n,"namedQueries")}class ym{constructor(e,t){this.wt=e,this.userId=t}static se(e,t){return new ym(e,t.uid||"")}getOverlay(e,t){return Bl(e).get(Ab(this.userId,t)).next(r=>r?Sb(this.wt,r):null)}getOverlays(e,t){const r=ro();return ge.forEach(t,i=>this.getOverlay(e,i).next(a=>{null!==a&&r.set(i,a)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((a,l)=>{const h=new Cb(t,l);i.push(this.ie(e,h))}),ge.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(l=>i.add(Li(l.getCollectionPath())));const a=[];return i.forEach(l=>{const h=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,r+1],!1,!0);a.push(Bl(e).W("collectionPathOverlayIndex",h))}),ge.waitFor(a)}getOverlaysForCollection(e,t,r){const i=ro(),a=Li(t),l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Bl(e).K("collectionPathOverlayIndex",l).next(h=>{for(const m of h){const v=Sb(this.wt,m);i.set(v.getKey(),v)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const a=ro();let l;const h=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Bl(e).J({index:"collectionGroupOverlayIndex",range:h},(m,v,C)=>{const T=Sb(this.wt,v);a.size()<i||T.largestBatchId===l?(a.set(T.getKey(),T),l=T.largestBatchId):C.done()}).next(()=>a)}ie(e,t){return Bl(e).put(function(r,i,a){const[l,h,m]=Ab(i,a.mutation.key);return{userId:i,collectionPath:h,documentId:m,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:Dd(r.ne,a.mutation)}}(this.wt,this.userId,t))}}function Bl(n){return ti(n,"documentOverlays")}class jl{constructor(){}re(e,t){this.oe(e,t),t.ue()}oe(e,t){if("nullValue"in e)this.ce(t,5);else if("booleanValue"in e)this.ce(t,10),t.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(t,15),t.ae(Ir(e.integerValue));else if("doubleValue"in e){const r=Ir(e.doubleValue);isNaN(r)?this.ce(t,13):(this.ce(t,15),md(r)?t.ae(0):t.ae(r))}else if("timestampValue"in e){const r=e.timestampValue;this.ce(t,20),"string"==typeof r?t.he(r):(t.he(`${r.seconds||""}`),t.ae(r.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,t),this.fe(t);else if("bytesValue"in e)this.ce(t,30),t.de(wu(e.bytesValue)),this.fe(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.ce(t,45),t.ae(r.latitude||0),t.ae(r.longitude||0)}else"mapValue"in e?NI(e)?this.ce(t,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,t),this.fe(t)):"arrayValue"in e?(this.me(e.arrayValue,t),this.fe(t)):mt()}le(e,t){this.ce(t,25),this.ge(e,t)}ge(e,t){t.he(e)}we(e,t){const r=e.fields||{};this.ce(t,55);for(const i of Object.keys(r))this.le(i,t),this.oe(r[i],t)}me(e,t){const r=e.values||[];this.ce(t,50);for(const i of r)this.oe(i,t)}_e(e,t){this.ce(t,37),tt.fromName(e).path.forEach(r=>{this.ce(t,60),this.ge(r,t)})}ce(e,t){e.ae(t)}fe(e){e.ae(2)}}function xM(n){if(0===n)return 8;let e=0;return n>>4==0&&(e+=4,n<<=4),n>>6==0&&(e+=2,n<<=2),n>>7==0&&(e+=1),e}function ps(n){const e=64-function(t){let r=0;for(let i=0;i<8;++i){const a=xM(255&t[i]);if(r+=a,8!==a)break}return r}(n);return Math.ceil(e/8)}jl.ye=new jl;class IS{constructor(){this.buffer=new Uint8Array(1024),this.position=0}pe(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ie(r.value),r=t.next();this.Te()}Ee(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ae(r.value),r=t.next();this.Re()}be(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ie(r);else if(r<2048)this.Ie(960|r>>>6),this.Ie(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ie(480|r>>>12),this.Ie(128|63&r>>>6),this.Ie(128|63&r);else{const i=t.codePointAt(0);this.Ie(240|i>>>18),this.Ie(128|63&i>>>12),this.Ie(128|63&i>>>6),this.Ie(128|63&i)}}this.Te()}Pe(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ae(r);else if(r<2048)this.Ae(960|r>>>6),this.Ae(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ae(480|r>>>12),this.Ae(128|63&r>>>6),this.Ae(128|63&r);else{const i=t.codePointAt(0);this.Ae(240|i>>>18),this.Ae(128|63&i>>>12),this.Ae(128|63&i>>>6),this.Ae(128|63&i)}}this.Re()}ve(e){const t=this.Ve(e),r=ps(t);this.Se(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}De(e){const t=this.Ve(e),r=ps(t);this.Se(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}Ce(){this.xe(255),this.xe(255)}Ne(){this.ke(255),this.ke(255)}reset(){this.position=0}seed(e){this.Se(e.length),this.buffer.set(e,this.position),this.position+=e.length}Oe(){return this.buffer.slice(0,this.position)}Ve(e){const t=function(i){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,i,!1),new Uint8Array(a.buffer)}(e),r=0!=(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ie(e){const t=255&e;0===t?(this.xe(0),this.xe(255)):255===t?(this.xe(255),this.xe(0)):this.xe(t)}Ae(e){const t=255&e;0===t?(this.ke(0),this.ke(255)):255===t?(this.ke(255),this.ke(0)):this.ke(e)}Te(){this.xe(0),this.xe(1)}Re(){this.ke(0),this.ke(1)}xe(e){this.Se(1),this.buffer[this.position++]=e}ke(e){this.Se(1),this.buffer[this.position++]=~e}Se(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class c0{constructor(e){this.Me=e}de(e){this.Me.pe(e)}he(e){this.Me.be(e)}ae(e){this.Me.ve(e)}ue(){this.Me.Ce()}}class bS{constructor(e){this.Me=e}de(e){this.Me.Ee(e)}he(e){this.Me.Pe(e)}ae(e){this.Me.De(e)}ue(){this.Me.Ne()}}class Kf{constructor(){this.Me=new IS,this.Fe=new c0(this.Me),this.$e=new bS(this.Me)}seed(e){this.Me.seed(e)}Be(e){return 0===e?this.Fe:this.$e}Oe(){return this.Me.Oe()}reset(){this.Me.reset()}}class Da{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Le(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Da(this.indexId,this.documentKey,this.arrayValue,r)}}function Tu(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=d0(n.arrayValue,e.arrayValue),0!==t?t:(t=d0(n.directionalValue,e.directionalValue),0!==t?t:tt.comparator(n.documentKey,e.documentKey)))}function d0(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class CS{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ue=e.orderBy,this.qe=[];for(const t of e.filters){const r=t;r.ht()?this.Ke=r:this.qe.push(r)}}Ge(e){const t=Xg(e);if(void 0!==t&&!this.Qe(t))return!1;const r=yu(e);let i=0,a=0;for(;i<r.length&&this.Qe(r[i]);++i);if(i===r.length)return!0;if(void 0!==this.Ke){const l=r[i];if(!this.je(this.Ke,l)||!this.We(this.Ue[a++],l))return!1;++i}for(;i<r.length;++i){const l=r[i];if(a>=this.Ue.length||!this.We(this.Ue[a++],l))return!1}return!0}Qe(e){for(const t of this.qe)if(this.je(t,e))return!0;return!1}je(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}We(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}class xb{constructor(){this.ze=new vm}addToCollectionParentIndex(e,t){return this.ze.add(t),ge.resolve()}getCollectionParents(e,t){return ge.resolve(this.ze.getEntries(t))}addFieldIndex(e,t){return ge.resolve()}deleteFieldIndex(e,t){return ge.resolve()}getDocumentsMatchingTarget(e,t){return ge.resolve(null)}getIndexType(e,t){return ge.resolve(0)}getFieldIndexes(e,t){return ge.resolve([])}getNextCollectionGroupToUpdate(e){return ge.resolve(null)}getMinOffset(e,t){return ge.resolve(ds.min())}getMinOffsetFromCollectionGroup(e,t){return ge.resolve(ds.min())}updateCollectionGroup(e,t,r){return ge.resolve()}updateIndexEntries(e,t){return ge.resolve()}}class vm{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Un(un.comparator),a=!i.has(r);return this.index[t]=i.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Un(un.comparator)).toArray()}}const wm=new Uint8Array(0);class Mb{constructor(e,t){this.user=e,this.databaseId=t,this.He=new vm,this.Je=new Ao(r=>Ml(r),(r,i)=>Mf(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.He.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.He.add(t)});const a={collectionId:r,parent:Li(i)};return Pb(e).put(a)}return ge.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[Sv(t),""],!1,!0);return Pb(e).K(i).next(a=>{for(const l of a){if(l.collectionId!==t)break;r.push(xo(l.parent))}return r})}addFieldIndex(e,t){const r=io(e),i={indexId:(l=t).indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])};var l;delete i.indexId;const a=r.add(i);if(t.indexState){const l=xd(e);return a.next(h=>{l.put(l0(h,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return a.next()}deleteFieldIndex(e,t){const r=io(e),i=xd(e),a=$l(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const r=$l(e);let i=!0;const a=new Map;return ge.forEach(this.Ye(t),l=>this.Xe(e,l).next(h=>{i&&(i=!!h),a.set(l,h)})).next(()=>{if(i){let l=Jt();const h=[];return ge.forEach(a,(m,v)=>{var C;qe("IndexedDbIndexManager",`Using index ${C=m,`id=${C.indexId}|cg=${C.collectionGroup}|f=${C.fields.map(vt=>`${vt.fieldPath}:${vt.kind}`).join(",")}`} to execute ${Ml(t)}`);const T=function(vt,wt){const Wt=Xg(wt);if(void 0===Wt)return null;for(const sn of wa(vt,Wt.fieldPath))switch(sn.op){case"array-contains-any":return sn.value.arrayValue.values||[];case"array-contains":return[sn.value]}return null}(v,m),x=function(vt,wt){const Wt=new Map;for(const sn of yu(wt))for(const li of wa(vt,sn.fieldPath))switch(li.op){case"==":case"in":Wt.set(sn.fieldPath.canonicalString(),li.value);break;case"not-in":case"!=":return Wt.set(sn.fieldPath.canonicalString(),li.value),Array.from(Wt.values())}return null}(v,m),$=function(vt,wt){const Wt=[];let sn=!0;for(const li of yu(wt)){const ka=0===li.kind?Uv(vt,li.fieldPath,vt.startAt):VI(vt,li.fieldPath,vt.startAt);Wt.push(ka.value),sn&&(sn=ka.inclusive)}return new Ea(Wt,sn)}(v,m),Y=function(vt,wt){const Wt=[];let sn=!0;for(const li of yu(wt)){const ka=0===li.kind?VI(vt,li.fieldPath,vt.endAt):Uv(vt,li.fieldPath,vt.endAt);Wt.push(ka.value),sn&&(sn=ka.inclusive)}return new Ea(Wt,sn)}(v,m),Ie=this.Ze(m,v,$),Re=this.Ze(m,v,Y),_t=this.tn(m,v,x),Et=this.en(m.indexId,T,Ie,$.inclusive,Re,Y.inclusive,_t);return ge.forEach(Et,vt=>r.j(vt,t.limit).next(wt=>{wt.forEach(Wt=>{const sn=tt.fromSegments(Wt.documentKey);l.has(sn)||(l=l.add(sn),h.push(sn))})}))}).next(()=>h)}return ge.resolve(null)})}Ye(e){let t=this.Je.get(e);return t||(t=[e],this.Je.set(e,t),t)}en(e,t,r,i,a,l,h){const m=(null!=t?t.length:1)*Math.max(r.length,a.length),v=m/(null!=t?t.length:1),C=[];for(let T=0;T<m;++T){const x=t?this.nn(t[T/v]):wm,$=this.sn(e,x,r[T%v],i),Y=this.rn(e,x,a[T%v],l),Ie=h.map(Re=>this.sn(e,x,Re,!0));C.push(...this.createRange($,Y,Ie))}return C}sn(e,t,r,i){const a=new Da(e,tt.empty(),t,r);return i?a:a.Le()}rn(e,t,r,i){const a=new Da(e,tt.empty(),t,r);return i?a.Le():a}Xe(e,t){const r=new CS(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(a=>{let l=null;for(const h of a)r.Ge(h)&&(!l||h.fields.length>l.fields.length)&&(l=h);return l})}getIndexType(e,t){let r=2;return ge.forEach(this.Ye(t),i=>this.Xe(e,i).next(a=>{a?0!==r&&a.fields.length<function(l){let h=new Un(Nr.comparator),m=!1;for(const v of l.filters){const C=v;C.field.isKeyField()||("array-contains"===C.op||"array-contains-any"===C.op?m=!0:h=h.add(C.field))}for(const v of l.orderBy)v.field.isKeyField()||(h=h.add(v.field));return h.size+(m?1:0)}(i)&&(r=1):r=0})).next(()=>r)}on(e,t){const r=new Kf;for(const i of yu(e)){const a=t.data.field(i.fieldPath);if(null==a)return null;const l=r.Be(i.kind);jl.ye.re(a,l)}return r.Oe()}nn(e){const t=new Kf;return jl.ye.re(e,t.Be(0)),t.Oe()}un(e,t){const r=new Kf;return jl.ye.re(xl(this.databaseId,t),r.Be(function(i){const a=yu(i);return 0===a.length?0:a[a.length-1].kind}(e))),r.Oe()}tn(e,t,r){if(null===r)return[];let i=[];i.push(new Kf);let a=0;for(const l of yu(e)){const h=r[a++];for(const m of i)if(this.cn(t,l.fieldPath)&&Af(h))i=this.an(i,l,h);else{const v=m.Be(l.kind);jl.ye.re(h,v)}}return this.hn(i)}Ze(e,t,r){return this.tn(e,t,r.position)}hn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Oe();return t}an(e,t,r){const i=[...e],a=[];for(const l of r.arrayValue.values||[])for(const h of i){const m=new Kf;m.seed(h.Oe()),jl.ye.re(l,m.Be(t.kind)),a.push(m)}return a}cn(e,t){return!!e.filters.find(r=>r instanceof Di&&r.field.isEqual(t)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,t){const r=io(e),i=xd(e);return(t?r.K("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.K()).next(a=>{const l=[];return ge.forEach(a,h=>i.get([h.indexId,this.uid]).next(m=>{l.push(function(v,C){const T=C?new Df(C.sequenceNumber,new ds(Ad(C.readTime),new tt(xo(C.documentKey)),C.largestBatchId)):Df.empty(),x=v.fields.map(([$,Y])=>new Cf(Nr.fromServerFormat($),Y));return new Sl(v.indexId,v.collectionGroup,x,T)}(h,m))})).next(()=>l)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,i)=>{const a=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==a?a:Xt(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=io(e),a=xd(e);return this.ln(e).next(l=>i.K("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(h=>ge.forEach(h,m=>a.put(l0(m.indexId,this.user,l,r)))))}updateIndexEntries(e,t){const r=new Map;return ge.forEach(t,(i,a)=>{const l=r.get(i.collectionGroup);return(l?ge.resolve(l):this.getFieldIndexes(e,i.collectionGroup)).next(h=>(r.set(i.collectionGroup,h),ge.forEach(h,m=>this.fn(e,i,m).next(v=>{const C=this.dn(a,m);return v.isEqual(C)?ge.resolve():this._n(e,a,m,v,C)}))))})}wn(e,t,r,i){return $l(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.un(r,t.key),documentKey:t.key.path.toArray()})}mn(e,t,r,i){return $l(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.un(r,t.key),t.key.path.toArray()])}fn(e,t,r){const i=$l(e);let a=new Un(Tu);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.un(r,t)])},(l,h)=>{a=a.add(new Da(r.indexId,t,h.arrayValue,h.directionalValue))}).next(()=>a)}dn(e,t){let r=new Un(Tu);const i=this.on(t,e);if(null==i)return r;const a=Xg(t);if(null!=a){const l=e.data.field(a.fieldPath);if(Af(l))for(const h of l.arrayValue.values||[])r=r.add(new Da(t.indexId,e.key,this.nn(h),i))}else r=r.add(new Da(t.indexId,e.key,wm,i));return r}_n(e,t,r,i,a){qe("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const l=[];return function(h,m,v,C,T){const x=h.getIterator(),$=m.getIterator();let Y=Rl(x),Ie=Rl($);for(;Y||Ie;){let Re=!1,_t=!1;if(Y&&Ie){const Et=v(Y,Ie);Et<0?_t=!0:Et>0&&(Re=!0)}else null!=Y?_t=!0:Re=!0;Re?(C(Ie),Ie=Rl($)):_t?(T(Y),Y=Rl(x)):(Y=Rl(x),Ie=Rl($))}}(i,a,Tu,h=>{l.push(this.wn(e,t,r,h))},h=>{l.push(this.mn(e,t,r,h))}),ge.waitFor(l)}ln(e){let t=1;return xd(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,a)=>{a.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((l,h)=>Tu(l,h)).filter((l,h,m)=>!h||0!==Tu(l,m[h-1]));const i=[];i.push(e);for(const l of r){const h=Tu(l,e),m=Tu(l,t);if(0===h)i[0]=e.Le();else if(h>0&&m<0)i.push(l),i.push(l.Le());else if(m>0)break}i.push(t);const a=[];for(let l=0;l<i.length;l+=2)a.push(IDBKeyRange.bound([i[l].indexId,this.uid,i[l].arrayValue,i[l].directionalValue,wm,[]],[i[l+1].indexId,this.uid,i[l+1].arrayValue,i[l+1].directionalValue,wm,[]]));return a}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Em)}getMinOffset(e,t){return ge.mapArray(this.Ye(t),r=>this.Xe(e,r).next(i=>i||mt())).next(Em)}}function Pb(n){return ti(n,"collectionParents")}function $l(n){return ti(n,"indexEntries")}function io(n){return ti(n,"indexConfiguration")}function xd(n){return ti(n,"indexState")}function Em(n){Lt(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;Av(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new ds(e.readTime,e.documentKey,t)}const Mo={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Zi{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Zi(e,Zi.DEFAULT_COLLECTION_PERCENTILE,Zi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function DS(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),a=[],l=IDBKeyRange.only(t.batchId);let h=0;const m=r.J({range:l},(C,T,x)=>(h++,x.delete()));a.push(m.next(()=>{Lt(1===h)}));const v=[];for(const C of t.mutations){const T=n0(e,C.key.path,t.batchId);a.push(i.delete(T)),v.push(C.key)}return ge.waitFor(a).next(()=>v)}function Im(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw mt();e=n.noDocument}return JSON.stringify(e).length}Zi.DEFAULT_COLLECTION_PERCENTILE=10,Zi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Zi.DEFAULT=new Zi(41943040,Zi.DEFAULT_COLLECTION_PERCENTILE,Zi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Zi.DISABLED=new Zi(-1,0,0);class bm{constructor(e,t,r,i){this.userId=e,this.wt=t,this.indexManager=r,this.referenceDelegate=i,this.gn={}}static se(e,t,r,i){Lt(""!==e.uid);const a=e.isAuthenticated()?e.uid:"";return new bm(a,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Su(e).J({index:"userMutationsIndex",range:r},(i,a,l)=>{t=!1,l.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const a=Hl(e),l=Su(e);return l.add({}).next(h=>{Lt("number"==typeof h);const m=new a0(h,t,r,i),v=function(x,$,Y){const Ie=Y.baseMutations.map(_t=>Dd(x.ne,_t)),Re=Y.mutations.map(_t=>Dd(x.ne,_t));return{userId:$,batchId:Y.batchId,localWriteTimeMs:Y.localWriteTime.toMillis(),baseMutations:Ie,mutations:Re}}(this.wt,this.userId,m),C=[];let T=new Un((x,$)=>Xt(x.canonicalString(),$.canonicalString()));for(const x of i){const $=n0(this.userId,x.key.path,h);T=T.add(x.key.path.popLast()),C.push(l.put(v)),C.push(a.put($,Ib))}return T.forEach(x=>{C.push(this.indexManager.addToCollectionParentIndex(e,x))}),e.addOnCommittedListener(()=>{this.gn[h]=m.keys()}),ge.waitFor(C).next(()=>m)})}lookupMutationBatch(e,t){return Su(e).get(t).next(r=>r?(Lt(r.userId===this.userId),Rd(this.wt,r)):null)}yn(e,t){return this.gn[t]?ge.resolve(this.gn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.gn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return Su(e).J({index:"userMutationsIndex",range:i},(l,h,m)=>{h.userId===this.userId&&(Lt(h.batchId>=r),a=Rd(this.wt,h)),m.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Su(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,a,l)=>{r=a.batchId,l.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Su(e).K("userMutationsIndex",t).next(r=>r.map(i=>Rd(this.wt,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Gf(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return Hl(e).J({range:i},(l,h,m)=>{const[v,C,T]=l,x=xo(C);if(v===this.userId&&t.path.isEqual(x))return Su(e).get(T).next($=>{if(!$)throw mt();Lt($.userId===this.userId),a.push(Rd(this.wt,$))});m.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Un(Xt);const i=[];return t.forEach(a=>{const l=Gf(this.userId,a.path),h=IDBKeyRange.lowerBound(l),m=Hl(e).J({range:h},(v,C,T)=>{const[x,$,Y]=v,Ie=xo($);x===this.userId&&a.path.isEqual(Ie)?r=r.add(Y):T.done()});i.push(m)}),ge.waitFor(i).next(()=>this.pn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,a=Gf(this.userId,r),l=IDBKeyRange.lowerBound(a);let h=new Un(Xt);return Hl(e).J({range:l},(m,v,C)=>{const[T,x,$]=m,Y=xo(x);T===this.userId&&r.isPrefixOf(Y)?Y.length===i&&(h=h.add($)):C.done()}).next(()=>this.pn(e,h))}pn(e,t){const r=[],i=[];return t.forEach(a=>{i.push(Su(e).get(a).next(l=>{if(null===l)throw mt();Lt(l.userId===this.userId),r.push(Rd(this.wt,l))}))}),ge.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return DS(e.ee,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.In(t.batchId)}),ge.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}In(e){delete this.gn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return ge.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return Hl(e).J({range:r},(a,l,h)=>{if(a[0]===this.userId){const m=xo(a[1]);i.push(m)}else h.done()}).next(()=>{Lt(0===i.length)})})}containsKey(e,t){return kb(e,this.userId,t)}Tn(e){return TS(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function kb(n,e,t){const r=Gf(e,t.path),i=r[1],a=IDBKeyRange.lowerBound(r);let l=!1;return Hl(n).J({range:a,H:!0},(h,m,v)=>{const[C,T,x]=h;C===e&&T===i&&(l=!0),v.done()}).next(()=>l)}function Su(n){return ti(n,"mutations")}function Hl(n){return ti(n,"documentMutations")}function TS(n){return ti(n,"mutationQueues")}class Au{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new Au(0)}static Rn(){return new Au(-1)}}class SS{constructor(e,t){this.referenceDelegate=e,this.wt=t}allocateTargetId(e){return this.bn(e).next(t=>{const r=new Au(t.highestTargetId);return t.highestTargetId=r.next(),this.Pn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.bn(e).next(t=>Ft.fromTimestamp(new rr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Pn(e,i)))}addTargetData(e,t){return this.vn(e,t).next(()=>this.bn(e).next(r=>(r.targetCount+=1,this.Vn(t,r),this.Pn(e,r))))}updateTargetData(e,t){return this.vn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Gl(e).delete(t.targetId)).next(()=>this.bn(e)).next(r=>(Lt(r.targetCount>0),r.targetCount-=1,this.Pn(e,r)))}removeTargets(e,t,r){let i=0;const a=[];return Gl(e).J((l,h)=>{const m=qf(h);m.sequenceNumber<=t&&null===r.get(m.targetId)&&(i++,a.push(this.removeTargetData(e,m)))}).next(()=>ge.waitFor(a)).next(()=>i)}forEachTarget(e,t){return Gl(e).J((r,i)=>{const a=qf(i);t(a)})}bn(e){return AS(e).get("targetGlobalKey").next(t=>(Lt(null!==t),t))}Pn(e,t){return AS(e).put("targetGlobalKey",t)}vn(e,t){return Gl(e).put(Tb(this.wt,t))}Vn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.bn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Ml(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return Gl(e).J({range:i,index:"queryTargetsIndex"},(l,h,m)=>{const v=qf(h);Mf(t,v.target)&&(a=v,m.done())}).next(()=>a)}addMatchingKeys(e,t,r){const i=[],a=Po(e);return t.forEach(l=>{const h=Li(l.path);i.push(a.put({targetId:r,path:h})),i.push(this.referenceDelegate.addReference(e,r,l))}),ge.waitFor(i)}removeMatchingKeys(e,t,r){const i=Po(e);return ge.forEach(t,a=>{const l=Li(a.path);return ge.waitFor([i.delete([r,l]),this.referenceDelegate.removeReference(e,r,a)])})}removeMatchingKeysForTargetId(e,t){const r=Po(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Po(e);let a=Jt();return i.J({range:r,H:!0},(l,h,m)=>{const v=xo(l[1]),C=new tt(v);a=a.add(C)}).next(()=>a)}containsKey(e,t){const r=Li(t.path),i=IDBKeyRange.bound([r],[Sv(r)],!1,!0);let a=0;return Po(e).J({index:"documentTargetsIndex",H:!0,range:i},([l,h],m,v)=>{0!==l&&(a++,v.done())}).next(()=>a>0)}te(e,t){return Gl(e).get(t).next(r=>r?qf(r):null)}}function Gl(n){return ti(n,"targets")}function AS(n){return ti(n,"targetGlobal")}function Po(n){return ti(n,"targetDocuments")}function h0([n,e],[t,r]){const i=Xt(n,t);return 0===i?Xt(e,r):i}class Nb{constructor(e){this.Sn=e,this.buffer=new Un(h0),this.Dn=0}Cn(){return++this.Dn}xn(e){const t=[e,this.Cn()];if(this.buffer.size<this.Sn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();h0(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Ob{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Nn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.kn(6e4)}stop(){this.Nn&&(this.Nn.cancel(),this.Nn=null)}get started(){return null!==this.Nn}kn(e){var t=this;qe("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Nn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,Ce.Z)(function*(){t.Nn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(r){Al(r)?qe("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield ma(r)}yield t.kn(3e5)}))}}class Lb{constructor(e,t){this.On=e,this.params=t}calculateTargetCount(e,t){return this.On.Mn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return ge.resolve(qi.ot);const r=new Nb(t);return this.On.forEachTarget(e,i=>r.xn(i.sequenceNumber)).next(()=>this.On.Fn(e,i=>r.xn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.On.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.On.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(qe("LruGarbageCollector","Garbage collection skipped; disabled"),ge.resolve(Mo)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(qe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Mo):this.$n(e,t))}getCacheSize(e){return this.On.getCacheSize(e)}$n(e,t){let r,i,a,l,h,m,v;const C=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(T=>(T>this.params.maximumSequenceNumbersToCollect?(qe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${T}`),i=this.params.maximumSequenceNumbersToCollect):i=T,l=Date.now(),this.nthSequenceNumber(e,i))).next(T=>(r=T,h=Date.now(),this.removeTargets(e,r,t))).next(T=>(a=T,m=Date.now(),this.removeOrphanedDocuments(e,r))).next(T=>(v=Date.now(),ga()<=Qs.in.DEBUG&&qe("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${l-C}ms\n\tDetermined least recently used ${i} in `+(h-l)+`ms\n\tRemoved ${a} targets in `+(m-h)+`ms\n\tRemoved ${T} documents in `+(v-m)+`ms\nTotal Duration: ${v-C}ms`),ge.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:T})))}}class Fb{constructor(e,t){this.db=e,this.garbageCollector=new Lb(this,t)}Mn(e){const t=this.Bn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Bn(e){let t=0;return this.Fn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Fn(e,t){return this.Ln(e,(r,i)=>t(i))}addReference(e,t,r){return zl(e,r)}removeReference(e,t,r){return zl(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return zl(e,t)}Un(e,t){return function(r,i){let a=!1;return TS(r).Y(l=>kb(r,l,i).next(h=>(h&&(a=!0),ge.resolve(!h)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Ln(e,(l,h)=>{if(h<=t){const m=this.Un(e,l).next(v=>{if(!v)return a++,r.getEntry(e,l).next(()=>(r.removeEntry(l,Ft.min()),Po(e).delete([0,Li(l.path)])))});i.push(m)}}).next(()=>ge.waitFor(i)).next(()=>r.apply(e)).next(()=>a)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return zl(e,t)}Ln(e,t){const r=Po(e);let i,a=qi.ot;return r.J({index:"documentTargetsIndex"},([l,h],{path:m,sequenceNumber:v})=>{0===l?(a!==qi.ot&&t(new tt(xo(i)),a),a=v,i=m):a=qi.ot}).next(()=>{a!==qi.ot&&t(new tt(xo(i)),a)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function zl(n,e){return Po(n).put((r=n.currentSequenceNumber,{targetId:0,path:Li(e.path),sequenceNumber:r}));var r}class Zf{constructor(){this.changes=new Ao(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,$n.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?ge.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Ub{constructor(e){this.wt=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Md(e).put(r)}removeEntry(e,t,r){return Md(e).delete(function(i,a){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],_m(a),l[l.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.qn(e,r)))}getEntry(e,t){let r=$n.newInvalidDocument(t);return Md(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Cm(t))},(i,a)=>{r=this.Kn(t,a)}).next(()=>r)}Gn(e,t){let r={size:0,document:$n.newInvalidDocument(t)};return Md(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Cm(t))},(i,a)=>{r={document:this.Kn(t,a),size:Im(a)}}).next(()=>r)}getEntries(e,t){let r=Ki();return this.Qn(e,t,(i,a)=>{const l=this.Kn(i,a);r=r.insert(i,l)}).next(()=>r)}jn(e,t){let r=Ki(),i=new Er(tt.comparator);return this.Qn(e,t,(a,l)=>{const h=this.Kn(a,l);r=r.insert(a,h),i=i.insert(a,Im(l))}).next(()=>({documents:r,Wn:i}))}Qn(e,t,r){if(t.isEmpty())return ge.resolve();let i=new Un(Bb);t.forEach(m=>i=i.add(m));const a=IDBKeyRange.bound(Cm(i.first()),Cm(i.last())),l=i.getIterator();let h=l.getNext();return Md(e).J({index:"documentKeyIndex",range:a},(m,v,C)=>{const T=tt.fromSegments([...v.prefixPath,v.collectionGroup,v.documentId]);for(;h&&Bb(h,T)<0;)r(h,null),h=l.getNext();h&&h.isEqual(T)&&(r(h,v),h=l.hasNext()?l.getNext():null),h?C.q(Cm(h)):C.done()}).next(()=>{for(;h;)r(h,null),h=l.hasNext()?l.getNext():null})}getAllFromCollection(e,t,r){const i=[t.popLast().toArray(),t.lastSegment(),_m(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],a=[t.popLast().toArray(),t.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Md(e).K(IDBKeyRange.bound(i,a,!0)).next(l=>{let h=Ki();for(const m of l){const v=this.Kn(tt.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);h=h.insert(v.key,v)}return h})}getAllFromCollectionGroup(e,t,r,i){let a=Ki();const l=f0(t,r),h=f0(t,ds.max());return Md(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(l,h,!0)},(m,v,C)=>{const T=this.Kn(tt.fromSegments(v.prefixPath.concat(v.collectionGroup,v.documentId)),v);a=a.insert(T.key,T),a.size===i&&C.done()}).next(()=>a)}newChangeBuffer(e){return new RS(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return xS(e).get("remoteDocumentGlobalKey").next(t=>(Lt(!!t),t))}qn(e,t){return xS(e).put("remoteDocumentGlobalKey",t)}Kn(e,t){if(t){const r=function wS(n,e){let t;if(e.document)t=uS(n.ne,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=tt.fromSegments(e.noDocument.path),i=Ad(e.noDocument.readTime);t=$n.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return mt();{const r=tt.fromSegments(e.unknownDocument.path),i=Ad(e.unknownDocument.version);t=$n.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(r){const i=new rr(r[0],r[1]);return Ft.fromTimestamp(i)}(e.readTime)),t}(this.wt,t);if(!r.isNoDocument()||!r.version.isEqual(Ft.min()))return r}return $n.newInvalidDocument(e)}}function Vb(n){return new Ub(n)}class RS extends Zf{constructor(e,t){super(),this.zn=e,this.trackRemovals=t,this.Hn=new Ao(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new Un((a,l)=>Xt(a.canonicalString(),l.canonicalString()));return this.changes.forEach((a,l)=>{const h=this.Hn.get(a);if(t.push(this.zn.removeEntry(e,a,h.readTime)),l.isValidDocument()){const m=Wf(this.zn.wt,l);i=i.add(a.path.popLast());const v=Im(m);r+=v-h.size,t.push(this.zn.addEntry(e,a,m))}else if(r-=h.size,this.trackRemovals){const m=Wf(this.zn.wt,l.convertToNoDocument(Ft.min()));t.push(this.zn.addEntry(e,a,m))}}),i.forEach(a=>{t.push(this.zn.indexManager.addToCollectionParentIndex(e,a))}),t.push(this.zn.updateMetadata(e,r)),ge.waitFor(t)}getFromCache(e,t){return this.zn.Gn(e,t).next(r=>(this.Hn.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.zn.jn(e,t).next(({documents:r,Wn:i})=>(i.forEach((a,l)=>{this.Hn.set(a,{size:l,readTime:r.get(a).readTime})}),r))}}function xS(n){return ti(n,"remoteDocumentGlobal")}function Md(n){return ti(n,"remoteDocumentsV14")}function Cm(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function f0(n,e){const t=e.documentKey.path.toArray();return[n,_m(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Bb(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(i=Xt(t[a],r[a]),i)return i;return i=Xt(t.length,r.length),i||(i=Xt(t[t.length-2],r[r.length-2]),i||Xt(t[t.length-1],r[r.length-1]))}class MS{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class jb{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.getBaseDocument(e,t,r))).next(i=>(null!==r&&ba(r.mutation,i,hs.empty(),rr.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Jt()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Jt()){const i=ro();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(a=>{let l=Ff();return a.forEach((h,m)=>{l=l.insert(h,m.overlayedDocument)}),l}))}getOverlayedDocuments(e,t){const r=ro();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Jt()))}populateOverlays(e,t,r){const i=[];return r.forEach(a=>{t.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((l,h)=>{t.set(l,h)})})}computeViews(e,t,r,i){let a=Ki();const l=Id(),h=Id();return t.forEach((m,v)=>{const C=r.get(v.key);i.has(v.key)&&(void 0===C||C.mutation instanceof Fs)?a=a.insert(v.key,v):void 0!==C&&(l.set(v.key,C.mutation.getFieldMask()),ba(C.mutation,v,C.mutation.getFieldMask(),rr.now()))}),this.recalculateAndSaveOverlays(e,a).next(m=>(m.forEach((v,C)=>l.set(v,C)),t.forEach((v,C)=>{var T;return h.set(v,new MS(C,null!==(T=l.get(v))&&void 0!==T?T:null))}),h))}recalculateAndSaveOverlays(e,t){const r=Id();let i=new Er((l,h)=>l-h),a=Jt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(l=>{for(const h of l)h.keys().forEach(m=>{const v=t.get(m);if(null===v)return;let C=r.get(m)||hs.empty();C=h.applyToLocalView(v,C),r.set(m,C);const T=(i.get(h.batchId)||Jt()).add(m);i=i.insert(h.batchId,T)})}).next(()=>{const l=[],h=i.getReverseIterator();for(;h.hasNext();){const m=h.getNext(),v=m.key,C=m.value,T=cm();C.forEach(x=>{if(!a.has(x)){const $=sb(t.get(x),r.get(x));null!==$&&T.set(x,$),a=a.add(x)}}),l.push(this.documentOverlayCache.saveOverlays(e,v,T))}return ge.waitFor(l)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r){return tt.isDocumentKey((i=t).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):$v(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r):this.getDocumentsMatchingCollectionQuery(e,t,r);var i}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(a=>{const l=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-a.size):ge.resolve(ro());let h=-1,m=a;return l.next(v=>ge.forEach(v,(C,T)=>(h<T.largestBatchId&&(h=T.largestBatchId),a.get(C)?ge.resolve():this.getBaseDocument(e,C,T).next(x=>{m=m.insert(C,x)}))).next(()=>this.populateOverlays(e,v,a)).next(()=>this.computeViews(e,m,v,Jt())).next(C=>({batchId:h,changes:cb(C)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new tt(t)).next(r=>{let i=Ff();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r){const i=t.collectionGroup;let a=Ff();return this.indexManager.getCollectionParents(e,i).next(l=>ge.forEach(l,h=>{const m=(v=t,C=h.child(i),new Ia(C,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt));var v,C;return this.getDocumentsMatchingCollectionQuery(e,m,r).next(v=>{v.forEach((C,T)=>{a=a.insert(C,T)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r){let i;return this.remoteDocumentCache.getAllFromCollection(e,t.path,r).next(a=>(i=a,this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId))).next(a=>{a.forEach((h,m)=>{const v=m.getKey();null===i.get(v)&&(i=i.insert(v,$n.newInvalidDocument(v)))});let l=Ff();return i.forEach((h,m)=>{const v=a.get(h);void 0!==v&&ba(v.mutation,m,hs.empty(),rr.now()),Gv(t,m)&&(l=l.insert(h,m))}),l})}getBaseDocument(e,t,r){return null===r||1===r.mutation.type?this.remoteDocumentCache.getEntry(e,t):ge.resolve($n.newInvalidDocument(t))}}class MM{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,t){return ge.resolve(this.Jn.get(t))}saveBundleMetadata(e,t){var r;return this.Jn.set(t.id,{id:(r=t).id,version:r.version,createTime:ai(r.createTime)}),ge.resolve()}getNamedQuery(e,t){return ge.resolve(this.Yn.get(t))}saveNamedQuery(e,t){return this.Yn.set(t.name,{name:(r=t).name,query:u0(r.bundledQuery),readTime:ai(r.readTime)}),ge.resolve();var r}}class PM{constructor(){this.overlays=new Er(tt.comparator),this.Xn=new Map}getOverlay(e,t){return ge.resolve(this.overlays.get(t))}getOverlays(e,t){const r=ro();return ge.forEach(t,i=>this.getOverlay(e,i).next(a=>{null!==a&&r.set(i,a)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,a)=>{this.ie(e,t,a)}),ge.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Xn.get(r);return void 0!==i&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.Xn.delete(r)),ge.resolve()}getOverlaysForCollection(e,t,r){const i=ro(),a=t.length+1,l=new tt(t.child("")),h=this.overlays.getIteratorFrom(l);for(;h.hasNext();){const m=h.getNext().value,v=m.getKey();if(!t.isPrefixOf(v.path))break;v.path.length===a&&m.largestBatchId>r&&i.set(m.getKey(),m)}return ge.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let a=new Er((v,C)=>v-C);const l=this.overlays.getIterator();for(;l.hasNext();){const v=l.getNext().value;if(v.getKey().getCollectionGroup()===t&&v.largestBatchId>r){let C=a.get(v.largestBatchId);null===C&&(C=ro(),a=a.insert(v.largestBatchId,C)),C.set(v.getKey(),v)}}const h=ro(),m=a.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach((v,C)=>h.set(v,C)),!(h.size()>=i)););return ge.resolve(h)}ie(e,t,r){const i=this.overlays.get(r.key);if(null!==i){const l=this.Xn.get(i.largestBatchId).delete(r.key);this.Xn.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new Cb(t,r));let a=this.Xn.get(t);void 0===a&&(a=Jt(),this.Xn.set(t,a)),this.Xn.set(t,a.add(r.key))}}class $b{constructor(){this.Zn=new Un(yi.ts),this.es=new Un(yi.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,t){const r=new yi(e,t);this.Zn=this.Zn.add(r),this.es=this.es.add(r)}ss(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.rs(new yi(e,t))}os(e,t){e.forEach(r=>this.removeReference(r,t))}us(e){const t=new tt(new un([])),r=new yi(t,e),i=new yi(t,e+1),a=[];return this.es.forEachInRange([r,i],l=>{this.rs(l),a.push(l.key)}),a}cs(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const t=new tt(new un([])),r=new yi(t,e),i=new yi(t,e+1);let a=Jt();return this.es.forEachInRange([r,i],l=>{a=a.add(l.key)}),a}containsKey(e){const t=new yi(e,0),r=this.Zn.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class yi{constructor(e,t){this.key=e,this.ls=t}static ts(e,t){return tt.comparator(e.key,t.key)||Xt(e.ls,t.ls)}static ns(e,t){return Xt(e.ls,t.ls)||tt.comparator(e.key,t.key)}}class kM{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.fs=1,this.ds=new Un(yi.ts)}checkEmpty(e){return ge.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){const a=this.fs;this.fs++;const l=new a0(a,t,r,i);this.mutationQueue.push(l);for(const h of i)this.ds=this.ds.add(new yi(h.key,a)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return ge.resolve(l)}lookupMutationBatch(e,t){return ge.resolve(this._s(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.ws(t+1),a=i<0?0:i;return ge.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return ge.resolve(0===this.mutationQueue.length?-1:this.fs-1)}getAllMutationBatches(e){return ge.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new yi(t,0),i=new yi(t,Number.POSITIVE_INFINITY),a=[];return this.ds.forEachInRange([r,i],l=>{const h=this._s(l.ls);a.push(h)}),ge.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Un(Xt);return t.forEach(i=>{const a=new yi(i,0),l=new yi(i,Number.POSITIVE_INFINITY);this.ds.forEachInRange([a,l],h=>{r=r.add(h.ls)})}),ge.resolve(this.gs(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let a=r;tt.isDocumentKey(a)||(a=a.child(""));const l=new yi(new tt(a),0);let h=new Un(Xt);return this.ds.forEachWhile(m=>{const v=m.key.path;return!!r.isPrefixOf(v)&&(v.length===i&&(h=h.add(m.ls)),!0)},l),ge.resolve(this.gs(h))}gs(e){const t=[];return e.forEach(r=>{const i=this._s(r);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){Lt(0===this.ys(t.batchId,"removed")),this.mutationQueue.shift();let r=this.ds;return ge.forEach(t.mutations,i=>{const a=new yi(i.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.ds=r})}In(e){}containsKey(e,t){const r=new yi(t,0),i=this.ds.firstAfterOrEqual(r);return ge.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return ge.resolve()}ys(e,t){return this.ws(e)}ws(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}_s(e){const t=this.ws(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class PS{constructor(e){this.ps=e,this.docs=new Er(tt.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),a=i?i.size:0,l=this.ps(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return ge.resolve(r?r.document.mutableCopy():$n.newInvalidDocument(t))}getEntries(e,t){let r=Ki();return t.forEach(i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():$n.newInvalidDocument(i))}),ge.resolve(r)}getAllFromCollection(e,t,r){let i=Ki();const a=new tt(t.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:h,value:{document:m}}=l.getNext();if(!t.isPrefixOf(h.path))break;h.path.length>t.length+1||Av(hd(m),r)<=0||(i=i.insert(m.key,m.mutableCopy()))}return ge.resolve(i)}getAllFromCollectionGroup(e,t,r,i){mt()}Is(e,t){return ge.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Dm(this)}getSize(e){return ge.resolve(this.size)}}class Dm extends Zf{constructor(e){super(),this.zn=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.zn.addEntry(e,i)):this.zn.removeEntry(r)}),ge.waitFor(t)}getFromCache(e,t){return this.zn.getEntry(e,t)}getAllFromCache(e,t){return this.zn.getEntries(e,t)}}class kS{constructor(e){this.persistence=e,this.Ts=new Ao(t=>Ml(t),Mf),this.lastRemoteSnapshotVersion=Ft.min(),this.highestTargetId=0,this.Es=0,this.As=new $b,this.targetCount=0,this.Rs=Au.An()}forEachTarget(e,t){return this.Ts.forEach((r,i)=>t(i)),ge.resolve()}getLastRemoteSnapshotVersion(e){return ge.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ge.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),ge.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Es&&(this.Es=t),ge.resolve()}vn(e){this.Ts.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Rs=new Au(t),this.highestTargetId=t),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,t){return this.vn(t),this.targetCount+=1,ge.resolve()}updateTargetData(e,t){return this.vn(t),ge.resolve()}removeTargetData(e,t){return this.Ts.delete(t.target),this.As.us(t.targetId),this.targetCount-=1,ge.resolve()}removeTargets(e,t,r){let i=0;const a=[];return this.Ts.forEach((l,h)=>{h.sequenceNumber<=t&&null===r.get(h.targetId)&&(this.Ts.delete(l),a.push(this.removeMatchingKeysForTargetId(e,h.targetId)),i++)}),ge.waitFor(a).next(()=>i)}getTargetCount(e){return ge.resolve(this.targetCount)}getTargetData(e,t){const r=this.Ts.get(t)||null;return ge.resolve(r)}addMatchingKeys(e,t,r){return this.As.ss(t,r),ge.resolve()}removeMatchingKeys(e,t,r){this.As.os(t,r);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach(l=>{a.push(i.markPotentiallyOrphaned(e,l))}),ge.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.As.us(t),ge.resolve()}getMatchingKeysForTargetId(e,t){const r=this.As.hs(t);return ge.resolve(r)}containsKey(e,t){return ge.resolve(this.As.containsKey(t))}}class Hb{constructor(e,t){this.bs={},this.overlays={},this.Ps=new qi(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new kS(this),this.indexManager=new xb,this.remoteDocumentCache=new PS(r=>this.referenceDelegate.Ss(r)),this.wt=new Db(t),this.Ds=new MM(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new PM,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.bs[e.toKey()];return r||(r=new kM(t,this.referenceDelegate),this.bs[e.toKey()]=r),r}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,t,r){qe("MemoryPersistence","Starting transaction:",e);const i=new Gb(this.Ps.next());return this.referenceDelegate.Cs(),r(i).next(a=>this.referenceDelegate.xs(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Ns(e,t){return ge.or(Object.values(this.bs).map(r=>()=>r.containsKey(e,t)))}}class Gb extends Rv{constructor(e){super(),this.currentSequenceNumber=e}}class ko{constructor(e){this.persistence=e,this.ks=new $b,this.Os=null}static Ms(e){return new ko(e)}get Fs(){if(this.Os)return this.Os;throw mt()}addReference(e,t,r){return this.ks.addReference(r,t),this.Fs.delete(r.toString()),ge.resolve()}removeReference(e,t,r){return this.ks.removeReference(r,t),this.Fs.add(r.toString()),ge.resolve()}markPotentiallyOrphaned(e,t){return this.Fs.add(t.toString()),ge.resolve()}removeTarget(e,t){this.ks.us(t.targetId).forEach(i=>this.Fs.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(a=>this.Fs.add(a.toString()))}).next(()=>r.removeTargetData(e,t))}Cs(){this.Os=new Set}xs(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ge.forEach(this.Fs,r=>{const i=tt.fromPath(r);return this.$s(e,i).next(a=>{a||t.removeEntry(i,Ft.min())})}).next(()=>(this.Os=null,t.apply(e)))}updateLimboDocument(e,t){return this.$s(e,t).next(r=>{r?this.Fs.delete(t.toString()):this.Fs.add(t.toString())})}Ss(e){return 0}$s(e,t){return ge.or([()=>ge.resolve(this.ks.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ns(e,t)])}}class zb{constructor(e){this.wt=e}O(e,t,r,i){const a=new Tf("createOrUpgrade",t);var h;r<1&&i>=1&&(e.createObjectStore("owner"),(h=e).createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",t0,{unique:!0}),h.createObjectStore("documentMutations"),Tm(e),function(h){h.createObjectStore("remoteDocuments")}(e));let l=ge.resolve();return r<3&&i>=3&&(0!==r&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),Tm(e)),l=l.next(()=>function(h){const m=h.store("targetGlobal"),v={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ft.min().toTimestamp(),targetCount:0};return m.put("targetGlobalKey",v)}(a))),r<4&&i>=4&&(0!==r&&(l=l.next(()=>function(h,m){return m.store("mutations").K().next(v=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",t0,{unique:!0});const C=m.store("mutations"),T=v.map(x=>C.put(x));return ge.waitFor(T)})}(e,a))),l=l.next(()=>{!function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(l=l.next(()=>this.Bs(a))),r<6&&i>=6&&(l=l.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.Ls(a)))),r<7&&i>=7&&(l=l.next(()=>this.Us(a))),r<8&&i>=8&&(l=l.next(()=>this.qs(e,a))),r<9&&i>=9&&(l=l.next(()=>{!function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(l=l.next(()=>this.Ks(a))),r<11&&i>=11&&(l=l.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(l=l.next(()=>{!function(h){const m=h.createObjectStore("documentOverlays",{keyPath:SM});m.createIndex("collectionPathOverlayIndex",pm,{unique:!1}),m.createIndex("collectionGroupOverlayIndex",AM,{unique:!1})}(e)})),r<13&&i>=13&&(l=l.next(()=>function(h){const m=h.createObjectStore("remoteDocumentsV14",{keyPath:yS});m.createIndex("documentKeyIndex",vS),m.createIndex("collectionGroupIndex",vM)}(e)).next(()=>this.Gs(e,a)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(l=l.next(()=>this.Qs(e,a))),r<15&&i>=15&&(l=l.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:bM}).createIndex("sequenceNumberIndex",CM,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:DM}).createIndex("documentKeyIndex",TM,{unique:!1})}(e))),l}Ls(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=Im(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Bs(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.K().next(i=>ge.forEach(i,a=>{const l=IDBKeyRange.bound([a.userId,-1],[a.userId,a.lastAcknowledgedBatchId]);return r.K("userMutationsIndex",l).next(h=>ge.forEach(h,m=>{Lt(m.userId===a.userId);const v=Rd(this.wt,m);return DS(e,a.userId,v).next(()=>{})}))}))}Us(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const a=[];return r.J((l,h)=>{const m=new un(l),v=[0,Li(m)];a.push(t.get(v).next(C=>C?ge.resolve():t.put({targetId:0,path:Li(m),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>ge.waitFor(a))})}qs(e,t){e.createObjectStore("collectionParents",{keyPath:IM});const r=t.store("collectionParents"),i=new vm,a=l=>{if(i.add(l)){const h=l.lastSegment(),m=l.popLast();return r.put({collectionId:h,parent:Li(m)})}};return t.store("remoteDocuments").J({H:!0},(l,h)=>{const m=new un(l);return a(m.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([l,h,m],v)=>{const C=xo(h);return a(C.popLast())}))}Ks(e){const t=e.store("targets");return t.J((r,i)=>{const a=qf(i),l=Tb(this.wt,a);return t.put(l)})}Gs(e,t){const r=t.store("remoteDocuments"),i=[];return r.J((a,l)=>{const h=t.store("remoteDocumentsV14"),m=(v=l,v.document?new tt(un.fromString(v.document.name).popFirst(5)):v.noDocument?tt.fromSegments(v.noDocument.path):v.unknownDocument?tt.fromSegments(v.unknownDocument.path):mt()).path.toArray();var v;const C={prefixPath:m.slice(0,m.length-2),collectionGroup:m[m.length-2],documentId:m[m.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};i.push(h.put(C))}).next(()=>ge.waitFor(i))}Qs(e,t){const r=t.store("mutations"),i=Vb(this.wt),a=new Hb(ko.Ms,this.wt.ne);return r.K().next(l=>{const h=new Map;return l.forEach(m=>{var v;let C=null!==(v=h.get(m.userId))&&void 0!==v?v:Jt();Rd(this.wt,m).keys().forEach(T=>C=C.add(T)),h.set(m.userId,C)}),ge.forEach(h,(m,v)=>{const C=new Jr(v),T=ym.se(this.wt,C),x=a.getIndexManager(C),$=bm.se(C,this.wt,x,a.referenceDelegate);return new jb(i,$,T,x).recalculateAndSaveOverlaysForDocumentKeys(new zf(t,qi.ot),m).next()})})}}function Tm(n){n.createObjectStore("targetDocuments",{keyPath:wM}).createIndex("documentTargetsIndex",EM,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",bb,{unique:!0}),n.createObjectStore("targetGlobal")}const Yf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class p0{constructor(e,t,r,i,a,l,h,m,v,C,T=14){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.js=a,this.window=l,this.document=h,this.Ws=v,this.zs=C,this.Hs=T,this.Ps=null,this.vs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Js=null,this.inForeground=!1,this.Ys=null,this.Xs=null,this.Zs=Number.NEGATIVE_INFINITY,this.ti=x=>Promise.resolve(),!p0.V())throw new Ge(ne.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Fb(this,i),this.ei=t+"main",this.wt=new Db(m),this.ni=new no(this.ei,this.Hs,new zb(this.wt)),this.Vs=new SS(this.referenceDelegate,this.wt),this.remoteDocumentCache=Vb(this.wt),this.Ds=new Rb,this.window&&this.window.localStorage?this.si=this.window.localStorage:(this.si=null,!1===C&&Qn("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ii().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ge(ne.FAILED_PRECONDITION,Yf);return this.ri(),this.oi(),this.ui(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Vs.getHighestSequenceNumber(e))}).then(e=>{this.Ps=new qi(e,this.Ws)}).then(()=>{this.vs=!0}).catch(e=>(this.ni&&this.ni.close(),Promise.reject(e)))}ci(e){var t=this;return this.ti=function(){var r=(0,Ce.Z)(function*(i){if(t.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ni.F(function(){var t=(0,Ce.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.js.enqueueAndForget((0,Ce.Z)(function*(){t.started&&(yield t.ii())})))}ii(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Pd(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ai(e).next(t=>{t||(this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)))})}).next(()=>this.hi(e)).next(t=>this.isPrimary&&!t?this.li(e).next(()=>!1):!!t&&this.fi(e).next(()=>!0))).catch(e=>{if(Al(e))return qe("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return qe("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.js.enqueueRetryable(()=>this.ti(e)),this.isPrimary=e})}ai(e){return Wl(e).get("owner").next(t=>ge.resolve(this.di(t)))}_i(e){return Pd(e).delete(this.clientId)}wi(){var e=this;return(0,Ce.Z)(function*(){if(e.isPrimary&&!e.mi(e.Zs,18e5)){e.Zs=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=ti(r,"clientMetadata");return i.K().next(a=>{const l=e.gi(a,18e5),h=a.filter(m=>-1===l.indexOf(m));return ge.forEach(h,m=>i.delete(m.clientId)).next(()=>h)})}).catch(()=>[]);if(e.si)for(const r of t)e.si.removeItem(e.yi(r.clientId))}})()}ui(){this.Xs=this.js.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ii().then(()=>this.wi()).then(()=>this.ui()))}di(e){return!!e&&e.ownerId===this.clientId}hi(e){return this.zs?ge.resolve(!0):Wl(e).get("owner").next(t=>{if(null!==t&&this.mi(t.leaseTimestampMs,5e3)&&!this.pi(t.ownerId)){if(this.di(t)&&this.networkEnabled)return!0;if(!this.di(t)){if(!t.allowTabSynchronization)throw new Ge(ne.FAILED_PRECONDITION,Yf);return!1}}return!(!this.networkEnabled||!this.inForeground)||Pd(e).K().next(r=>void 0===this.gi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const l=!this.inForeground&&i.inForeground,h=this.networkEnabled===i.networkEnabled;if(!this.networkEnabled&&i.networkEnabled||l&&h)return!0}return!1}))}).next(t=>(this.isPrimary!==t&&qe("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,Ce.Z)(function*(){e.vs=!1,e.Ii(),e.Xs&&(e.Xs.cancel(),e.Xs=null),e.Ti(),e.Ei(),yield e.ni.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const r=new zf(t,qi.ot);return e.li(r).next(()=>e._i(r))}),e.ni.close(),e.Ai()})()}gi(e,t){return e.filter(r=>this.mi(r.updateTimeMs,t)&&!this.pi(r.clientId))}Ri(){return this.runTransaction("getActiveClients","readonly",e=>Pd(e).K().next(t=>this.gi(t,18e5).map(r=>r.clientId)))}get started(){return this.vs}getMutationQueue(e,t){return bm.se(e,this.wt,t,this.referenceDelegate)}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Mb(e,this.wt.ne.databaseId)}getDocumentOverlayCache(e){return ym.se(this.wt,e)}getBundleCache(){return this.Ds}runTransaction(e,t,r){qe("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",a=15===(l=this.Hs)?RM:14===l?o0:13===l?s0:12===l?gm:11===l?r0:void mt();var l;let h;return this.ni.runTransaction(e,i,a,m=>(h=new zf(m,this.Ps?this.Ps.next():qi.ot),"readwrite-primary"===t?this.ai(h).next(v=>!!v||this.hi(h)).next(v=>{if(!v)throw Qn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)),new Ge(ne.FAILED_PRECONDITION,TI);return r(h)}).next(v=>this.fi(h).next(()=>v)):this.bi(h).next(()=>r(h)))).then(m=>(h.raiseOnCommittedEvent(),m))}bi(e){return Wl(e).get("owner").next(t=>{if(null!==t&&this.mi(t.leaseTimestampMs,5e3)&&!this.pi(t.ownerId)&&!this.di(t)&&!(this.zs||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ge(ne.FAILED_PRECONDITION,Yf)})}fi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Wl(e).put("owner",t)}static V(){return no.V()}li(e){const t=Wl(e);return t.get("owner").next(r=>this.di(r)?(qe("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):ge.resolve())}mi(e,t){const r=Date.now();return!(e<r-t||e>r&&(Qn(`Detected an update time that is in the future: ${e} > ${r}`),1))}ri(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ys=()=>{this.js.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.ii()))},this.document.addEventListener("visibilitychange",this.Ys),this.inForeground="visible"===this.document.visibilityState)}Ti(){this.Ys&&(this.document.removeEventListener("visibilitychange",this.Ys),this.Ys=null)}oi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Js=()=>{this.Ii(),(0,N.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.js.enterRestrictedMode(!0),this.js.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Js))}Ei(){this.Js&&(this.window.removeEventListener("pagehide",this.Js),this.Js=null)}pi(e){var t;try{const r=null!==(null===(t=this.si)||void 0===t?void 0:t.getItem(this.yi(e)));return qe("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Qn("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Ii(){if(this.si)try{this.si.setItem(this.yi(this.clientId),String(Date.now()))}catch(e){Qn("Failed to set zombie client id.",e)}}Ai(){if(this.si)try{this.si.removeItem(this.yi(this.clientId))}catch{}}yi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Wl(n){return ti(n,"owner")}function Pd(n){return ti(n,"clientMetadata")}function kd(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Wb{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Pi=r,this.vi=i}static Vi(e,t){let r=Jt(),i=Jt();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Wb(e,t.fromCache,r,i)}}class NS{constructor(){this.Si=!1}initialize(e,t){this.Di=e,this.indexManager=t,this.Si=!0}getDocumentsMatchingQuery(e,t,r,i){return this.Ci(e,t).next(a=>a||this.xi(e,t,i,r)).next(a=>a||this.Ni(e,t))}Ci(e,t){return ge.resolve(null)}xi(e,t,r,i){return function _M(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}(t)||i.isEqual(Ft.min())?this.Ni(e,t):this.Di.getDocuments(e,r).next(a=>{const l=this.ki(t,a);return this.Oi(t,l,r,i)?this.Ni(e,t):(ga()<=Qs.in.DEBUG&&qe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Hv(t)),this.Mi(e,l,t,dd(i,-1)))})}ki(e,t){let r=new Un(YI(e));return t.forEach((i,a)=>{Gv(e,a)&&(r=r.add(a))}),r}Oi(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ni(e,t){return ga()<=Qs.in.DEBUG&&qe("QueryEngine","Using full collection scan to execute query:",Hv(t)),this.Di.getDocumentsMatchingQuery(e,t,ds.min())}Mi(e,t,r,i){return this.Di.getDocumentsMatchingQuery(e,r,i).next(a=>(t.forEach(l=>{a=a.insert(l.key,l)}),a))}}class NM{constructor(e,t,r,i){this.persistence=e,this.Fi=t,this.wt=i,this.$i=new Er(Xt),this.Bi=new Ao(a=>Ml(a),Mf),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(r)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new jb(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.$i))}}function OS(n,e,t,r){return new NM(n,e,t,r)}function g0(n,e){return m0.apply(this,arguments)}function m0(){return m0=(0,Ce.Z)(function*(n,e){const t=it(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(a=>(i=a,t.qi(e),t.mutationQueue.getAllMutationBatches(r))).next(a=>{const l=[],h=[];let m=Jt();for(const v of i){l.push(v.batchId);for(const C of v.mutations)m=m.add(C.key)}for(const v of a){h.push(v.batchId);for(const C of v.mutations)m=m.add(C.key)}return t.localDocuments.getDocuments(r,m).next(v=>({Ki:v,removedBatchIds:l,addedBatchIds:h}))})})}),m0.apply(this,arguments)}function LS(n,e){const t=it(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),a=t.Ui.newChangeBuffer({trackRemovals:!0});return function(l,h,m,v){const C=m.batch,T=C.keys();let x=ge.resolve();return T.forEach($=>{x=x.next(()=>v.getEntry(h,$)).next(Y=>{const Ie=m.docVersions.get($);Lt(null!==Ie),Y.version.compareTo(Ie)<0&&(C.applyToRemoteDocument(Y,m),Y.isValidDocument()&&(Y.setReadTime(m.commitVersion),v.addEntry(Y)))})}),x.next(()=>l.mutationQueue.removeMutationBatch(h,C))}(t,r,e,a).next(()=>a.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let h=Jt();for(let m=0;m<l.mutationResults.length;++m)l.mutationResults[m].transformResults.length>0&&(h=h.add(l.batch.mutations[m].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function qb(n){const e=it(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Vs.getLastRemoteSnapshotVersion(t))}function FS(n,e){const t=it(n),r=e.snapshotVersion;let i=t.$i;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const l=t.Ui.newChangeBuffer({trackRemovals:!0});i=t.$i;const h=[];e.targetChanges.forEach((C,T)=>{const x=i.get(T);if(!x)return;h.push(t.Vs.removeMatchingKeys(a,C.removedDocuments,T).next(()=>t.Vs.addMatchingKeys(a,C.addedDocuments,T)));let $=x.withSequenceNumber(a.currentSequenceNumber);var Y,Ie,Re;e.targetMismatches.has(T)?$=$.withResumeToken(cr.EMPTY_BYTE_STRING,Ft.min()).withLastLimboFreeSnapshotVersion(Ft.min()):C.resumeToken.approximateByteSize()>0&&($=$.withResumeToken(C.resumeToken,r)),i=i.insert(T,$),Ie=$,Re=C,(0===(Y=x).resumeToken.approximateByteSize()||Ie.snapshotVersion.toMicroseconds()-Y.snapshotVersion.toMicroseconds()>=3e8||Re.addedDocuments.size+Re.modifiedDocuments.size+Re.removedDocuments.size>0)&&h.push(t.Vs.updateTargetData(a,$))});let m=Ki(),v=Jt();if(e.documentUpdates.forEach(C=>{e.resolvedLimboDocuments.has(C)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(a,C))}),h.push(_0(a,l,e.documentUpdates).next(C=>{m=C.Gi,v=C.Qi})),!r.isEqual(Ft.min())){const C=t.Vs.getLastRemoteSnapshotVersion(a).next(T=>t.Vs.setTargetsMetadata(a,a.currentSequenceNumber,r));h.push(C)}return ge.waitFor(h).next(()=>l.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,m,v)).next(()=>m)}).then(a=>(t.$i=i,a))}function _0(n,e,t){let r=Jt(),i=Jt();return t.forEach(a=>r=r.add(a)),e.getEntries(n,r).next(a=>{let l=Ki();return t.forEach((h,m)=>{const v=a.get(h);m.isFoundDocument()!==v.isFoundDocument()&&(i=i.add(h)),m.isNoDocument()&&m.version.isEqual(Ft.min())?(e.removeEntry(h,m.readTime),l=l.insert(h,m)):!v.isValidDocument()||m.version.compareTo(v.version)>0||0===m.version.compareTo(v.version)&&v.hasPendingWrites?(e.addEntry(m),l=l.insert(h,m)):qe("LocalStore","Ignoring outdated watch update for ",h,". Current version:",v.version," Watch version:",m.version)}),{Gi:l,Qi:i}})}function Kb(n,e){const t=it(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function ql(n,e){const t=it(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Vs.getTargetData(r,e).next(a=>a?(i=a,ge.resolve(i)):t.Vs.allocateTargetId(r).next(l=>(i=new Vl(e,l,0,r.currentSequenceNumber),t.Vs.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.$i.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.$i=t.$i.insert(r.targetId,r),t.Bi.set(e,r.targetId)),r})}function Nd(n,e,t){return y0.apply(this,arguments)}function y0(){return y0=(0,Ce.Z)(function*(n,e,t){const r=it(n),i=r.$i.get(e),a=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",a,l=>r.persistence.referenceDelegate.removeTarget(l,i)))}catch(l){if(!Al(l))throw l;qe("LocalStore",`Failed to update sequence numbers for target ${e}: ${l}`)}r.$i=r.$i.remove(e),r.Bi.delete(i.target)}),y0.apply(this,arguments)}function Qf(n,e,t){const r=it(n);let i=Ft.min(),a=Jt();return r.persistence.runTransaction("Execute query","readonly",l=>function(h,m,v){const C=it(h),T=C.Bi.get(v);return void 0!==T?ge.resolve(C.$i.get(T)):C.Vs.getTargetData(m,v)}(r,l,Ls(e)).next(h=>{if(h)return i=h.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(l,h.targetId).next(m=>{a=m})}).next(()=>r.Fi.getDocumentsMatchingQuery(l,e,t?i:Ft.min(),t?a:Jt())).next(h=>(v0(r,ZI(e),h),{documents:h,ji:a})))}function Sm(n,e){const t=it(n),r=it(t.Vs),i=t.$i.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",a=>r.te(a,e).next(l=>l?l.target:null))}function US(n,e){const t=it(n),r=t.Li.get(e)||Ft.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Ui.getAllFromCollectionGroup(i,e,dd(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(v0(t,e,i),i))}function v0(n,e,t){let r=Ft.min();t.forEach((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)}),n.Li.set(e,r)}function E0(){return E0=(0,Ce.Z)(function*(n,e,t,r){const i=it(n);let a=Jt(),l=Ki();for(const v of t){const C=e.Wi(v.metadata.name);v.document&&(a=a.add(C));const T=e.zi(v);T.setReadTime(e.Hi(v.metadata.readTime)),l=l.insert(C,T)}const h=i.Ui.newChangeBuffer({trackRemovals:!0}),m=yield ql(i,(v=r,Ls(kl(un.fromString(`__bundle__/docs/${v}`)))));var v;return i.persistence.runTransaction("Apply bundle documents","readwrite",v=>_0(v,h,l).next(C=>(h.apply(v),C)).next(C=>i.Vs.removeMatchingKeysForTargetId(v,m.targetId).next(()=>i.Vs.addMatchingKeys(v,a,m.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(v,C.Gi,C.Qi)).next(()=>C.Gi)))}),E0.apply(this,arguments)}function VS(n,e){return Zb.apply(this,arguments)}function Zb(){return Zb=(0,Ce.Z)(function*(n,e,t=Jt()){const r=yield ql(n,Ls(u0(e.bundledQuery))),i=it(n);return i.persistence.runTransaction("Save named query","readwrite",a=>{const l=ai(e.readTime);if(r.snapshotVersion.compareTo(l)>=0)return i.Ds.saveNamedQuery(a,e);const h=r.withResumeToken(cr.EMPTY_BYTE_STRING,l);return i.$i=i.$i.insert(h.targetId,h),i.Vs.updateTargetData(a,h).next(()=>i.Vs.removeMatchingKeysForTargetId(a,r.targetId)).next(()=>i.Vs.addMatchingKeys(a,t,r.targetId)).next(()=>i.Ds.saveNamedQuery(a,e))})}),Zb.apply(this,arguments)}function BS(n,e){return`firestore_clients_${n}_${e}`}function Yb(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function I0(n,e){return`firestore_targets_${n}_${e}`}class Am{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ji(e,t,r){const i=JSON.parse(r);let a,l="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return l&&i.error&&(l="string"==typeof i.error.message&&"string"==typeof i.error.code,l&&(a=new Ge(i.error.code,i.error.message))),l?new Am(e,t,i.state,a):(Qn("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Rm{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ji(e,t){const r=JSON.parse(t);let i,a="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return a&&r.error&&(a="string"==typeof r.error.message&&"string"==typeof r.error.code,a&&(i=new Ge(r.error.code,r.error.message))),a?new Rm(e,r.state,i):(Qn("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class b0{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ji(e,t){const r=JSON.parse(t);let i="object"==typeof r&&r.activeTargetIds instanceof Array,a=Uf();for(let l=0;i&&l<r.activeTargetIds.length;++l)i=MI(r.activeTargetIds[l]),a=a.add(r.activeTargetIds[l]);return i?new b0(e,a):(Qn("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Qb{constructor(e,t){this.clientId=e,this.onlineState=t}static Ji(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new Qb(t.clientId,t.onlineState):(Qn("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Xb{constructor(){this.activeTargetIds=Uf()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Jb{constructor(e,t,r,i,a){this.window=e,this.js=t,this.persistenceKey=r,this.tr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.er=this.nr.bind(this),this.sr=new Er(Xt),this.started=!1,this.ir=[];const l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.rr=BS(this.persistenceKey,this.tr),this.ur=`firestore_sequence_number_${this.persistenceKey}`,this.sr=this.sr.insert(this.tr,new Xb),this.cr=new RegExp(`^firestore_clients_${l}_([^_]*)$`),this.ar=new RegExp(`^firestore_mutations_${l}_(\\d+)(?:_(.*))?$`),this.hr=new RegExp(`^firestore_targets_${l}_(\\d+)$`),this.lr=`firestore_online_state_${this.persistenceKey}`,this.dr=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.er)}static V(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,Ce.Z)(function*(){const t=yield e.syncEngine.Ri();for(const i of t){if(i===e.tr)continue;const a=e.getItem(BS(e.persistenceKey,i));if(a){const l=b0.Ji(i,a);l&&(e.sr=e.sr.insert(l.clientId,l))}}e._r();const r=e.storage.getItem(e.lr);if(r){const i=e.wr(r);i&&e.mr(i)}for(const i of e.ir)e.nr(i);e.ir=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.ur,JSON.stringify(e))}getAllActiveQueryTargets(){return this.gr(this.sr)}isActiveQueryTarget(e){let t=!1;return this.sr.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.yr(e,"pending")}updateMutationState(e,t,r){this.yr(e,t,r),this.pr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(I0(this.persistenceKey,e));if(r){const i=Rm.Ji(e,r);i&&(t=i.state)}}return this.Ir.Xi(e),this._r(),t}removeLocalQueryTarget(e){this.Ir.Zi(e),this._r()}isLocalQueryTarget(e){return this.Ir.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(I0(this.persistenceKey,e))}updateQueryState(e,t,r){this.Tr(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.pr(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Er(e)}notifyBundleLoaded(e){this.Ar(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.er),this.removeItem(this.rr),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return qe("SharedClientState","READ",e,t),t}setItem(e,t){qe("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){qe("SharedClientState","REMOVE",e),this.storage.removeItem(e)}nr(e){var t=this;const r=e;if(r.storageArea===this.storage){if(qe("SharedClientState","EVENT",r.key,r.newValue),r.key===this.rr)return void Qn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.js.enqueueRetryable((0,Ce.Z)(function*(){if(t.started){if(null!==r.key)if(t.cr.test(r.key)){if(null==r.newValue){const i=t.Rr(r.key);return t.br(i,null)}{const i=t.Pr(r.key,r.newValue);if(i)return t.br(i.clientId,i)}}else if(t.ar.test(r.key)){if(null!==r.newValue){const i=t.vr(r.key,r.newValue);if(i)return t.Vr(i)}}else if(t.hr.test(r.key)){if(null!==r.newValue){const i=t.Sr(r.key,r.newValue);if(i)return t.Dr(i)}}else if(r.key===t.lr){if(null!==r.newValue){const i=t.wr(r.newValue);if(i)return t.mr(i)}}else if(r.key===t.ur){const i=function(a){let l=qi.ot;if(null!=a)try{const h=JSON.parse(a);Lt("number"==typeof h),l=h}catch(h){Qn("SharedClientState","Failed to read sequence number from WebStorage",h)}return l}(r.newValue);i!==qi.ot&&t.sequenceNumberHandler(i)}else if(r.key===t.dr){const i=t.Cr(r.newValue);yield Promise.all(i.map(a=>t.syncEngine.Nr(a)))}}else t.ir.push(r)}))}}get Ir(){return this.sr.get(this.tr)}_r(){this.setItem(this.rr,this.Ir.Yi())}yr(e,t,r){const i=new Am(this.currentUser,e,t,r),a=Yb(this.persistenceKey,this.currentUser,e);this.setItem(a,i.Yi())}pr(e){const t=Yb(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Er(e){this.storage.setItem(this.lr,JSON.stringify({clientId:this.tr,onlineState:e}))}Tr(e,t,r){const i=I0(this.persistenceKey,e),a=new Rm(e,t,r);this.setItem(i,a.Yi())}Ar(e){const t=JSON.stringify(Array.from(e));this.setItem(this.dr,t)}Rr(e){const t=this.cr.exec(e);return t?t[1]:null}Pr(e,t){const r=this.Rr(e);return b0.Ji(r,t)}vr(e,t){const r=this.ar.exec(e),i=Number(r[1]);return Am.Ji(new Jr(void 0!==r[2]?r[2]:null),i,t)}Sr(e,t){const r=this.hr.exec(e),i=Number(r[1]);return Rm.Ji(i,t)}wr(e){return Qb.Ji(e)}Cr(e){return JSON.parse(e)}Vr(e){var t=this;return(0,Ce.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.kr(e.batchId,e.state,e.error);qe("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Dr(e){return this.syncEngine.Or(e.targetId,e.state,e.error)}br(e,t){const r=t?this.sr.insert(e,t):this.sr.remove(e),i=this.gr(this.sr),a=this.gr(r),l=[],h=[];return a.forEach(m=>{i.has(m)||l.push(m)}),i.forEach(m=>{a.has(m)||h.push(m)}),this.syncEngine.Mr(l,h).then(()=>{this.sr=r})}mr(e){this.sr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}gr(e){let t=Uf();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class eC{constructor(){this.Fr=new Xb,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,t,r){this.$r[e]=t}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new Xb,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class OM{Br(e){}shutdown(){}}class jS{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){qe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){qe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const LM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class FM{constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}class UM extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.so=(e.ssl?"https":"http")+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,t,r,i,a){const l=this.oo(e,t);qe("RestConnection","Sending: ",l,r);const h={};return this.uo(h,i,a),this.co(e,l,h,r).then(m=>(qe("RestConnection","Received: ",m),m),m=>{throw Zg("RestConnection",`${e} failed with error: `,m,"url: ",l,"request:",r),m})}ao(e,t,r,i,a,l){return this.ro(e,t,r,i,a)}uo(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+Dl,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,a)=>e[a]=i),r&&r.headers.forEach((i,a)=>e[a]=i)}oo(e,t){return`${this.so}/v1/${t}:${LM[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,t,r,i){return new Promise((a,l)=>{const h=new II;h.listenOnce(vI.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Kg.NO_ERROR:const v=h.getResponseJson();qe("Connection","XHR received:",JSON.stringify(v)),a(v);break;case Kg.TIMEOUT:qe("Connection",'RPC "'+e+'" timed out'),l(new Ge(ne.DEADLINE_EXCEEDED,"Request time out"));break;case Kg.HTTP_ERROR:const C=h.getStatus();if(qe("Connection",'RPC "'+e+'" failed with status:',C,"response text:",h.getResponseText()),C>0){const T=h.getResponseJson().error;if(T&&T.status&&T.message){const x=function($){const Y=$.toLowerCase().replace(/_/g,"-");return Object.values(ne).indexOf(Y)>=0?Y:ne.UNKNOWN}(T.status);l(new Ge(x,T.message))}else l(new Ge(ne.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new Ge(ne.UNAVAILABLE,"Connection failed."));break;default:mt()}}finally{qe("Connection",'RPC "'+e+'" completed.')}});const m=JSON.stringify(i);h.send(t,"POST",m,r,15)})}ho(e,t,r){const i=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=BT(),l=jT(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(h.xmlHttpFactory=new EI({})),this.uo(h.initMessageHeaders,t,r),(0,N.uI)()||(0,N.b$)()||(0,N.d)()||(0,N.w1)()||(0,N.Mn)()||(0,N.ru)()||(h.httpHeadersOverwriteParam="$httpHeaders");const m=i.join("");qe("Connection","Creating WebChannel: "+m,h);const v=a.createWebChannel(m,h);let C=!1,T=!1;const x=new FM({jr:Y=>{T?qe("Connection","Not sending because WebChannel is closed:",Y):(C||(qe("Connection","Opening WebChannel transport."),v.open(),C=!0),qe("Connection","WebChannel sending:",Y),v.send(Y))},Wr:()=>v.close()}),$=(Y,Ie,Re)=>{Y.listen(Ie,_t=>{try{Re(_t)}catch(Et){setTimeout(()=>{throw Et},0)}})};return $(v,Ef.EventType.OPEN,()=>{T||qe("Connection","WebChannel transport opened.")}),$(v,Ef.EventType.CLOSE,()=>{T||(T=!0,qe("Connection","WebChannel transport closed"),x.eo())}),$(v,Ef.EventType.ERROR,Y=>{T||(T=!0,Zg("Connection","WebChannel transport errored:",Y),x.eo(new Ge(ne.UNAVAILABLE,"The operation could not be completed")))}),$(v,Ef.EventType.MESSAGE,Y=>{var Ie;if(!T){const Re=Y.data[0];Lt(!!Re);const _t=Re,Et=_t.error||(null===(Ie=_t[0])||void 0===Ie?void 0:Ie.error);if(Et){qe("Connection","WebChannel received error:",Et);const vt=Et.status;let wt=function(sn){const li=Or[sn];if(void 0!==li)return Kv(li)}(vt),Wt=Et.message;void 0===wt&&(wt=ne.INTERNAL,Wt="Unknown error status: "+vt+" with message "+Et.message),T=!0,x.eo(new Ge(wt,Wt)),v.close()}else qe("Connection","WebChannel received:",Re),x.no(Re)}}),$(l,wI.STAT_EVENT,Y=>{Y.stat===Cv.PROXY?qe("Connection","Detected buffering proxy"):Y.stat===Cv.NOPROXY&&qe("Connection","Detected no buffering proxy")}),setTimeout(()=>{x.Zr()},0),x}}function $S(){return typeof window<"u"?window:null}function s(){return typeof document<"u"?document:null}function o(n){return new mb(n,!0)}class u{constructor(e,t,r=1e3,i=1.5,a=6e4){this.js=e,this.timerId=t,this.lo=r,this.fo=i,this._o=a,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const t=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),i=Math.max(0,t-r);i>0&&qe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.wo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,i,()=>(this.yo=Date.now(),e())),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}cancel(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}class c{constructor(e,t,r,i,a,l,h,m){this.js=e,this.Ao=r,this.Ro=i,this.bo=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=h,this.listener=m,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new u(e,t)}Do(){return 1===this.state||5===this.state||this.Co()}Co(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.xo()}stop(){var e=this;return(0,Ce.Z)(function*(){e.Do()&&(yield e.close(0))})()}No(){this.state=0,this.So.reset()}ko(){this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,()=>this.Oo()))}Mo(e){this.Fo(),this.stream.send(e)}Oo(){var e=this;return(0,Ce.Z)(function*(){if(e.Co())return e.close(0)})()}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}close(e,t){var r=this;return(0,Ce.Z)(function*(){r.Fo(),r.$o(),r.So.cancel(),r.Po++,4!==e?r.So.reset():t&&t.code===ne.RESOURCE_EXHAUSTED?(Qn(t.toString()),Qn("Using maximum backoff delay to prevent overloading the backend."),r.So.po()):t&&t.code===ne.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.Bo(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Jr(t)})()}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),t=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Po===t&&this.Uo(r,i)},r=>{e(()=>{const i=new Ge(ne.UNKNOWN,"Fetching auth token failed: "+r.message);return this.qo(i)})})}Uo(e,t){const r=this.Lo(this.Po);this.stream=this.Ko(e,t),this.stream.zr(()=>{r(()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,()=>(this.Co()&&(this.state=3),Promise.resolve())),this.listener.zr()))}),this.stream.Jr(i=>{r(()=>this.qo(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}xo(){var e=this;this.state=5,this.So.Io((0,Ce.Z)(function*(){e.state=0,e.start()}))}qo(e){return qe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return t=>{this.js.enqueueAndForget(()=>this.Po===e?t():(qe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class d extends c{constructor(e,t,r,i,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,l),this.wt=a}Ko(e,t){return this.bo.ho("Listen",e,t)}onMessage(e){this.So.reset();const t=function lS(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(m=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===m?1:"REMOVE"===m?2:"CURRENT"===m?3:"RESET"===m?4:mt(),i=e.targetChange.targetIds||[],a=function(m,v){return m.dt?(Lt(void 0===v||"string"==typeof v),cr.fromBase64String(v||"")):(Lt(void 0===v||v instanceof Uint8Array),cr.fromUint8Array(v||new Uint8Array))}(n,e.targetChange.resumeToken),l=e.targetChange.cause,h=l&&function(m){const v=void 0===m.code?ne.UNKNOWN:Kv(m.code);return new Ge(v,m.message||"")}(l);t=new Ti(r,i,a,h||null)}else if("documentChange"in e){const r=e.documentChange,i=Ro(n,r.document.name),a=ai(r.document.updateTime),l=new ei({mapValue:{fields:r.document.fields}}),h=$n.newFoundDocument(i,a,l);t=new Bf(r.targetIds||[],r.removedTargetIds||[],h.key,h)}else if("documentDelete"in e){const r=e.documentDelete,i=Ro(n,r.document),a=r.readTime?ai(r.readTime):Ft.min(),l=$n.newNoDocument(i,a);t=new Bf([],r.removedTargetIds||[],l.key,l)}else if("documentRemove"in e){const r=e.documentRemove,i=Ro(n,r.document);t=new Bf([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return mt();{const r=e.filter,a=new qv(r.count||0);t=new fb(r.targetId,a)}}var m;return t}(this.wt,e),r=function(i){if(!("targetChange"in i))return Ft.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Ft.min():a.readTime?ai(a.readTime):Ft.min()}(e);return this.listener.Go(t,r)}Qo(e){const t={};t.database=Cd(this.wt),t.addTarget=function(i,a){let l;const h=a.target;return l=sm(h)?{documents:Xv(i,h)}:{query:fm(i,h)},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0?l.resumeToken=_b(i,a.resumeToken):a.snapshotVersion.compareTo(Ft.min())>0&&(l.readTime=Ca(i,a.snapshotVersion.toTimestamp())),l}(this.wt,e);const r=function hS(n,e){const t=function(r,i){switch(i){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return mt()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.Mo(t)}jo(e){const t={};t.database=Cd(this.wt),t.removeTarget=e,this.Mo(t)}}class f extends c{constructor(e,t,r,i,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,l),this.wt=a,this.Wo=!1}get zo(){return this.Wo}start(){this.Wo=!1,this.lastStreamToken=void 0,super.start()}Bo(){this.Wo&&this.Ho([])}Ko(e,t){return this.bo.ho("Write",e,t)}onMessage(e){if(Lt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();const t=function cS(n,e){return n&&n.length>0?(Lt(void 0!==e),n.map(t=>function(r,i){let a=ai(r.updateTime?r.updateTime:i);return a.isEqual(Ft.min())&&(a=ai(i)),new Of(a,r.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=ai(e.commitTime);return this.listener.Jo(r,t)}return Lt(!e.writeResults||0===e.writeResults.length),this.Wo=!0,this.listener.Yo()}Xo(){const e={};e.database=Cd(this.wt),this.Mo(e)}Ho(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Dd(this.wt,r))};this.Mo(t)}}class y extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.bo=r,this.wt=i,this.Zo=!1}tu(){if(this.Zo)throw new Ge(ne.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,t,r){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.bo.ro(e,t,r,i,a)).catch(i=>{throw"FirebaseError"===i.name?(i.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ge(ne.UNKNOWN,i.toString())})}ao(e,t,r,i){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.bo.ao(e,t,r,a,l,i)).catch(a=>{throw"FirebaseError"===a.name?(a.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ge(ne.UNKNOWN,a.toString())})}terminate(){this.Zo=!0}}class E{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve())))}uu(e){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,"Online"===e&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(Qn(t),this.su=!1):qe("OnlineStateTracker",t)}cu(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}class b{constructor(e,t,r,i,a){var l=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=a,this.du.Br(h=>{r.enqueueAndForget((0,Ce.Z)(function*(){var m;Be(l)&&(qe("RemoteStore","Restarting streams for network reachability change."),yield(m=(0,Ce.Z)(function*(v){const C=it(v);C.lu.add(4),yield V(C),C._u.set("Unknown"),C.lu.delete(4),yield D(C)}),function(v){return m.apply(this,arguments)})(l))}))}),this._u=new E(r,i)}}function D(n){return A.apply(this,arguments)}function A(){return A=(0,Ce.Z)(function*(n){if(Be(n))for(const e of n.fu)yield e(!0)}),A.apply(this,arguments)}function V(n){return ee.apply(this,arguments)}function ee(){return ee=(0,Ce.Z)(function*(n){for(const e of n.fu)yield e(!1)}),ee.apply(this,arguments)}function ce(n,e){const t=it(n);t.hu.has(e.targetId)||(t.hu.set(e.targetId,e),Mt(t)?ct(t):Mm(t).Co()&&Ye(t,e))}function Ae(n,e){const t=it(n),r=Mm(t);t.hu.delete(e),r.Co()&&nt(t,e),0===t.hu.size&&(r.Co()?r.ko():Be(t)&&t._u.set("Unknown"))}function Ye(n,e){n.wu.Nt(e.targetId),Mm(n).Qo(e)}function nt(n,e){n.wu.Nt(e),Mm(n).jo(e)}function ct(n){n.wu=new oS({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),te:e=>n.hu.get(e)||null}),Mm(n).start(),n._u.iu()}function Mt(n){return Be(n)&&!Mm(n).Do()&&n.hu.size>0}function Be(n){return 0===it(n).lu.size}function zt(n){n.wu=void 0}function ir(n){return hr.apply(this,arguments)}function hr(){return hr=(0,Ce.Z)(function*(n){n.hu.forEach((e,t)=>{Ye(n,e)})}),hr.apply(this,arguments)}function VM(n,e){return HS.apply(this,arguments)}function HS(){return HS=(0,Ce.Z)(function*(n,e){zt(n),Mt(n)?(n._u.uu(e),ct(n)):n._u.set("Unknown")}),HS.apply(this,arguments)}function U1(n,e,t){return GS.apply(this,arguments)}function GS(){return GS=(0,Ce.Z)(function*(n,e,t){if(n._u.set("Online"),e instanceof Ti&&2===e.state&&e.cause)try{yield(r=(0,Ce.Z)(function*(i,a){const l=a.cause;for(const h of a.targetIds)i.hu.has(h)&&(yield i.remoteSyncer.rejectListen(h,l),i.hu.delete(h),i.wu.removeTarget(h))}),function(i,a){return r.apply(this,arguments)})(n,e)}catch(r){qe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield tC(n,r)}else if(e instanceof Bf?n.wu.Ut(e):e instanceof fb?n.wu.zt(e):n.wu.Gt(e),!t.isEqual(Ft.min()))try{const r=yield qb(n.localStore);t.compareTo(r)>=0&&(yield function(i,a){const l=i.wu.Yt(a);return l.targetChanges.forEach((h,m)=>{if(h.resumeToken.approximateByteSize()>0){const v=i.hu.get(m);v&&i.hu.set(m,v.withResumeToken(h.resumeToken,a))}}),l.targetMismatches.forEach(h=>{const m=i.hu.get(h);if(!m)return;i.hu.set(h,m.withResumeToken(cr.EMPTY_BYTE_STRING,m.snapshotVersion)),nt(i,h);const v=new Vl(m.target,h,1,m.sequenceNumber);Ye(i,v)}),i.remoteSyncer.applyRemoteEvent(l)}(n,t))}catch(r){qe("RemoteStore","Failed to raise snapshot:",r),yield tC(n,r)}var r}),GS.apply(this,arguments)}function tC(n,e,t){return zS.apply(this,arguments)}function zS(){return zS=(0,Ce.Z)(function*(n,e,t){if(!Al(e))throw e;n.lu.add(1),yield V(n),n._u.set("Offline"),t||(t=()=>qb(n.localStore)),n.asyncQueue.enqueueRetryable((0,Ce.Z)(function*(){qe("RemoteStore","Retrying IndexedDB access"),yield t(),n.lu.delete(1),yield D(n)}))}),zS.apply(this,arguments)}function BM(n,e){return e().catch(t=>tC(n,t,e))}function xm(n){return WS.apply(this,arguments)}function WS(){return WS=(0,Ce.Z)(function*(n){const e=it(n),t=Od(e);let r=e.au.length>0?e.au[e.au.length-1].batchId:-1;for(;V1(e);)try{const i=yield Kb(e.localStore,r);if(null===i){0===e.au.length&&t.ko();break}r=i.batchId,B1(e,i)}catch(i){yield tC(e,i)}jM(e)&&$M(e)}),WS.apply(this,arguments)}function V1(n){return Be(n)&&n.au.length<10}function B1(n,e){n.au.push(e);const t=Od(n);t.Co()&&t.zo&&t.Ho(e.mutations)}function jM(n){return Be(n)&&!Od(n).Do()&&n.au.length>0}function $M(n){Od(n).start()}function j1(n){return qS.apply(this,arguments)}function qS(){return qS=(0,Ce.Z)(function*(n){Od(n).Xo()}),qS.apply(this,arguments)}function $1(n){return KS.apply(this,arguments)}function KS(){return KS=(0,Ce.Z)(function*(n){const e=Od(n);for(const t of n.au)e.Ho(t.mutations)}),KS.apply(this,arguments)}function H1(n,e,t){return ZS.apply(this,arguments)}function ZS(){return ZS=(0,Ce.Z)(function*(n,e,t){const r=n.au.shift(),i=mm.from(r,e,t);yield BM(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield xm(n)}),ZS.apply(this,arguments)}function G1(n,e){return YS.apply(this,arguments)}function YS(){return YS=(0,Ce.Z)(function*(n,e){var t;e&&Od(n).zo&&(yield(t=(0,Ce.Z)(function*(r,i){if(lm(a=i.code)&&a!==ne.ABORTED){const l=r.au.shift();Od(r).No(),yield BM(r,()=>r.remoteSyncer.rejectFailedWrite(l.batchId,i)),yield xm(r)}var a}),function(r,i){return t.apply(this,arguments)})(n,e)),jM(n)&&$M(n)}),YS.apply(this,arguments)}function HM(n,e){return QS.apply(this,arguments)}function QS(){return QS=(0,Ce.Z)(function*(n,e){const t=it(n);t.asyncQueue.verifyOperationInProgress(),qe("RemoteStore","RemoteStore received new credentials");const r=Be(t);t.lu.add(3),yield V(t),r&&t._u.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.lu.delete(3),yield D(t)}),QS.apply(this,arguments)}function XS(n,e){return JS.apply(this,arguments)}function JS(){return JS=(0,Ce.Z)(function*(n,e){const t=it(n);e?(t.lu.delete(2),yield D(t)):e||(t.lu.add(2),yield V(t),t._u.set("Unknown"))}),JS.apply(this,arguments)}function Mm(n){return n.mu||(n.mu=function(e,t,r){const i=it(e);return i.tu(),new d(t,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)}(n.datastore,n.asyncQueue,{zr:ir.bind(null,n),Jr:VM.bind(null,n),Go:U1.bind(null,n)}),n.fu.push(function(){var e=(0,Ce.Z)(function*(t){t?(n.mu.No(),Mt(n)?ct(n):n._u.set("Unknown")):(yield n.mu.stop(),zt(n))});return function(t){return e.apply(this,arguments)}}())),n.mu}function Od(n){return n.gu||(n.gu=function(e,t,r){const i=it(e);return i.tu(),new f(t,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)}(n.datastore,n.asyncQueue,{zr:j1.bind(null,n),Jr:G1.bind(null,n),Yo:$1.bind(null,n),Jo:H1.bind(null,n)}),n.fu.push(function(){var e=(0,Ce.Z)(function*(t){t?(n.gu.No(),yield xm(n)):(yield n.gu.stop(),n.au.length>0&&(qe("RemoteStore",`Stopping write stream with ${n.au.length} pending writes`),n.au=[]))});return function(t){return e.apply(this,arguments)}}())),n.gu}class eA{constructor(e,t,r,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new oi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}static createAndSchedule(e,t,r,i,a){const l=Date.now()+r,h=new eA(e,t,l,i,a);return h.start(r),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ge(ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Pm(n,e){if(Qn("AsyncQueue",`${e}: ${n}`),Al(n))return new Ge(ne.UNAVAILABLE,`${e}: ${n}`);throw n}class km{constructor(e){this.comparator=e?(t,r)=>e(t,r)||tt.comparator(t.key,r.key):(t,r)=>tt.comparator(t.key,r.key),this.keyedMap=Ff(),this.sortedSet=new Er(this.comparator)}static emptySet(e){return new km(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof km)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new km;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class GM{constructor(){this.yu=new Er(tt.comparator)}track(e){const t=e.doc.key,r=this.yu.get(t);r?0!==e.type&&3===r.type?this.yu=this.yu.insert(t,e):3===e.type&&1!==r.type?this.yu=this.yu.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.yu=this.yu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.yu=this.yu.remove(t):1===e.type&&2===r.type?this.yu=this.yu.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):mt():this.yu=this.yu.insert(t,e)}pu(){const e=[];return this.yu.inorderTraversal((t,r)=>{e.push(r)}),e}}class Nm{constructor(e,t,r,i,a,l,h,m){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=h,this.excludesMetadataChanges=m}static fromInitialDocuments(e,t,r,i){const a=[];return t.forEach(l=>{a.push({type:0,doc:l})}),new Nm(e,t,km.emptySet(t),a,r,i,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&kf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class z1{constructor(){this.Iu=void 0,this.listeners=[]}}class W1{constructor(){this.queries=new Ao(e=>KI(e),kf),this.onlineState="Unknown",this.Tu=new Set}}function tA(n,e){return nA.apply(this,arguments)}function nA(){return nA=(0,Ce.Z)(function*(n,e){const t=it(n),r=e.query;let i=!1,a=t.queries.get(r);if(a||(i=!0,a=new z1),i)try{a.Iu=yield t.onListen(r)}catch(l){const h=Pm(l,`Initialization of query '${Hv(e.query)}' failed`);return void e.onError(h)}t.queries.set(r,a),a.listeners.push(e),e.Eu(t.onlineState),a.Iu&&e.Au(a.Iu)&&sA(t)}),nA.apply(this,arguments)}function rA(n,e){return iA.apply(this,arguments)}function iA(){return iA=(0,Ce.Z)(function*(n,e){const t=it(n),r=e.query;let i=!1;const a=t.queries.get(r);if(a){const l=a.listeners.indexOf(e);l>=0&&(a.listeners.splice(l,1),i=0===a.listeners.length)}if(i)return t.queries.delete(r),t.onUnlisten(r)}),iA.apply(this,arguments)}function q1(n,e){const t=it(n);let r=!1;for(const i of e){const l=t.queries.get(i.query);if(l){for(const h of l.listeners)h.Au(i)&&(r=!0);l.Iu=i}}r&&sA(t)}function K1(n,e,t){const r=it(n),i=r.queries.get(e);if(i)for(const a of i.listeners)a.onError(t);r.queries.delete(e)}function sA(n){n.Tu.forEach(e=>{e.next()})}class oA{constructor(e,t,r){this.query=e,this.Ru=t,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=r||{}}Au(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new Nm(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),t=!0):this.Vu(e,this.onlineState)&&(this.Su(e),t=!0),this.Pu=e,t}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let t=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),t=!0),t}Vu(e,t){return!e.fromCache||!(this.options.Du&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}vu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Su(e){e=Nm.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}class Z1{constructor(e,t){this.payload=e,this.byteLength=t}Cu(){return"metadata"in this.payload}}class zM{constructor(e){this.wt=e}Wi(e){return Ro(this.wt,e)}zi(e){return e.metadata.exists?uS(this.wt,e.document,!1):$n.newNoDocument(this.Wi(e.metadata.name),this.Hi(e.metadata.readTime))}Hi(e){return ai(e)}}class Y1{constructor(e,t,r){this.xu=e,this.localStore=t,this.wt=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=WM(e)}Nu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t;const r=un.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ku(e){const t=new Map,r=new zM(this.wt);for(const i of e)if(i.metadata.queries){const a=r.Wi(i.metadata.name);for(const l of i.metadata.queries){const h=(t.get(l)||Jt()).add(a);t.set(l,h)}}return t}complete(){var e=this;return(0,Ce.Z)(function*(){const t=yield function w0(n,e,t,r){return E0.apply(this,arguments)}(e.localStore,new zM(e.wt),e.documents,e.xu.id),r=e.ku(e.documents);for(const i of e.queries)yield VS(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,Ou:e.collectionGroups,Mu:t}})()}}function WM(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class qM{constructor(e){this.key=e}}class KM{constructor(e){this.key=e}}class ZM{constructor(e,t){this.query=e,this.Fu=t,this.$u=null,this.current=!1,this.Bu=Jt(),this.mutatedKeys=Jt(),this.Lu=YI(e),this.Uu=new km(this.Lu)}get qu(){return this.Fu}Ku(e,t){const r=t?t.Gu:new GM,i=t?t.Uu:this.Uu;let a=t?t.mutatedKeys:this.mutatedKeys,l=i,h=!1;const m="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,v="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((C,T)=>{const x=i.get(C),$=Gv(this.query,T)?T:null,Y=!!x&&this.mutatedKeys.has(x.key),Ie=!!$&&($.hasLocalMutations||this.mutatedKeys.has($.key)&&$.hasCommittedMutations);let Re=!1;x&&$?x.data.isEqual($.data)?Y!==Ie&&(r.track({type:3,doc:$}),Re=!0):this.Qu(x,$)||(r.track({type:2,doc:$}),Re=!0,(m&&this.Lu($,m)>0||v&&this.Lu($,v)<0)&&(h=!0)):!x&&$?(r.track({type:0,doc:$}),Re=!0):x&&!$&&(r.track({type:1,doc:x}),Re=!0,(m||v)&&(h=!0)),Re&&($?(l=l.add($),a=Ie?a.add(C):a.delete(C)):(l=l.delete(C),a=a.delete(C)))}),null!==this.query.limit)for(;l.size>this.query.limit;){const C="F"===this.query.limitType?l.last():l.first();l=l.delete(C.key),a=a.delete(C.key),r.track({type:1,doc:C})}return{Uu:l,Gu:r,Oi:h,mutatedKeys:a}}Qu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const i=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const a=e.Gu.pu();a.sort((v,C)=>function(T,x){const $=Y=>{switch(Y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return mt()}};return $(T)-$(x)}(v.type,C.type)||this.Lu(v.doc,C.doc)),this.ju(r);const l=t?this.Wu():[],h=0===this.Bu.size&&this.current?1:0,m=h!==this.$u;return this.$u=h,0!==a.length||m?{snapshot:new Nm(this.query,e.Uu,i,a,e.mutatedKeys,0===h,m,!1),zu:l}:{zu:l}}Eu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new GM,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach(t=>this.Fu=this.Fu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Fu=this.Fu.delete(t)),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=Jt(),this.Uu.forEach(r=>{this.Hu(r.key)&&(this.Bu=this.Bu.add(r.key))});const t=[];return e.forEach(r=>{this.Bu.has(r)||t.push(new KM(r))}),this.Bu.forEach(r=>{e.has(r)||t.push(new qM(r))}),t}Ju(e){this.Fu=e.ji,this.Bu=Jt();const t=this.Ku(e.documents);return this.applyChanges(t,!0)}Yu(){return Nm.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}class Q1{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class X1{constructor(e){this.key=e,this.Xu=!1}}class J1{constructor(e,t,r,i,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.Zu={},this.tc=new Ao(h=>KI(h),kf),this.ec=new Map,this.nc=new Set,this.sc=new Er(tt.comparator),this.ic=new Map,this.rc=new $b,this.oc={},this.uc=new Map,this.cc=Au.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return!0===this.ac}}function eL(n,e){return aA.apply(this,arguments)}function aA(){return aA=(0,Ce.Z)(function*(n,e){const t=xA(n);let r,i;const a=t.tc.get(e);if(a)r=a.targetId,t.sharedClientState.addLocalQueryTarget(r),i=a.view.Yu();else{const l=yield ql(t.localStore,Ls(e));t.isPrimaryClient&&ce(t.remoteStore,l);const h=t.sharedClientState.addLocalQueryTarget(l.targetId);r=l.targetId,i=yield uA(t,e,r,"current"===h)}return i}),aA.apply(this,arguments)}function uA(n,e,t,r){return lA.apply(this,arguments)}function lA(){return lA=(0,Ce.Z)(function*(n,e,t,r){n.hc=(C,T,x)=>{return($=(0,Ce.Z)(function*(Y,Ie,Re,_t){let Et=Ie.view.Ku(Re);Et.Oi&&(Et=yield Qf(Y.localStore,Ie.query,!1).then(({documents:Wt})=>Ie.view.Ku(Wt,Et)));const vt=_t&&_t.targetChanges.get(Ie.targetId),wt=Ie.view.applyChanges(Et,Y.isPrimaryClient,vt);return vA(Y,Ie.targetId,wt.zu),wt.snapshot}),function(Y,Ie,Re,_t){return $.apply(this,arguments)})(n,C,T,x);var $};const i=yield Qf(n.localStore,e,!0),a=new ZM(e,i.ji),l=a.Ku(i.documents),h=Vf.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState),m=a.applyChanges(l,n.isPrimaryClient,h);vA(n,t,m.zu);const v=new Q1(e,t,a);return n.tc.set(e,v),n.ec.has(t)?n.ec.get(t).push(e):n.ec.set(t,[e]),m.snapshot}),lA.apply(this,arguments)}function tL(n,e){return cA.apply(this,arguments)}function cA(){return cA=(0,Ce.Z)(function*(n,e){const t=it(n),r=t.tc.get(e),i=t.ec.get(r.targetId);if(i.length>1)return t.ec.set(r.targetId,i.filter(a=>!kf(a,e))),void t.tc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Nd(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),Ae(t.remoteStore,r.targetId),Om(t,r.targetId)}).catch(ma))):(Om(t,r.targetId),yield Nd(t.localStore,r.targetId,!0))}),cA.apply(this,arguments)}function dA(){return dA=(0,Ce.Z)(function*(n,e,t){const r=MA(n);try{const i=yield function(a,l){const h=it(a),m=rr.now(),v=l.reduce((x,$)=>x.add($.key),Jt());let C,T;return h.persistence.runTransaction("Locally write mutations","readwrite",x=>{let $=Ki(),Y=Jt();return h.Ui.getEntries(x,v).next(Ie=>{$=Ie,$.forEach((Re,_t)=>{_t.isValidDocument()||(Y=Y.add(Re))})}).next(()=>h.localDocuments.getOverlayedDocuments(x,$)).next(Ie=>{C=Ie;const Re=[];for(const _t of l){const Et=iS(_t,C.get(_t.key).overlayedDocument);null!=Et&&Re.push(new Fs(_t.key,Et,im(Et.value.mapValue),dr.exists(!0)))}return h.mutationQueue.addMutationBatch(x,m,Re,l)}).next(Ie=>{T=Ie;const Re=Ie.applyToLocalDocumentSet(C,Y);return h.documentOverlayCache.saveOverlays(x,Ie.batchId,Re)})}).then(()=>({batchId:T.batchId,changes:cb(C)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,l,h){let m=a.oc[a.currentUser.toKey()];m||(m=new Er(Xt)),m=m.insert(l,h),a.oc[a.currentUser.toKey()]=m}(r,i.batchId,t),yield Kl(r,i.changes),yield xm(r.remoteStore)}catch(i){const a=Pm(i,"Failed to persist write");t.reject(a)}}),dA.apply(this,arguments)}function YM(n,e){return hA.apply(this,arguments)}function hA(){return hA=(0,Ce.Z)(function*(n,e){const t=it(n);try{const r=yield FS(t.localStore,e);e.targetChanges.forEach((i,a)=>{const l=t.ic.get(a);l&&(Lt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?l.Xu=!0:i.modifiedDocuments.size>0?Lt(l.Xu):i.removedDocuments.size>0&&(Lt(l.Xu),l.Xu=!1))}),yield Kl(t,r,e)}catch(r){yield ma(r)}}),hA.apply(this,arguments)}function QM(n,e,t){const r=it(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const i=[];r.tc.forEach((a,l)=>{const h=l.view.Eu(e);h.snapshot&&i.push(h.snapshot)}),function(a,l){const h=it(a);h.onlineState=l;let m=!1;h.queries.forEach((v,C)=>{for(const T of C.listeners)T.Eu(l)&&(m=!0)}),m&&sA(h)}(r.eventManager,e),i.length&&r.Zu.Go(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function rL(n,e,t){return fA.apply(this,arguments)}function fA(){return fA=(0,Ce.Z)(function*(n,e,t){const r=it(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.ic.get(e),a=i&&i.key;if(a){let l=new Er(tt.comparator);l=l.insert(a,$n.newNoDocument(a,Ft.min()));const h=Jt().add(a),m=new bd(Ft.min(),new Map,new Un(Xt),l,h);yield YM(r,m),r.sc=r.sc.remove(a),r.ic.delete(e),wA(r)}else yield Nd(r.localStore,e,!1).then(()=>Om(r,e,t)).catch(ma)}),fA.apply(this,arguments)}function iL(n,e){return pA.apply(this,arguments)}function pA(){return pA=(0,Ce.Z)(function*(n,e){const t=it(n),r=e.batch.batchId;try{const i=yield LS(t.localStore,e);yA(t,r,null),_A(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Kl(t,i)}catch(i){yield ma(i)}}),pA.apply(this,arguments)}function sL(n,e,t){return gA.apply(this,arguments)}function gA(){return gA=(0,Ce.Z)(function*(n,e,t){const r=it(n);try{const i=yield function(a,l){const h=it(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let v;return h.mutationQueue.lookupMutationBatch(m,l).next(C=>(Lt(null!==C),v=C.keys(),h.mutationQueue.removeMutationBatch(m,C))).next(()=>h.mutationQueue.performConsistencyCheck(m)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(m,v,l)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,v)).next(()=>h.localDocuments.getDocuments(m,v))})}(r.localStore,e);yA(r,e,t),_A(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Kl(r,i)}catch(i){yield ma(i)}}),gA.apply(this,arguments)}function mA(){return mA=(0,Ce.Z)(function*(n,e){const t=it(n);Be(t.remoteStore)||qe("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(a){const l=it(a);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>l.mutationQueue.getHighestUnacknowledgedBatchId(h))}(t.localStore);if(-1===r)return void e.resolve();const i=t.uc.get(r)||[];i.push(e),t.uc.set(r,i)}catch(r){const i=Pm(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),mA.apply(this,arguments)}function _A(n,e){(n.uc.get(e)||[]).forEach(t=>{t.resolve()}),n.uc.delete(e)}function yA(n,e,t){const r=it(n);let i=r.oc[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),r.oc[r.currentUser.toKey()]=i}}function Om(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.ec.get(e))n.tc.delete(r),t&&n.Zu.lc(r,t);n.ec.delete(e),n.isPrimaryClient&&n.rc.us(e).forEach(r=>{n.rc.containsKey(r)||XM(n,r)})}function XM(n,e){n.nc.delete(e.path.canonicalString());const t=n.sc.get(e);null!==t&&(Ae(n.remoteStore,t),n.sc=n.sc.remove(e),n.ic.delete(t),wA(n))}function vA(n,e,t){for(const r of t)r instanceof qM?(n.rc.addReference(r.key,e),aL(n,r)):r instanceof KM?(qe("SyncEngine","Document no longer in limbo: "+r.key),n.rc.removeReference(r.key,e),n.rc.containsKey(r.key)||XM(n,r.key)):mt()}function aL(n,e){const t=e.key,r=t.path.canonicalString();n.sc.get(t)||n.nc.has(r)||(qe("SyncEngine","New document in limbo: "+t),n.nc.add(r),wA(n))}function wA(n){for(;n.nc.size>0&&n.sc.size<n.maxConcurrentLimboResolutions;){const e=n.nc.values().next().value;n.nc.delete(e);const t=new tt(un.fromString(e)),r=n.cc.next();n.ic.set(r,new X1(t)),n.sc=n.sc.insert(t,r),ce(n.remoteStore,new Vl(Ls(kl(t.path)),r,2,qi.ot))}}function Kl(n,e,t){return EA.apply(this,arguments)}function EA(){return EA=(0,Ce.Z)(function*(n,e,t){const r=it(n),i=[],a=[],l=[];var h;r.tc.isEmpty()||(r.tc.forEach((h,m)=>{l.push(r.hc(m,e,t).then(v=>{if(v){r.isPrimaryClient&&r.sharedClientState.updateQueryState(m.targetId,v.fromCache?"not-current":"current"),i.push(v);const C=Wb.Vi(m.targetId,v);a.push(C)}}))}),yield Promise.all(l),r.Zu.Go(i),yield(h=(0,Ce.Z)(function*(m,v){const C=it(m);try{yield C.persistence.runTransaction("notifyLocalViewChanges","readwrite",T=>ge.forEach(v,x=>ge.forEach(x.Pi,$=>C.persistence.referenceDelegate.addReference(T,x.targetId,$)).next(()=>ge.forEach(x.vi,$=>C.persistence.referenceDelegate.removeReference(T,x.targetId,$)))))}catch(T){if(!Al(T))throw T;qe("LocalStore","Failed to update sequence numbers: "+T)}for(const T of v){const x=T.targetId;if(!T.fromCache){const $=C.$i.get(x),Ie=$.withLastLimboFreeSnapshotVersion($.snapshotVersion);C.$i=C.$i.insert(x,Ie)}}}),function(m,v){return h.apply(this,arguments)})(r.localStore,a))}),EA.apply(this,arguments)}function uL(n,e){return IA.apply(this,arguments)}function IA(){return IA=(0,Ce.Z)(function*(n,e){const t=it(n);if(!t.currentUser.isEqual(e)){qe("SyncEngine","User change. New user:",e.toKey());const r=yield g0(t.localStore,e);t.currentUser=e,(i=t).uc.forEach(l=>{l.forEach(h=>{h.reject(new Ge(ne.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.uc.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Kl(t,r.Ki)}var i}),IA.apply(this,arguments)}function lL(n,e){const t=it(n),r=t.ic.get(e);if(r&&r.Xu)return Jt().add(r.key);{let i=Jt();const a=t.ec.get(e);if(!a)return i;for(const l of a){const h=t.tc.get(l);i=i.unionWith(h.view.qu)}return i}}function cL(n,e){return bA.apply(this,arguments)}function bA(){return bA=(0,Ce.Z)(function*(n,e){const t=it(n),r=yield Qf(t.localStore,e.query,!0),i=e.view.Ju(r);return t.isPrimaryClient&&vA(t,e.targetId,i.zu),i}),bA.apply(this,arguments)}function dL(n,e){return CA.apply(this,arguments)}function CA(){return CA=(0,Ce.Z)(function*(n,e){const t=it(n);return US(t.localStore,e).then(r=>Kl(t,r))}),CA.apply(this,arguments)}function hL(n,e,t,r){return DA.apply(this,arguments)}function DA(){return DA=(0,Ce.Z)(function*(n,e,t,r){const i=it(n),a=yield function(l,h){const m=it(l),v=it(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",C=>v.yn(C,h).next(T=>T?m.localDocuments.getDocuments(C,T):ge.resolve(null)))}(i.localStore,e);var h;null!==a?("pending"===t?yield xm(i.remoteStore):"acknowledged"===t||"rejected"===t?(yA(i,e,r||null),_A(i,e),h=e,it(it(i.localStore).mutationQueue).In(h)):mt(),yield Kl(i,a)):qe("SyncEngine","Cannot apply mutation batch with id: "+e)}),DA.apply(this,arguments)}function TA(){return TA=(0,Ce.Z)(function*(n,e){const t=it(n);if(xA(t),MA(t),!0===e&&!0!==t.ac){const r=t.sharedClientState.getAllActiveQueryTargets(),i=yield JM(t,r.toArray());t.ac=!0,yield XS(t.remoteStore,!0);for(const a of i)ce(t.remoteStore,a)}else if(!1===e&&!1!==t.ac){const r=[];let i=Promise.resolve();t.ec.forEach((a,l)=>{t.sharedClientState.isLocalQueryTarget(l)?r.push(l):i=i.then(()=>(Om(t,l),Nd(t.localStore,l,!0))),Ae(t.remoteStore,l)}),yield i,yield JM(t,r),function(a){const l=it(a);l.ic.forEach((h,m)=>{Ae(l.remoteStore,m)}),l.rc.cs(),l.ic=new Map,l.sc=new Er(tt.comparator)}(t),t.ac=!1,yield XS(t.remoteStore,!1)}}),TA.apply(this,arguments)}function JM(n,e,t){return SA.apply(this,arguments)}function SA(){return SA=(0,Ce.Z)(function*(n,e,t){const r=it(n),i=[],a=[];for(const l of e){let h;const m=r.ec.get(l);if(m&&0!==m.length){h=yield ql(r.localStore,Ls(m[0]));for(const v of m){const C=r.tc.get(v),T=yield cL(r,C);T.snapshot&&a.push(T.snapshot)}}else{const v=yield Sm(r.localStore,l);h=yield ql(r.localStore,v),yield uA(r,eP(v),l,!1)}i.push(h)}return r.Zu.Go(a),i}),SA.apply(this,arguments)}function eP(n){return WI(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function pL(n){const e=it(n);return it(it(e.localStore).persistence).Ri()}function gL(n,e,t,r){return AA.apply(this,arguments)}function AA(){return AA=(0,Ce.Z)(function*(n,e,t,r){const i=it(n);if(i.ac)return void qe("SyncEngine","Ignoring unexpected query state notification.");const a=i.ec.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const l=yield US(i.localStore,ZI(a[0])),h=bd.createSynthesizedRemoteEventForCurrentChange(e,"current"===t);yield Kl(i,l,h);break}case"rejected":yield Nd(i.localStore,e,!0),Om(i,e,r);break;default:mt()}}),AA.apply(this,arguments)}function mL(n,e,t){return RA.apply(this,arguments)}function RA(){return RA=(0,Ce.Z)(function*(n,e,t){const r=xA(n);if(r.ac){for(const i of e){if(r.ec.has(i)){qe("SyncEngine","Adding an already active target "+i);continue}const a=yield Sm(r.localStore,i),l=yield ql(r.localStore,a);yield uA(r,eP(a),l.targetId,!1),ce(r.remoteStore,l)}for(const i of t)r.ec.has(i)&&(yield Nd(r.localStore,i,!1).then(()=>{Ae(r.remoteStore,i),Om(r,i)}).catch(ma))}}),RA.apply(this,arguments)}function xA(n){const e=it(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=YM.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=lL.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=rL.bind(null,e),e.Zu.Go=q1.bind(null,e.eventManager),e.Zu.lc=K1.bind(null,e.eventManager),e}function MA(n){const e=it(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=iL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=sL.bind(null,e),e}class tP{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,Ce.Z)(function*(){t.wt=o(e.databaseInfo.databaseId),t.sharedClientState=t.dc(e),t.persistence=t._c(e),yield t.persistence.start(),t.localStore=t.wc(e),t.gcScheduler=t.mc(e,t.localStore),t.indexBackfillerScheduler=t.gc(e,t.localStore)})()}mc(e,t){return null}gc(e,t){return null}wc(e){return OS(this.persistence,new NS,e.initialUser,this.wt)}_c(e){return new Hb(ko.Ms,this.wt)}dc(e){return new eC}terminate(){var e=this;return(0,Ce.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class nP extends tP{constructor(e,t,r){super(),this.yc=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,Ce.Z)(function*(){yield t().call(r,e),yield r.yc.initialize(r,e),yield MA(r.yc.syncEngine),yield xm(r.yc.remoteStore),yield r.persistence.ci(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}wc(e){return OS(this.persistence,new NS,e.initialUser,this.wt)}mc(e,t){return new Ob(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}gc(e,t){const r=new tm(t,this.persistence);return new AI(e.asyncQueue,r)}_c(e){const t=kd(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?Zi.withCacheSize(this.cacheSizeBytes):Zi.DEFAULT;return new p0(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,$S(),s(),this.wt,this.sharedClientState,!!this.forceOwnership)}dc(e){return new eC}}class yL extends nP{constructor(e,t){super(e,t,!1),this.yc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,Ce.Z)(function*(){yield t().call(r,e);const i=r.yc.syncEngine;r.sharedClientState instanceof Jb&&(r.sharedClientState.syncEngine={kr:hL.bind(null,i),Or:gL.bind(null,i),Mr:mL.bind(null,i),Ri:pL.bind(null,i),Nr:dL.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.ci(function(){var a=(0,Ce.Z)(function*(l){yield function fL(n,e){return TA.apply(this,arguments)}(r.yc.syncEngine,l),r.gcScheduler&&(l&&!r.gcScheduler.started?r.gcScheduler.start():l||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(l&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():l||r.indexBackfillerScheduler.stop())});return function(l){return a.apply(this,arguments)}}())})()}dc(e){const t=$S();if(!Jb.V(t))throw new Ge(ne.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=kd(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Jb(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class PA{initialize(e,t){var r=this;return(0,Ce.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>QM(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=uL.bind(null,r.syncEngine),yield XS(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new W1}createDatastore(e){const t=o(e.databaseInfo.databaseId),r=new UM(e.databaseInfo);return new y(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,i=e.asyncQueue,a=h=>QM(this.syncEngine,h,0),l=jS.V()?new jS:new OM,new b(t,r,i,a,l);var t,r,i,a,l}createSyncEngine(e,t){return function(r,i,a,l,h,m,v){const C=new J1(r,i,a,l,h,m);return v&&(C.ac=!0),C}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,Ce.Z)(function*(t){const r=it(t);qe("RemoteStore","RemoteStore shutting down."),r.lu.add(5),yield V(r),r.du.shutdown(),r._u.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function rP(n,e=10240){let t=0;return{read:()=>(0,Ce.Z)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,Ce.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class nC{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class vL{constructor(e,t){this.Ec=e,this.wt=t,this.metadata=new oi,this.buffer=new Uint8Array,this.Ac=new TextDecoder("utf-8"),this.Rc().then(r=>{r&&r.Cu()?this.metadata.resolve(r.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.payload)}`))},r=>this.metadata.reject(r))}close(){return this.Ec.cancel()}getMetadata(){var e=this;return(0,Ce.Z)(function*(){return e.metadata.promise})()}fc(){var e=this;return(0,Ce.Z)(function*(){return yield e.getMetadata(),e.Rc()})()}Rc(){var e=this;return(0,Ce.Z)(function*(){const t=yield e.bc();if(null===t)return null;const r=e.Ac.decode(t),i=Number(r);isNaN(i)&&e.Pc(`length string (${r}) is not valid number`);const a=yield e.vc(i);return new Z1(JSON.parse(a),t.length+i)})()}Vc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}bc(){var e=this;return(0,Ce.Z)(function*(){for(;e.Vc()<0&&!(yield e.Sc()););if(0===e.buffer.length)return null;const t=e.Vc();t<0&&e.Pc("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}vc(e){var t=this;return(0,Ce.Z)(function*(){for(;t.buffer.length<e;)(yield t.Sc())&&t.Pc("Reached the end of bundle when more is expected.");const r=t.Ac.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}Pc(e){throw this.Ec.cancel(),new Error(`Invalid bundle format: ${e}`)}Sc(){var e=this;return(0,Ce.Z)(function*(){const t=yield e.Ec.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class wL{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,Ce.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new Ge(ne.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,Ce.Z)(function*(a,l){const h=it(a),m=Cd(h.wt)+"/documents",v={documents:l.map($=>jf(h.wt,$))},C=yield h.ao("BatchGetDocuments",m,v,l.length),T=new Map;C.forEach($=>{const Y=function vb(n,e){return"found"in e?function(t,r){Lt(!!r.found);const i=Ro(t,r.found.name),a=ai(r.found.updateTime),l=new ei({mapValue:{fields:r.found.fields}});return $n.newFoundDocument(i,a,l)}(n,e):"missing"in e?function(t,r){Lt(!!r.missing),Lt(!!r.readTime);const i=Ro(t,r.missing),a=ai(r.readTime);return $n.newNoDocument(i,a)}(n,e):mt()}(h.wt,$);T.set(Y.key.toString(),Y)});const x=[];return l.forEach($=>{const Y=T.get($.toString());Lt(!!Y),x.push(Y)}),x}),function(a,l){return i.apply(this,arguments)})(t.datastore,e);var i;return r.forEach(i=>t.recordVersion(i)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ll(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,Ce.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,i)=>{const a=tt.fromPath(i);e.mutations.push(new um(a,e.precondition(a)))}),yield(r=(0,Ce.Z)(function*(i,a){const l=it(i),h=Cd(l.wt)+"/documents",m={writes:a.map(v=>Dd(l.wt,v))};yield l.ro("Commit",h,m)}),function(i,a){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw mt();t=Ft.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new Ge(ne.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?dr.updateTime(t):dr.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ft.min()))throw new Ge(ne.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return dr.updateTime(t)}return dr.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class EL{constructor(e,t,r,i,a){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=a,this.Dc=r.maxAttempts,this.So=new u(this.asyncQueue,"transaction_retry")}run(){this.Dc-=1,this.Cc()}Cc(){var e=this;this.So.Io((0,Ce.Z)(function*(){const t=new wL(e.datastore),r=e.xc(t);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(a=>{e.Nc(a)}))}).catch(i=>{e.Nc(i)})}))}xc(e){try{const t=this.updateFunction(e);return!gd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Nc(e){this.Dc>0&&this.kc(e)?(this.Dc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Cc(),Promise.resolve()))):this.deferred.reject(e)}kc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||!lm(t)}return!1}}class IL{constructor(e,t,r,i){var a=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Jr.UNAUTHENTICATED,this.clientId=Tv.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var l=(0,Ce.Z)(function*(h){qe("FirestoreClient","Received user=",h.uid),yield a.authCredentialListener(h),a.user=h});return function(h){return l.apply(this,arguments)}}()),this.appCheckCredentials.start(r,l=>(qe("FirestoreClient","Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}getConfiguration(){var e=this;return(0,Ce.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Ge(ne.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new oi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,Ce.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=Pm(r,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function iP(n,e){return kA.apply(this,arguments)}function kA(){return kA=(0,Ce.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),qe("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var i=(0,Ce.Z)(function*(a){r.isEqual(a)||(yield g0(e.localStore,a),r=a)});return function(a){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=e}),kA.apply(this,arguments)}function sP(n,e){return NA.apply(this,arguments)}function NA(){return NA=(0,Ce.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield OA(n);qe("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(i=>HM(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,a)=>HM(e.remoteStore,a)),n.onlineComponents=e}),NA.apply(this,arguments)}function OA(n){return LA.apply(this,arguments)}function LA(){return LA=(0,Ce.Z)(function*(n){return n.offlineComponents||(qe("FirestoreClient","Using default OfflineComponentProvider"),yield iP(n,new tP)),n.offlineComponents}),LA.apply(this,arguments)}function rC(n){return FA.apply(this,arguments)}function FA(){return FA=(0,Ce.Z)(function*(n){return n.onlineComponents||(qe("FirestoreClient","Using default OnlineComponentProvider"),yield sP(n,new PA)),n.onlineComponents}),FA.apply(this,arguments)}function oP(n){return OA(n).then(e=>e.persistence)}function UA(n){return OA(n).then(e=>e.localStore)}function aP(n){return rC(n).then(e=>e.remoteStore)}function VA(n){return rC(n).then(e=>e.syncEngine)}function Lm(n){return BA.apply(this,arguments)}function BA(){return BA=(0,Ce.Z)(function*(n){const e=yield rC(n),t=e.eventManager;return t.onListen=eL.bind(null,e.syncEngine),t.onUnlisten=tL.bind(null,e.syncEngine),t}),BA.apply(this,arguments)}function uP(n,e,t={}){const r=new oi;return n.asyncQueue.enqueueAndForget((0,Ce.Z)(function*(){return function(i,a,l,h,m){const v=new nC({next:T=>{a.enqueueAndForget(()=>rA(i,C));const x=T.docs.has(l);!x&&T.fromCache?m.reject(new Ge(ne.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&T.fromCache&&h&&"server"===h.source?m.reject(new Ge(ne.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(T)},error:T=>m.reject(T)}),C=new oA(kl(l.path),v,{includeMetadataChanges:!0,Du:!0});return tA(i,C)}(yield Lm(n),n.asyncQueue,e,t,r)})),r.promise}function lP(n,e,t={}){const r=new oi;return n.asyncQueue.enqueueAndForget((0,Ce.Z)(function*(){return function(i,a,l,h,m){const v=new nC({next:T=>{a.enqueueAndForget(()=>rA(i,C)),T.fromCache&&"server"===h.source?m.reject(new Ge(ne.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(T)},error:T=>m.reject(T)}),C=new oA(l,v,{includeMetadataChanges:!0,Du:!0});return tA(i,C)}(yield Lm(n),n.asyncQueue,e,t,r)})),r.promise}const cP=new Map;function jA(n,e,t){if(!t)throw new Ge(ne.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function dP(n,e,t,r){if(!0===e&&!0===r)throw new Ge(ne.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function hP(n){if(!tt.isDocumentKey(n))throw new Ge(ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function fP(n){if(tt.isDocumentKey(n))throw new Ge(ne.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function iC(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":mt()}function In(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ge(ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=iC(n);throw new Ge(ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function pP(n,e){if(e<=0)throw new Ge(ne.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class gP{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Ge(ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Ge(ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,dP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class C0{constructor(e,t,r){this._authCredentials=t,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gP({}),this._settingsFrozen=!1,e instanceof ya?this._databaseId=e:(this._app=e,this._databaseId=function(i){if(!Object.prototype.hasOwnProperty.apply(i.options,["projectId"]))throw new Ge(ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ya(i.options.projectId)}(e))}get app(){if(!this._app)throw new Ge(ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Ge(ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gP(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new cd;switch(t.type){case"gapi":const r=t.client;return Lt(!("object"!=typeof r||null===r||!r.auth||!r.auth.getAuthHeaderValueForFirstParty)),new wr(r,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Ge(ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=cP.get(e);t&&(qe("ComponentProvider","Removing Datastore"),cP.delete(e),t.terminate())}(this),Promise.resolve()}}class fr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ru(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new fr(this.firestore,e,this._key)}}class Yi{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Yi(this.firestore,e,this._query)}}class Ru extends Yi{constructor(e,t,r){super(e,t,kl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new fr(this.firestore,null,new tt(e))}withConverter(e){return new Ru(this.firestore,e,this._path)}}function mP(n,e,...t){if(n=(0,N.m9)(n),jA("collection","path",e),n instanceof C0){const r=un.fromString(e,...t);return fP(r),new Ru(n,null,r)}{if(!(n instanceof fr||n instanceof Ru))throw new Ge(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(un.fromString(e,...t));return fP(r),new Ru(n.firestore,null,r)}}function sC(n,e,...t){if(n=(0,N.m9)(n),1===arguments.length&&(e=Tv.I()),jA("doc","path",e),n instanceof C0){const r=un.fromString(e,...t);return hP(r),new fr(n,null,new tt(r))}{if(!(n instanceof fr||n instanceof Ru))throw new Ge(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(un.fromString(e,...t));return hP(r),new fr(n.firestore,n instanceof Ru?n.converter:null,new tt(r))}}function _P(n,e){return n=(0,N.m9)(n),e=(0,N.m9)(e),(n instanceof fr||n instanceof Ru)&&(e instanceof fr||e instanceof Ru)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function yP(n,e){return n=(0,N.m9)(n),e=(0,N.m9)(e),n instanceof Yi&&e instanceof Yi&&n.firestore===e.firestore&&kf(n._query,e._query)&&n.converter===e.converter}class kL{constructor(){this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new u(this,"async_queue_retry"),this.Kc=()=>{const t=s();t&&qe("AsyncQueue","Visibility state changed to "+t.visibilityState),this.So.Eo()};const e=s();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const t=s();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise(()=>{});const t=new oi;return this.Qc(()=>this.Fc&&this.Uc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Mc.push(e),this.jc()))}jc(){var e=this;return(0,Ce.Z)(function*(){if(0!==e.Mc.length){try{yield e.Mc[0](),e.Mc.shift(),e.So.reset()}catch(t){if(!Al(t))throw t;qe("AsyncQueue","Operation failed with retryable error: "+t)}e.Mc.length>0&&e.So.Io(()=>e.jc())}})()}Qc(e){const t=this.Oc.then(()=>(this.Lc=!0,e().catch(r=>{throw this.Bc=r,this.Lc=!1,Qn("INTERNAL UNHANDLED ERROR: ",function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+"\n"+a.stack),l}(r)),r}).then(r=>(this.Lc=!1,r))));return this.Oc=t,t}enqueueAfterDelay(e,t,r){this.Gc(),this.qc.indexOf(e)>-1&&(t=0);const i=eA.createAndSchedule(this,e,t,r,a=>this.Wc(a));return this.$c.push(i),i}Gc(){this.Bc&&mt()}verifyOperationInProgress(){}zc(){var e=this;return(0,Ce.Z)(function*(){let t;do{t=e.Oc,yield t}while(t!==e.Oc)})()}Hc(e){for(const t of this.$c)if(t.timerId===e)return!0;return!1}Jc(e){return this.zc().then(()=>{this.$c.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.$c)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.zc()})}Yc(e){this.qc.push(e)}Wc(e){const t=this.$c.indexOf(e);this.$c.splice(t,1)}}function $A(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const r=e;for(const i of["next","error","complete"])if(i in r&&"function"==typeof r[i])return!0;return!1}(n)}class NL{constructor(){this._progressObserver={},this._taskCompletionResolver=new oi,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class br extends C0{constructor(e,t,r){super(e,t,r),this.type="firestore",this._queue=new kL,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||vP(this),this._firestoreClient.terminate()}}function ui(n){return n._firestoreClient||vP(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function vP(n){var e;const t=n._freezeSettings(),r=(a=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new Pv(n._databaseId,a,n._persistenceKey,(h=t).host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,h.useFetchStreams));var a,h;n._firestoreClient=new IL(n._authCredentials,n._appCheckCredentials,n._queue,r)}function wP(n,e,t){const r=new oi;return n.asyncQueue.enqueue((0,Ce.Z)(function*(){try{yield iP(n,t),yield sP(n,e),r.resolve()}catch(i){const a=i;if(!("FirebaseError"===(l=a).name?l.code===ne.FAILED_PRECONDITION||l.code===ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||22===l.code||20===l.code||11===l.code))throw a;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+a),r.reject(a)}var l})).then(()=>r.promise)}function EP(n){if(n._initialized||n._terminated)throw new Ge(ne.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Zl{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Ge(ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Nr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class xu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new xu(cr.fromBase64String(e))}catch(t){throw new Ge(ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new xu(cr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Xf{constructor(e){this._methodName=e}}class oC{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ge(ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ge(ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Xt(this._lat,e._lat)||Xt(this._long,e._long)}}const GL=/^__.*__$/;class zL{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new Fs(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ed(e,this.data,t,this.fieldTransforms)}}class IP{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Fs(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function bP(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw mt()}}class aC{constructor(e,t,r,i,a,l){this.settings=e,this.databaseId=t,this.wt=r,this.ignoreUndefinedProperties=i,void 0===a&&this.Xc(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Zc(){return this.settings.Zc}ta(e){return new aC(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ea(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.ta({path:r,na:!1});return i.sa(e),i}ia(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.ta({path:r,na:!1});return i.Xc(),i}ra(e){return this.ta({path:void 0,na:!0})}oa(e){return cC(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.sa(this.path.get(e))}sa(e){if(0===e.length)throw this.oa("Document fields must not be empty");if(bP(this.Zc)&&GL.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}class WL{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.wt=r||o(e)}aa(e,t,r,i=!1){return new aC({Zc:e,methodName:t,ca:r,path:Nr.emptyPath(),na:!1,ua:i},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}function Jf(n){const e=n._freezeSettings(),t=o(n._databaseId);return new WL(n._databaseId,!!e.ignoreUndefinedProperties,t)}function uC(n,e,t,r,i,a={}){const l=n.aa(a.merge||a.mergeFields?2:0,e,t,i);WA("Data must be an object, but it was:",l,r);const h=TP(r,l);let m,v;if(a.merge)m=new hs(l.fieldMask),v=l.fieldTransforms;else if(a.mergeFields){const C=[];for(const T of a.mergeFields){const x=qA(e,T,t);if(!l.contains(x))throw new Ge(ne.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);AP(C,x)||C.push(x)}m=new hs(C),v=l.fieldTransforms.filter(T=>m.covers(T.field))}else m=null,v=l.fieldTransforms;return new zL(new ei(h),m,v)}class D0 extends Xf{_toFieldTransform(e){if(2!==e.Zc)throw e.oa(1===e.Zc?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof D0}}function CP(n,e,t){return new aC({Zc:3,ca:e.settings.ca,methodName:n._methodName,na:t},e.databaseId,e.wt,e.ignoreUndefinedProperties)}class HA extends Xf{_toFieldTransform(e){return new Nf(e.path,new Nl)}isEqual(e){return e instanceof HA}}class qL extends Xf{constructor(e,t){super(e),this.ha=t}_toFieldTransform(e){const t=CP(this,e,!0),r=this.ha.map(a=>ep(a,t)),i=new Cu(r);return new Nf(e.path,i)}isEqual(e){return this===e}}class KL extends Xf{constructor(e,t){super(e),this.ha=t}_toFieldTransform(e){const t=CP(this,e,!0),r=this.ha.map(a=>ep(a,t)),i=new Ol(r);return new Nf(e.path,i)}isEqual(e){return this===e}}class ZL extends Xf{constructor(e,t){super(e),this.la=t}_toFieldTransform(e){const t=new vd(e.wt,JI(e.wt,this.la));return new Nf(e.path,t)}isEqual(e){return this===e}}function GA(n,e,t,r){const i=n.aa(1,e,t);WA("Data must be an object, but it was:",i,r);const a=[],l=ei.empty();vu(r,(m,v)=>{const C=lC(e,m,t);v=(0,N.m9)(v);const T=i.ia(C);if(v instanceof D0)a.push(C);else{const x=ep(v,T);null!=x&&(a.push(C),l.set(C,x))}});const h=new hs(a);return new IP(l,h,i.fieldTransforms)}function zA(n,e,t,r,i,a){const l=n.aa(1,e,t),h=[qA(e,r,t)],m=[i];if(a.length%2!=0)throw new Ge(ne.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<a.length;x+=2)h.push(qA(e,a[x])),m.push(a[x+1]);const v=[],C=ei.empty();for(let x=h.length-1;x>=0;--x)if(!AP(v,h[x])){const $=h[x];let Y=m[x];Y=(0,N.m9)(Y);const Ie=l.ia($);if(Y instanceof D0)v.push($);else{const Re=ep(Y,Ie);null!=Re&&(v.push($),C.set($,Re))}}const T=new hs(v);return new IP(C,T,l.fieldTransforms)}function DP(n,e,t,r=!1){return ep(t,n.aa(r?4:3,e))}function ep(n,e){if(SP(n=(0,N.m9)(n)))return WA("Unsupported field value:",e,n),TP(n,e);if(n instanceof Xf)return function(t,r){if(!bP(r.Zc))throw r.oa(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r.oa(`${t._methodName}() is not currently supported inside arrays`);const i=t._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.na&&4!==e.Zc)throw e.oa("Nested arrays are not supported");return function(t,r){const i=[];let a=0;for(const l of t){let h=ep(l,r.ra(a));null==h&&(h={nullValue:"NULL_VALUE"}),i.push(h),a++}return{arrayValue:{values:i}}}(n,e)}return function(t,r){if(null===(t=(0,N.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return JI(r.wt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const i=rr.fromDate(t);return{timestampValue:Ca(r.wt,i)}}if(t instanceof rr){const i=new rr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Ca(r.wt,i)}}if(t instanceof oC)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof xu)return{bytesValue:_b(r.wt,t._byteString)};if(t instanceof fr){const i=r.databaseId,a=t.firestore._databaseId;if(!a.isEqual(i))throw r.oa(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:dm(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r.oa(`Unsupported field value: ${iC(t)}`)}(n,e)}function TP(n,e){const t={};return pd(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):vu(n,(r,i)=>{const a=ep(i,e.ea(r));null!=a&&(t[r]=a)}),{mapValue:{fields:t}}}function SP(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof rr||n instanceof oC||n instanceof xu||n instanceof fr||n instanceof Xf)}function WA(n,e,t){if(!SP(t)||"object"!=typeof(r=t)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=iC(t);throw e.oa("an object"===r?n+" a custom object":n+" "+r)}var r}function qA(n,e,t){if((e=(0,N.m9)(e))instanceof Zl)return e._internalPath;if("string"==typeof e)return lC(n,e);throw cC("Field path arguments must be of type string or ",n,!1,void 0,t)}const YL=new RegExp("[~\\*/\\[\\]]");function lC(n,e,t){if(e.search(YL)>=0)throw cC(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Zl(...e.split("."))._internalPath}catch{throw cC(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function cC(n,e,t,r,i){const a=r&&!r.isEmpty(),l=void 0!==i;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let m="";return(a||l)&&(m+=" (found",a&&(m+=` in field ${r}`),l&&(m+=` in document ${i}`),m+=")"),new Ge(ne.INVALID_ARGUMENT,h+n+m)}function AP(n,e){return n.some(t=>t.isEqual(e))}class T0{constructor(e,t,r,i,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new fr(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new QL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(dC("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class QL extends T0{data(){return super.data()}}function dC(n,e){return"string"==typeof e?lC(n,e):e instanceof Zl?e._internalPath:e._delegate._internalPath}class tp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Yl extends T0{constructor(e,t,r,i,a,l){super(e,t,r,i,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new S0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(dC("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class S0 extends Yl{data(e={}){return super.data(e)}}class Ld{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new tp(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new S0(this._firestore,this._userDataWriter,r.key,r,new tp(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ge(ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(l=>({type:"added",doc:new S0(r._firestore,r._userDataWriter,l.doc.key,l.doc,new tp(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:a++}))}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>i||3!==l.type).map(l=>{const h=new S0(r._firestore,r._userDataWriter,l.doc.key,l.doc,new tp(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let m=-1,v=-1;return 0!==l.type&&(m=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),1!==l.type&&(a=a.add(l.doc),v=a.indexOf(l.doc.key)),{type:XL(l.type),doc:h,oldIndex:m,newIndex:v}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function XL(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return mt()}}function RP(n,e){return n instanceof Yl&&e instanceof Yl?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Ld&&e instanceof Ld&&n._firestore===e._firestore&&yP(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function xP(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new Ge(ne.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class A0{}function Fd(n,...e){for(const t of e)n=t._apply(n);return n}class JL extends A0{constructor(e,t,r){super(),this.fa=e,this.da=t,this._a=r,this.type="where"}_apply(e){const t=Jf(e.firestore),r=function(i,a,l,h,m,v,C){let T;if(m.isKeyField()){if("array-contains"===v||"array-contains-any"===v)throw new Ge(ne.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if("in"===v||"not-in"===v){LP(C,v);const $=[];for(const Y of C)$.push(OP(h,i,Y));T={arrayValue:{values:$}}}else T=OP(h,i,C)}else"in"!==v&&"not-in"!==v&&"array-contains-any"!==v||LP(C,v),T=DP(l,"where",C,"in"===v||"not-in"===v);const x=Di.create(m,v,T);return function($,Y){if(Y.ht()){const Re=jv($);if(null!==Re&&!Re.isEqual(Y.field))throw new Ge(ne.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${Re.toString()}' and '${Y.field.toString()}'`);const _t=am($);null!==_t&&FP(0,Y.field,_t)}const Ie=function(Re,_t){for(const Et of Re.filters)if(_t.indexOf(Et.op)>=0)return Et.op;return null}($,function(Re){switch(Re){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(Y.op));if(null!==Ie)throw new Ge(ne.INVALID_ARGUMENT,Ie===Y.op?`Invalid query. You cannot use more than one '${Y.op.toString()}' filter.`:`Invalid query. You cannot use '${Y.op.toString()}' filters with '${Ie.toString()}' filters.`)}(i,x),x}(e._query,0,t,e.firestore._databaseId,this.fa,this.da,this._a);return new Yi(e.firestore,e.converter,function(i,a){const l=i.filters.concat([a]);return new Ia(i.path,i.collectionGroup,i.explicitOrderBy.slice(),l,i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}class tF extends A0{constructor(e,t){super(),this.fa=e,this.wa=t,this.type="orderBy"}_apply(e){const t=function(r,i,a){if(null!==r.startAt)throw new Ge(ne.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new Ge(ne.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const l=new Pl(i,a);return function(h,m){if(null===am(h)){const v=jv(h);null!==v&&FP(0,v,m.field)}}(r,l),l}(e._query,this.fa,this.wa);return new Yi(e.firestore,e.converter,function(r,i){const a=r.explicitOrderBy.concat([i]);return new Ia(r.path,r.collectionGroup,a,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}class MP extends A0{constructor(e,t,r){super(),this.type=e,this.ma=t,this.ga=r}_apply(e){return new Yi(e.firestore,e.converter,qI(e._query,this.ma,this.ga))}}class PP extends A0{constructor(e,t,r){super(),this.type=e,this.ya=t,this.pa=r}_apply(e){const t=NP(e,this.type,this.ya,this.pa);return new Yi(e.firestore,e.converter,(i=t,new Ia((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)));var r,i}}class kP extends A0{constructor(e,t,r){super(),this.type=e,this.ya=t,this.pa=r}_apply(e){const t=NP(e,this.type,this.ya,this.pa);return new Yi(e.firestore,e.converter,(i=t,new Ia((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,i)));var r,i}}function NP(n,e,t,r){if(t[0]=(0,N.m9)(t[0]),t[0]instanceof T0)return function(i,a,l,h,m){if(!h)throw new Ge(ne.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const v=[];for(const C of Pf(i))if(C.field.isKeyField())v.push(xl(a,h.key));else{const T=h.data.field(C.field);if(xv(T))throw new Ge(ne.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+C.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===T){const x=C.field.canonicalString();throw new Ge(ne.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${x}' (used as the orderBy) does not exist.`)}v.push(T)}return new Ea(v,m)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Jf(n.firestore);return function(a,l,h,m,v,C){const T=a.explicitOrderBy;if(v.length>T.length)throw new Ge(ne.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const x=[];for(let $=0;$<v.length;$++){const Y=v[$];if(T[$].field.isKeyField()){if("string"!=typeof Y)throw new Ge(ne.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof Y}`);if(!$v(a)&&-1!==Y.indexOf("/"))throw new Ge(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${Y}' contains a slash.`);const Ie=a.path.child(un.fromString(Y));if(!tt.isDocumentKey(Ie))throw new Ge(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${Ie}' is not because it contains an odd number of segments.`);const Re=new tt(Ie);x.push(xl(l,Re))}else{const Ie=DP(h,m,Y);x.push(Ie)}}return new Ea(x,C)}(n._query,n.firestore._databaseId,i,e,t,r)}}function OP(n,e,t){if("string"==typeof(t=(0,N.m9)(t))){if(""===t)throw new Ge(ne.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!$v(e)&&-1!==t.indexOf("/"))throw new Ge(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(un.fromString(t));if(!tt.isDocumentKey(r))throw new Ge(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return xl(n,new tt(r))}if(t instanceof fr)return xl(n,t._key);throw new Ge(ne.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${iC(t)}.`)}function LP(n,e){if(!Array.isArray(n)||0===n.length)throw new Ge(ne.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(n.length>10)throw new Ge(ne.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function FP(n,e,t){if(!t.isEqual(e))throw new Ge(ne.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}const lF={maxAttempts:5};class KA{convertValue(e,t="none"){switch(va(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ir(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(wu(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw mt()}}convertObject(e,t){const r={};return vu(e.fields,(i,a)=>{r[i]=this.convertValue(a,t)}),r}convertGeoPoint(e){return new oC(Ir(e.latitude),Ir(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Mv(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Sf(e));default:return null}}convertTimestamp(e){const t=_a(e);return new rr(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=un.fromString(e);Lt(Jv(r));const i=new ya(r.get(1),r.get(3)),a=new tt(r.popFirst(5));return i.isEqual(t)||Qn(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function hC(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class cF extends KA{constructor(e){super(),this.firestore=e}convertBytes(e){return new xu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new fr(this.firestore,null,t)}}class UP{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Jf(e)}set(e,t,r){this._verifyNotCommitted();const i=Ud(e,this._firestore),a=hC(i.converter,t,r),l=uC(this._dataReader,"WriteBatch.set",i._key,a,null!==i.converter,r);return this._mutations.push(l.toMutation(i._key,dr.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const a=Ud(e,this._firestore);let l;return l="string"==typeof(t=(0,N.m9)(t))||t instanceof Zl?zA(this._dataReader,"WriteBatch.update",a._key,t,r,i):GA(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(l.toMutation(a._key,dr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Ud(e,this._firestore);return this._mutations=this._mutations.concat(new Ll(t._key,dr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ge(ne.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Ud(n,e){if((n=(0,N.m9)(n)).firestore!==e)throw new Ge(ne.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class np extends KA{constructor(e){super(),this.firestore=e}convertBytes(e){return new xu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new fr(this.firestore,null,t)}}function VP(n,e,t){n=In(n,fr);const r=In(n.firestore,br),i=hC(n.converter,e,t);return Fm(r,[uC(Jf(r),"setDoc",n._key,i,null!==n.converter,t).toMutation(n._key,dr.none())])}function BP(n,e,t,...r){n=In(n,fr);const i=In(n.firestore,br),a=Jf(i);let l;return l="string"==typeof(e=(0,N.m9)(e))||e instanceof Zl?zA(a,"updateDoc",n._key,e,t,r):GA(a,"updateDoc",n._key,e),Fm(i,[l.toMutation(n._key,dr.exists(!0))])}function jP(n,...e){var t,r,i;n=(0,N.m9)(n);let a={includeMetadataChanges:!1},l=0;"object"!=typeof e[l]||$A(e[l])||(a=e[l],l++);const h={includeMetadataChanges:a.includeMetadataChanges};if($A(e[l])){const T=e[l];e[l]=null===(t=T.next)||void 0===t?void 0:t.bind(T),e[l+1]=null===(r=T.error)||void 0===r?void 0:r.bind(T),e[l+2]=null===(i=T.complete)||void 0===i?void 0:i.bind(T)}let m,v,C;if(n instanceof fr)v=In(n.firestore,br),C=kl(n._key.path),m={next:T=>{e[l]&&e[l](ZA(v,n,T))},error:e[l+1],complete:e[l+2]};else{const T=In(n,Yi);v=In(T.firestore,br),C=T._query;const x=new np(v);m={next:$=>{e[l]&&e[l](new Ld(v,x,T,$))},error:e[l+1],complete:e[l+2]},xP(n._query)}return function(T,x,$,Y){const Ie=new nC(Y),Re=new oA(x,Ie,$);return T.asyncQueue.enqueueAndForget((0,Ce.Z)(function*(){return tA(yield Lm(T),Re)})),()=>{Ie.Tc(),T.asyncQueue.enqueueAndForget((0,Ce.Z)(function*(){return rA(yield Lm(T),Re)}))}}(ui(v),C,h,m)}function Fm(n,e){return function(t,r){const i=new oi;return t.asyncQueue.enqueueAndForget((0,Ce.Z)(function*(){return function nL(n,e,t){return dA.apply(this,arguments)}(yield VA(t),r,i)})),i.promise}(ui(n),e)}function ZA(n,e,t){const r=t.docs.get(e._key),i=new np(n);return new Yl(n,i,e._key,r,new tp(t.hasPendingWrites,t.fromCache),e.converter)}class wF extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Jf(e)}get(e){const t=Ud(e,this._firestore),r=new cF(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||1!==i.length)return mt();const a=i[0];if(a.isFoundDocument())return new T0(this._firestore,r,a.key,a,t.converter);if(a.isNoDocument())return new T0(this._firestore,r,t._key,null,t.converter);throw mt()})}set(e,t,r){const i=Ud(e,this._firestore),a=hC(i.converter,t,r),l=uC(this._dataReader,"Transaction.set",i._key,a,null!==i.converter,r);return this._transaction.set(i._key,l),this}update(e,t,r,...i){const a=Ud(e,this._firestore);let l;return l="string"==typeof(t=(0,N.m9)(t))||t instanceof Zl?zA(this._dataReader,"Transaction.update",a._key,t,r,i):GA(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,l),this}delete(e){const t=Ud(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Ud(e,this._firestore),r=new np(this._firestore);return super.get(e).then(i=>new Yl(this._firestore,r,t._key,i._document,new tp(!1,!1),t.converter))}}function YA(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Ge("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function HP(){if(typeof Uint8Array>"u")throw new Ge("unimplemented","Uint8Arrays are not available in this environment.")}function GP(){if(!function YT(){return typeof atob<"u"}())throw new Ge("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(n,e=!0){Dl=ki.SDK_VERSION,(0,ki._registerComponent)(new zi.wA("firestore",(t,{options:r})=>{const i=t.getProvider("app").getImmediate(),a=new br(i,new Yg(t.getProvider("auth-internal")),new DI(t.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:e},r),a._setSettings(r),a},"PUBLIC")),(0,ki.registerVersion)(Dv,"3.4.13",n),(0,ki.registerVersion)(Dv,"3.4.13","esm2017")}();class R0{constructor(e){this._delegate=e}static fromBase64String(e){return GP(),new R0(xu.fromBase64String(e))}static fromUint8Array(e){return HP(),new R0(xu.fromUint8Array(e))}toBase64(){return GP(),this._delegate.toBase64()}toUint8Array(){return HP(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function QA(n){return function RF(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class xF{enableIndexedDbPersistence(e,t){return function LL(n,e){EP(n=In(n,br));const t=ui(n),r=n._freezeSettings(),i=new PA;return wP(t,i,new nP(i,r.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function FL(n){EP(n=In(n,br));const e=ui(n),t=n._freezeSettings(),r=new PA;return wP(e,r,new yL(r,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function UL(n){if(n._initialized&&!n._terminated)throw new Ge(ne.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new oi;return n._queue.enqueueAndForgetEvenWhileRestricted((0,Ce.Z)(function*(){try{yield(t=(0,Ce.Z)(function*(r){if(!no.V())return Promise.resolve();const i=r+"main";yield no.delete(i)}),function(r){return t.apply(this,arguments)})(kd(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class zP{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof ya||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Zg("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){!function ML(n,e,t,r={}){var i;const a=(n=In(n,C0))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==e&&Zg("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},a),{host:`${e}:${t}`,ssl:!1})),r.mockUserToken){let l,h;if("string"==typeof r.mockUserToken)l=r.mockUserToken,h=Jr.MOCK_USER;else{l=(0,N.Sg)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new Ge(ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Jr(m)}n._authCredentials=new HT(new CI(l,h))}}(this._delegate,e,t,r)}enableNetwork(){return function BL(n){return function bL(n){return n.asyncQueue.enqueue((0,Ce.Z)(function*(){const e=yield oP(n),t=yield aP(n);return e.setNetworkEnabled(!0),function(r){const i=it(r);return i.lu.delete(0),D(i)}(t)}))}(ui(n=In(n,br)))}(this._delegate)}disableNetwork(){return function jL(n){return function CL(n){return n.asyncQueue.enqueue((0,Ce.Z)(function*(){const e=yield oP(n),t=yield aP(n);return e.setNetworkEnabled(!1),(r=(0,Ce.Z)(function*(i){const a=it(i);a.lu.add(0),yield V(a),a._u.set("Offline")}),function(i){return r.apply(this,arguments)})(t);var r}))}(ui(n=In(n,br)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,dP("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function VL(n){return function(e){const t=new oi;return e.asyncQueue.enqueueAndForget((0,Ce.Z)(function*(){return function oL(n,e){return mA.apply(this,arguments)}(yield VA(e),t)})),t.promise}(ui(n=In(n,br)))}(this._delegate)}onSnapshotsInSync(e){return function vF(n,e){return function SL(n,e){const t=new nC(e);return n.asyncQueue.enqueueAndForget((0,Ce.Z)(function*(){return r=yield Lm(n),i=t,it(r).Tu.add(i),void i.next();var r,i})),()=>{t.Tc(),n.asyncQueue.enqueueAndForget((0,Ce.Z)(function*(){return r=yield Lm(n),i=t,void it(r).Tu.delete(i);var r,i}))}}(ui(n=In(n,br)),$A(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new Ge("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Um(this,mP(this._delegate,e))}catch(t){throw gs(t,"collection()","Firestore.collection()")}}doc(e){try{return new No(this,sC(this._delegate,e))}catch(t){throw gs(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new ms(this,function PL(n,e){if(n=In(n,C0),jA("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Ge(ne.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Yi(n,null,(t=e,new Ia(un.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw gs(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function EF(n,e,t){n=In(n,br);const r=Object.assign(Object.assign({},lF),t);return function(i){if(i.maxAttempts<1)throw new Ge(ne.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function AL(n,e,t){const r=new oi;return n.asyncQueue.enqueueAndForget((0,Ce.Z)(function*(){const i=yield(a=n,rC(a).then(l=>l.datastore));var a;new EL(n.asyncQueue,i,t,e,r).run()})),r.promise}(ui(n),i=>e(new wF(n,i)),r)}(this._delegate,t=>e(new WP(this,t)))}batch(){return ui(this._delegate),new qP(new UP(this._delegate,e=>Fm(this._delegate,e)))}loadBundle(e){return function $L(n,e){const t=ui(n=In(n,br)),r=new NL;return function RL(n,e,t,r){const i=function(a,l){let h;return h="string"==typeof a?(new TextEncoder).encode(a):a,m=function(m,v){if(m instanceof Uint8Array)return rP(m,v);if(m instanceof ArrayBuffer)return rP(new Uint8Array(m),v);if(m instanceof ReadableStream)return m.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),new vL(m,l);var m}(t,o(e));n.asyncQueue.enqueueAndForget((0,Ce.Z)(function*(){!function _L(n,e,t){const r=it(n);var i;(i=(0,Ce.Z)(function*(a,l,h){try{const m=yield l.getMetadata();if(yield function(x,$){const Y=it(x),Ie=ai($.createTime);return Y.persistence.runTransaction("hasNewerBundle","readonly",Re=>Y.Ds.getBundleMetadata(Re,$.id)).then(Re=>!!Re&&Re.createTime.compareTo(Ie)>=0)}(a.localStore,m))return yield l.close(),h._completeWith({taskState:"Success",documentsLoaded:(x=m).totalDocuments,bytesLoaded:x.totalBytes,totalDocuments:x.totalDocuments,totalBytes:x.totalBytes}),Promise.resolve(new Set);h._updateProgress(WM(m));const v=new Y1(m,a.localStore,l.wt);let C=yield l.fc();for(;C;){const x=yield v.Nu(C);x&&h._updateProgress(x),C=yield l.fc()}const T=yield v.complete();return yield Kl(a,T.Mu,void 0),yield function(x,$){const Y=it(x);return Y.persistence.runTransaction("Save bundle","readwrite",Ie=>Y.Ds.saveBundleMetadata(Ie,$))}(a.localStore,m),h._completeWith(T.progress),Promise.resolve(T.Ou)}catch(m){return Zg("SyncEngine",`Loading bundle failed with ${m}`),h._failWith(m),Promise.resolve(new Set)}var x}),function(a,l,h){return i.apply(this,arguments)})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield VA(n),i,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function HL(n,e){return function xL(n,e){return n.asyncQueue.enqueue((0,Ce.Z)(function*(){return function(t,r){const i=it(t);return i.persistence.runTransaction("Get named query","readonly",a=>i.Ds.getNamedQuery(a,r))}(yield UA(n),e)}))}(ui(n=In(n,br)),e).then(t=>t?new Yi(n,null,t.query):null)}(this._delegate,e).then(t=>t?new ms(this,t):null)}}class fC extends KA{constructor(e){super(),this.firestore=e}convertBytes(e){return new R0(new xu(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return No.forKey(t,this.firestore,null)}}class WP{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new fC(e)}get(e){const t=ip(e);return this._delegate.get(t).then(r=>new x0(this._firestore,new Yl(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=ip(e);return r?(YA("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=ip(e);return 2===arguments.length?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=ip(e);return this._delegate.delete(t),this}}class qP{constructor(e){this._delegate=e}set(e,t,r){const i=ip(e);return r?(YA("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=ip(e);return 2===arguments.length?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=ip(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class rp{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new S0(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new M0(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=rp.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let a=i.get(t);return a||(a=new rp(e,new fC(e),t),i.set(t,a)),a}}rp.INSTANCES=new WeakMap;class No{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new fC(e)}static forPath(e,t,r){if(e.length%2!=0)throw new Ge("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new No(t,new fr(t._delegate,r,new tt(e)))}static forKey(e,t,r){return new No(t,new fr(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Um(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Um(this.firestore,mP(this._delegate,e))}catch(t){throw gs(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,N.m9)(e))instanceof fr&&_P(this._delegate,e)}set(e,t){t=YA("DocumentReference.set",t);try{return t?VP(this._delegate,e,t):VP(this._delegate,e)}catch(r){throw gs(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?BP(this._delegate,e):BP(this._delegate,e,t,...r)}catch(i){throw gs(i,"updateDoc()","DocumentReference.update()")}}delete(){return function _F(n){return Fm(In(n.firestore,br),[new Ll(n._key,dr.none())])}(this._delegate)}onSnapshot(...e){const t=KP(e),r=ZP(e,i=>new x0(this.firestore,new Yl(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return jP(this._delegate,t,r)}get(e){let t;return t="cache"===e?.source?function hF(n){n=In(n,fr);const e=In(n.firestore,br),t=ui(e),r=new np(e);return function DL(n,e){const t=new oi;return n.asyncQueue.enqueueAndForget((0,Ce.Z)(function*(){return(r=(0,Ce.Z)(function*(i,a,l){try{const h=yield function(m,v){const C=it(m);return C.persistence.runTransaction("read document","readonly",T=>C.localDocuments.getDocument(T,v))}(i,a);h.isFoundDocument()?l.resolve(h):h.isNoDocument()?l.resolve(null):l.reject(new Ge(ne.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(h){const m=Pm(h,`Failed to get document '${a} from cache`);l.reject(m)}}),function(i,a,l){return r.apply(this,arguments)})(yield UA(n),e,t);var r})),t.promise}(t,n._key).then(i=>new Yl(e,r,n._key,i,new tp(null!==i&&i.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function fF(n){n=In(n,fr);const e=In(n.firestore,br);return uP(ui(e),n._key,{source:"server"}).then(t=>ZA(e,n,t))}(this._delegate):function dF(n){n=In(n,fr);const e=In(n.firestore,br);return uP(ui(e),n._key).then(t=>ZA(e,n,t))}(this._delegate),t.then(r=>new x0(this.firestore,new Yl(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new No(this.firestore,this._delegate.withConverter(e?rp.getInstance(this.firestore,e):null))}}function gs(n,e,t){return n.message=n.message.replace(e,t),n}function KP(n){for(const e of n)if("object"==typeof e&&!QA(e))return e;return{}}function ZP(n,e){var t,r;let i;return i=QA(n[0])?n[0]:QA(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:a=>{i.next&&i.next(e(a))},error:null===(t=i.error)||void 0===t?void 0:t.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class x0{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new No(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return RP(this._delegate,e._delegate)}}class M0 extends x0{data(e){const t=this._delegate.data(e);return function bI(n,e){n||mt()}(void 0!==t),t}}class ms{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new fC(e)}where(e,t,r){try{return new ms(this.firestore,Fd(this._delegate,function eF(n,e,t){const r=e,i=dC("where",n);return new JL(i,r,t)}(e,t,r)))}catch(i){throw gs(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new ms(this.firestore,Fd(this._delegate,function nF(n,e="asc"){const t=e,r=dC("orderBy",n);return new tF(r,t)}(e,t)))}catch(r){throw gs(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new ms(this.firestore,Fd(this._delegate,function rF(n){return pP("limit",n),new MP("limit",n,"F")}(e)))}catch(t){throw gs(t,"limit()","Query.limit()")}}limitToLast(e){try{return new ms(this.firestore,Fd(this._delegate,function iF(n){return pP("limitToLast",n),new MP("limitToLast",n,"L")}(e)))}catch(t){throw gs(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new ms(this.firestore,Fd(this._delegate,function sF(...n){return new PP("startAt",n,!0)}(...e)))}catch(t){throw gs(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new ms(this.firestore,Fd(this._delegate,function oF(...n){return new PP("startAfter",n,!1)}(...e)))}catch(t){throw gs(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new ms(this.firestore,Fd(this._delegate,function aF(...n){return new kP("endBefore",n,!1)}(...e)))}catch(t){throw gs(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new ms(this.firestore,Fd(this._delegate,function uF(...n){return new kP("endAt",n,!0)}(...e)))}catch(t){throw gs(t,"endAt()","Query.endAt()")}}isEqual(e){return yP(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function gF(n){n=In(n,Yi);const e=In(n.firestore,br),t=ui(e),r=new np(e);return function TL(n,e){const t=new oi;return n.asyncQueue.enqueueAndForget((0,Ce.Z)(function*(){return(r=(0,Ce.Z)(function*(i,a,l){try{const h=yield Qf(i,a,!0),m=new ZM(a,h.ji),v=m.Ku(h.documents),C=m.applyChanges(v,!1);l.resolve(C.snapshot)}catch(h){const m=Pm(h,`Failed to execute query '${a} against cache`);l.reject(m)}}),function(i,a,l){return r.apply(this,arguments)})(yield UA(n),e,t);var r})),t.promise}(t,n._query).then(i=>new Ld(e,r,n,i))}(this._delegate):"server"===e?.source?function mF(n){n=In(n,Yi);const e=In(n.firestore,br),t=ui(e),r=new np(e);return lP(t,n._query,{source:"server"}).then(i=>new Ld(e,r,n,i))}(this._delegate):function pF(n){n=In(n,Yi);const e=In(n.firestore,br),t=ui(e),r=new np(e);return xP(n._query),lP(t,n._query).then(i=>new Ld(e,r,n,i))}(this._delegate),t.then(r=>new XA(this.firestore,new Ld(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=KP(e),r=ZP(e,i=>new XA(this.firestore,new Ld(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return jP(this._delegate,t,r)}withConverter(e){return new ms(this.firestore,this._delegate.withConverter(e?rp.getInstance(this.firestore,e):null))}}class PF{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new M0(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class XA{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new ms(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new M0(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new PF(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new M0(this._firestore,r))})}isEqual(e){return RP(this._delegate,e._delegate)}}class Um extends ms{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new No(this.firestore,e):null}doc(e){try{return new No(this.firestore,void 0===e?sC(this._delegate):sC(this._delegate,e))}catch(t){throw gs(t,"doc()","CollectionReference.doc()")}}add(e){return function yF(n,e){const t=In(n.firestore,br),r=sC(n),i=hC(n.converter,e);return Fm(t,[uC(Jf(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,dr.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new No(this.firestore,t))}isEqual(e){return _P(this._delegate,e._delegate)}withConverter(e){return new Um(this.firestore,this._delegate.withConverter(e?rp.getInstance(this.firestore,e):null))}}function ip(n){return In(n,fr)}class JA{constructor(...e){this._delegate=new Zl(...e)}static documentId(){return new JA(Nr.keyField().canonicalString())}isEqual(e){return(e=(0,N.m9)(e))instanceof Zl&&this._delegate._internalPath.isEqual(e._internalPath)}}class sp{constructor(e){this._delegate=e}static serverTimestamp(){const e=function bF(){return new HA("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new sp(e)}static delete(){const e=function IF(){return new D0("deleteField")}();return e._methodName="FieldValue.delete",new sp(e)}static arrayUnion(...e){const t=function CF(...n){return new qL("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new sp(t)}static arrayRemove(...e){const t=function DF(...n){return new KL("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new sp(t)}static increment(e){const t=function TF(n){return new ZL("increment",n)}(e);return t._methodName="FieldValue.increment",new sp(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const kF={Firestore:zP,GeoPoint:oC,Timestamp:rr,Blob:R0,Transaction:WP,WriteBatch:qP,DocumentReference:No,DocumentSnapshot:x0,Query:ms,QueryDocumentSnapshot:M0,QuerySnapshot:XA,CollectionReference:Um,FieldPath:JA,FieldValue:sp,setLogLevel:function MF(n){!function $T(n){pa.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};!function OF(n){(function NF(n,e){n.INTERNAL.registerComponent(new zi.wA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},kF)))})(n,(e,t)=>new zP(e,t,new xF)),n.registerVersion("@firebase/firestore-compat","0.1.22")}(zh.Z);var eR=M(6451),pC=M(5363),LF=M(6063);class FF extends sa.x{constructor(e=1/0,t=1/0,r=LF.l){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:a,_windowTime:l}=this;t||(r.push(e),!i&&r.push(a.now()+l)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,a=i.slice();for(let l=0;l<a.length&&!e.closed;l+=r?1:2)e.next(a[l]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,a=(i?1:2)*e;if(e<1/0&&a<r.length&&r.splice(0,r.length-a),!i){const l=t.now();let h=0;for(let m=1;m<r.length&&r[m]<=l;m+=2)h=m;h&&r.splice(0,h+1)}}}var YP=M(3099);function QP(n,e,t){let r,i=!1;return n&&"object"==typeof n?({bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n):r=n??1/0,(0,YP.B)({connector:()=>new FF(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function XP(n,e){return(0,_h.m)(e)?yr(()=>n,e):yr(()=>n)}var tR=M(9468),nR=M(5867);const JP=new Map,$F={activated:!1,tokenObservers:[]},HF={initialized:!1,enabled:!1};function Si(n){return JP.get(n)||$F}function Ta(n,e){JP.set(n,e)}function mC(){return HF}class KF{constructor(e,t,r,i,a){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,Ce.Z)(function*(){t.stop();try{t.pending=new N.BH,yield function ZF(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new N.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(r){t.retryPolicy(r)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const _s=new N.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function tk(n){if(!Si(n).activated)throw _s.create("use-before-activation",{appName:n.name})}function oR(n,e){return aR.apply(this,arguments)}function aR(){return aR=(0,Ce.Z)(function*({url:n,body:e},t){var r,i;const a={"Content-Type":"application/json"},l=t.getImmediate({optional:!0});if(l){const $=yield l.getHeartbeatsHeader();$&&(a["X-Firebase-Client"]=$)}const h={method:"POST",body:JSON.stringify(e),headers:a};let m,v;try{m=yield fetch(n,h)}catch($){throw _s.create("fetch-network-error",{originalErrorMessage:null===(r=$)||void 0===r?void 0:r.message})}if(200!==m.status)throw _s.create("fetch-status-error",{httpStatus:m.status});try{v=yield m.json()}catch($){throw _s.create("fetch-parse-error",{originalErrorMessage:null===(i=$)||void 0===i?void 0:i.message})}const C=v.ttl.match(/^([\d.]+)(s)$/);if(!C||!C[2]||isNaN(Number(C[1])))throw _s.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${v.ttl}`});const T=1e3*Number(C[1]),x=Date.now();return{token:v.token,expireTimeMillis:x+T,issuedAtTimeMillis:x}}),aR.apply(this,arguments)}function JF(n,e){const{projectId:t,appId:r,apiKey:i}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${t}/apps/${r}:exchangeDebugToken?key=${i}`,body:{debug_token:e}}}const P0="firebase-app-check-store";let vC=null;function rk(){return vC||(vC=new Promise((n,e)=>{var t;try{const r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=i=>{n(i.target.result)},r.onerror=i=>{var a;e(_s.create("storage-open",{originalErrorMessage:null===(a=i.target.error)||void 0===a?void 0:a.message}))},r.onupgradeneeded=i=>{0===i.oldVersion&&i.target.result.createObjectStore(P0,{keyPath:"compositeKey"})}}catch(r){e(_s.create("storage-open",{originalErrorMessage:null===(t=r)||void 0===t?void 0:t.message}))}}),vC)}function uR(){return uR=(0,Ce.Z)(function*(n,e){const r=(yield rk()).transaction(P0,"readwrite"),a=r.objectStore(P0).put({compositeKey:n,value:e});return new Promise((l,h)=>{a.onsuccess=m=>{l()},r.onerror=m=>{var v;h(_s.create("storage-set",{originalErrorMessage:null===(v=m.target.error)||void 0===v?void 0:v.message}))}})}),uR.apply(this,arguments)}const k0=new Qs.Yd("@firebase/app-check");function ak(n,e){return(0,N.hl)()?function rU(n,e){return function ik(n,e){return uR.apply(this,arguments)}(function ok(n){return`${n.options.appId}-${n.name}`}(n),e)}(n,e).catch(t=>{k0.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function uk(){return mC().enabled}function lk(){return hR.apply(this,arguments)}function hR(){return hR=(0,Ce.Z)(function*(){const n=mC();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),hR.apply(this,arguments)}const lU={error:"UNKNOWN_ERROR"};function cU(n){return N.US.encodeString(JSON.stringify(n),!1)}function wC(n){return fR.apply(this,arguments)}function fR(){return fR=(0,Ce.Z)(function*(n,e=!1){const t=n.app;tk(t);const r=Si(t);let a,i=r.token;if(!i){const m=yield r.cachedTokenPromise;m&&EC(m)&&(i=m)}if(!e&&i&&EC(i))return{token:i.token};let h,l=!1;if(uk()){r.exchangeTokenPromise||(r.exchangeTokenPromise=oR(JF(t,yield lk()),n.heartbeatServiceProvider).then(v=>(r.exchangeTokenPromise=void 0,v)),l=!0);const m=yield r.exchangeTokenPromise;return yield ak(t,m),Ta(t,Object.assign(Object.assign({},r),{token:m})),{token:m.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().then(m=>(r.exchangeTokenPromise=void 0,m)),l=!0),i=yield r.exchangeTokenPromise}catch(m){"appCheck/throttled"===m.code?k0.warn(m.message):k0.error(m),a=m}return i?(h={token:i.token},Ta(t,Object.assign(Object.assign({},r),{token:i})),yield ak(t,i)):h=hU(a),l&&dk(t,h),h}),fR.apply(this,arguments)}function gR(n,e){const t=Si(n),r=t.tokenObservers.filter(i=>i.next!==e);0===r.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),Ta(n,Object.assign(Object.assign({},t),{tokenObservers:r}))}function ck(n){const{app:e}=n,t=Si(e);let r=t.tokenRefresher;r||(r=function dU(n){const{app:e}=n;return new KF((0,Ce.Z)(function*(){let r;if(r=Si(e).token?yield wC(n,!0):yield wC(n),r.error)throw r.error}),()=>!0,()=>{const t=Si(e);if(t.token){let r=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,t.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},3e4,96e4)}(n),Ta(e,Object.assign(Object.assign({},t),{tokenRefresher:r}))),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function dk(n,e){const t=Si(n).tokenObservers;for(const r of t)try{"EXTERNAL"===r.type&&null!=e.error?r.error(e.error):r.next(e)}catch{}}function EC(n){return n.expireTimeMillis-Date.now()>0}function hU(n){return{token:cU(lU),error:n}}class fU{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=Si(this.app);for(const t of e)gR(this.app,t.next);return Promise.resolve()}}const vk="app-check-internal";!function SU(){(0,ki._registerComponent)(new zi.wA("app-check",n=>function pU(n,e){return new fU(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(vk).initialize()})),(0,ki._registerComponent)(new zi.wA(vk,n=>function gU(n){return{getToken:e=>wC(n,e),addTokenListener:e=>function pR(n,e,t,r){const{app:i}=n,a=Si(i),l={next:t,error:r,type:e};if(Ta(i,Object.assign(Object.assign({},a),{tokenObservers:[...a.tokenObservers,l]})),a.token&&EC(a.token)){const h=a.token;Promise.resolve().then(()=>{t({token:h.token}),ck(n)}).catch(()=>{})}a.cachedTokenPromise.then(()=>ck(n))}(n,"INTERNAL",e),removeTokenListener:e=>gR(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,ki.registerVersion)("@firebase/app-check","0.5.12")}();class N0{constructor(){return(0,En.vb)("app-check")}}typeof window<"u"&&window;var bC=M(127);const wR=new g.OlP("angularfire2.auth.use-emulator"),ER=new g.OlP("angularfire2.auth.settings"),IR=new g.OlP("angularfire2.auth.tenant-id"),bR=new g.OlP("angularfire2.auth.langugage-code"),CR=new g.OlP("angularfire2.auth.use-device-language"),DR=new g.OlP("angularfire.auth.persistence"),TR=(n,e,t,r,i,a,l,h)=>(0,$r.cc)(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const m=e.runOutsideAngular(()=>n.auth());if(t&&m.useEmulator(...t),r&&(m.tenantId=r),m.languageCode=i,a&&m.useDeviceLanguage(),l)for(const[v,C]of Object.entries(l))m.settings[v]=C;return h&&m.setPersistence(h),m},[t,r,i,a,l,h]);let O0=(()=>{class n{constructor(t,r,i,a,l,h,m,v,C,T,x,$){const Y=new sa.x,Ie=ot(void 0).pipe((0,pC.Q)(l.outsideAngular),yr(()=>a.runOutsideAngular(()=>Promise.resolve().then(M.bind(M,5881)))),(0,At.U)(()=>(0,$r.on)(t,a,r)),(0,At.U)(Re=>TR(Re,a,h,v,C,T,m,x)),QP({bufferSize:1,refCount:!1}));if(oc(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=ot(null);else{Ie.pipe(ss()).subscribe();const _t=Ie.pipe(yr(wt=>wt.getRedirectResult().then(Wt=>Wt,()=>null)),En.iC,QP({bufferSize:1,refCount:!1})),Et=Ie.pipe(yr(wt=>new $i.y(Wt=>({unsubscribe:a.runOutsideAngular(()=>wt.onAuthStateChanged(sn=>Wt.next(sn),sn=>Wt.error(sn),()=>Wt.complete()))})))),vt=Ie.pipe(yr(wt=>new $i.y(Wt=>({unsubscribe:a.runOutsideAngular(()=>wt.onIdTokenChanged(sn=>Wt.next(sn),sn=>Wt.error(sn),()=>Wt.complete()))}))));this.authState=_t.pipe(XP(Et),(0,tR.R)(l.outsideAngular),(0,pC.Q)(l.insideAngular)),this.user=_t.pipe(XP(vt),(0,tR.R)(l.outsideAngular),(0,pC.Q)(l.insideAngular)),this.idToken=this.user.pipe(yr(wt=>wt?(0,qt.D)(wt.getIdToken()):ot(null))),this.idTokenResult=this.user.pipe(yr(wt=>wt?(0,qt.D)(wt.getIdTokenResult()):ot(null))),this.credential=(0,eR.T)(_t,Y,this.authState.pipe(is(wt=>!wt))).pipe((0,At.U)(wt=>wt?.user?wt:null),(0,tR.R)(l.outsideAngular),(0,pC.Q)(l.insideAngular))}return(0,$r.pX)(this,Ie,a,{spy:{apply:(Re,_t,Et)=>{(Re.startsWith("signIn")||Re.startsWith("createUser"))&&Et.then(vt=>Y.next(vt))}}})}}return n.\u0275fac=function(t){return new(t||n)(g.LFG($r.Dh),g.LFG($r.xv,8),g.LFG(g.Lbi),g.LFG(g.R0b),g.LFG(En.HU),g.LFG(wR,8),g.LFG(ER,8),g.LFG(IR,8),g.LFG(bR,8),g.LFG(CR,8),g.LFG(DR,8),g.LFG(N0,8))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),kU=(()=>{class n{constructor(){bC.Z.registerVersion("angularfire",En.q4.full,"auth-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({providers:[O0]}),n})();function Ek(n,e){return function NU(n,e=uu.z){return new $i.y(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}(n,e)}function SR(n,e){return Ek(n,e).pipe((0,At.U)(t=>({payload:t,type:"query"})))}function CC(n,e){return SR(n,e).pipe(Ic(void 0),yl(),(0,At.U)(([t,r])=>{const i=r.payload.docChanges(),a=i.map(l=>({type:l.type,payload:l}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((l,h)=>{const m=i.find(C=>C.doc.ref.isEqual(l.ref)),v=t?.payload.docs.find(C=>C.ref.isEqual(l.ref));m&&JSON.stringify(m.doc.metadata)===JSON.stringify(l.metadata)||!m&&v&&JSON.stringify(v.metadata)===JSON.stringify(l.metadata)||a.push({type:"modified",payload:{oldIndex:h,newIndex:h,type:"modified",doc:l}})}),a}))}function Ik(n,e,t){return CC(n,t).pipe(wo((r,i)=>function LU(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function FU(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return AR(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return AR(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return AR(n,e.oldIndex,1)}return n}(n,r))}),n}(r,i.map(a=>a.payload),e),[]),pg(),(0,At.U)(r=>r.map(i=>({type:i.type,payload:i}))))}function AR(n,e,t,...r){const i=n.slice();return i.splice(e,t,...r),i}function bk(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class Ck{constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=CC(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,At.U)(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(Ic(void 0),yl(),is(([r,i])=>i.length>0||!r),(0,At.U)(([r,i])=>i),En.iC)}auditTrail(e){return this.stateChanges(e).pipe(wo((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=bk(e);return Ik(this.query,t,this.afs.schedulers.outsideAngular).pipe(En.iC)}valueChanges(e={}){return SR(this.query,this.afs.schedulers.outsideAngular).pipe((0,At.U)(t=>t.payload.docs.map(r=>e.idField?Object.assign(Object.assign({},r.data()),{[e.idField]:r.id}):r.data())),En.iC)}get(e){return(0,qt.D)(this.query.get(e)).pipe(En.iC)}add(e){return this.ref.add(e)}doc(e){return new Dk(this.ref.doc(e),this.afs)}}class Dk{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:i,query:a}=Ak(r,t);return new Ck(i,a,this.afs)}snapshotChanges(){return function OU(n,e){return Ek(n,e).pipe(Ic(void 0),yl(),(0,At.U)(([t,r])=>r.exists?t?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(En.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,At.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,qt.D)(this.ref.get(e)).pipe(En.iC)}}class UU{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?CC(this.query,this.afs.schedulers.outsideAngular).pipe((0,At.U)(t=>t.filter(r=>e.indexOf(r.type)>-1)),is(t=>t.length>0),En.iC):CC(this.query,this.afs.schedulers.outsideAngular).pipe(En.iC)}auditTrail(e){return this.stateChanges(e).pipe(wo((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=bk(e);return Ik(this.query,t,this.afs.schedulers.outsideAngular).pipe(En.iC)}valueChanges(e={}){return SR(this.query,this.afs.schedulers.outsideAngular).pipe((0,At.U)(r=>r.payload.docs.map(i=>e.idField?Object.assign({[e.idField]:i.id},i.data()):i.data())),En.iC)}get(e){return(0,qt.D)(this.query.get(e)).pipe(En.iC)}}const Tk=new g.OlP("angularfire2.enableFirestorePersistence"),Sk=new g.OlP("angularfire2.firestore.persistenceSettings"),VU=new g.OlP("angularfire2.firestore.settings"),BU=new g.OlP("angularfire2.firestore.use-emulator");function Ak(n,e=(t=>t)){return{query:e(n),ref:n}}let Rk=(()=>{class n{constructor(t,r,i,a,l,h,m,v,C,T,x,$,Y,Ie,Re,_t,Et){this.schedulers=m;const vt=(0,$r.on)(t,h,r),wt=C;T&&TR(vt,h,x,Y,Ie,Re,$,_t),[this.firestore,this.persistenceEnabled$]=(0,$r.cc)(`${vt.name}.firestore`,"AngularFirestore",vt.name,()=>{const Wt=h.runOutsideAngular(()=>vt.firestore());if(a&&Wt.settings(a),wt&&Wt.useEmulator(...wt),i&&!oc(l)){const sn=()=>{try{return(0,qt.D)(Wt.enablePersistence(v||void 0).then(()=>!0,()=>!1))}catch(li){return typeof console<"u"&&console.warn(li),ot(!1)}};return[Wt,h.runOutsideAngular(sn)]}return[Wt,ot(!1)]},[a,wt,i])}collection(t,r){let i;i="string"==typeof t?this.firestore.collection(t):t;const{ref:a,query:l}=Ak(i,r),h=this.schedulers.ngZone.run(()=>a);return new Ck(h,l,this)}collectionGroup(t,r){const i=r||(l=>l),a=this.firestore.collectionGroup(t);return new UU(i(a),this)}doc(t){let r;r="string"==typeof t?this.firestore.doc(t):t;const i=this.schedulers.ngZone.run(()=>r);return new Dk(i,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(g.LFG($r.Dh),g.LFG($r.xv,8),g.LFG(Tk,8),g.LFG(VU,8),g.LFG(g.Lbi),g.LFG(g.R0b),g.LFG(En.HU),g.LFG(Sk,8),g.LFG(BU,8),g.LFG(O0,8),g.LFG(wR,8),g.LFG(ER,8),g.LFG(IR,8),g.LFG(bR,8),g.LFG(CR,8),g.LFG(DR,8),g.LFG(N0,8))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),jU=(()=>{class n{constructor(){bC.Z.registerVersion("angularfire",En.q4.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:Tk,useValue:!0},{provide:Sk,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({providers:[Rk]}),n})();class so{constructor(e,t,r,i){this.afs=e,this.afAuth=t,this.router=r,this.ngZone=i,this.afAuth.authState.subscribe(a=>{a?(this.userData=a,localStorage.setItem("user",JSON.stringify(this.userData)),JSON.parse(localStorage.getItem("user"))):(localStorage.setItem("user","null"),JSON.parse(localStorage.getItem("user")))})}SignIn(e,t){return this.afAuth.signInWithEmailAndPassword(e,t).then(r=>{this.SetUserData(r.user),this.afAuth.authState.subscribe(i=>{i&&this.router.navigate(["dashboard"])})}).catch(r=>{window.alert(r.message)})}SignUp(e,t){return this.afAuth.createUserWithEmailAndPassword(e,t).then(r=>{this.SendVerificationMail(),this.SetUserData(r.user)}).catch(r=>{window.alert(r.message)})}SendVerificationMail(){return this.afAuth.currentUser.then(e=>e.sendEmailVerification()).then(()=>{this.router.navigate(["verify-email-address"])})}ForgotPassword(e){return this.afAuth.sendPasswordResetEmail(e).then(()=>{window.alert("Password reset email sent, check your inbox.")}).catch(t=>{window.alert(t)})}get isLoggedIn(){const e=JSON.parse(localStorage.getItem("user"));return null!==e&&!1!==e.emailVerified}GoogleAuth(){return this.AuthLogin(new ET.Q).then(e=>{this.router.navigate(["dashboard"])})}AuthLogin(e){return this.afAuth.signInWithPopup(e).then(t=>{this.router.navigate(["dashboard"]),this.SetUserData(t.user)}).catch(t=>{window.alert(t)})}SetUserData(e){return this.afs.doc(`users/${e.uid}`).set({uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,emailVerified:e.emailVerified},{merge:!0})}SignOut(){return this.afAuth.signOut().then(()=>{localStorage.removeItem("user"),this.router.navigate(["sign-in"])})}}so.\u0275fac=function(e){return new(e||so)(g.LFG(Rk),g.LFG(O0),g.LFG(vr),g.LFG(g.R0b))},so.\u0275prov=g.Yz7({token:so,factory:so.\u0275fac,providedIn:"root"});class L0{constructor(e,t,r){this.authService=e,this.router=t,this.appRoutingModule=r,this.btnClick=()=>{this.router.navigateByUrl("/user")}}ngOnInit(){}goToForgotPassword(){this.router.navigate(["/forgot-password"])}goToSignUp(){this.router.navigate(["/sign-up"])}}L0.\u0275fac=function(e){return new(e||L0)(g.Y36(so),g.Y36(vr),g.Y36(Sa))},L0.\u0275cmp=g.Xpm({type:L0,selectors:[["app-sign-in"]],decls:31,vars:0,consts:[[1,"displayTable"],[1,"displayTableCell"],[1,"authBlock"],[1,"formGroup"],["type","text","placeholder"," Username","required","",1,"formControl",2,"margin-top","3px"],["userName",""],["type","password","placeholder"," Password","required","",1,"formControl"],["userPassword",""],[1,"butonLogin"],["type","button","value","Sign In",1,"btn","btnPrimary",3,"click"],[2,"margin-top","15px"],["type","button",1,"butonGoogle",3,"click"],[1,"fab","fa-google-plus-g"],[1,"forgotPassword"],[1,"uitare"],["routerLink","/forgot-password",3,"click"],[1,"redirectToLogin"],[1,"signUpbuton"],["routerLink","/sign-up",1,"redirect",3,"click"]],template:function(e,t){if(1&e){const r=g.EpF();g.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),g._uU(4,"Sign In"),g.qZA(),g.TgZ(5,"div",3),g._UZ(6,"input",4,5),g.qZA(),g.TgZ(8,"div",3),g._UZ(9,"input",6,7),g.qZA(),g.TgZ(11,"div",3)(12,"button",8)(13,"input",9),g.NdJ("click",function(){g.CHM(r);const a=g.MAs(7),l=g.MAs(10);return g.KtG(t.authService.SignIn(a.value,l.value))}),g.qZA()()(),g.TgZ(14,"div",3)(15,"h5",10),g._uU(16,"Or"),g.qZA()(),g.TgZ(17,"div",3)(18,"button",11),g.NdJ("click",function(){return t.authService.GoogleAuth()}),g._UZ(19,"i",12),g._uU(20," Sign In With Google "),g.qZA()(),g.TgZ(21,"div",13)(22,"button",14)(23,"a",15),g.NdJ("click",function(){return t.goToForgotPassword()}),g._uU(24,"Forgot Password"),g.qZA()()()(),g.TgZ(25,"div",16)(26,"span"),g._uU(27,"Don't have an account?"),g.TgZ(28,"button",17)(29,"span",18),g.NdJ("click",function(){return t.goToSignUp()}),g._uU(30," Sign Up Here"),g.qZA()()()()()()}},styles:[".displayTable[_ngcontent-%COMP%]{display:flex;justify-content:center;padding-top:150px}.butonLogin[_ngcontent-%COMP%]{margin-top:15px;color:#000;background-color:#fff;border-radius:20px;text-align:center;cursor:pointer;border-color:#fff}.butonLogin[_ngcontent-%COMP%]:hover{background-color:#000;color:#fff;border-color:#000}.formControl[_ngcontent-%COMP%]{color:#000;background-color:#fff;border-radius:20px;border-color:#fff}.butonGoogle[_ngcontent-%COMP%]{margin-top:15px;color:red;background-color:#fff;border-radius:20px;text-align:center;cursor:pointer;border-color:#fff}.butonGoogle[_ngcontent-%COMP%]:hover{background-color:red;color:#fff;border-color:red}.uitare[_ngcontent-%COMP%]{margin-top:55px;color:#000;background-color:#fff;border-radius:20px;text-align:center;cursor:pointer;border-color:#fff}.uitare[_ngcontent-%COMP%]:hover{background-color:#000;color:#fff;border-color:#000}.redirectToLogin[_ngcontent-%COMP%]{color:#fff}.signUpbuton[_ngcontent-%COMP%]{margin-left:10px;color:#000;background-color:#fff;border-radius:20px;text-align:center;cursor:pointer;border-color:#fff}.signUpbuton[_ngcontent-%COMP%]:hover{background-color:#000;color:#fff;border-color:#000}"]});class Vm{constructor(e,t){this.authService=e,this.router=t}goToSignIn(){this.router.navigate(["/sign-in"])}ngOnInit(){}}function $U(n,e){if(1&n&&(g.TgZ(0,"div",1)(1,"div",17)(2,"div",18),g._UZ(3,"img",19),g.TgZ(4,"h1"),g._uU(5,"Hello: "),g.TgZ(6,"strong"),g._uU(7),g.qZA()(),g.TgZ(8,"div",20)(9,"p"),g._uU(10,"User ID: "),g.TgZ(11,"strong"),g._uU(12),g.qZA()(),g.TgZ(13,"p"),g._uU(14,"Email: "),g.TgZ(15,"strong"),g._uU(16),g.qZA()(),g.TgZ(17,"p"),g._uU(18,"Email Verified: "),g.TgZ(19,"strong"),g._uU(20),g.qZA()()()()()()),2&n){const t=e.ngIf;g.xp6(3),g.s9C("src",t.photoURL?t.photoURL:"/assets/poza.png",g.LSH),g.s9C("alt",t.displayName),g.xp6(4),g.Oqu(t.displayName?t.displayName:"User"),g.xp6(5),g.Oqu(t.uid),g.xp6(4),g.Oqu(t.email),g.xp6(4),g.Oqu(t.emailVerified)}}Vm.\u0275fac=function(e){return new(e||Vm)(g.Y36(so),g.Y36(vr))},Vm.\u0275cmp=g.Xpm({type:Vm,selectors:[["app-sign-up"]],decls:28,vars:0,consts:[[1,"displayTable"],[1,"displayTableCell"],[1,"authBlock"],[1,"titlu"],[1,"formGroup"],["type","email","placeholder"," Email Address","required","",1,"formControl"],["userEmail",""],["type","password","placeholder"," Password","required","",1,"formControl"],["userPwd",""],[1,"butonSignUp"],["type","button","value","Sign Up",1,"btn","btnPrimary",3,"click"],[2,"margin-top","15px"],["type","button",1,"butonGoogle",3,"click"],[1,"fab","fa-google-plus-g"],[1,"redirectToLogin"],[1,"buttonUitareSignIn"],["routerLink","/sign-in",1,"redirect",3,"click"]],template:function(e,t){if(1&e){const r=g.EpF();g.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3"),g._uU(5,"Sign Up"),g.qZA()(),g.TgZ(6,"div",4),g._UZ(7,"input",5,6),g.qZA(),g.TgZ(9,"div",4),g._UZ(10,"input",7,8),g.qZA(),g.TgZ(12,"div",4)(13,"button",9)(14,"input",10),g.NdJ("click",function(){g.CHM(r);const a=g.MAs(8),l=g.MAs(11);return g.KtG(t.authService.SignUp(a.value,l.value))}),g.qZA()()(),g.TgZ(15,"div",4)(16,"h5",11),g._uU(17,"Or"),g.qZA()(),g.TgZ(18,"div",4)(19,"button",12),g.NdJ("click",function(){return t.authService.GoogleAuth()}),g._UZ(20,"i",13),g._uU(21," Continue With Google "),g.qZA()()(),g.TgZ(22,"div",14)(23,"span"),g._uU(24,"Already have an account? "),g.TgZ(25,"button",15)(26,"span",16),g.NdJ("click",function(){return t.goToSignIn()}),g._uU(27,"Sign In"),g.qZA()()()()()()}},styles:[".titlu[_ngcontent-%COMP%]{padding-top:22px;padding-left:27px}.formControl[_ngcontent-%COMP%]{color:#000;background-color:#fff;border-radius:20px;border-color:#fff}.formGroup[_ngcontent-%COMP%]{padding-left:27px}.butonSignUp[_ngcontent-%COMP%]{margin-top:15px;color:#000;background-color:#fff;border-radius:20px;text-align:center;cursor:pointer;border-color:#fff}.butonSignUp[_ngcontent-%COMP%]:hover{background-color:#000;color:#fff;border-color:#000}.butonGoogle[_ngcontent-%COMP%]{margin-top:15px;color:red;background-color:#fff;border-radius:20px;text-align:center;cursor:pointer;border-color:#fff}.butonGoogle[_ngcontent-%COMP%]:hover{background-color:red;color:#fff;border-color:red}.redirectToLogin[_ngcontent-%COMP%]{padding-top:15px;padding-left:27px}.buttonUitareSignIn[_ngcontent-%COMP%]{margin-left:10px;color:#000;background-color:#fff;border-radius:20px;text-align:center;cursor:pointer;border-color:#fff}.buttonUitareSignIn[_ngcontent-%COMP%]:hover{background-color:#000;color:#fff;border-color:#000}"]});class F0{constructor(e,t,r){this.authService=e,this.router=t,this.appRoutingModule=r}ngOnInit(){}goToMap(){this.router.navigate(["/map"])}}F0.\u0275fac=function(e){return new(e||F0)(g.Y36(so),g.Y36(vr),g.Y36(Sa))},F0.\u0275cmp=g.Xpm({type:F0,selectors:[["app-dashboard"]],decls:21,vars:1,consts:[[1,"container-fluid"],[1,"row"],[1,"col-md-2","d-md-block","sidebar"],[1,"sidebarSticky"],[1,"nav","flex-column"],[1,"nav-item"],["routerLink","/map",1,"userCss",3,"click"],[1,"nav-link","active"],[1,"fas","fa-user"],[1,"logOutCss"],[1,"nav-link",3,"click"],[1,"fas","fa-sign-out-alt"],["role","main",1,"col-md-9","ml-sm-auto","col-lg-10","px-4"],[1,"inner-adjust"],[1,"pt-3","pb-2","mb-3","border-bottom"],[1,"h2"],["class","row",4,"ngIf"],[1,"col-md-12"],[1,"media"],[1,"align-self-start","mr-5","img-thumbnail","rounded-circle",3,"src","alt"],[1,"media-body"]],template:function(e,t){1&e&&(g.TgZ(0,"div",0)(1,"div",1)(2,"nav",2)(3,"div",3)(4,"ul",4)(5,"li",5)(6,"button",6),g.NdJ("click",function(){return t.goToMap()}),g.TgZ(7,"a",7),g._UZ(8,"i",8),g._uU(9,"Map "),g.qZA()()(),g.TgZ(10,"li",5)(11,"button",9)(12,"a",10),g.NdJ("click",function(){return t.authService.SignOut()}),g._UZ(13,"i",11),g._uU(14,"Sign Out "),g.qZA()()()()()(),g.TgZ(15,"main",12)(16,"div",13)(17,"div",14)(18,"h1",15),g._uU(19,"User Profile"),g.qZA()(),g.YNc(20,$U,21,6,"div",16),g.qZA()()()()),2&e&&(g.xp6(20),g.Q6J("ngIf",t.authService.userData))},dependencies:[Fn,$h],styles:[".sidebar[_ngcontent-%COMP%]{background-color:transparent}.media[_ngcontent-%COMP%]{width:47px}.userCss[_ngcontent-%COMP%]{margin-top:15px;color:#000;background-color:#fff;border-radius:20px;text-align:center;cursor:pointer;border-color:#fff}.userCss[_ngcontent-%COMP%]:hover{background-color:#000;color:#fff;border-color:#000}.logOutCss[_ngcontent-%COMP%]{margin-top:15px;color:#000;background-color:#fff;border-radius:20px;text-align:center;cursor:pointer;border-color:#fff}.logOutCss[_ngcontent-%COMP%]:hover{background-color:#000;color:#fff;border-color:#000}"]});class U0{constructor(e,t,r){this.authService=e,this.router=t,this.appRoutingModule=r}ngOnInit(){}goToSignIn(){this.router.navigate(["/sign-in"])}}function HU(n,e){if(1&n&&(g.TgZ(0,"div",5)(1,"p",11),g._uU(2,"We have sent a confirmation email to "),g.TgZ(3,"strong"),g._uU(4),g.qZA(),g._uU(5,"."),g.qZA(),g.TgZ(6,"p",12),g._uU(7,"Please check your email and click on the link to verify your email address."),g.qZA()()),2&n){const t=e.ngIf;g.xp6(4),g.Oqu(t.email)}}U0.\u0275fac=function(e){return new(e||U0)(g.Y36(so),g.Y36(vr),g.Y36(Sa))},U0.\u0275cmp=g.Xpm({type:U0,selectors:[["app-forgot-password"]],decls:19,vars:0,consts:[[1,"displayTable"],[1,"displayTableCell"],[1,"authBlock"],[1,"titlu"],[1,"textCenter"],[1,"formGroup"],["type","email","placeholder"," Email Address","required","",1,"formControl"],["passwordResetEmail",""],["type","submit","value","Reset Password",1,"btn","btnPrimary",3,"click"],[1,"redirectToLogin"],[1,"buttonUitareSignIn"],["routerLink","/sign-in",1,"redirect",3,"click"]],template:function(e,t){if(1&e){const r=g.EpF();g.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3"),g._uU(5,"Reset Password"),g.qZA()(),g.TgZ(6,"p",4),g._uU(7,"Please enter your email address to request a password reset."),g.qZA(),g.TgZ(8,"div",5),g._UZ(9,"input",6,7),g.qZA(),g.TgZ(11,"div",5)(12,"input",8),g.NdJ("click",function(){g.CHM(r);const a=g.MAs(10);return g.KtG(t.authService.ForgotPassword(a.value))}),g.qZA()()(),g.TgZ(13,"div",9)(14,"span"),g._uU(15,"Do you want to go back to?"),g.TgZ(16,"button",10)(17,"span",11),g.NdJ("click",function(){return t.goToSignIn()}),g._uU(18,"Sign In"),g.qZA()()()()()()}},styles:[".titlu[_ngcontent-%COMP%]{padding-top:22px;padding-left:27px}.textCenter[_ngcontent-%COMP%]{padding-top:15px;padding-left:27px}.formControl[_ngcontent-%COMP%]{color:#000;background-color:#fff;border-radius:20px;border-color:#fff}.btnPrimary[_ngcontent-%COMP%]{margin-top:15px;color:#000;background-color:#fff;border-radius:20px;text-align:center;cursor:pointer;border-color:#fff}.btnPrimary[_ngcontent-%COMP%]:hover{background-color:#000;color:#fff;border-color:#000}.formGroup[_ngcontent-%COMP%]{padding-left:27px}.redirectToLogin[_ngcontent-%COMP%]{padding-top:15px;padding-left:27px}.buttonUitareSignIn[_ngcontent-%COMP%]{margin-left:10px;color:#000;background-color:#fff;border-radius:20px;text-align:center;cursor:pointer;border-color:#fff}.buttonUitareSignIn[_ngcontent-%COMP%]:hover{background-color:#000;color:#fff;border-color:#000}"]});class V0{constructor(e,t,r){this.authService=e,this.router=t,this.appRoutingModule=r}ngOnInit(){}goToSignIn(){this.router.navigate(["/sign-in"])}}V0.\u0275fac=function(e){return new(e||V0)(g.Y36(so),g.Y36(vr),g.Y36(Sa))},V0.\u0275cmp=g.Xpm({type:V0,selectors:[["app-verify-email"]],decls:17,vars:1,consts:[[1,"displayTable"],[1,"displayTableCell"],[1,"authBlock"],[1,"titlu"],["class","formGroup",4,"ngIf"],[1,"formGroup"],["type","button",1,"btn","btnPrimary",3,"click"],[1,"fas","fa-redo-alt"],[1,"redirectToLogin"],[1,"buttonUitareSignIn"],["routerLink","/sign-in",1,"redirect",3,"click"],[1,"textCenter",2,"margin-top","15px"],[1,"textCenter",2,"margin-top","5px"]],template:function(e,t){1&e&&(g.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3"),g._uU(5,"Thank You For Registering"),g.qZA()(),g.YNc(6,HU,8,1,"div",4),g.TgZ(7,"div",5)(8,"button",6),g.NdJ("click",function(){return t.authService.SendVerificationMail()}),g._UZ(9,"i",7),g._uU(10," Resend Verification Email "),g.qZA()()(),g.TgZ(11,"div",8)(12,"span"),g._uU(13,"Do you want to go back to?"),g.TgZ(14,"button",9)(15,"span",10),g.NdJ("click",function(){return t.goToSignIn()}),g._uU(16,"Sign In"),g.qZA()()()()()()),2&e&&(g.xp6(6),g.Q6J("ngIf",t.authService.userData))},styles:[".titlu[_ngcontent-%COMP%]{padding-top:22px;padding-left:27px}.btnPrimary[_ngcontent-%COMP%]{margin-top:15px;color:#000;background-color:#fff;border-radius:20px;text-align:center;cursor:pointer;border-color:#fff}.btnPrimary[_ngcontent-%COMP%]:hover{background-color:#000;color:#fff;border-color:#000}.formGroup[_ngcontent-%COMP%]{padding-left:27px}.redirectToLogin[_ngcontent-%COMP%]{padding-top:15px;padding-left:27px}.buttonUitareSignIn[_ngcontent-%COMP%]{margin-left:10px;color:#000;background-color:#fff;border-radius:20px;text-align:center;cursor:pointer;border-color:#fff}.buttonUitareSignIn[_ngcontent-%COMP%]:hover{background-color:#000;color:#fff;border-color:#000}"]});class Bm{constructor(e,t){this.authService=e,this.router=t}canActivate(e,t){return!0!==this.authService.isLoggedIn&&this.router.navigate(["sign-in"]),!0}}Bm.\u0275fac=function(e){return new(e||Bm)(g.LFG(so),g.LFG(vr))},Bm.\u0275prov=g.Yz7({token:Bm,factory:Bm.\u0275fac,providedIn:"root"});var xk=M(7082);const GU=["mapViewNode"];class B0{constructor(e,t,r){this.authService=e,this.router=t,this.appRoutingModule=r,this.mapLoadedEvent=new g.vpe,this.zoom=12.5,this.center=[26.05526,44.444589],this.basemap="arcgis-topographic",this.loaded=!1,this.pointCoords=[26.05526,44.444589],this.dir=0,this.count=0,this.timeoutHandler=null}initializeMap(){var e=this;return(0,Ce.Z)(function*(){try{(0,xk.setDefaultOptions)({css:!0});const[t,r,i,a,l,h,m,v,C,T,x,$,Y]=yield(0,xk.loadModules)(["esri/config","esri/Map","esri/views/MapView","esri/layers/FeatureLayer","esri/Graphic","esri/geometry/Point","esri/layers/GraphicsLayer","esri/rest/route","esri/rest/support/RouteParameters","esri/rest/support/FeatureSet","esri/widgets/Search","esri/widgets/Locate","esri/widgets/Track"]);t.apiKey="AAPK19cc5ed287f34a649cf16f254420dedffsQjqs3kRR14R4hp7_x402Ak34cIuHmeUWVKwuywgYavggqCfHdwevE48_0sLHSp",e._Map=r,e._MapView=i,e._FeatureLayer=a,e._Graphic=l,e._GraphicsLayer=m,e._Route=v,e._RouteParameters=C,e._FeatureSet=T,e._Point=new h(e.pointCoords[0],e.pointCoords[1]),e.map=new r({basemap:"arcgis-navigation"}),e.addFeatureLayers(),e.addGraphicLayers(),e.addPoint(e.pointCoords[1],e.pointCoords[0]),e.view=new i({container:e.mapViewEl.nativeElement,center:[26.05526,44.444589],zoom:e.zoom,map:e.map});const Et=new x({view:e.view});e.view.ui.add(Et,"top-right");const vt=new $({view:e.view,useHeadingEnabled:!1,goToOverride:function(Wt,sn){return sn.target.scale=1500,Wt.goTo(sn.target)}});e.view.ui.add(vt,"top-left");const wt=new Y({view:e.view,graphic:new l({symbol:{type:"simple-marker",size:"12px",color:"green",outline:{color:"#efefef",width:"1.5px"}}}),useHeadingEnabled:!1});return e.view.ui.add(wt,"top-left"),yield e.view.when(),console.log("ArcGIS map loaded"),e.addRouter(),console.log("Map center: "+e.view.center.latitude+", "+e.view.center.longitude),e.view}catch(t){console.log("EsriLoader: ",t)}})()}addGraphicLayers(){this.graphicsLayer=new this._GraphicsLayer,this.map.add(this.graphicsLayer)}addFeatureLayers(){var e=new this._FeatureLayer({url:"https://services7.arcgis.com/q3jnX0CLBpfNBGZ6/arcgis/rest/services/terenurifotbalregie/FeatureServer/0"});this.map.add(e);const t={title:"Trailhead",content:"<b>Name:</b> {Name}<br><b>Fulladdress:</b> {Fulladdress}<br><b>Street:</b> {Street}<br><b>Featured image: </b> {Featured_image} <br><b>Municipality:</b> {Municipality}<br><b>Categories:</b> {Categories}<br><b>Phones:</b> {Phones}<br><b>Claimed:</b> {Claimed}<br><b>Opening hours: </b> {Opening_hours}<br><b>Review Count:</b> {Review_Count}<br><b>Average Rating:</b> {Average_Rating}<br><b>Review URL</b> {Review_URL}<br><b>Google Maps URL: </b> {Google_Maps_URL}<br><b>Website: </b> {Website}<br><b>Latitude:</b> {Latitude}<br><b>Longitude: </b> {Longitude} ft"};t.content=t.content.replace("{Featured_image}","<img src='{Featured_image}' style='max-width:200px;max-height:200px;'/>"),t.content=t.content.replace("{Review_URL}","<a href='{Review_URL}' target='_blank'>Review</a>"),t.content=t.content.replace("{Google_Maps_URL}","<a href='{Google_Maps_URL}' target='_blank'>Google Maps Link</a>"),t.content=t.content.replace("{Website}","<a href='{Website}' target='_blank'>Website</a>");var r=new this._FeatureLayer({url:"https://services7.arcgis.com/q3jnX0CLBpfNBGZ6/arcgis/rest/services/terenurifotbalregie/FeatureServer/0",popupTemplate:t});this.map.add(r,0);var i=new this._FeatureLayer({url:"https://services7.arcgis.com/q3jnX0CLBpfNBGZ6/arcgis/rest/services/terenurifotbalregie/FeatureServer/0"});this.map.add(i,0),console.log("feature layers added")}addPoint(e,t){this.graphicsLayer=new this._GraphicsLayer,this.map.add(this.graphicsLayer),this.pointGraphic=new this._Graphic({geometry:{type:"point",longitude:t,latitude:e},symbol:{type:"simple-marker",color:[226,119,40],outline:{color:[255,255,255],width:1}}}),this.graphicsLayer.add(this.pointGraphic)}removePoint(){null!=this.pointGraphic&&this.graphicsLayer.remove(this.pointGraphic)}addRouter(){this.view.on("click",i=>{console.log("point clicked: ",i.mapPoint.latitude,i.mapPoint.longitude),0===this.view.graphics.length?t("origin",i.mapPoint):1===this.view.graphics.length?(t("destination",i.mapPoint),r()):(this.view.graphics.removeAll(),t("origin",i.mapPoint))});var t=(i,a)=>{const l=new this._Graphic({symbol:{type:"simple-marker",color:"origin"===i?"white":"black",size:"8px"},geometry:a});this.view.graphics.add(l)},r=()=>{const i=new this._RouteParameters({stops:new this._FeatureSet({features:this.view.graphics.toArray()}),returnDirections:!0,directionsLanguage:"ro"});this._Route.solve("https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",i).then(a=>{for(let l of a.routeResults)l.route.symbol={type:"simple-line",color:[5,150,255],width:3},this.view.graphics.add(l.route);if(a.routeResults.length>0){const l=document.createElement("ol");l.classList="esri-widget esri-widget--panel esri-directions__scroller",l.style.marginTop="0",l.style.padding="15px 15px 15px 30px";let m=0;a.routeResults[0].directions.features.forEach((v,C)=>{m+=parseFloat(v.attributes.length);const T=document.createElement("li");let $=1.609344*v.attributes.length*1e3;$=Math.round($),T.innerHTML=v.attributes.text+" ("+$+") m",l.appendChild(T)}),m*=1.609344,console.log("dist (km) = ",m),this.view.ui.empty("top-right"),this.view.ui.add(l,"top-right")}}).catch(a=>{console.log(a)})}}runTimer(){this.timeoutHandler=setTimeout(()=>{this.runTimer()},200)}animatePointDemo(){switch(this.removePoint(),this.dir){case 0:this.pointCoords[1]+=.01;break;case 1:this.pointCoords[0]+=.02;break;case 2:this.pointCoords[1]-=.01;break;case 3:this.pointCoords[0]-=.02}this.count+=1,this.count>=10&&(this.count=0,this.dir+=1,this.dir>3&&(this.dir=0)),this.addPoint(this.pointCoords[1],this.pointCoords[0])}stopTimer(){null!=this.timeoutHandler&&(clearTimeout(this.timeoutHandler),this.timeoutHandler=null)}ngOnInit(){this.initializeMap().then(()=>{console.log("mapView ready: ",this.view.ready),this.loaded=this.view.ready,this.mapLoadedEvent.emit(!0),this.runTimer()})}ngOnDestroy(){this.view&&(this.view.container=null),this.stopTimer()}goToDashboard(){this.router.navigate(["/dashboard"])}}B0.\u0275fac=function(e){return new(e||B0)(g.Y36(so),g.Y36(vr),g.Y36(Sa))},B0.\u0275cmp=g.Xpm({type:B0,selectors:[["app-esri-map"]],viewQuery:function(e,t){if(1&e&&g.Gf(GU,7),2&e){let r;g.iGM(r=g.CRH())&&(t.mapViewEl=r.first)}},outputs:{mapLoadedEvent:"mapLoadedEvent"},decls:17,vars:0,consts:[["fxLayout","row"],["fxFlex","20%","fxLayout","column"],["fxFlex","80%"],["mapViewNode",""],[1,"sidebarSticky"],[1,"nav","flex-column"],[1,"nav-item"],["routerLink","/dashboard",1,"userCss",3,"click"],[1,"nav-link","active"],[1,"fas","fa-user"],[1,"logOutCss"],[1,"nav-link",3,"click"],[1,"fas","fa-sign-out-alt"]],template:function(e,t){1&e&&(g.TgZ(0,"div",0),g._UZ(1,"div",1),g.TgZ(2,"div",2),g._UZ(3,"div",null,3),g.qZA()(),g.TgZ(5,"div",4)(6,"ul",5)(7,"li",6)(8,"button",7),g.NdJ("click",function(){return t.goToDashboard()}),g.TgZ(9,"a",8),g._UZ(10,"i",9),g._uU(11,"Go Back To User Profile "),g.qZA()()(),g.TgZ(12,"li",6)(13,"button",10)(14,"a",11),g.NdJ("click",function(){return t.authService.SignOut()}),g._UZ(15,"i",12),g._uU(16,"Sign Out "),g.qZA()()()()())},styles:[".esri-view[_ngcontent-%COMP%]{height:555px}.label[_ngcontent-%COMP%]{font-size:18px;text-align:center;padding-top:10px;padding-bottom:10px}.full-w[_ngcontent-%COMP%]{width:100%}.userCss[_ngcontent-%COMP%]{margin-top:10px;margin-left:10px;color:#000;background-color:#fff;border-radius:20px;text-align:center;cursor:pointer;border-color:#fff}.userCss[_ngcontent-%COMP%]:hover{background-color:#000;color:#fff;border-color:#000}.logOutCss[_ngcontent-%COMP%]{margin-top:10px;margin-left:10px;color:#000;background-color:#fff;border-radius:20px;text-align:center;cursor:pointer;border-color:#fff}.logOutCss[_ngcontent-%COMP%]:hover{background-color:#000;color:#fff;border-color:#000}"]});const zU=[{path:"",redirectTo:"/sign-in",pathMatch:"full"},{path:"sign-in",component:L0},{path:"register-user",component:Vm},{path:"sign-up",component:Vm},{path:"dashboard",component:F0,canActivate:[Bm]},{path:"forgot-password",component:U0},{path:"verify-email-address",component:V0},{path:"map",component:B0}];class Sa{}Sa.\u0275fac=function(e){return new(e||Sa)},Sa.\u0275mod=g.oAB({type:Sa}),Sa.\u0275inj=g.cJS({imports:[Ey.forRoot(zU),Ey]});class j0{constructor(){this.title="proiect-isi",this.tabs=[{name:"Map",link:"/map"}]}mapLoadedEvent(e){console.log("The map loaded: "+e)}}j0.\u0275fac=function(e){return new(e||j0)},j0.\u0275cmp=g.Xpm({type:j0,selectors:[["app-root"]],decls:2,vars:0,consts:[[1,"spate"]],template:function(e,t){1&e&&(g.TgZ(0,"div",0),g._UZ(1,"router-outlet"),g.qZA())},dependencies:[Jw],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0}.spate[_ngcontent-%COMP%]{background-image:url(/assets/fundal.jpeg);background-repeat:no-repeat;background-size:100% 100%;height:100vh;color:#fff}"]});const Mk="firebasestorage.googleapis.com",Pk="storageBucket";class Hr extends N.ZR{constructor(e,t){super(RR(e),`Firebase Storage: ${t} (${RR(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Hr.prototype)}_codeEquals(e){return RR(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}function RR(n){return"storage/"+n}function xR(){return new Hr("unknown","An unknown error occurred, please check the error payload for server response.")}function kk(){return new Hr("canceled","User canceled the upload/download.")}function Nk(){return new Hr("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function jm(n){return new Hr("invalid-argument",n)}function Ok(){return new Hr("app-deleted","The Firebase app was deleted.")}function Lk(n){return new Hr("invalid-root-operation","The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function $0(n,e){return new Hr("invalid-format","String does not match format '"+n+"': "+e)}function H0(n){throw new Hr("internal-error","Internal error: "+n)}class Qi{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=Qi.makeFromUrl(e,t)}catch{return new Qi(e,"")}if(""===r.path)return r;throw function n2(n){return new Hr("invalid-default-bucket","Invalid default bucket '"+n+"'.")}(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)",h=new RegExp("^gs://"+i+"(/(.*))?$","i");function v(wt){wt.path_=decodeURIComponent(wt.path)}const T=t.replace(/[.]/g,"\\."),vt=[{regex:h,indices:{bucket:1,path:3},postModify:function a(wt){"/"===wt.path.charAt(wt.path.length-1)&&(wt.path_=wt.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${T}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:v},{regex:new RegExp(`^https?://${t===Mk?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:v}];for(let wt=0;wt<vt.length;wt++){const Wt=vt[wt],sn=Wt.regex.exec(e);if(sn){let ka=sn[Wt.indices.path];ka||(ka=""),r=new Qi(sn[Wt.indices.bucket],ka),Wt.postModify(r);break}}if(null==r)throw function t2(n){return new Hr("invalid-url","Invalid URL '"+n+"'.")}(e);return r}}class o2{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function DC(n){return"string"==typeof n||n instanceof String}function Fk(n){return MR()&&n instanceof Blob}function MR(){return typeof Blob<"u"}function PR(n,e,t,r){if(r<e)throw jm(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw jm(`Invalid value for '${n}'. Expected ${t} or less.`)}function Ql(n,e,t){let r=e;return null==t&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function Uk(n){const e=encodeURIComponent;let t="?";for(const r in n)n.hasOwnProperty(r)&&(t=t+(e(r)+"=")+e(n[r])+"&");return t=t.slice(0,-1),t}var Vd=(()=>(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"}(Vd||(Vd={})),Vd))();class h2{constructor(e,t,r,i,a,l,h,m,v,C,T){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=l,this.callback_=h,this.errorCallback_=m,this.timeout_=v,this.progressCallback_=C,this.connectionFactory_=T,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((x,$)=>{this.resolve_=x,this.reject_=$,this.start_()})}start_(){const t=(r,i)=>{const a=this.resolve_,l=this.reject_,h=i.connection;if(i.wasSuccessCode)try{const m=this.callback_(h,h.getResponse());!function l2(n){return void 0!==n}(m)?a():a(m)}catch(m){l(m)}else if(null!==h){const m=xR();m.serverResponse=h.getErrorText(),l(this.errorCallback_?this.errorCallback_(h,m):m)}else l(i.canceled?this.appDelete_?Ok():kk():function e2(){return new Hr("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}())};this.canceled_?t(0,new TC(!1,null,!0)):this.backoffId_=function a2(n,e,t){let r=1,i=null,a=null,l=!1,h=0;function m(){return 2===h}let v=!1;function C(...Re){v||(v=!0,e.apply(null,Re))}function T(Re){i=setTimeout(()=>{i=null,n($,m())},Re)}function x(){a&&clearTimeout(a)}function $(Re,..._t){if(v)return void x();if(Re)return x(),void C.call(null,Re,..._t);if(m()||l)return x(),void C.call(null,Re,..._t);let vt;r<64&&(r*=2),1===h?(h=2,vt=0):vt=1e3*(r+Math.random()),T(vt)}let Y=!1;function Ie(Re){Y||(Y=!0,x(),!v&&(null!==i?(Re||(h=2),clearTimeout(i),T(0)):Re||(h=1)))}return T(0),a=setTimeout(()=>{l=!0,Ie(!0)},t),Ie}((r,i)=>{if(i)return void r(!1,new TC(!1,null,!0));const a=this.connectionFactory_();this.pendingConnection_=a;const l=h=>{null!==this.progressCallback_&&this.progressCallback_(h.loaded,h.lengthComputable?h.total:-1)};null!==this.progressCallback_&&a.addUploadProgressListener(l),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&a.removeUploadProgressListener(l),this.pendingConnection_=null;const h=a.getErrorCode()===Vd.NO_ERROR,m=a.getStatus();if(!h||this.isRetryStatusCode_(m)){const C=a.getErrorCode()===Vd.ABORT;return void r(!1,new TC(!1,null,C))}const v=-1!==this.successCodes_.indexOf(m);r(!0,new TC(v,a))})},t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function u2(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const t=e>=500&&e<600,i=-1!==[408,429].indexOf(e),a=-1!==this.additionalRetryCodes_.indexOf(e);return t||i||a}}class TC{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function v2(...n){const e=function y2(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==e){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}if(MR())return new Blob(n);throw new Hr("unsupported-environment","This browser doesn't seem to support creating Blobs")}const oo={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class kR{constructor(e,t){this.data=e,this.contentType=t||null}}function NR(n,e){switch(n){case oo.RAW:return new kR(Vk(e));case oo.BASE64:case oo.BASE64URL:return new kR(Bk(n,e));case oo.DATA_URL:return new kR(function b2(n){const e=new jk(n);return e.base64?Bk(oo.BASE64,e.rest):function I2(n){let e;try{e=decodeURIComponent(n)}catch{throw $0(oo.DATA_URL,"Malformed data URL.")}return Vk(e)}(e.rest)}(e),function C2(n){return new jk(n).contentType}(e))}throw xR()}function Vk(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?t<n.length-1&&56320==(64512&n.charCodeAt(t+1))?(r=65536|(1023&r)<<10|1023&n.charCodeAt(++t),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function Bk(n,e){switch(n){case oo.BASE64:{const i=-1!==e.indexOf("-"),a=-1!==e.indexOf("_");if(i||a)throw $0(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case oo.BASE64URL:{const i=-1!==e.indexOf("+"),a=-1!==e.indexOf("/");if(i||a)throw $0(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=function E2(n){return atob(n)}(e)}catch{throw $0(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}class jk{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw $0(oo.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;null!=r&&(this.base64=function D2(n,e){return n.length>=e.length&&n.substring(n.length-e.length)===e}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}class Mu{constructor(e,t){let r=0,i="";Fk(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(Fk(this.data_)){const i=function w2(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}(this.data_,e,t);return null===i?null:new Mu(i)}{const r=new Uint8Array(this.data_.buffer,e,t-e);return new Mu(r,!0)}}static getBlob(...e){if(MR()){const t=e.map(r=>r instanceof Mu?r.data_:r);return new Mu(v2.apply(null,t))}{const t=e.map(l=>DC(l)?NR(oo.RAW,l).data:l.data_);let r=0;t.forEach(l=>{r+=l.byteLength});const i=new Uint8Array(r);let a=0;return t.forEach(l=>{for(let h=0;h<l.length;h++)i[a++]=l[h]}),new Mu(i,!0)}}uploadData(){return this.data_}}function OR(n){let e;try{e=JSON.parse(n)}catch{return null}return function d2(n){return"object"==typeof n&&!Array.isArray(n)}(e)?e:null}function $k(n){const e=n.lastIndexOf("/",n.length-2);return-1===e?n:n.slice(e+1)}function A2(n,e){return e}class ys{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||A2}}let SC=null;function G0(){if(SC)return SC;const n=[];n.push(new ys("bucket")),n.push(new ys("generation")),n.push(new ys("metageneration")),n.push(new ys("name","fullPath",!0));const t=new ys("name");t.xform=function e(a,l){return function R2(n){return!DC(n)||n.length<2?n:$k(n)}(l)},n.push(t);const i=new ys("size");return i.xform=function r(a,l){return void 0!==l?Number(l):l},n.push(i),n.push(new ys("timeCreated")),n.push(new ys("updated")),n.push(new ys("md5Hash",null,!0)),n.push(new ys("cacheControl",null,!0)),n.push(new ys("contentDisposition",null,!0)),n.push(new ys("contentEncoding",null,!0)),n.push(new ys("contentLanguage",null,!0)),n.push(new ys("contentType",null,!0)),n.push(new ys("metadata","customMetadata",!0)),SC=n,SC}function Hk(n,e,t){const r=OR(e);return null===r?null:function M2(n,e,t){const r={type:"file"},i=t.length;for(let a=0;a<i;a++){const l=t[a];r[l.local]=l.xform(r,e[l.server])}return function x2(n,e){Object.defineProperty(n,"ref",{get:function t(){const a=new Qi(n.bucket,n.fullPath);return e._makeStorageReference(a)}})}(r,n),r}(n,r,t)}function LR(n,e){const t={},r=e.length;for(let i=0;i<r;i++){const a=e[i];a.writable&&(t[a.server]=n[a.local])}return JSON.stringify(t)}const Gk="prefixes";class Pu{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function ku(n){if(!n)throw xR()}function AC(n,e){return function t(r,i){const a=Hk(n,i,e);return ku(null!==a),a}}function $m(n){return function e(t,r){let i;return i=401===t.getStatus()?t.getErrorText().includes("Firebase App Check token is invalid")?function XU(){return new Hr("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}():function QU(){return new Hr("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===t.getStatus()?function YU(n){return new Hr("quota-exceeded","Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(n.bucket):403===t.getStatus()?function JU(n){return new Hr("unauthorized","User does not have permission to access '"+n+"'.")}(n.path):r,i.serverResponse=r.serverResponse,i}}function z0(n){const e=$m(n);return function t(r,i){let a=e(r,i);return 404===r.getStatus()&&(a=function ZU(n){return new Hr("object-not-found","Object '"+n+"' does not exist.")}(n.path)),a.serverResponse=i.serverResponse,a}}function Wk(n,e,t){const i=Ql(e.fullServerUrl(),n.host,n._protocol),l=n.maxOperationRetryTime,h=new Pu(i,"GET",AC(n,t),l);return h.errorHandler=z0(e),h}function F2(n,e,t,r,i){const a={};a.prefix=e.isRoot?"":e.path+"/",t&&t.length>0&&(a.delimiter=t),r&&(a.pageToken=r),i&&(a.maxResults=i);const h=Ql(e.bucketOnlyServerUrl(),n.host,n._protocol),v=n.maxOperationRetryTime,C=new Pu(h,"GET",function O2(n,e){return function t(r,i){const a=function N2(n,e,t){const r=OR(t);return null===r?null:function k2(n,e,t){const r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[Gk])for(const i of t[Gk]){const a=i.replace(/\/$/,""),l=n._makeStorageReference(new Qi(e,a));r.prefixes.push(l)}if(t.items)for(const i of t.items){const a=n._makeStorageReference(new Qi(e,i.name));r.items.push(a)}return r}(n,e,r)}(n,e,i);return ku(null!==a),a}}(n,e.bucket),v);return C.urlParams=a,C.errorHandler=$m(e),C}function Kk(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=function j2(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}class RC{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}}function FR(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{ku(!1)}return ku(!!t&&-1!==(e||["active"]).indexOf(t)),t}const z2={STATE_CHANGED:"state_changed"},vs={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function UR(n){switch(n){case"running":case"pausing":case"canceling":return vs.RUNNING;case"paused":return vs.PAUSED;case"success":return vs.SUCCESS;case"canceled":return vs.CANCELED;default:return vs.ERROR}}class W2{constructor(e,t,r){if(function c2(n){return"function"==typeof n}(e)||null!=t||null!=r)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{const a=e;this.next=a.next,this.error=a.error,this.complete=a.complete}}}function Hm(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}class q2{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Vd.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Vd.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Vd.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw H0("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==i)for(const a in i)i.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,i[a].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw H0("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw H0("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw H0("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw H0("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class K2 extends q2{initXhr(){this.xhr_.responseType="text"}}function Aa(){return new K2}class Xk{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=G0(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{this._request=void 0,this._chunkMultiplier=1,i._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=i,this._transition("error"))},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals("canceled")?this.completeTransitions_():(this._error=i,this._transition("error"))},this._promise=new Promise((i,a)=>{this._resolve=i,this._reject=a,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,t)=>{const r=function $2(n,e,t,r,i){const a=e.bucketOnlyServerUrl(),l=Kk(e,r,i),h={name:l.fullPath},m=Ql(a,n.host,n._protocol),C={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":l.contentType,"Content-Type":"application/json; charset=utf-8"},T=LR(l,t),Y=new Pu(m,"POST",function $(Ie){let Re;FR(Ie);try{Re=Ie.getResponseHeader("X-Goog-Upload-URL")}catch{ku(!1)}return ku(DC(Re)),Re},n.maxUploadRetryTime);return Y.urlParams=h,Y.headers=C,Y.body=T,Y.errorHandler=$m(e),Y}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Aa,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._uploadUrl=a,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,r)=>{const i=function H2(n,e,t,r){const m=new Pu(t,"POST",function a(v){const C=FR(v,["active","final"]);let T=null;try{T=v.getResponseHeader("X-Goog-Upload-Size-Received")}catch{ku(!1)}T||ku(!1);const x=Number(T);return ku(!isNaN(x)),new RC(x,r.size(),"final"===C)},n.maxUploadRetryTime);return m.headers={"X-Goog-Upload-Command":"query"},m.errorHandler=$m(e),m}(this._ref.storage,this._ref._location,e,this._blob),a=this._ref.storage._makeRequest(i,Aa,t,r);this._request=a,a.getPromise().then(l=>{this._request=void 0,this._updateProgress(l.current),this._needToFetchStatus=!1,l.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=262144*this._chunkMultiplier,t=new RC(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,a)=>{let l;try{l=function G2(n,e,t,r,i,a,l,h){const m=new RC(0,0);if(l?(m.current=l.current,m.total=l.total):(m.current=0,m.total=r.size()),r.size()!==m.total)throw function i2(){return new Hr("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}();const v=m.total-m.current;let C=v;i>0&&(C=Math.min(C,i));const T=m.current,Y={"X-Goog-Upload-Command":C===v?"upload, finalize":"upload","X-Goog-Upload-Offset":`${m.current}`},Ie=r.slice(T,T+C);if(null===Ie)throw Nk();const vt=new Pu(t,"POST",function Re(wt,Wt){const sn=FR(wt,["active","final"]),li=m.current+C,ka=r.size();let Yx;return Yx="final"===sn?AC(e,a)(wt,Wt):null,new RC(li,ka,"final"===sn,Yx)},e.maxUploadRetryTime);return vt.headers=Y,vt.body=Ie.uploadData(),vt.progressCallback=h||null,vt.errorHandler=$m(n),vt}(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(m){return this._error=m,void this._transition("error")}const h=this._ref.storage._makeRequest(l,Aa,i,a);this._request=h,h.getPromise().then(m=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(m.current),m.finalized?(this._metadata=m.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const r=Wk(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Aa,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const r=function Zk(n,e,t,r,i){const a=e.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"},m=function h(){let vt="";for(let wt=0;wt<2;wt++)vt+=Math.random().toString().slice(2);return vt}();l["Content-Type"]="multipart/related; boundary="+m;const v=Kk(e,r,i),C=LR(v,t),$=Mu.getBlob("--"+m+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+C+"\r\n--"+m+"\r\nContent-Type: "+v.contentType+"\r\n\r\n",r,"\r\n--"+m+"--");if(null===$)throw Nk();const Y={name:v.fullPath},Ie=Ql(a,n.host,n._protocol),_t=n.maxUploadRetryTime,Et=new Pu(Ie,"POST",AC(n,t),_t);return Et.urlParams=Y,Et.headers=l,Et.body=$.uploadData(),Et.errorHandler=$m(e),Et}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Aa,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request&&this._request.cancel();break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=kk(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=UR(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){const a=new W2(t||void 0,r||void 0,i||void 0);return this._addObserver(a),()=>{this._removeObserver(a)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(UR(this._state)){case vs.SUCCESS:Hm(this._resolve.bind(null,this.snapshot))();break;case vs.CANCELED:case vs.ERROR:Hm(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(UR(this._state)){case vs.RUNNING:case vs.PAUSED:e.next&&Hm(e.next.bind(e,this.snapshot))();break;case vs.SUCCESS:e.complete&&Hm(e.complete.bind(e))();break;default:e.error&&Hm(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class op{constructor(e,t){this._service=e,this._location=t instanceof Qi?t:Qi.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new op(e,t)}get root(){const e=new Qi(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return $k(this._location.path)}get storage(){return this._service}get parent(){const e=function T2(n){if(0===n.length)return null;const e=n.lastIndexOf("/");return-1===e?"":n.slice(0,e)}(this._location.path);if(null===e)return null;const t=new Qi(this._location.bucket,e);return new op(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw Lk(e)}}function eN(n,e,t){return VR.apply(this,arguments)}function VR(){return VR=(0,Ce.Z)(function*(n,e,t){const i=yield tN(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),null!=i.nextPageToken&&(yield eN(n,e,i.nextPageToken))}),VR.apply(this,arguments)}function tN(n,e){null!=e&&"number"==typeof e.maxResults&&PR("options.maxResults",1,1e3,e.maxResults);const t=e||{},r=F2(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,Aa)}function oV(n){n._throwIfRoot("getDownloadURL");const e=function U2(n,e,t){const i=Ql(e.fullServerUrl(),n.host,n._protocol),l=n.maxOperationRetryTime,h=new Pu(i,"GET",function L2(n,e){return function t(r,i){const a=Hk(n,i,e);return ku(null!==a),function P2(n,e,t,r){const i=OR(e);if(null===i||!DC(i.downloadTokens))return null;const a=i.downloadTokens;if(0===a.length)return null;const l=encodeURIComponent;return a.split(",").map(v=>{const T=n.fullPath;return Ql("/b/"+l(n.bucket)+"/o/"+l(T),t,r)+Uk({alt:"media",token:v})})[0]}(a,i,n.host,n._protocol)}}(n,t),l);return h.errorHandler=z0(e),h}(n.storage,n._location,G0());return n.storage.makeRequestWithTokens(e,Aa).then(t=>{if(null===t)throw function s2(){return new Hr("no-download-url","The given file does not have any download URLs.")}();return t})}function nN(n,e){const t=function S2(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return 0===n.length?t:n+"/"+t}(n._location.path,e),r=new Qi(n._location.bucket,t);return new op(n.storage,r)}function rN(n,e){if(n instanceof BR){const t=n;if(null==t._bucket)throw function r2(){return new Hr("no-default-bucket","No default bucket found. Did you set the '"+Pk+"' property when initializing the app?")}();const r=new op(t,t._bucket);return null!=e?rN(r,e):r}return void 0!==e?nN(n,e):n}function cV(n,e){if(e&&function uV(n){return/^[A-Za-z]+:\/\//.test(n)}(e)){if(n instanceof BR)return function lV(n,e){return new op(n,e)}(n,e);throw jm("To use ref(service, url), the first argument must be a Storage instance.")}return rN(n,e)}function iN(n,e){const t=e?.[Pk];return null==t?null:Qi.makeFromBucketSpec(t,n)}class BR{constructor(e,t,r,i,a){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=a,this._bucket=null,this._host=Mk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?Qi.makeFromBucketSpec(i,this._host):iN(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?Qi.makeFromBucketSpec(this._url,e):iN(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){PR("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){PR("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,Ce.Z)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const t=e._authProvider.getImmediate({optional:!0});if(t){const r=yield t.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,Ce.Z)(function*(){const t=e._appCheckProvider.getImmediate({optional:!0});return t?(yield t.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new op(this,e)}_makeRequest(e,t,r,i){if(this._deleted)return new o2(Ok());{const a=function _2(n,e,t,r,i,a){const l=Uk(n.urlParams),h=n.url+l,m=Object.assign({},n.headers);return function g2(n,e){e&&(n["X-Firebase-GMPID"]=e)}(m,e),function f2(n,e){null!==e&&e.length>0&&(n.Authorization="Firebase "+e)}(m,t),function p2(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}(m,a),function m2(n,e){null!==e&&(n["X-Firebase-AppCheck"]=e)}(m,r),new h2(h,n.method,m,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i)}(e,this._appId,r,i,t,this._firebaseVersion);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}makeRequestWithTokens(e,t){var r=this;return(0,Ce.Z)(function*(){const[i,a]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(e,t,i,a).getPromise()})()}}const sN="@firebase/storage";function uN(n,e){return cV(n=(0,N.m9)(n),e)}function EV(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new BR(t,r,i,e,ki.SDK_VERSION)}!function IV(){(0,ki._registerComponent)(new zi.wA("storage",EV,"PUBLIC").setMultipleInstances(!0)),(0,ki.registerVersion)(sN,"0.9.9",""),(0,ki.registerVersion)(sN,"0.9.9","esm2017")}();class xC{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class lN{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new xC(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new xC(r,this,this._ref))},t)}on(e,t,r,i){let a;return t&&(a="function"==typeof t?l=>t(new xC(l,this,this._ref)):{next:t.next?l=>t.next(new xC(l,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,a,r||void 0,i||void 0)}}class cN{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new Xl(e,this._service))}get items(){return this._delegate.items.map(e=>new Xl(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class Xl{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=function vV(n,e){return nN(n,e)}(this._delegate,e);return new Xl(t,this.storage)}get root(){return new Xl(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new Xl(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new lN(function hV(n,e,t){return function tV(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new Xk(n,new Mu(e),t)}(n=(0,N.m9)(n),e,t)}(this._delegate,e,t),this)}putString(e,t=oo.RAW,r){this._throwIfRoot("putString");const i=NR(t,e),a=Object.assign({},r);return null==a.contentType&&null!=i.contentType&&(a.contentType=i.contentType),new lN(new Xk(this._delegate,new Mu(i.data,!0),a),this)}listAll(){return function mV(n){return function rV(n){const e={prefixes:[],items:[]};return eN(n,e).then(()=>e)}(n=(0,N.m9)(n))}(this._delegate).then(e=>new cN(e,this.storage))}list(e){return function gV(n,e){return tN(n=(0,N.m9)(n),e)}(this._delegate,e||void 0).then(t=>new cN(t,this.storage))}getMetadata(){return function fV(n){return function iV(n){n._throwIfRoot("getMetadata");const e=Wk(n.storage,n._location,G0());return n.storage.makeRequestWithTokens(e,Aa)}(n=(0,N.m9)(n))}(this._delegate)}updateMetadata(e){return function pV(n,e){return function sV(n,e){n._throwIfRoot("updateMetadata");const t=function V2(n,e,t,r){const a=Ql(e.fullServerUrl(),n.host,n._protocol),h=LR(t,r),v=n.maxOperationRetryTime,C=new Pu(a,"PATCH",AC(n,r),v);return C.headers={"Content-Type":"application/json; charset=utf-8"},C.body=h,C.errorHandler=z0(e),C}(n.storage,n._location,e,G0());return n.storage.makeRequestWithTokens(t,Aa)}(n=(0,N.m9)(n),e)}(this._delegate,e)}getDownloadURL(){return function _V(n){return oV(n=(0,N.m9)(n))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function yV(n){return function aV(n){n._throwIfRoot("deleteObject");const e=function B2(n,e){const r=Ql(e.fullServerUrl(),n.host,n._protocol),h=new Pu(r,"DELETE",function l(m,v){},n.maxOperationRetryTime);return h.successCodes=[200,204],h.errorHandler=z0(e),h}(n.storage,n._location);return n.storage.makeRequestWithTokens(e,Aa)}(n=(0,N.m9)(n))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw Lk(e)}}class dN{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(hN(e))throw jm("ref() expected a child path but got a URL, use refFromURL instead.");return new Xl(uN(this._delegate,e),this)}refFromURL(e){if(!hN(e))throw jm("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Qi.makeFromUrl(e,this._delegate.host)}catch{throw jm("refFromUrl() expected a valid full URL but got an invalid one.")}return new Xl(uN(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){!function wV(n,e,t,r={}){!function dV(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:i}=r;i&&(n._overrideAuthToken="string"==typeof i?i:(0,N.Sg)(i,n.app.options.projectId))}(n,e,t,r)}(this._delegate,e,t,r)}}function hN(n){return/^[A-Za-z]+:\/\//.test(n)}function TV(n,{instanceIdentifier:e}){const t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new dN(t,r)}function fN(n){const e=function AV(n){return new $i.y(e=>{const t=l=>e.next(l);t(n.snapshot);const a=n.on("state_changed",t);return n.then(l=>{t(l),e.complete()},l=>{t(n.snapshot),(l=>{e.error(l)})(l)}),function(){a()}}).pipe(function WU(n,e=uu.z){return(0,Mr.e)((t,r)=>{let i=null,a=null,l=null;const h=()=>{if(i){i.unsubscribe(),i=null;const v=a;a=null,r.next(v)}};function m(){const v=l+n,C=e.now();if(C<v)return i=this.schedule(void 0,v-C),void r.add(i);h()}t.subscribe((0,zn.x)(r,v=>{a=v,l=e.now(),i||(i=e.schedule(m,n),r.add(i))},()=>{h(),r.complete()},void 0,()=>{a=i=null}))})}(0))}(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>e,percentageChanges:()=>e.pipe((0,At.U)(t=>t.bytesTransferred/t.totalBytes*100))}}function MC(n){return{getDownloadURL:()=>ot(void 0).pipe(En.fc,yr(()=>n.getDownloadURL()),En.iC),getMetadata:()=>ot(void 0).pipe(En.fc,yr(()=>n.getMetadata()),En.iC),delete:()=>(0,qt.D)(n.delete()),child:e=>MC(n.child(e)),updateMetadata:e=>(0,qt.D)(n.updateMetadata(e)),put:(e,t)=>fN(n.put(e,t)),putString:(e,t,r)=>fN(n.putString(e,t,r)),list:e=>(0,qt.D)(n.list(e)),listAll:()=>(0,qt.D)(n.listAll())}}!function SV(n){const e={TaskState:vs,TaskEvent:z2,StringFormat:oo,Storage:dN,Reference:Xl};n.INTERNAL.registerComponent(new zi.wA("storage-compat",TV,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion("@firebase/storage-compat","0.1.17")}(zh.Z);const RV=new g.OlP("angularfire2.storageBucket"),xV=new g.OlP("angularfire2.storage.maxUploadRetryTime"),MV=new g.OlP("angularfire2.storage.maxOperationRetryTime"),PV=new g.OlP("angularfire2.storage.use-emulator");let kV=(()=>{class n{constructor(t,r,i,a,l,h,m,v,C,T){const x=(0,$r.on)(t,l,r);this.storage=(0,$r.cc)(`${x.name}.storage.${i}`,"AngularFireStorage",x.name,()=>{const $=l.runOutsideAngular(()=>x.storage(i||void 0)),Y=C;return Y&&$.useEmulator(...Y),m&&$.setMaxUploadRetryTime(m),v&&$.setMaxOperationRetryTime(v),$},[m,v])}ref(t){return MC(this.storage.ref(t))}refFromURL(t){return MC(this.storage.refFromURL(t))}upload(t,r,i){return MC(this.storage.ref(t)).put(r,i)}}return n.\u0275fac=function(t){return new(t||n)(g.LFG($r.Dh),g.LFG($r.xv,8),g.LFG(RV,8),g.LFG(g.Lbi),g.LFG(g.R0b),g.LFG(En.HU),g.LFG(xV,8),g.LFG(MV,8),g.LFG(PV,8),g.LFG(N0,8))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),NV=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({}),n})(),OV=(()=>{class n{constructor(){bC.Z.registerVersion("angularfire",En.q4.full,"gcs-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({providers:[kV],imports:[NV]}),n})();var LV=M(5032);const pN="@firebase/database";let jR="";function mN(n){jR=n}class VV{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,N.Pz)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,N.cI)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class BV{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,N.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const _N=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new VV(e)}}catch{}return new BV},ap=_N("localStorage"),$R=_N("sessionStorage"),Gm=new Qs.Yd("@firebase/database"),yN=function(){let n=1;return function(){return n++}}(),vN=function(n){const e=(0,N.dS)(n),t=new N.gQ;t.update(e);const r=t.digest();return N.US.encodeByteArray(r)},W0=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=W0.apply(null,r):e+="object"==typeof r?(0,N.Pz)(r):r,e+=" "}return e};let up=null,wN=!0;const EN=function(n,e){(0,N.hu)(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(Gm.logLevel=Qs.in.VERBOSE,up=Gm.log.bind(Gm),e&&$R.set("logging_enabled",!0)):"function"==typeof n?up=n:(up=null,$R.remove("logging_enabled"))},Ai=function(...n){if(!0===wN&&(wN=!1,null===up&&!0===$R.get("logging_enabled")&&EN(!0)),up){const e=W0.apply(null,n);up(e)}},q0=function(n){return function(...e){Ai(n,...e)}},HR=function(...n){const e="FIREBASE INTERNAL ERROR: "+W0(...n);Gm.error(e)},Nu=function(...n){const e=`FIREBASE FATAL ERROR: ${W0(...n)}`;throw Gm.error(e),new Error(e)},Xi=function(...n){const e="FIREBASE WARNING: "+W0(...n);Gm.warn(e)},PC=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},Jl="[MIN_NAME]",Ou="[MAX_NAME]",lp=function(n,e){if(n===e)return 0;if(n===Jl||e===Ou)return-1;if(e===Jl||n===Ou)return 1;{const t=kC(n),r=kC(e);return null!==t?null!==r?t-r==0?n.length-e.length:t-r:-1:null!==r?1:n<e?-1:1}},HV=function(n,e){return n===e?0:n<e?-1:1},K0=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+(0,N.Pz)(e))},GR=function(n){if("object"!=typeof n||null===n)return(0,N.Pz)(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)0!==r&&(t+=","),t+=(0,N.Pz)(e[r]),t+=":",t+=GR(n[e[r]]);return t+="}",t},IN=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)r.push(n.substring(i,i+e>t?t:i+e));return r};function Ri(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const bN=function(n){(0,N.hu)(!PC(n),"Invalid JSON number");const r=1023;let i,a,l,h,m;0===n?(a=0,l=0,i=1/n==-1/0?1:0):(i=n<0,(n=Math.abs(n))>=Math.pow(2,1-r)?(h=Math.min(Math.floor(Math.log(n)/Math.LN2),r),a=h+r,l=Math.round(n*Math.pow(2,52-h)-Math.pow(2,52))):(a=0,l=Math.round(n/Math.pow(2,-1074))));const v=[];for(m=52;m;m-=1)v.push(l%2?1:0),l=Math.floor(l/2);for(m=11;m;m-=1)v.push(a%2?1:0),a=Math.floor(a/2);v.push(i?1:0),v.reverse();const C=v.join("");let T="";for(m=0;m<64;m+=8){let x=parseInt(C.substr(m,8),2).toString(16);1===x.length&&(x="0"+x),T+=x}return T.toLowerCase()},qV=new RegExp("^-?(0*)\\d{1,10}$"),CN=-2147483648,zR=2147483647,kC=function(n){if(qV.test(n)){const e=Number(n);if(e>=CN&&e<=zR)return e}return null},zm=function(n){try{n()}catch(e){setTimeout(()=>{throw Xi("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},Z0=function(n,e){const t=setTimeout(n,e);return"object"==typeof t&&t.unref&&t.unref(),t};class ZV{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Xi(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class YV{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(Ai("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Xi(e)}}let Y0=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const RN=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,PN="websocket",kN="long_polling";class qR{constructor(e,t,r,i,a=!1,l="",h=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=a,this.persistenceKey=l,this.includeNamespaceInQueryParams=h,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=ap.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&ap.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function NN(n,e,t){let r;if((0,N.hu)("string"==typeof e,"typeof type must == string"),(0,N.hu)("object"==typeof t,"typeof params must == object"),e===PN)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==kN)throw new Error("Unknown connection type: "+e);r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function QV(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const i=[];return Ri(t,(a,l)=>{i.push(a+"="+l)}),r+i.join("&")}class XV{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,N.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,N.p$)(this.counters_)}}const KR={},ZR={};function YR(n){const e=n.toString();return KR[e]||(KR[e]=new XV),KR[e]}class eB{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&zm(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class Bd{constructor(e,t,r,i,a,l,h){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.transportSessionId=l,this.lastSessionId=h,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=q0(e),this.stats_=YR(t),this.urlFn=m=>(this.appCheckToken&&(m.ac=this.appCheckToken),NN(t,kN,m))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new eB(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if((0,N.Yr)()||"complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new QR((...a)=>{const[l,h,m,v,C]=a;if(this.incrementIncomingBytes_(a),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===l)this.id=h,this.password=m;else{if("close"!==l)throw new Error("Unrecognized command received: "+l);h?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(h,()=>{this.onClosed_()})):this.onClosed_()}},(...a)=>{const[l,h]=a;this.incrementIncomingBytes_(a),this.myPacketOrderer.handleResponse(l,h)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&RN.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Bd.forceAllow_=!0}static forceDisallow(){Bd.forceDisallow_=!0}static isAvailable(){return!((0,N.Yr)()||!Bd.forceAllow_&&(Bd.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,N.Pz)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=(0,N.h$)(t),i=IN(r,1840);for(let a=0;a<i.length;a++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[a]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,N.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,N.Pz)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class QR{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,N.Yr)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=yN(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=QR.createIFrame_();let a="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(a='<script>document.domain="'+document.domain+'";<\/script>');const l="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(l),this.myIFrame.doc.close()}catch(h){Ai("frame writing exception"),h.stack&&Ai(h.stack),Ai(h)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Ai("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const l=this.pendingSegs.shift();r=r+"&seg"+i+"="+l.seg+"&ts"+i+"="+l.ts+"&d"+i+"="+l.d,i++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(i),r()})}addTag(e,t){(0,N.Yr)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Ai("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}let OC=null;typeof MozWebSocket<"u"?OC=MozWebSocket:typeof WebSocket<"u"&&(OC=WebSocket);let Wm=(()=>{class n{constructor(t,r,i,a,l,h,m){this.connId=t,this.applicationId=i,this.appCheckToken=a,this.authToken=l,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=q0(this.connId),this.stats_=YR(r),this.connURL=n.connectionURL_(r,h,m,a,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,a,l){const h={v:"5"};return!(0,N.Yr)()&&typeof location<"u"&&location.hostname&&RN.test(location.hostname)&&(h.r="f"),r&&(h.s=r),i&&(h.ls=i),a&&(h.ac=a),l&&(h.p=l),NN(t,PN,h)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,ap.set("previous_websocket_failure",!0);try{let i;if((0,N.Yr)()){i={headers:{"User-Agent":`Firebase/5/${jR}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);const l=process.env,h=0===this.connURL.indexOf("wss://")?l.HTTPS_PROXY||l.https_proxy:l.HTTP_PROXY||l.http_proxy;h&&(i.proxy={origin:h})}this.mySock=new OC(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const a=i.message||i.data;return a&&this.log_(a),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const a=i.message||i.data;a&&this.log_(a),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&null!==OC&&!n.forceDisallow_}static previouslyFailed(){return ap.isInMemoryStorage||!0===ap.get("previous_websocket_failure")}markConnectionHealthy(){ap.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=(0,N.cI)(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,N.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();const r=(0,N.Pz)(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=IN(r,16384);i.length>1&&this.sendString_(String(i.length));for(let a=0;a<i.length;a++)this.sendString_(i[a])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),jN=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Bd,Wm]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const r=Wm&&Wm.isAvailable();let i=r&&!Wm.previouslyFailed();if(t.webSocketOnly&&(r||Xi("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Wm];else{const a=this.transports_=[];for(const l of n.ALL_TRANSPORTS)l&&l.isAvailable()&&a.push(l);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class KN{constructor(e,t,r,i,a,l,h,m,v,C){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=a,this.onMessage_=l,this.onReady_=h,this.onDisconnect_=m,this.onKill_=v,this.lastSessionId=C,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=q0("c:"+this.id+":"),this.transportManager_=new jN(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Z0(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=K0("t",e),r=K0("d",e);if("c"===t)this.onSecondaryControl_(r);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=K0("t",e),r=K0("d",e);"c"===t?this.onControl_(r):"d"===t&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=K0("t",e);if("d"in e){const r=e.d;if("h"===t)this.onHandshake_(r);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(r):"r"===t?this.onReset_(r):"e"===t?HR("Server Error: "+r):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):HR("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==r&&Xi("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Z0(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Z0(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(ap.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class ZN{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}class YN{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,N.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let a=0;a<i.length;a++)if(i[a].callback===t&&(!r||r===i[a].context))return void i.splice(a,1)}validateEventType_(e){(0,N.hu)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class LC extends YN{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!(0,N.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new LC}getInitialEvent(e){return(0,N.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class Vn{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Mn(){return new Vn("")}function fn(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function jd(n){return n.pieces_.length-n.pieceNum_}function Xn(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Vn(n.pieces_,e)}function JR(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function Q0(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function JN(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Vn(e,0)}function Cr(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof Vn)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new Vn(t,0)}function pn(n){return n.pieceNum_>=n.pieces_.length}function ws(n,e){const t=fn(n),r=fn(e);if(null===t)return e;if(t===r)return ws(Xn(n),Xn(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function IB(n,e){const t=Q0(n,0),r=Q0(e,0);for(let i=0;i<t.length&&i<r.length;i++){const a=lp(t[i],r[i]);if(0!==a)return a}return t.length===r.length?0:t.length<r.length?-1:1}function ex(n,e){if(jd(n)!==jd(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function Oo(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(jd(n)>jd(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class bB{constructor(e,t){this.errorPrefix_=t,this.parts_=Q0(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=(0,N.ug)(this.parts_[r]);eO(this)}}function eO(n){if(n.byteLength_>768)throw new Error(n.errorPrefix_+"has a key path longer than 768 bytes ("+n.byteLength_+").");if(n.parts_.length>32)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+cp(n))}function cp(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class tx extends YN{constructor(){let e,t;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new tx}getInitialEvent(e){return(0,N.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const X0=1e3;let UC,dp=(()=>{class n extends ZN{constructor(t,r,i,a,l,h,m,v){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=a,this.onServerInfoUpdate_=l,this.authTokenProvider_=h,this.appCheckTokenProvider_=m,this.authOverride_=v,this.id=n.nextPersistentConnectionId_++,this.log_=q0("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=X0,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,v&&!(0,N.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");tx.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&LC.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){const a=++this.requestNumber_,l={r:a,a:t,b:r};this.log_((0,N.Pz)(l)),(0,N.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(l),i&&(this.requestCBHash_[a]=i)}get(t){this.initConnection_();const r=new N.BH,a={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:h=>{const m=h.d;"ok"===h.s?r.resolve(m):r.reject(m)}};return this.outstandingGets_.push(a),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(t,r,i,a){this.initConnection_();const l=t._queryIdentifier,h=t._path.toString();this.log_("Listen called for "+h+" "+l),this.listens.has(h)||this.listens.set(h,new Map),(0,N.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,N.hu)(!this.listens.get(h).has(l),"listen() called twice for same path/queryId.");const m={onComplete:a,hashFn:r,query:t,tag:i};this.listens.get(h).set(l,m),this.connected_&&this.sendListen_(m)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){const r=t.query,i=r._path.toString(),a=r._queryIdentifier;this.log_("Listen on "+i+" for "+a);const l={p:i};t.tag&&(l.q=r._queryObject,l.t=t.tag),l.h=t.hashFn(),this.sendRequest("q",l,m=>{const v=m.d,C=m.s;n.warnOnListenWarnings_(v,r),(this.listens.get(i)&&this.listens.get(i).get(a))===t&&(this.log_("listen response",m),"ok"!==C&&this.removeListen_(i,a),t.onComplete&&t.onComplete(C,v))})}static warnOnListenWarnings_(t,r){if(t&&"object"==typeof t&&(0,N.r3)(t,"w")){const i=(0,N.DV)(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const a='".indexOn": "'+r._queryParams.getIndex().toString()+'"',l=r._path.toString();Xi(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${a} at ${l} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,N.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=(0,N.w9)(t)?"auth":"gauth",i={cred:t};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,a=>{const l=a.s,h=a.d||"error";this.authToken_===t&&("ok"===l?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(l,h))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,i=t.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){const i=t._path.toString(),a=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+a),(0,N.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,a)&&this.connected_&&this.sendUnlisten_(i,a,t._queryObject,r)}sendUnlisten_(t,r,i,a){this.log_("Unlisten on "+t+" for "+r);const l={p:t};a&&(l.q=i,l.t=a),this.sendRequest("n",l)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,a){const l={p:r,d:i};this.log_("onDisconnect "+t,l),this.sendRequest(t,l,h=>{a&&setTimeout(()=>{a(h.s,h.d)},Math.floor(0))})}put(t,r,i,a){this.putInternal("p",t,r,i,a)}merge(t,r,i,a){this.putInternal("m",t,r,i,a)}putInternal(t,r,i,a,l){this.initConnection_();const h={p:r,d:i};void 0!==l&&(h.h=l),this.outstandingPuts_.push({action:t,request:h,onComplete:a}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,a=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,l=>{this.log_(r+" response",l),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),a&&a(l.s,l.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,N.Pz)(t));const r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),"d"===t?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===t?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===t?this.onListenRevoked_(r.p,r.q):"ac"===t?this.onAuthRevoked_(r.s,r.d):"apc"===t?this.onAppCheckRevoked_(r.s,r.d):"sd"===t?this.onSecurityDebugPacket_(r):HR("Unrecognized action received from server: "+(0,N.Pz)(t)+"\nAre you using the latest client?")}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,N.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=X0,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=X0,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=X0),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,Ce.Z)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const r=t.onDataMessage_.bind(t),i=t.onReady_.bind(t),a=t.onRealtimeDisconnect_.bind(t),l=t.id+":"+n.nextConnectionId_++,h=t.lastSessionId;let m=!1,v=null;const C=function(){v?v.close():(m=!0,a())};t.realtime_={close:C,sendRequest:function($){(0,N.hu)(v,"sendRequest call when we're not connected not allowed."),v.sendRequest($)}};const x=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[$,Y]=yield Promise.all([t.authTokenProvider_.getToken(x),t.appCheckTokenProvider_.getToken(x)]);m?Ai("getToken() completed but was canceled"):(Ai("getToken() completed. Creating connection."),t.authToken_=$&&$.accessToken,t.appCheckToken_=Y&&Y.token,v=new KN(l,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,r,i,a,Ie=>{Xi(Ie+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},h))}catch($){t.log_("Failed to get token: "+$),m||(t.repoInfo_.nodeAdmin&&Xi($),C())}}})()}interrupt(t){Ai("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Ai("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,N.xb)(this.interruptReasons_)&&(this.reconnectDelay_=X0,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;i=r?r.map(l=>GR(l)).join("$"):"default";const a=this.removeListen_(t,i);a&&a.onComplete&&a.onComplete("permission_denied")}removeListen_(t,r){const i=new Vn(t).toString();let a;if(this.listens.has(i)){const l=this.listens.get(i);a=l.get(r),l.delete(r),0===l.size&&this.listens.delete(i)}else a=void 0;return a}onAuthRevoked_(t,r){Ai("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Ai("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";(0,N.Yr)()&&(r=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+r+"."+jR.replace(/\./g,"-")]=1,(0,N.uI)()?t["framework.cordova"]=1:(0,N.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=LC.getInstance().currentlyOnline();return(0,N.xb)(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class _n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new _n(e,t)}}class FC{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new _n(Jl,e),i=new _n(Jl,t);return 0!==this.compare(r,i)}minPost(){return _n.MIN}}class rO extends FC{static get __EMPTY_NODE(){return UC}static set __EMPTY_NODE(e){UC=e}compare(e,t){return lp(e.name,t.name)}isDefinedOn(e){throw(0,N.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return _n.MIN}maxPost(){return new _n(Ou,UC)}makePost(e,t){return(0,N.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new _n(e,UC)}toString(){return".key"}}const Lu=new rO;class VC{constructor(e,t,r,i,a=null){this.isReverse_=i,this.resultGenerator_=a,this.nodeStack_=[];let l=1;for(;!e.isEmpty();)if(l=t?r(e.key,t):1,i&&(l*=-1),l<0)e=this.isReverse_?e.left:e.right;else{if(0===l){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let rx,Ra=(()=>{class n{constructor(t,r,i,a,l){this.key=t,this.value=r,this.color=i??n.RED,this.left=a??Vs.EMPTY_NODE,this.right=l??Vs.EMPTY_NODE}copy(t,r,i,a,l){return new n(t??this.key,r??this.value,i??this.color,a??this.left,l??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let a=this;const l=i(t,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(t,r,i),null):0===l?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(t,r,i)),a.fixUp_()}removeMin_(){if(this.left.isEmpty())return Vs.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,a;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(t,i.key)){if(i.right.isEmpty())return Vs.EMPTY_NODE;a=i.right.min_(),i=i.copy(a.key,a.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class Vs{constructor(e,t=Vs.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Vs(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Ra.BLACK,null,null))}remove(e){return new Vs(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ra.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new VC(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new VC(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new VC(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new VC(this.root_,null,this.comparator_,!0,e)}}function MB(n,e){return lp(n.name,e.name)}function nx(n,e){return lp(n,e)}Vs.EMPTY_NODE=new class xB{copy(e,t,r,i,a){return this}insert(e,t,r){return new Ra(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const iO=function(n){return"number"==typeof n?"number:"+bN(n):"string:"+n},sO=function(n){if(n.isLeafNode()){const e=n.val();(0,N.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,N.r3)(e,".sv"),"Priority must be a string or number.")}else(0,N.hu)(n===rx||n.isEmpty(),"priority of unexpected type.");(0,N.hu)(n===rx||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let oO,aO,uO,qm=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,(0,N.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),sO(this.priorityNode_)}static set __childrenNodeConstructor(t){oO=t}static get __childrenNodeConstructor(){return oO}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return pn(t)?this:".priority"===fn(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const i=fn(t);return null===i?r:r.isEmpty()&&".priority"!==i?this:((0,N.hu)(".priority"!==i||1===jd(t),".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Xn(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+iO(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",t+="number"===r?bN(this.value_):this.value_,this.lazyHash_=vN(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:((0,N.hu)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,i=typeof this.value_,a=n.VALUE_TYPE_ORDER.indexOf(r),l=n.VALUE_TYPE_ORDER.indexOf(i);return(0,N.hu)(a>=0,"Unknown leaf type: "+r),(0,N.hu)(l>=0,"Unknown leaf type: "+i),a===l?"object"===i?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:l-a}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}return!1}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const sr=new class OB extends FC{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),a=r.compareTo(i);return 0===a?lp(e.name,t.name):a}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return _n.MIN}maxPost(){return new _n(Ou,new qm("[PRIORITY-POST]",uO))}makePost(e,t){const r=aO(e);return new _n(t,new qm("[PRIORITY-POST]",r))}toString(){return".priority"}},LB=Math.log(2);class FB{constructor(e){this.count=parseInt(Math.log(e+1)/LB,10),this.current_=this.count-1;const i=(a=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const BC=function(n,e,t,r){n.sort(e);const i=function(m,v){const C=v-m;let T,x;if(0===C)return null;if(1===C)return T=n[m],x=t?t(T):T,new Ra(x,T.node,Ra.BLACK,null,null);{const $=parseInt(C/2,10)+m,Y=i(m,$),Ie=i($+1,v);return T=n[$],x=t?t(T):T,new Ra(x,T.node,Ra.BLACK,Y,Ie)}},h=function(m){let v=null,C=null,T=n.length;const x=function(Y,Ie){const Re=T-Y,_t=T;T-=Y;const Et=i(Re+1,_t),vt=n[Re],wt=t?t(vt):vt;$(new Ra(wt,vt.node,Ie,null,Et))},$=function(Y){v?(v.left=Y,v=Y):(C=Y,v=Y)};for(let Y=0;Y<m.count;++Y){const Ie=m.nextBitIsOne(),Re=Math.pow(2,m.count-(Y+1));Ie?x(Re,Ra.BLACK):(x(Re,Ra.BLACK),x(Re,Ra.RED))}return C}(new FB(n.length));return new Vs(r||e,h)};let ix;const Km={};class ec{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,N.hu)(Km&&sr,"ChildrenNode.ts has not been loaded"),ix=ix||new ec({".priority":Km},{".priority":sr}),ix}get(e){const t=(0,N.DV)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Vs?t:null}hasIndex(e){return(0,N.r3)(this.indexSet_,e.toString())}addIndex(e,t){(0,N.hu)(e!==Lu,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const a=t.getIterator(_n.Wrap);let h,l=a.getNext();for(;l;)i=i||e.isDefinedOn(l.node),r.push(l),l=a.getNext();h=i?BC(r,e.getCompare()):Km;const m=e.toString(),v=Object.assign({},this.indexSet_);v[m]=e;const C=Object.assign({},this.indexes_);return C[m]=h,new ec(C,v)}addToIndexes(e,t){const r=(0,N.UI)(this.indexes_,(i,a)=>{const l=(0,N.DV)(this.indexSet_,a);if((0,N.hu)(l,"Missing index implementation for "+a),i===Km){if(l.isDefinedOn(e.node)){const h=[],m=t.getIterator(_n.Wrap);let v=m.getNext();for(;v;)v.name!==e.name&&h.push(v),v=m.getNext();return h.push(e),BC(h,l.getCompare())}return Km}{const h=t.get(e.name);let m=i;return h&&(m=m.remove(new _n(e.name,h))),m.insert(e,e.node)}});return new ec(r,this.indexSet_)}removeFromIndexes(e,t){const r=(0,N.UI)(this.indexes_,i=>{if(i===Km)return i;{const a=t.get(e.name);return a?i.remove(new _n(e.name,a)):i}});return new ec(r,this.indexSet_)}}let J0,tn=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&sO(this.priorityNode_),this.children_.isEmpty()&&(0,N.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return J0||(J0=new n(new Vs(nx),null,ec.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||J0}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const r=this.children_.get(t);return null===r?J0:r}}getChild(t){const r=fn(t);return null===r?this:this.getImmediateChild(r).getChild(Xn(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,r){if((0,N.hu)(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);{const i=new _n(t,r);let a,l;r.isEmpty()?(a=this.children_.remove(t),l=this.indexMap_.removeFromIndexes(i,this.children_)):(a=this.children_.insert(t,r),l=this.indexMap_.addToIndexes(i,this.children_));const h=a.isEmpty()?J0:this.priorityNode_;return new n(a,h,l)}}updateChild(t,r){const i=fn(t);if(null===i)return r;{(0,N.hu)(".priority"!==fn(t)||1===jd(t),".priority must be the last token in a path");const a=this.getImmediateChild(i).updateChild(Xn(t),r);return this.updateImmediateChild(i,a)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let i=0,a=0,l=!0;if(this.forEachChild(sr,(h,m)=>{r[h]=m.val(t),i++,l&&n.INTEGER_REGEXP_.test(h)?a=Math.max(a,Number(h)):l=!1}),!t&&l&&a<2*i){const h=[];for(const m in r)h[m]=r[m];return h}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+iO(this.getPriority().val())+":"),this.forEachChild(sr,(r,i)=>{const a=i.hash();""!==a&&(t+=":"+r+":"+a)}),this.lazyHash_=""===t?"":vN(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){const a=this.resolveIndex_(i);if(a){const l=a.getPredecessorKey(new _n(t,r));return l?l.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new _n(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new _n(r,this.children_.get(r)):null}forEachChild(t,r){const i=this.resolveIndex_(t);return i?i.inorderTraversal(a=>r(a.name,a.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,a=>a);{const a=this.children_.getIteratorFrom(t.name,_n.Wrap);let l=a.peek();for(;null!=l&&r.compare(l,t)<0;)a.getNext(),l=a.peek();return a}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,a=>a);{const a=this.children_.getReverseIteratorFrom(t.name,_n.Wrap);let l=a.peek();for(;null!=l&&r.compare(l,t)>0;)a.getNext(),l=a.peek();return a}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===ew?-1:0}withIndex(t){if(t===Lu||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===Lu||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(sr),a=r.getIterator(sr);let l=i.getNext(),h=a.getNext();for(;l&&h;){if(l.name!==h.name||!l.node.equals(h.node))return!1;l=i.getNext(),h=a.getNext()}return null===l&&null===h}return!1}return!1}}resolveIndex_(t){return t===Lu?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const ew=new class UB extends tn{constructor(){super(new Vs(nx),tn.EMPTY_NODE,ec.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return tn.EMPTY_NODE}isEmpty(){return!1}};function Lr(n,e=null){if(null===n)return tn.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),(0,N.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new qm(n,Lr(e));if(n instanceof Array){let t=tn.EMPTY_NODE;return Ri(n,(r,i)=>{if((0,N.r3)(n,r)&&"."!==r.substring(0,1)){const a=Lr(i);(a.isLeafNode()||!a.isEmpty())&&(t=t.updateImmediateChild(r,a))}}),t.updatePriority(Lr(e))}{const t=[];let r=!1;if(Ri(n,(l,h)=>{if("."!==l.substring(0,1)){const m=Lr(h);m.isEmpty()||(r=r||!m.getPriority().isEmpty(),t.push(new _n(l,m)))}}),0===t.length)return tn.EMPTY_NODE;const a=BC(t,MB,l=>l.name,nx);if(r){const l=BC(t,sr.getCompare());return new tn(a,Lr(e),new ec({".priority":l},{".priority":sr}))}return new tn(a,Lr(e),ec.Default)}}Object.defineProperties(_n,{MIN:{value:new _n(Jl,tn.EMPTY_NODE)},MAX:{value:new _n(Ou,ew)}}),rO.__EMPTY_NODE=tn.EMPTY_NODE,qm.__childrenNodeConstructor=tn,function PB(n){rx=n}(ew),function NB(n){uO=n}(ew),function kB(n){aO=n}(Lr);class sx extends FC{constructor(e){super(),this.indexPath_=e,(0,N.hu)(!pn(e)&&".priority"!==fn(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),a=r.compareTo(i);return 0===a?lp(e.name,t.name):a}makePost(e,t){const r=Lr(e),i=tn.EMPTY_NODE.updateChild(this.indexPath_,r);return new _n(t,i)}maxPost(){const e=tn.EMPTY_NODE.updateChild(this.indexPath_,ew);return new _n(Ou,e)}toString(){return Q0(this.indexPath_,0).join("/")}}const ox=new class BB extends FC{compare(e,t){const r=e.node.compareTo(t.node);return 0===r?lp(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return _n.MIN}maxPost(){return _n.MAX}makePost(e,t){const r=Lr(e);return new _n(t,r)}toString(){return".value"}},Zm="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",jB=function(){let n=0;const e=[];return function(t){const r=t===n;let i;n=t;const a=new Array(8);for(i=7;i>=0;i--)a[i]=Zm.charAt(t%64),t=Math.floor(t/64);(0,N.hu)(0===t,"Cannot push at time == 0");let l=a.join("");if(r){for(i=11;i>=0&&63===e[i];i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)l+=Zm.charAt(e[i]);return(0,N.hu)(20===l.length,"nextPushId: Length should be 20."),l}}(),dO=function(n){if(n===""+zR)return"-";const e=kC(n);if(null!=e)return""+(e+1);const t=new Array(n.length);for(let l=0;l<t.length;l++)t[l]=n.charAt(l);if(t.length<786)return t.push("-"),t.join("");let r=t.length-1;for(;r>=0&&"z"===t[r];)r--;if(-1===r)return Ou;const a=Zm.charAt(Zm.indexOf(t[r])+1);return t[r]=a,t.slice(0,r+1).join("")},hO=function(n){if(n===""+CN)return Jl;const e=kC(n);if(null!=e)return""+(e-1);const t=new Array(n.length);for(let r=0;r<t.length;r++)t[r]=n.charAt(r);return"-"===t[t.length-1]?1===t.length?""+zR:(delete t[t.length-1],t.join("")):(t[t.length-1]=Zm.charAt(Zm.indexOf(t[t.length-1])-1),t.join("")+"z".repeat(786-t.length))};function fO(n){return{type:"value",snapshotNode:n}}function Ym(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function tw(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function nw(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class ux{constructor(e){this.index_=e}updateChild(e,t,r,i,a,l){(0,N.hu)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const h=e.getImmediateChild(t);return h.getChild(i).equals(r.getChild(i))&&h.isEmpty()===r.isEmpty()||(null!=l&&(r.isEmpty()?e.hasChild(t)?l.trackChildChange(tw(t,h)):(0,N.hu)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):h.isEmpty()?l.trackChildChange(Ym(t,r)):l.trackChildChange(nw(t,r,h))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return null!=r&&(e.isLeafNode()||e.forEachChild(sr,(i,a)=>{t.hasChild(i)||r.trackChildChange(tw(i,a))}),t.isLeafNode()||t.forEachChild(sr,(i,a)=>{if(e.hasChild(i)){const l=e.getImmediateChild(i);l.equals(a)||r.trackChildChange(nw(i,a,l))}else r.trackChildChange(Ym(i,a))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?tn.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class rw{constructor(e){this.indexedFilter_=new ux(e.getIndex()),this.index_=e.getIndex(),this.startPost_=rw.getStartPost_(e),this.endPost_=rw.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,t,r,i,a,l){return this.matches(new _n(t,r))||(r=tn.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,a,l)}updateFullNode(e,t,r){t.isLeafNode()&&(t=tn.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(tn.EMPTY_NODE);const a=this;return t.forEachChild(sr,(l,h)=>{a.matches(new _n(l,h))||(i=i.updateImmediateChild(l,tn.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class HB{constructor(e){this.rangedFilter_=new rw(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,t,r,i,a,l){return this.rangedFilter_.matches(new _n(t,r))||(r=tn.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,a,l):this.fullLimitUpdateChild_(e,t,r,a,l)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=tn.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let a;i=tn.EMPTY_NODE.withIndex(this.index_),a=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let l=0;for(;a.hasNext()&&l<this.limit_;){const h=a.getNext();let m;if(m=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),h)<=0:this.index_.compare(h,this.rangedFilter_.getEndPost())<=0,!m)break;i=i.updateImmediateChild(h.name,h.node),l++}}else{let a,l,h,m;if(i=t.withIndex(this.index_),i=i.updatePriority(tn.EMPTY_NODE),this.reverse_){m=i.getReverseIterator(this.index_),a=this.rangedFilter_.getEndPost(),l=this.rangedFilter_.getStartPost();const T=this.index_.getCompare();h=(x,$)=>T($,x)}else m=i.getIterator(this.index_),a=this.rangedFilter_.getStartPost(),l=this.rangedFilter_.getEndPost(),h=this.index_.getCompare();let v=0,C=!1;for(;m.hasNext();){const T=m.getNext();!C&&h(a,T)<=0&&(C=!0),C&&v<this.limit_&&h(T,l)<=0?v++:i=i.updateImmediateChild(T.name,tn.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,a){let l;if(this.reverse_){const T=this.index_.getCompare();l=(x,$)=>T($,x)}else l=this.index_.getCompare();const h=e;(0,N.hu)(h.numChildren()===this.limit_,"");const m=new _n(t,r),v=this.reverse_?h.getFirstChild(this.index_):h.getLastChild(this.index_),C=this.rangedFilter_.matches(m);if(h.hasChild(t)){const T=h.getImmediateChild(t);let x=i.getChildAfterChild(this.index_,v,this.reverse_);for(;null!=x&&(x.name===t||h.hasChild(x.name));)x=i.getChildAfterChild(this.index_,x,this.reverse_);const $=null==x?1:l(x,m);if(C&&!r.isEmpty()&&$>=0)return a?.trackChildChange(nw(t,r,T)),h.updateImmediateChild(t,r);{a?.trackChildChange(tw(t,T));const Ie=h.updateImmediateChild(t,tn.EMPTY_NODE);return null!=x&&this.rangedFilter_.matches(x)?(a?.trackChildChange(Ym(x.name,x.node)),Ie.updateImmediateChild(x.name,x.node)):Ie}}return r.isEmpty()?e:C&&l(v,m)>=0?(null!=a&&(a.trackChildChange(tw(v.name,v.node)),a.trackChildChange(Ym(t,r))),h.updateImmediateChild(t,r).updateImmediateChild(v.name,tn.EMPTY_NODE)):e}}class jC{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=sr}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,N.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,N.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Jl}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,N.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,N.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ou}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,N.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===sr}copy(){const e=new jC;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function lx(n,e,t){const r=n.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=t?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function cx(n,e,t){const r=n.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==t?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function $C(n,e){const t=n.copy();return t.index_=e,t}function pO(n){const e={};if(n.isDefault())return e;let t;return n.index_===sr?t="$priority":n.index_===ox?t="$value":n.index_===Lu?t="$key":((0,N.hu)(n.index_ instanceof sx,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=(0,N.Pz)(t),n.startSet_&&(e.startAt=(0,N.Pz)(n.indexStartValue_),n.startNameSet_&&(e.startAt+=","+(0,N.Pz)(n.indexStartName_))),n.endSet_&&(e.endAt=(0,N.Pz)(n.indexEndValue_),n.endNameSet_&&(e.endAt+=","+(0,N.Pz)(n.indexEndName_))),n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function gO(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_)),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_)),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==sr&&(e.i=n.index_.toString()),e}class HC extends ZN{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=q0("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,N.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const a=e._path.toString();this.log_("Listen called for "+a+" "+e._queryIdentifier);const l=HC.getListenId_(e,r),h={};this.listens_[l]=h;const m=pO(e._queryParams);this.restRequest_(a+".json",m,(v,C)=>{let T=C;if(404===v&&(T=null,v=null),null===v&&this.onDataUpdate_(a,T,!1,r),(0,N.DV)(this.listens_,l)===h){let x;x=v?401===v?"permission_denied":"rest_error:"+v:"ok",i(x,null)}})}unlisten(e,t){const r=HC.getListenId_(e,t);delete this.listens_[r]}get(e){const t=pO(e._queryParams),r=e._path.toString(),i=new N.BH;return this.restRequest_(r+".json",t,(a,l)=>{let h=l;404===a&&(h=null,a=null),null===a?(this.onDataUpdate_(r,h,!1,null),i.resolve(h)):i.reject(new Error(h))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,a])=>{i&&i.accessToken&&(t.auth=i.accessToken),a&&a.token&&(t.ac=a.token);const l=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,N.xO)(t);this.log_("Sending REST request for "+l);const h=new XMLHttpRequest;h.onreadystatechange=()=>{if(r&&4===h.readyState){this.log_("REST Response for "+l+" received. status:",h.status,"response:",h.responseText);let m=null;if(h.status>=200&&h.status<300){try{m=(0,N.cI)(h.responseText)}catch{Xi("Failed to parse JSON response for "+l+": "+h.responseText)}r(null,m)}else 401!==h.status&&404!==h.status&&Xi("Got unsuccessful REST response for "+l+" Status: "+h.status),r(h.status);r=null}},h.open("GET",l,!0),h.send()})}}class ZB{constructor(){this.rootNode_=tn.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function GC(){return{value:null,children:new Map}}function Qm(n,e,t){if(pn(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const r=fn(e);n.children.has(r)||n.children.set(r,GC()),Qm(n.children.get(r),e=Xn(e),t)}}function dx(n,e){if(pn(e))return n.value=null,n.children.clear(),!0;if(null!==n.value){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(sr,(r,i)=>{Qm(n,new Vn(r),i)}),dx(n,e)}}if(n.children.size>0){const t=fn(e);return e=Xn(e),n.children.has(t)&&dx(n.children.get(t),e)&&n.children.delete(t),0===n.children.size}return!0}function hx(n,e,t){null!==n.value?t(e,n.value):function YB(n,e){n.children.forEach((t,r)=>{e(r,t)})}(n,(r,i)=>{hx(i,new Vn(e.toString()+"/"+r),t)})}class QB{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Ri(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}class ej{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new QB(e);const r=1e4+2e4*Math.random();Z0(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;Ri(e,(i,a)=>{a>0&&(0,N.r3)(this.statsToReport_,i)&&(t[i]=a,r=!0)}),r&&this.server_.reportStats(t),Z0(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Lo=(()=>(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Lo||(Lo={})),Lo))();function gx(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class zC{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Lo.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(pn(this.path)){if(null!=this.affectedTree.value)return(0,N.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Vn(e));return new zC(Mn(),t,this.revert)}}return(0,N.hu)(fn(this.path)===e,"operationForChild called for unrelated child."),new zC(Xn(this.path),this.affectedTree,this.revert)}}class iw{constructor(e,t){this.source=e,this.path=t,this.type=Lo.LISTEN_COMPLETE}operationForChild(e){return pn(this.path)?new iw(this.source,Mn()):new iw(this.source,Xn(this.path))}}class hp{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Lo.OVERWRITE}operationForChild(e){return pn(this.path)?new hp(this.source,Mn(),this.snap.getImmediateChild(e)):new hp(this.source,Xn(this.path),this.snap)}}class Xm{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Lo.MERGE}operationForChild(e){if(pn(this.path)){const t=this.children.subtree(new Vn(e));return t.isEmpty()?null:t.value?new hp(this.source,Mn(),t.value):new Xm(this.source,Mn(),t)}return(0,N.hu)(fn(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Xm(this.source,Xn(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class $d{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(pn(e))return this.isFullyInitialized()&&!this.filtered_;const t=fn(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class tj{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function sw(n,e,t,r,i,a){const l=r.filter(h=>h.type===t);l.sort((h,m)=>function ij(n,e,t){if(null==e.childName||null==t.childName)throw(0,N.g5)("Should only compare child_ events.");const r=new _n(e.childName,e.snapshotNode),i=new _n(t.childName,t.snapshotNode);return n.index_.compare(r,i)}(n,h,m)),l.forEach(h=>{const m=function rj(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,h,a);i.forEach(v=>{v.respondsTo(h.type)&&e.push(v.createEvent(m,n.query_))})})}function WC(n,e){return{eventCache:n,serverCache:e}}function ow(n,e,t,r){return WC(new $d(e,t,r),n.serverCache)}function _O(n,e,t,r){return WC(n.eventCache,new $d(e,t,r))}function qC(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function fp(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let mx;class or{constructor(e,t=(()=>(mx||(mx=new Vs(HV)),mx))()){this.value=e,this.children=t}static fromObject(e){let t=new or(null);return Ri(e,(r,i)=>{t=t.set(new Vn(r),i)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Mn(),value:this.value};if(pn(e))return null;{const r=fn(e),i=this.children.get(r);if(null!==i){const a=i.findRootMostMatchingPathAndValue(Xn(e),t);return null!=a?{path:Cr(new Vn(r),a.path),value:a.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(pn(e))return this;{const t=fn(e),r=this.children.get(t);return null!==r?r.subtree(Xn(e)):new or(null)}}set(e,t){if(pn(e))return new or(t,this.children);{const r=fn(e),a=(this.children.get(r)||new or(null)).set(Xn(e),t),l=this.children.insert(r,a);return new or(this.value,l)}}remove(e){if(pn(e))return this.children.isEmpty()?new or(null):new or(null,this.children);{const t=fn(e),r=this.children.get(t);if(r){const i=r.remove(Xn(e));let a;return a=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&a.isEmpty()?new or(null):new or(this.value,a)}return this}}get(e){if(pn(e))return this.value;{const t=fn(e),r=this.children.get(t);return r?r.get(Xn(e)):null}}setTree(e,t){if(pn(e))return t;{const r=fn(e),a=(this.children.get(r)||new or(null)).setTree(Xn(e),t);let l;return l=a.isEmpty()?this.children.remove(r):this.children.insert(r,a),new or(this.value,l)}}fold(e){return this.fold_(Mn(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,a)=>{r[i]=a.fold_(Cr(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Mn(),t)}findOnPath_(e,t,r){const i=!!this.value&&r(t,this.value);if(i)return i;if(pn(e))return null;{const a=fn(e),l=this.children.get(a);return l?l.findOnPath_(Xn(e),Cr(t,a),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Mn(),t)}foreachOnPath_(e,t,r){if(pn(e))return this;{this.value&&r(t,this.value);const i=fn(e),a=this.children.get(i);return a?a.foreachOnPath_(Xn(e),Cr(t,i),r):new or(null)}}foreach(e){this.foreach_(Mn(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Cr(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}class xa{constructor(e){this.writeTree_=e}static empty(){return new xa(new or(null))}}function aw(n,e,t){if(pn(e))return new xa(new or(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(null!=r){const i=r.path;let a=r.value;const l=ws(i,e);return a=a.updateChild(l,t),new xa(n.writeTree_.set(i,a))}{const i=new or(t),a=n.writeTree_.setTree(e,i);return new xa(a)}}}function _x(n,e,t){let r=n;return Ri(t,(i,a)=>{r=aw(r,Cr(e,i),a)}),r}function yO(n,e){if(pn(e))return xa.empty();{const t=n.writeTree_.setTree(e,new or(null));return new xa(t)}}function yx(n,e){return null!=pp(n,e)}function pp(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(ws(t.path,e)):null}function vO(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(sr,(r,i)=>{e.push(new _n(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&e.push(new _n(r,i.value))}),e}function Hd(n,e){if(pn(e))return n;{const t=pp(n,e);return new xa(null!=t?new or(t):n.writeTree_.subtree(e))}}function vx(n){return n.writeTree_.isEmpty()}function Jm(n,e){return wO(Mn(),n.writeTree_,e)}function wO(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,a)=>{".priority"===i?((0,N.hu)(null!==a.value,"Priority writes must always be leaf nodes"),r=a.value):t=wO(Cr(n,i),a,t)}),!t.getChild(n).isEmpty()&&null!==r&&(t=t.updateChild(Cr(n,".priority"),r)),t}}function KC(n,e){return DO(e,n)}function cj(n,e){if(n.snap)return Oo(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&Oo(Cr(n.path,t),e))return!0;return!1}function hj(n){return n.visible}function EO(n,e,t){let r=xa.empty();for(let i=0;i<n.length;++i){const a=n[i];if(e(a)){const l=a.path;let h;if(a.snap)Oo(t,l)?(h=ws(t,l),r=aw(r,h,a.snap)):Oo(l,t)&&(h=ws(l,t),r=aw(r,Mn(),a.snap.getChild(h)));else{if(!a.children)throw(0,N.g5)("WriteRecord should have .snap or .children");if(Oo(t,l))h=ws(t,l),r=_x(r,h,a.children);else if(Oo(l,t))if(h=ws(l,t),pn(h))r=_x(r,Mn(),a.children);else{const m=(0,N.DV)(a.children,fn(h));if(m){const v=m.getChild(Xn(h));r=aw(r,Mn(),v)}}}}}return r}function IO(n,e,t,r,i){if(r||i){const a=Hd(n.visibleWrites,e);return!i&&vx(a)?t:i||null!=t||yx(a,Mn())?Jm(EO(n.allWrites,function(v){return(v.visible||i)&&(!r||!~r.indexOf(v.writeId))&&(Oo(v.path,e)||Oo(e,v.path))},e),t||tn.EMPTY_NODE):null}{const a=pp(n.visibleWrites,e);if(null!=a)return a;{const l=Hd(n.visibleWrites,e);return vx(l)?t:null!=t||yx(l,Mn())?Jm(l,t||tn.EMPTY_NODE):null}}}function ZC(n,e,t,r){return IO(n.writeTree,n.treePath,e,t,r)}function wx(n,e){return function fj(n,e,t){let r=tn.EMPTY_NODE;const i=pp(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(sr,(a,l)=>{r=r.updateImmediateChild(a,l)}),r;if(t){const a=Hd(n.visibleWrites,e);return t.forEachChild(sr,(l,h)=>{const m=Jm(Hd(a,new Vn(l)),h);r=r.updateImmediateChild(l,m)}),vO(a).forEach(l=>{r=r.updateImmediateChild(l.name,l.node)}),r}return vO(Hd(n.visibleWrites,e)).forEach(l=>{r=r.updateImmediateChild(l.name,l.node)}),r}(n.writeTree,n.treePath,e)}function bO(n,e,t,r){return function pj(n,e,t,r,i){(0,N.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");const a=Cr(e,t);if(yx(n.visibleWrites,a))return null;{const l=Hd(n.visibleWrites,a);return vx(l)?i.getChild(t):Jm(l,i.getChild(t))}}(n.writeTree,n.treePath,e,t,r)}function YC(n,e){return function mj(n,e){return pp(n.visibleWrites,e)}(n.writeTree,Cr(n.treePath,e))}function Ex(n,e,t){return function gj(n,e,t,r){const i=Cr(e,t),a=pp(n.visibleWrites,i);return null!=a?a:r.isCompleteForChild(t)?Jm(Hd(n.visibleWrites,i),r.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function CO(n,e){return DO(Cr(n.treePath,e),n.writeTree)}function DO(n,e){return{treePath:n,writeTree:e}}class wj{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;(0,N.hu)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,N.hu)(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const a=i.type;if("child_added"===t&&"child_removed"===a)this.changeMap.set(r,nw(r,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===a)this.changeMap.delete(r);else if("child_removed"===t&&"child_changed"===a)this.changeMap.set(r,tw(r,i.oldSnap));else if("child_changed"===t&&"child_added"===a)this.changeMap.set(r,Ym(r,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==a)throw(0,N.g5)("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(r,nw(r,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}const TO=new class Ej{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}};class Ix{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=null!=this.optCompleteServerCache_?new $d(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ex(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:fp(this.viewCache_),a=function vj(n,e,t,r,i,a){return function _j(n,e,t,r,i,a,l){let h;const m=Hd(n.visibleWrites,e),v=pp(m,Mn());if(null!=v)h=v;else{if(null==t)return[];h=Jm(m,t)}if(h=h.withIndex(l),h.isEmpty()||h.isLeafNode())return[];{const C=[],T=l.getCompare(),x=a?h.getReverseIteratorFrom(r,l):h.getIteratorFrom(r,l);let $=x.getNext();for(;$&&C.length<i;)0!==T($,r)&&C.push($),$=x.getNext();return C}}(n.writeTree,n.treePath,e,t,r,i,a)}(this.writes_,i,t,1,r,e);return 0===a.length?null:a[0]}}function SO(n,e,t,r,i,a){const l=e.eventCache;if(null!=YC(r,t))return e;{let h,m;if(pn(t))if((0,N.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const v=fp(e),T=wx(r,v instanceof tn?v:tn.EMPTY_NODE);h=n.filter.updateFullNode(e.eventCache.getNode(),T,a)}else{const v=ZC(r,fp(e));h=n.filter.updateFullNode(e.eventCache.getNode(),v,a)}else{const v=fn(t);if(".priority"===v){(0,N.hu)(1===jd(t),"Can't have a priority with additional path components");const C=l.getNode();m=e.serverCache.getNode();const T=bO(r,t,C,m);h=null!=T?n.filter.updatePriority(C,T):l.getNode()}else{const C=Xn(t);let T;if(l.isCompleteForChild(v)){m=e.serverCache.getNode();const x=bO(r,t,l.getNode(),m);T=null!=x?l.getNode().getImmediateChild(v).updateChild(C,x):l.getNode().getImmediateChild(v)}else T=Ex(r,v,e.serverCache);h=null!=T?n.filter.updateChild(l.getNode(),v,T,C,i,a):l.getNode()}}return ow(e,h,l.isFullyInitialized()||pn(t),n.filter.filtersNodes())}}function QC(n,e,t,r,i,a,l,h){const m=e.serverCache;let v;const C=l?n.filter:n.filter.getIndexedFilter();if(pn(t))v=C.updateFullNode(m.getNode(),r,null);else if(C.filtersNodes()&&!m.isFiltered()){const $=m.getNode().updateChild(t,r);v=C.updateFullNode(m.getNode(),$,null)}else{const $=fn(t);if(!m.isCompleteForPath(t)&&jd(t)>1)return e;const Y=Xn(t),Re=m.getNode().getImmediateChild($).updateChild(Y,r);v=".priority"===$?C.updatePriority(m.getNode(),Re):C.updateChild(m.getNode(),$,Re,Y,TO,null)}const T=_O(e,v,m.isFullyInitialized()||pn(t),C.filtersNodes());return SO(n,T,t,i,new Ix(i,T,a),h)}function bx(n,e,t,r,i,a,l){const h=e.eventCache;let m,v;const C=new Ix(i,e,a);if(pn(t))v=n.filter.updateFullNode(e.eventCache.getNode(),r,l),m=ow(e,v,!0,n.filter.filtersNodes());else{const T=fn(t);if(".priority"===T)v=n.filter.updatePriority(e.eventCache.getNode(),r),m=ow(e,v,h.isFullyInitialized(),h.isFiltered());else{const x=Xn(t),$=h.getNode().getImmediateChild(T);let Y;if(pn(x))Y=r;else{const Ie=C.getCompleteChild(T);Y=null!=Ie?".priority"===JR(x)&&Ie.getChild(JN(x)).isEmpty()?Ie:Ie.updateChild(x,r):tn.EMPTY_NODE}m=$.equals(Y)?e:ow(e,n.filter.updateChild(h.getNode(),T,Y,x,C,l),h.isFullyInitialized(),n.filter.filtersNodes())}}return m}function AO(n,e){return n.eventCache.isCompleteForChild(e)}function RO(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function Cx(n,e,t,r,i,a,l,h){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let v,m=e;v=pn(t)?r:new or(null).setTree(t,r);const C=e.serverCache.getNode();return v.children.inorderTraversal((T,x)=>{if(C.hasChild(T)){const Y=RO(0,e.serverCache.getNode().getImmediateChild(T),x);m=QC(n,m,new Vn(T),Y,i,a,l,h)}}),v.children.inorderTraversal((T,x)=>{const $=!e.serverCache.isCompleteForChild(T)&&void 0===x.value;if(!C.hasChild(T)&&!$){const Ie=RO(0,e.serverCache.getNode().getImmediateChild(T),x);m=QC(n,m,new Vn(T),Ie,i,a,l,h)}}),m}class xj{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new ux(r.getIndex()),a=function GB(n){return n.loadsAllData()?new ux(n.getIndex()):n.hasLimit()?new HB(n):new rw(n)}(r);this.processor_=function Ij(n){return{filter:n}}(a);const l=t.serverCache,h=t.eventCache,m=i.updateFullNode(tn.EMPTY_NODE,l.getNode(),null),v=a.updateFullNode(tn.EMPTY_NODE,h.getNode(),null),C=new $d(m,l.isFullyInitialized(),i.filtersNodes()),T=new $d(v,h.isFullyInitialized(),a.filtersNodes());this.viewCache_=WC(T,C),this.eventGenerator_=new tj(this.query_)}get query(){return this.query_}}function kj(n,e){const t=fp(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!pn(e)&&!t.getImmediateChild(fn(e)).isEmpty())?t.getChild(e):null}function xO(n){return 0===n.eventRegistrations_.length}function MO(n,e,t){const r=[];if(t){(0,N.hu)(null==e,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(a=>{const l=a.createCancelEvent(t,i);l&&r.push(l)})}if(e){let i=[];for(let a=0;a<n.eventRegistrations_.length;++a){const l=n.eventRegistrations_[a];if(l.matches(e)){if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(a+1));break}}else i.push(l)}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function PO(n,e,t,r){e.type===Lo.MERGE&&null!==e.source.queryId&&((0,N.hu)(fp(n.viewCache_),"We should always have a full cache before handling merges"),(0,N.hu)(qC(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,a=function Cj(n,e,t,r,i){const a=new wj;let l,h;if(t.type===Lo.OVERWRITE){const v=t;v.source.fromUser?l=bx(n,e,v.path,v.snap,r,i,a):((0,N.hu)(v.source.fromServer,"Unknown source."),h=v.source.tagged||e.serverCache.isFiltered()&&!pn(v.path),l=QC(n,e,v.path,v.snap,r,i,h,a))}else if(t.type===Lo.MERGE){const v=t;v.source.fromUser?l=function Tj(n,e,t,r,i,a,l){let h=e;return r.foreach((m,v)=>{const C=Cr(t,m);AO(e,fn(C))&&(h=bx(n,h,C,v,i,a,l))}),r.foreach((m,v)=>{const C=Cr(t,m);AO(e,fn(C))||(h=bx(n,h,C,v,i,a,l))}),h}(n,e,v.path,v.children,r,i,a):((0,N.hu)(v.source.fromServer,"Unknown source."),h=v.source.tagged||e.serverCache.isFiltered(),l=Cx(n,e,v.path,v.children,r,i,h,a))}else if(t.type===Lo.ACK_USER_WRITE){const v=t;l=v.revert?function Rj(n,e,t,r,i,a){let l;if(null!=YC(r,t))return e;{const h=new Ix(r,e,i),m=e.eventCache.getNode();let v;if(pn(t)||".priority"===fn(t)){let C;if(e.serverCache.isFullyInitialized())C=ZC(r,fp(e));else{const T=e.serverCache.getNode();(0,N.hu)(T instanceof tn,"serverChildren would be complete if leaf node"),C=wx(r,T)}v=n.filter.updateFullNode(m,C,a)}else{const C=fn(t);let T=Ex(r,C,e.serverCache);null==T&&e.serverCache.isCompleteForChild(C)&&(T=m.getImmediateChild(C)),v=null!=T?n.filter.updateChild(m,C,T,Xn(t),h,a):e.eventCache.getNode().hasChild(C)?n.filter.updateChild(m,C,tn.EMPTY_NODE,Xn(t),h,a):m,v.isEmpty()&&e.serverCache.isFullyInitialized()&&(l=ZC(r,fp(e)),l.isLeafNode()&&(v=n.filter.updateFullNode(v,l,a)))}return l=e.serverCache.isFullyInitialized()||null!=YC(r,Mn()),ow(e,v,l,n.filter.filtersNodes())}}(n,e,v.path,r,i,a):function Sj(n,e,t,r,i,a,l){if(null!=YC(i,t))return e;const h=e.serverCache.isFiltered(),m=e.serverCache;if(null!=r.value){if(pn(t)&&m.isFullyInitialized()||m.isCompleteForPath(t))return QC(n,e,t,m.getNode().getChild(t),i,a,h,l);if(pn(t)){let v=new or(null);return m.getNode().forEachChild(Lu,(C,T)=>{v=v.set(new Vn(C),T)}),Cx(n,e,t,v,i,a,h,l)}return e}{let v=new or(null);return r.foreach((C,T)=>{const x=Cr(t,C);m.isCompleteForPath(x)&&(v=v.set(C,m.getNode().getChild(x)))}),Cx(n,e,t,v,i,a,h,l)}}(n,e,v.path,v.affectedTree,r,i,a)}else{if(t.type!==Lo.LISTEN_COMPLETE)throw(0,N.g5)("Unknown operation type: "+t.type);l=function Aj(n,e,t,r,i){const a=e.serverCache;return SO(n,_O(e,a.getNode(),a.isFullyInitialized()||pn(t),a.isFiltered()),t,r,TO,i)}(n,e,t.path,r,a)}const m=a.getChanges();return function Dj(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=qC(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&t.push(fO(qC(e)))}}(e,l,m),{viewCache:l,changes:m}}(n.processor_,i,e,t,r);return function bj(n,e){(0,N.hu)(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),(0,N.hu)(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,a.viewCache),(0,N.hu)(a.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=a.viewCache,kO(n,a.changes,a.viewCache.eventCache.getNode(),null)}function kO(n,e,t,r){return function nj(n,e,t,r){const i=[],a=[];return e.forEach(l=>{"child_changed"===l.type&&n.index_.indexedValueChanged(l.oldSnap,l.snapshotNode)&&a.push(function $B(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(l.childName,l.snapshotNode))}),sw(n,i,"child_removed",e,r,t),sw(n,i,"child_added",e,r,t),sw(n,i,"child_moved",a,r,t),sw(n,i,"child_changed",e,r,t),sw(n,i,"value",e,r,t),i}(n.eventGenerator_,e,t,r?[r]:n.eventRegistrations_)}let XC,eD;class NO{constructor(){this.views=new Map}}function Dx(n,e,t,r){const i=e.source.queryId;if(null!==i){const a=n.views.get(i);return(0,N.hu)(null!=a,"SyncTree gave us an op for an invalid query."),PO(a,e,t,r)}{let a=[];for(const l of n.views.values())a=a.concat(PO(l,e,t,r));return a}}function Tx(n,e,t,r,i){const l=n.views.get(e._queryIdentifier);if(!l){let h=ZC(t,i?r:null),m=!1;h?m=!0:r instanceof tn?(h=wx(t,r),m=!1):(h=tn.EMPTY_NODE,m=!1);const v=WC(new $d(h,m,!1),new $d(r,i,!1));return new xj(e,v)}return l}function OO(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Gd(n,e){let t=null;for(const r of n.views.values())t=t||kj(r,e);return t}function LO(n,e){return e._queryParams.loadsAllData()?JC(n):n.views.get(e._queryIdentifier)}function FO(n,e){return null!=LO(n,e)}function zd(n){return null!=JC(n)}function JC(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let Hj=1;class UO{constructor(e){this.listenProvider_=e,this.syncPointTree_=new or(null),this.pendingWriteTree_=function yj(){return{visibleWrites:xa.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Sx(n,e,t,r,i){return function oj(n,e,t,r,i){(0,N.hu)(r>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=aw(n.visibleWrites,e,t)),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r,i),i?e_(n,new hp({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function Wd(n,e,t=!1){const r=function uj(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}(n.pendingWriteTree_,e);if(function lj(n,e){const t=n.allWrites.findIndex(h=>h.writeId===e);(0,N.hu)(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,a=!1,l=n.allWrites.length-1;for(;i&&l>=0;){const h=n.allWrites[l];h.visible&&(l>=t&&cj(h,r.path)?i=!1:Oo(r.path,h.path)&&(a=!0)),l--}return!!i&&(a?(function dj(n){n.visibleWrites=EO(n.allWrites,hj,Mn()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(r.snap?n.visibleWrites=yO(n.visibleWrites,r.path):Ri(r.children,m=>{n.visibleWrites=yO(n.visibleWrites,Cr(r.path,m))}),!0))}(n.pendingWriteTree_,e)){let a=new or(null);return null!=r.snap?a=a.set(Mn(),!0):Ri(r.children,l=>{a=a.set(new Vn(l),!0)}),e_(n,new zC(r.path,a,t))}return[]}function uw(n,e,t){return e_(n,new hp({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function tD(n,e,t,r){const i=e._path,a=n.syncPointTree_.get(i);let l=[];if(a&&("default"===e._queryIdentifier||FO(a,e))){const h=function Bj(n,e,t,r){const i=e._queryIdentifier,a=[];let l=[];const h=zd(n);if("default"===i)for(const[m,v]of n.views.entries())l=l.concat(MO(v,t,r)),xO(v)&&(n.views.delete(m),v.query._queryParams.loadsAllData()||a.push(v.query));else{const m=n.views.get(i);m&&(l=l.concat(MO(m,t,r)),xO(m)&&(n.views.delete(i),m.query._queryParams.loadsAllData()||a.push(m.query)))}return h&&!zd(n)&&a.push(new(function Fj(){return(0,N.hu)(XC,"Reference.ts has not been loaded"),XC}())(e._repo,e._path)),{removed:a,events:l}}(a,e,t,r);(function Uj(n){return 0===n.views.size})(a)&&(n.syncPointTree_=n.syncPointTree_.remove(i));const m=h.removed;l=h.events;const v=-1!==m.findIndex(T=>T._queryParams.loadsAllData()),C=n.syncPointTree_.findOnPath(i,(T,x)=>zd(x));if(v&&!C){const T=n.syncPointTree_.subtree(i);if(!T.isEmpty()){const x=function Qj(n){return n.fold((e,t,r)=>{if(t&&zd(t))return[JC(t)];{let i=[];return t&&(i=OO(t)),Ri(r,(a,l)=>{i=i.concat(l)}),i}})}(T);for(let $=0;$<x.length;++$){const Y=x[$],Ie=Y.query,Re=GO(n,Y);n.listenProvider_.startListening(cw(Ie),lw(n,Ie),Re.hashFn,Re.onComplete)}}}!C&&m.length>0&&!r&&(v?n.listenProvider_.stopListening(cw(e),null):m.forEach(T=>{const x=n.queryToTagMap.get(rD(T));n.listenProvider_.stopListening(cw(T),x)})),function Xj(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=rD(r),a=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(a)}}}(n,m)}return l}function VO(n,e,t,r){const i=Ax(n,r);if(null!=i){const a=Rx(i),l=a.path,h=a.queryId,m=ws(l,e);return xx(n,l,new hp(gx(h),m,t))}return[]}function BO(n,e){const t=n._path;let r=null,i=!1;e.syncPointTree_.foreachOnPath(t,(v,C)=>{const T=ws(v,t);r=r||Gd(C,T),i=i||zd(C)});let l,a=e.syncPointTree_.get(t);a?(i=i||zd(a),r=r||Gd(a,Mn())):(a=new NO,e.syncPointTree_=e.syncPointTree_.set(t,a)),null!=r?l=!0:(l=!1,r=tn.EMPTY_NODE,e.syncPointTree_.subtree(t).foreachChild((C,T)=>{const x=Gd(T,Mn());x&&(r=r.updateImmediateChild(C,x))}));const h=FO(a,n);if(!h&&!n._queryParams.loadsAllData()){const v=rD(n);(0,N.hu)(!e.queryToTagMap.has(v),"View does not exist, but we have a tag");const C=function Jj(){return Hj++}();e.queryToTagMap.set(v,C),e.tagToQueryMap.set(C,v)}return{syncPoint:a,writesCache:KC(e.pendingWriteTree_,t),serverCache:r,serverCacheComplete:l,foundAncestorDefaultView:i,viewAlreadyExists:h}}function jO(n,e,t){const{syncPoint:r,serverCache:i,writesCache:a,serverCacheComplete:l,viewAlreadyExists:h,foundAncestorDefaultView:m}=BO(e,n);let v=function Vj(n,e,t,r,i,a){const l=Tx(n,e,r,i,a);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,l),function Nj(n,e){n.eventRegistrations_.push(e)}(l,t),function Oj(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(sr,(a,l)=>{r.push(Ym(a,l))}),t.isFullyInitialized()&&r.push(fO(t.getNode())),kO(n,r,t.getNode(),e)}(l,t)}(r,e,t,a,i,l);if(!h&&!m){const C=LO(r,e);v=v.concat(function e$(n,e,t){const r=e._path,i=lw(n,e),a=GO(n,t),l=n.listenProvider_.startListening(cw(e),i,a.hashFn,a.onComplete),h=n.syncPointTree_.subtree(r);if(i)(0,N.hu)(!zd(h.value),"If we're adding a query, it shouldn't be shadowed");else{const m=h.fold((v,C,T)=>{if(!pn(v)&&C&&zd(C))return[JC(C).query];{let x=[];return C&&(x=x.concat(OO(C).map($=>$.query))),Ri(T,($,Y)=>{x=x.concat(Y)}),x}});for(let v=0;v<m.length;++v){const C=m[v];n.listenProvider_.stopListening(cw(C),lw(n,C))}}return l}(n,e,C))}return v}function nD(n,e,t){const i=n.pendingWriteTree_,a=n.syncPointTree_.findOnPath(e,(l,h)=>{const v=Gd(h,ws(l,e));if(v)return v});return IO(i,e,a,t,!0)}function e_(n,e){return $O(e,n.syncPointTree_,null,KC(n.pendingWriteTree_,Mn()))}function $O(n,e,t,r){if(pn(n.path))return HO(n,e,t,r);{const i=e.get(Mn());null==t&&null!=i&&(t=Gd(i,Mn()));let a=[];const l=fn(n.path),h=n.operationForChild(l),m=e.children.get(l);if(m&&h){const v=t?t.getImmediateChild(l):null,C=CO(r,l);a=a.concat($O(h,m,v,C))}return i&&(a=a.concat(Dx(i,n,r,t))),a}}function HO(n,e,t,r){const i=e.get(Mn());null==t&&null!=i&&(t=Gd(i,Mn()));let a=[];return e.children.inorderTraversal((l,h)=>{const m=t?t.getImmediateChild(l):null,v=CO(r,l),C=n.operationForChild(l);C&&(a=a.concat(HO(C,h,m,v)))}),i&&(a=a.concat(Dx(i,n,r,t))),a}function GO(n,e){const t=e.query,r=lw(n,t);return{hashFn:()=>(function Mj(n){return n.viewCache_.serverCache.getNode()}(e)||tn.EMPTY_NODE).hash(),onComplete:i=>{if("ok"===i)return r?function qj(n,e,t){const r=Ax(n,t);if(r){const i=Rx(r),a=i.path,l=i.queryId,h=ws(a,e);return xx(n,a,new iw(gx(l),h))}return[]}(n,t._path,r):function Wj(n,e){return e_(n,new iw({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(n,t._path);{const a=function WV(n,e){let t="Unknown Error";"too_big"===n?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?t="Client doesn't have permission to access the desired data.":"unavailable"===n&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}(i,t);return tD(n,t,null,a)}}}}function lw(n,e){const t=rD(e);return n.queryToTagMap.get(t)}function rD(n){return n._path.toString()+"$"+n._queryIdentifier}function Ax(n,e){return n.tagToQueryMap.get(e)}function Rx(n){const e=n.indexOf("$");return(0,N.hu)(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Vn(n.substr(0,e))}}function xx(n,e,t){const r=n.syncPointTree_.get(e);return(0,N.hu)(r,"Missing sync point for query tag that we're tracking"),Dx(r,t,KC(n.pendingWriteTree_,e),null)}function cw(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function $j(){return(0,N.hu)(eD,"Reference.ts has not been loaded"),eD}())(n._repo,n._path):n}class Mx{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Mx(t)}node(){return this.node_}}class Px{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Cr(this.path_,e);return new Px(this.syncTree_,t)}node(){return nD(this.syncTree_,this.path_)}}const zO=function(n,e,t){return n&&"object"==typeof n?((0,N.hu)(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?n$(n[".sv"],e,t):"object"==typeof n[".sv"]?r$(n[".sv"],e):void(0,N.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},n$=function(n,e,t){if("timestamp"===n)return t.timestamp;(0,N.hu)(!1,"Unexpected server value: "+n)},r$=function(n,e,t){n.hasOwnProperty("increment")||(0,N.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;"number"!=typeof r&&(0,N.hu)(!1,"Unexpected increment value: "+r);const i=e.node();if((0,N.hu)(null!==i&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const l=i.getValue();return"number"!=typeof l?r:l+r},WO=function(n,e,t,r){return Nx(e,new Px(t,n),r)},kx=function(n,e,t){return Nx(n,new Mx(e),t)};function Nx(n,e,t){const r=n.getPriority().val(),i=zO(r,e.getImmediateChild(".priority"),t);let a;if(n.isLeafNode()){const l=n,h=zO(l.getValue(),e,t);return h!==l.getValue()||i!==l.getPriority().val()?new qm(h,Lr(i)):n}{const l=n;return a=l,i!==l.getPriority().val()&&(a=a.updatePriority(new qm(i))),l.forEachChild(sr,(h,m)=>{const v=Nx(m,e.getImmediateChild(h),t);v!==m&&(a=a.updateImmediateChild(h,v))}),a}}class Ox{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function iD(n,e){let t=e instanceof Vn?e:new Vn(e),r=n,i=fn(t);for(;null!==i;){const a=(0,N.DV)(r.node.children,i)||{children:{},childCount:0};r=new Ox(i,r,a),t=Xn(t),i=fn(t)}return r}function gp(n){return n.node.value}function Lx(n,e){n.node.value=e,Fx(n)}function qO(n){return n.node.childCount>0}function sD(n,e){Ri(n.node.children,(t,r)=>{e(new Ox(t,n,r))})}function KO(n,e,t,r){t&&!r&&e(n),sD(n,i=>{KO(i,e,!0,r)}),t&&r&&e(n)}function dw(n){return new Vn(null===n.parent?n.name:dw(n.parent)+"/"+n.name)}function Fx(n){null!==n.parent&&function o$(n,e,t){const r=function i$(n){return void 0===gp(n)&&!qO(n)}(t),i=(0,N.r3)(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,Fx(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,Fx(n))}(n.parent,n.name,n)}const a$=/[\[\].#$\/\u0000-\u001F\u007F]/,u$=/[\[\].#$\u0000-\u001F\u007F]/,Ux=10485760,oD=function(n){return"string"==typeof n&&0!==n.length&&!a$.test(n)},ZO=function(n){return"string"==typeof n&&0!==n.length&&!u$.test(n)},hw=function(n){return null===n||"string"==typeof n||"number"==typeof n&&!PC(n)||n&&"object"==typeof n&&(0,N.r3)(n,".sv")},Fu=function(n,e,t,r){r&&void 0===e||fw((0,N.gK)(n,"value"),e,t)},fw=function(n,e,t){const r=t instanceof Vn?new bB(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+cp(r));if("function"==typeof e)throw new Error(n+"contains a function "+cp(r)+" with contents = "+e.toString());if(PC(e))throw new Error(n+"contains "+e.toString()+" "+cp(r));if("string"==typeof e&&e.length>Ux/3&&(0,N.ug)(e)>Ux)throw new Error(n+"contains a string greater than "+Ux+" utf8 bytes "+cp(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let i=!1,a=!1;if(Ri(e,(l,h)=>{if(".value"===l)i=!0;else if(".priority"!==l&&".sv"!==l&&(a=!0,!oD(l)))throw new Error(n+" contains an invalid key ("+l+") "+cp(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function CB(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=(0,N.ug)(e),eO(n)})(r,l),fw(n,h,r),function DB(n){const e=n.parts_.pop();n.byteLength_-=(0,N.ug)(e),n.parts_.length>0&&(n.byteLength_-=1)}(r)}),i&&a)throw new Error(n+' contains ".value" child '+cp(r)+" in addition to actual children.")}},YO=function(n,e,t,r){if(r&&void 0===e)return;const i=(0,N.gK)(n,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const a=[];Ri(e,(l,h)=>{const m=new Vn(l);if(fw(i,h,Cr(t,m)),".priority"===JR(m)&&!hw(h))throw new Error(i+"contains an invalid value for '"+m.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(m)}),function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const a=Q0(r);for(let l=0;l<a.length;l++)if((".priority"!==a[l]||l!==a.length-1)&&!oD(a[l]))throw new Error(n+"contains an invalid key ("+a[l]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(IB);let i=null;for(t=0;t<e.length;t++){if(r=e[t],null!==i&&Oo(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,a)},Vx=function(n,e,t){if(!t||void 0!==e){if(PC(e))throw new Error((0,N.gK)(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!hw(e))throw new Error((0,N.gK)(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},pw=function(n,e,t,r){if(!(r&&void 0===t||oD(t)))throw new Error((0,N.gK)(n,e)+'was an invalid key = "'+t+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},gw=function(n,e,t,r){if(!(r&&void 0===t||ZO(t)))throw new Error((0,N.gK)(n,e)+'was an invalid path = "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Fo=function(n,e){if(".info"===fn(e))throw new Error(n+" failed = Can't modify data under /.info/")},QO=function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!oD(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),ZO(n)}(t))throw new Error((0,N.gK)(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class h${constructor(){this.eventLists_=[],this.recursionDepth_=0}}function aD(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],a=i.getPath();null!==t&&!ex(a,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:a}),t.events.push(i)}t&&n.eventLists_.push(t)}function XO(n,e,t){aD(n,t),JO(n,r=>ex(r,e))}function Uo(n,e,t){aD(n,t),JO(n,r=>Oo(r,e)||Oo(e,r))}function JO(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];i&&(e(i.path)?(f$(n.eventLists_[r]),n.eventLists_[r]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}function f$(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const r=t.getEventRunner();up&&Ai("event: "+t.toString()),zm(r)}}}const e1="repo_interrupt";class g${constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new h$,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=GC(),this.transactionQueueTree_=new Ox,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function t1(n){const t=n.infoData_.getNode(new Vn(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function mw(n){return function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n}({timestamp:t1(n)})}function n1(n,e,t,r,i){n.dataUpdateCount++;const a=new Vn(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let l=[];if(i)if(r){const m=(0,N.UI)(t,v=>Lr(v));l=function Zj(n,e,t,r){const i=Ax(n,r);if(i){const a=Rx(i),l=a.path,h=a.queryId,m=ws(l,e),v=or.fromObject(t);return xx(n,l,new Xm(gx(h),m,v))}return[]}(n.serverSyncTree_,a,m,i)}else{const m=Lr(t);l=VO(n.serverSyncTree_,a,m,i)}else if(r){const m=(0,N.UI)(t,v=>Lr(v));l=function zj(n,e,t){const r=or.fromObject(t);return e_(n,new Xm({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(n.serverSyncTree_,a,m)}else{const m=Lr(t);l=uw(n.serverSyncTree_,a,m)}let h=a;l.length>0&&(h=t_(n,a)),Uo(n.eventQueue_,h,l)}function r1(n,e){Bx(n,"connected",e),!1===e&&function w$(n){mp(n,"onDisconnectEvents");const e=mw(n),t=GC();hx(n.onDisconnect_,Mn(),(i,a)=>{const l=WO(i,a,n.serverSyncTree_,e);Qm(t,i,l)});let r=[];hx(t,Mn(),(i,a)=>{r=r.concat(uw(n.serverSyncTree_,i,a));const l=Gx(n,i);t_(n,l)}),n.onDisconnect_=GC(),Uo(n.eventQueue_,Mn(),r)}(n)}function Bx(n,e,t){const r=new Vn("/.info/"+e),i=Lr(t);n.infoData_.updateSnapshot(r,i);const a=uw(n.infoSyncTree_,r,i);Uo(n.eventQueue_,r,a)}function uD(n){return n.nextWriteId_++}function y$(n,e){const t=function Yj(n,e){const t=e._path;let r=null;n.syncPointTree_.foreachOnPath(t,(v,C)=>{const T=ws(v,t);r=r||Gd(C,T)});let i=n.syncPointTree_.get(t);i?r=r||Gd(i,Mn()):(i=new NO,n.syncPointTree_=n.syncPointTree_.set(t,i));const a=null!=r,l=a?new $d(r,!0,!1):null;return function Pj(n){return qC(n.viewCache_)}(Tx(i,e,KC(n.pendingWriteTree_,e._path),a?l.getNode():tn.EMPTY_NODE,a))}(n.serverSyncTree_,e);return null!=t?Promise.resolve(t):n.server_.get(e).then(r=>{const i=Lr(r).withIndex(e._queryParams.getIndex());if(e._queryParams.loadsAllData())uw(n.serverSyncTree_,e._path,i);else{const l=function Kj(n,e){const{syncPoint:t,serverCache:r,writesCache:i,serverCacheComplete:a}=BO(e,n),l=Tx(t,e,i,r,a);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,l),e._queryParams.loadsAllData()?null:lw(n,e)}(n.serverSyncTree_,e);VO(n.serverSyncTree_,e._path,i,l)}return tD(n.serverSyncTree_,e,null).length>0&&mp(n,"unexpected cancel events in repoGetValue"),i},r=>(mp(n,"get for query "+(0,N.Pz)(e)+" failed: "+r),Promise.reject(new Error(r))))}function jx(n,e,t,r,i){mp(n,"set",{path:e.toString(),value:t,priority:r});const a=mw(n),l=Lr(t,r),h=nD(n.serverSyncTree_,e),m=kx(l,h,a),v=uD(n),C=Sx(n.serverSyncTree_,e,m,v,!0);aD(n.eventQueue_,C),n.server_.put(e.toString(),l.val(!0),(x,$)=>{const Y="ok"===x;Y||Xi("set at "+e+" failed: "+x);const Ie=Wd(n.serverSyncTree_,v,!Y);Uo(n.eventQueue_,e,Ie),qd(0,i,x,$)});const T=Gx(n,e);t_(n,T),Uo(n.eventQueue_,T,[])}function E$(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{"ok"===r&&dx(n.onDisconnect_,e),qd(0,t,r,i)})}function i1(n,e,t,r){const i=Lr(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(a,l)=>{"ok"===a&&Qm(n.onDisconnect_,e,i),qd(0,r,a,l)})}function $x(n,e,t){let r;r=".info"===fn(e._path)?tD(n.infoSyncTree_,e,t):tD(n.serverSyncTree_,e,t),XO(n.eventQueue_,e._path,r)}function s1(n){n.persistentConnection_&&n.persistentConnection_.interrupt(e1)}function mp(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Ai(t,...e)}function qd(n,e,t,r){e&&zm(()=>{if("ok"===t)e(null);else{const i=(t||"error").toUpperCase();let a=i;r&&(a+=": "+r);const l=new Error(a);l.code=i,e(l)}})}function Hx(n,e,t){return nD(n.serverSyncTree_,e,t)||tn.EMPTY_NODE}function lD(n,e=n.transactionQueueTree_){if(e||cD(n,e),gp(e)){const t=a1(n,e);(0,N.hu)(t.length>0,"Sending zero length transaction queue"),t.every(i=>0===i.status)&&function S$(n,e,t){const r=t.map(v=>v.currentWriteId),i=Hx(n,e,r);let a=i;const l=i.hash();for(let v=0;v<t.length;v++){const C=t[v];(0,N.hu)(0===C.status,"tryToSendTransactionQueue_: items in queue should all be run."),C.status=1,C.retryCount++;const T=ws(e,C.path);a=a.updateChild(T,C.currentOutputSnapshotRaw)}const h=a.val(!0),m=e;n.server_.put(m.toString(),h,v=>{mp(n,"transaction put response",{path:m.toString(),status:v});let C=[];if("ok"===v){const T=[];for(let x=0;x<t.length;x++)t[x].status=2,C=C.concat(Wd(n.serverSyncTree_,t[x].currentWriteId)),t[x].onComplete&&T.push(()=>t[x].onComplete(null,!0,t[x].currentOutputSnapshotResolved)),t[x].unwatcher();cD(n,iD(n.transactionQueueTree_,e)),lD(n,n.transactionQueueTree_),Uo(n.eventQueue_,e,C);for(let x=0;x<T.length;x++)zm(T[x])}else{if("datastale"===v)for(let T=0;T<t.length;T++)t[T].status=3===t[T].status?4:0;else{Xi("transaction at "+m.toString()+" failed: "+v);for(let T=0;T<t.length;T++)t[T].status=4,t[T].abortReason=v}t_(n,e)}},l)}(n,dw(e),t)}else qO(e)&&sD(e,t=>{lD(n,t)})}function t_(n,e){const t=o1(n,e),r=dw(t);return function A$(n,e,t){if(0===e.length)return;const r=[];let i=[];const l=e.filter(h=>0===h.status).map(h=>h.currentWriteId);for(let h=0;h<e.length;h++){const m=e[h],v=ws(t,m.path);let T,C=!1;if((0,N.hu)(null!==v,"rerunTransactionsUnderNode_: relativePath should not be null."),4===m.status)C=!0,T=m.abortReason,i=i.concat(Wd(n.serverSyncTree_,m.currentWriteId,!0));else if(0===m.status)if(m.retryCount>=25)C=!0,T="maxretry",i=i.concat(Wd(n.serverSyncTree_,m.currentWriteId,!0));else{const x=Hx(n,m.path,l);m.currentInputSnapshot=x;const $=e[h].update(x.val());if(void 0!==$){fw("transaction failed: Data returned ",$,m.path);let Y=Lr($);"object"==typeof $&&null!=$&&(0,N.r3)($,".priority")||(Y=Y.updatePriority(x.getPriority()));const Re=m.currentWriteId,_t=mw(n),Et=kx(Y,x,_t);m.currentOutputSnapshotRaw=Y,m.currentOutputSnapshotResolved=Et,m.currentWriteId=uD(n),l.splice(l.indexOf(Re),1),i=i.concat(Sx(n.serverSyncTree_,m.path,Et,m.currentWriteId,m.applyLocally)),i=i.concat(Wd(n.serverSyncTree_,Re,!0))}else C=!0,T="nodata",i=i.concat(Wd(n.serverSyncTree_,m.currentWriteId,!0))}Uo(n.eventQueue_,t,i),i=[],C&&(e[h].status=2,setTimeout(e[h].unwatcher,Math.floor(0)),e[h].onComplete&&r.push("nodata"===T?()=>e[h].onComplete(null,!1,e[h].currentInputSnapshot):()=>e[h].onComplete(new Error(T),!1,null)))}cD(n,n.transactionQueueTree_);for(let h=0;h<r.length;h++)zm(r[h]);lD(n,n.transactionQueueTree_)}(n,a1(n,t),r),r}function o1(n,e){let t,r=n.transactionQueueTree_;for(t=fn(e);null!==t&&void 0===gp(r);)r=iD(r,t),t=fn(e=Xn(e));return r}function a1(n,e){const t=[];return u1(n,e,t),t.sort((r,i)=>r.order-i.order),t}function u1(n,e,t){const r=gp(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);sD(e,i=>{u1(n,i,t)})}function cD(n,e){const t=gp(e);if(t){let r=0;for(let i=0;i<t.length;i++)2!==t[i].status&&(t[r]=t[i],r++);t.length=r,Lx(e,t.length>0?t:void 0)}sD(e,r=>{cD(n,r)})}function Gx(n,e){const t=dw(o1(n,e)),r=iD(n.transactionQueueTree_,e);return function s$(n,e,t){let r=t?n:n.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,i=>{zx(n,i)}),zx(n,r),KO(r,i=>{zx(n,i)}),t}function zx(n,e){const t=gp(e);if(t){const r=[];let i=[],a=-1;for(let l=0;l<t.length;l++)3===t[l].status||(1===t[l].status?((0,N.hu)(a===l-1,"All SENT items should be at beginning of queue."),a=l,t[l].status=3,t[l].abortReason="set"):((0,N.hu)(0===t[l].status,"Unexpected transaction status in abort"),t[l].unwatcher(),i=i.concat(Wd(n.serverSyncTree_,t[l].currentWriteId,!0)),t[l].onComplete&&r.push(t[l].onComplete.bind(null,new Error("set"),!1,null))));-1===a?Lx(e,void 0):t.length=a+1,Uo(n.eventQueue_,dw(e),i);for(let l=0;l<r.length;l++)zm(r[l])}}const Wx=function(n,e){const t=M$(n),r=t.namespace;return"firebase.com"===t.domain&&Nu(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==t.domain&&Nu("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Xi("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new qR(t.host,t.secure,r,"ws"===t.scheme||"wss"===t.scheme,e,"",r!==t.subdomain),path:new Vn(t.pathString)}},M$=function(n){let e="",t="",r="",i="",a="",l=!0,h="https",m=443;if("string"==typeof n){let v=n.indexOf("//");v>=0&&(h=n.substring(0,v-1),n=n.substring(v+2));let C=n.indexOf("/");-1===C&&(C=n.length);let T=n.indexOf("?");-1===T&&(T=n.length),e=n.substring(0,Math.min(C,T)),C<T&&(i=function R$(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}(n.substring(C,T)));const x=function x$(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const r=t.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Xi(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,T)));v=e.indexOf(":"),v>=0?(l="https"===h||"wss"===h,m=parseInt(e.substring(v+1),10)):v=e.length;const $=e.slice(0,v);if("localhost"===$.toLowerCase())t="localhost";else if($.split(".").length<=2)t=$;else{const Y=e.indexOf(".");r=e.substring(0,Y).toLowerCase(),t=e.substring(Y+1),a=r}"ns"in x&&(a=x.ns)}return{host:e,port:m,domain:t,subdomain:r,secure:l,scheme:h,pathString:i,namespace:a}};class l1{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,N.Pz)(this.snapshot.exportVal())}}class c1{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class d1{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,N.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class h1{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new N.BH;return E$(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Fo("OnDisconnect.remove",this._path);const e=new N.BH;return i1(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Fo("OnDisconnect.set",this._path),Fu("OnDisconnect.set",e,this._path,!1);const t=new N.BH;return i1(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Fo("OnDisconnect.setWithPriority",this._path),Fu("OnDisconnect.setWithPriority",e,this._path,!1),Vx("OnDisconnect.setWithPriority",t,!1);const r=new N.BH;return function I$(n,e,t,r,i){const a=Lr(t,r);n.server_.onDisconnectPut(e.toString(),a.val(!0),(l,h)=>{"ok"===l&&Qm(n.onDisconnect_,e,a),qd(0,i,l,h)})}(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){Fo("OnDisconnect.update",this._path),YO("OnDisconnect.update",e,this._path,!1);const t=new N.BH;return function b$(n,e,t,r){if((0,N.xb)(t))return Ai("onDisconnect().update() called with empty data.  Don't do anything."),void qd(0,r,"ok",void 0);n.server_.onDisconnectMerge(e.toString(),t,(i,a)=>{"ok"===i&&Ri(t,(l,h)=>{const m=Lr(h);Qm(n.onDisconnect_,Cr(e,l),m)}),qd(0,r,i,a)})}(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}class Bs{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return pn(this._path)?null:JR(this._path)}get ref(){return new Vo(this._repo,this._path)}get _queryIdentifier(){const e=gO(this._queryParams),t=GR(e);return"{}"===t?"default":t}get _queryObject(){return gO(this._queryParams)}isEqual(e){if(!((e=(0,N.m9)(e))instanceof Bs))return!1;const t=this._repo===e._repo,r=ex(this._path,e._path);return t&&r&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function EB(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}function dD(n,e){if(!0===n._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function Kd(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===Lu){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Jl)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==Ou)throw new Error(r);if("string"!=typeof t)throw new Error(i)}}else if(n.getIndex()===sr){if(null!=e&&!hw(e)||null!=t&&!hw(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,N.hu)(n.getIndex()instanceof sx||n.getIndex()===ox,"unknown index type."),null!=e&&"object"==typeof e||null!=t&&"object"==typeof t)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function hD(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Vo extends Bs{constructor(e,t){super(e,t,new jC,!1)}get parent(){const e=JN(this._path);return null===e?null:new Vo(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class _p{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Vn(e),r=yp(this.ref,e);return new _p(this._node.getChild(t),r,sr)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,i)=>e(new _p(i,yp(this.ref,r),sr)))}hasChild(e){const t=new Vn(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function f1(n,e){return(n=(0,N.m9)(n))._checkNotDeleted("ref"),void 0!==e?yp(n._root,e):n._root}function p1(n,e){(n=(0,N.m9)(n))._checkNotDeleted("refFromURL");const t=Wx(e,n._repo.repoInfo_.nodeAdmin);QO("refFromURL",t);const r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&Nu("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),f1(n,t.path.toString())}function yp(n,e){return null===fn((n=(0,N.m9)(n))._path)?(t=e,t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),gw("child","path",t,!1)):gw("child","path",e,!1),new Vo(n._repo,Cr(n._path,e));var t}function qx(n,e){n=(0,N.m9)(n),Fo("set",n._path),Fu("set",e,n._path,!1);const t=new N.BH;return jx(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function L$(n,e){YO("update",e,n._path,!1);const t=new N.BH;return function v$(n,e,t,r){mp(n,"update",{path:e.toString(),value:t});let i=!0;const a=mw(n),l={};if(Ri(t,(h,m)=>{i=!1,l[h]=WO(Cr(e,h),Lr(m),n.serverSyncTree_,a)}),i)Ai("update() called with empty data.  Don't do anything."),qd(0,r,"ok",void 0);else{const h=uD(n),m=function Gj(n,e,t,r){!function aj(n,e,t,r){(0,N.hu)(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=_x(n.visibleWrites,e,t),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r);const i=or.fromObject(t);return e_(n,new Xm({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}(n.serverSyncTree_,e,l,h);aD(n.eventQueue_,m),n.server_.merge(e.toString(),t,(v,C)=>{const T="ok"===v;T||Xi("update at "+e+" failed: "+v);const x=Wd(n.serverSyncTree_,h,!T),$=x.length>0?t_(n,e):e;Uo(n.eventQueue_,$,x),qd(0,r,v,C)}),Ri(t,v=>{const C=Gx(n,Cr(e,v));t_(n,C)}),Uo(n.eventQueue_,e,[])}}(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}class fD{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const r=t._queryParams.getIndex();return new l1("value",this,new _p(e.snapshotNode,new Vo(t._repo,t._path),r))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new c1(this,e,t):null}matches(e){return e instanceof fD&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class pD{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new c1(this,e,t):null}createEvent(e,t){(0,N.hu)(null!=e.childName,"Child events should have a childName.");const r=yp(new Vo(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new l1(e.type,this,new _p(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof pD&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function _w(n,e,t,r,i){let a;if("object"==typeof r&&(a=void 0,i=r),"function"==typeof r&&(a=r),i&&i.onlyOnce){const m=t,v=(C,T)=>{$x(n._repo,n,h),m(C,T)};v.userCallback=t.userCallback,v.context=t.context,t=v}const l=new d1(t,a||void 0),h="value"===e?new fD(l):new pD(e,l);return function C$(n,e,t){let r;r=".info"===fn(e._path)?jO(n.infoSyncTree_,e,t):jO(n.serverSyncTree_,e,t),XO(n.eventQueue_,e._path,r)}(n._repo,n,h),()=>$x(n._repo,n,h)}function Kx(n,e,t,r){return _w(n,"value",e,t,r)}function g1(n,e,t,r){return _w(n,"child_added",e,t,r)}function m1(n,e,t,r){return _w(n,"child_changed",e,t,r)}function _1(n,e,t,r){return _w(n,"child_moved",e,t,r)}function y1(n,e,t,r){return _w(n,"child_removed",e,t,r)}function v1(n,e,t){let r=null;const i=t?new d1(t):null;"value"===e?r=new fD(i):e&&(r=new pD(e,i)),$x(n._repo,n,r)}class Ma{}class w1 extends Ma{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Fu("endAt",this._value,e._path,!0);const t=cx(e._queryParams,this._value,this._key);if(hD(t),Kd(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Bs(e._repo,e._path,t,e._orderByCalled)}}class V$ extends Ma{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Fu("endBefore",this._value,e._path,!1);const t=function KB(n,e,t){let r,i;return n.index_===Lu?("string"==typeof e&&(e=hO(e)),i=cx(n,e,t)):(r=null==t?Jl:hO(t),i=cx(n,e,r)),i.endBeforeSet_=!0,i}(e._queryParams,this._value,this._key);if(hD(t),Kd(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Bs(e._repo,e._path,t,e._orderByCalled)}}class E1 extends Ma{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Fu("startAt",this._value,e._path,!0);const t=lx(e._queryParams,this._value,this._key);if(hD(t),Kd(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Bs(e._repo,e._path,t,e._orderByCalled)}}class $$ extends Ma{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Fu("startAfter",this._value,e._path,!1);const t=function qB(n,e,t){let r;if(n.index_===Lu)"string"==typeof e&&(e=dO(e)),r=lx(n,e,t);else{let i;i=null==t?Ou:dO(t),r=lx(n,e,i)}return r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(hD(t),Kd(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Bs(e._repo,e._path,t,e._orderByCalled)}}class G$ extends Ma{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Bs(e._repo,e._path,function zB(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}(e._queryParams,this._limit),e._orderByCalled)}}class W$ extends Ma{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Bs(e._repo,e._path,function WB(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}(e._queryParams,this._limit),e._orderByCalled)}}class K$ extends Ma{constructor(e){super(),this._path=e}_apply(e){dD(e,"orderByChild");const t=new Vn(this._path);if(pn(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new sx(t),i=$C(e._queryParams,r);return Kd(i),new Bs(e._repo,e._path,i,!0)}}class Y$ extends Ma{_apply(e){dD(e,"orderByKey");const t=$C(e._queryParams,Lu);return Kd(t),new Bs(e._repo,e._path,t,!0)}}class X$ extends Ma{_apply(e){dD(e,"orderByPriority");const t=$C(e._queryParams,sr);return Kd(t),new Bs(e._repo,e._path,t,!0)}}class eH extends Ma{_apply(e){dD(e,"orderByValue");const t=$C(e._queryParams,ox);return Kd(t),new Bs(e._repo,e._path,t,!0)}}class nH extends Ma{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(Fu("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new w1(this._value,this._key)._apply(new E1(this._value,this._key)._apply(e))}}function Pa(n,...e){let t=(0,N.m9)(n);for(const r of e)t=r._apply(t);return t}(function Lj(n){(0,N.hu)(!XC,"__referenceConstructor has already been defined"),XC=n})(Vo),function jj(n){(0,N.hu)(!eD,"__referenceConstructor has already been defined"),eD=n}(Vo);const Zx={};function b1(n,e,t,r,i){let a=r||n.options.databaseURL;void 0===a&&(n.options.projectId||Nu("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ai("Using default host for project ",n.options.projectId),a=`${n.options.projectId}-default-rtdb.firebaseio.com`);let m,v,l=Wx(a,i),h=l.repoInfo;typeof process<"u"&&process.env&&(v=process.env.FIREBASE_DATABASE_EMULATOR_HOST),v?(m=!0,a=`http://${v}?ns=${h.namespace}`,l=Wx(a,i),h=l.repoInfo):m=!l.repoInfo.secure;const C=i&&m?new Y0(Y0.OWNER):new YV(n.name,n.options,e);QO("Invalid Firebase Database URL",l),pn(l.path)||Nu("Database URL must point to the root of a Firebase Database (not including a child path).");const T=function aH(n,e,t,r){let i=Zx[e.name];i||(i={},Zx[e.name]=i);let a=i[n.toURLString()];return a&&Nu("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),a=new g$(n,false,t,r),i[n.toURLString()]=a,a}(h,n,C,new ZV(n.name,t));return new lH(T,n)}class lH{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function m$(n,e,t){if(n.stats_=YR(n.repoInfo_),n.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)n.server_=new HC(n.repoInfo_,(r,i,a,l)=>{n1(n,r,i,a,l)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>r1(n,!0),0);else{if(typeof t<"u"&&null!==t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,N.Pz)(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new dp(n.repoInfo_,e,(r,i,a,l)=>{n1(n,r,i,a,l)},r=>{r1(n,r)},r=>{!function _$(n,e){Ri(e,(t,r)=>{Bx(n,t,r)})}(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=function JV(n,e){const t=n.toString();return ZR[t]||(ZR[t]=e()),ZR[t]}(n.repoInfo_,()=>new ej(n.stats_,n.server_)),n.infoData_=new ZB,n.infoSyncTree_=new UO({startListening:(r,i,a,l)=>{let h=[];const m=n.infoData_.getNode(r._path);return m.isEmpty()||(h=uw(n.infoSyncTree_,r._path,m),setTimeout(()=>{l("ok")},0)),h},stopListening:()=>{}}),Bx(n,"connected",!1),n.serverSyncTree_=new UO({startListening:(r,i,a,l)=>(n.server_.listen(r,a,i,(h,m)=>{const v=l(h,m);Uo(n.eventQueue_,r._path,v)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Vo(this._repo,Mn())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function oH(n,e){const t=Zx[e];(!t||t[n.key]!==n)&&Nu(`Database ${e}(${n.repoInfo_}) has already been deleted.`),s1(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Nu("Cannot call "+e+" on a deleted database.")}}function C1(){jN.IS_TRANSPORT_INITIALIZED&&Xi("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function cH(){C1(),Bd.forceDisallow()}function dH(){C1(),Wm.forceDisallow(),Bd.forceAllow()}function gH(n,e){EN(n,e)}const _H={".sv":"timestamp"};class wH{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}dp.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},dp.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function mH(n){mN(ki.SDK_VERSION),(0,ki._registerComponent)(new zi.wA("database",(e,{instanceIdentifier:t})=>b1(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),(0,ki.registerVersion)(pN,"0.13.3",n),(0,ki.registerVersion)(pN,"0.13.3","esm2017")}();const CH=new Qs.Yd("@firebase/database-compat"),D1=function(n){CH.warn("FIREBASE WARNING: "+n)};class SH{constructor(e){this._delegate=e}cancel(e){(0,N.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,N.Wj)("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){(0,N.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,N.Wj)("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){(0,N.Dv)("OnDisconnect.set",1,2,arguments.length),(0,N.Wj)("OnDisconnect.set","onComplete",t,!0);const r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,N.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,N.Wj)("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),a=>r(a)),i}update(e,t){if((0,N.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let a=0;a<e.length;++a)i[""+a]=e[a];e=i,D1("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,N.Wj)("OnDisconnect.update","onComplete",t,!0);const r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}}class AH{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return(0,N.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class Zd{constructor(e,t){this._database=e,this._delegate=t}val(){return(0,N.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,N.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,N.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,N.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,N.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),gw("DataSnapshot.child","path",e,!1),new Zd(this._database,this._delegate.child(e))}hasChild(e){return(0,N.Dv)("DataSnapshot.hasChild",1,1,arguments.length),gw("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,N.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,N.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,N.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new Zd(this._database,t)))}hasChildren(){return(0,N.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,N.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,N.Dv)("DataSnapshot.ref",0,0,arguments.length),new ao(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Fi{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var a;(0,N.Dv)("Query.on",2,4,arguments.length),(0,N.Wj)("Query.on","callback",t,!1);const l=Fi.getCancelAndContextArgs_("Query.on",r,i),h=(v,C)=>{t.call(l.context,new Zd(this.database,v),C)};h.userCallback=t,h.context=l.context;const m=null===(a=l.cancel)||void 0===a?void 0:a.bind(l.context);switch(e){case"value":return Kx(this._delegate,h,m),t;case"child_added":return g1(this._delegate,h,m),t;case"child_removed":return y1(this._delegate,h,m),t;case"child_changed":return m1(this._delegate,h,m),t;case"child_moved":return _1(this._delegate,h,m),t;default:throw new Error((0,N.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if((0,N.Dv)("Query.off",0,3,arguments.length),function(n,e,t){if(void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,N.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,e),(0,N.Wj)("Query.off","callback",t,!0),(0,N.lb)("Query.off","context",r,!0),t){const i=()=>{};i.userCallback=t,i.context=r,v1(this._delegate,e,i)}else v1(this._delegate,e)}get(){return function F$(n){return y$((n=(0,N.m9)(n))._repo,n).then(e=>new _p(e,new Vo(n._repo,n._path),n._queryParams.getIndex()))}(this._delegate).then(e=>new Zd(this.database,e))}once(e,t,r,i){(0,N.Dv)("Query.once",1,4,arguments.length),(0,N.Wj)("Query.once","callback",t,!0);const a=Fi.getCancelAndContextArgs_("Query.once",r,i),l=new N.BH,h=(v,C)=>{const T=new Zd(this.database,v);t&&t.call(a.context,T,C),l.resolve(T)};h.userCallback=t,h.context=a.context;const m=v=>{a.cancel&&a.cancel.call(a.context,v),l.reject(v)};switch(e){case"value":Kx(this._delegate,h,m,{onlyOnce:!0});break;case"child_added":g1(this._delegate,h,m,{onlyOnce:!0});break;case"child_removed":y1(this._delegate,h,m,{onlyOnce:!0});break;case"child_changed":m1(this._delegate,h,m,{onlyOnce:!0});break;case"child_moved":_1(this._delegate,h,m,{onlyOnce:!0});break;default:throw new Error((0,N.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return l.promise}limitToFirst(e){return(0,N.Dv)("Query.limitToFirst",1,1,arguments.length),new Fi(this.database,Pa(this._delegate,function z$(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new G$(n)}(e)))}limitToLast(e){return(0,N.Dv)("Query.limitToLast",1,1,arguments.length),new Fi(this.database,Pa(this._delegate,function q$(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new W$(n)}(e)))}orderByChild(e){return(0,N.Dv)("Query.orderByChild",1,1,arguments.length),new Fi(this.database,Pa(this._delegate,function Z$(n){if("$key"===n)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===n)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===n)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return gw("orderByChild","path",n,!1),new K$(n)}(e)))}orderByKey(){return(0,N.Dv)("Query.orderByKey",0,0,arguments.length),new Fi(this.database,Pa(this._delegate,function Q$(){return new Y$}()))}orderByPriority(){return(0,N.Dv)("Query.orderByPriority",0,0,arguments.length),new Fi(this.database,Pa(this._delegate,function J$(){return new X$}()))}orderByValue(){return(0,N.Dv)("Query.orderByValue",0,0,arguments.length),new Fi(this.database,Pa(this._delegate,function tH(){return new eH}()))}startAt(e=null,t){return(0,N.Dv)("Query.startAt",0,2,arguments.length),new Fi(this.database,Pa(this._delegate,function j$(n=null,e){return pw("startAt","key",e,!0),new E1(n,e)}(e,t)))}startAfter(e=null,t){return(0,N.Dv)("Query.startAfter",0,2,arguments.length),new Fi(this.database,Pa(this._delegate,function H$(n,e){return pw("startAfter","key",e,!0),new $$(n,e)}(e,t)))}endAt(e=null,t){return(0,N.Dv)("Query.endAt",0,2,arguments.length),new Fi(this.database,Pa(this._delegate,function U$(n,e){return pw("endAt","key",e,!0),new w1(n,e)}(e,t)))}endBefore(e=null,t){return(0,N.Dv)("Query.endBefore",0,2,arguments.length),new Fi(this.database,Pa(this._delegate,function B$(n,e){return pw("endBefore","key",e,!0),new V$(n,e)}(e,t)))}equalTo(e,t){return(0,N.Dv)("Query.equalTo",1,2,arguments.length),new Fi(this.database,Pa(this._delegate,function rH(n,e){return pw("equalTo","key",e,!0),new nH(n,e)}(e,t)))}toString(){return(0,N.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,N.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,N.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof Fi))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){const i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,(0,N.Wj)(e,"cancel",i.cancel,!0),i.context=r,(0,N.lb)(e,"context",i.context,!0);else if(t)if("object"==typeof t&&null!==t)i.context=t;else{if("function"!=typeof t)throw new Error((0,N.gK)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");i.cancel=t}return i}get ref(){return new ao(this.database,new Vo(this._delegate._repo,this._delegate._path))}}class ao extends Fi{constructor(e,t){super(e,new Bs(t._repo,t._path,new jC,!1)),this.database=e,this._delegate=t}getKey(){return(0,N.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,N.Dv)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new ao(this.database,yp(this._delegate,e))}getParent(){(0,N.Dv)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new ao(this.database,e):null}getRoot(){return(0,N.Dv)("Reference.root",0,0,arguments.length),new ao(this.database,this._delegate.root)}set(e,t){(0,N.Dv)("Reference.set",1,2,arguments.length),(0,N.Wj)("Reference.set","onComplete",t,!0);const r=qx(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if((0,N.Dv)("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let a=0;a<e.length;++a)i[""+a]=e[a];e=i,D1("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Fo("Reference.update",this._delegate._path),(0,N.Wj)("Reference.update","onComplete",t,!0);const r=L$(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,N.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,N.Wj)("Reference.setWithPriority","onComplete",r,!0);const i=function O$(n,e,t){if(Fo("setWithPriority",n._path),Fu("setWithPriority",e,n._path,!1),Vx("setWithPriority",t,!1),".length"===n.key||".keys"===n.key)throw"setWithPriority failed: "+n.key+" is a read-only object.";const r=new N.BH;return jx(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}(this._delegate,e,t);return r&&i.then(()=>r(null),a=>r(a)),i}remove(e){(0,N.Dv)("Reference.remove",0,1,arguments.length),(0,N.Wj)("Reference.remove","onComplete",e,!0);const t=function k$(n){return Fo("remove",n._path),qx(n,null)}(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){(0,N.Dv)("Reference.transaction",1,3,arguments.length),(0,N.Wj)("Reference.transaction","transactionUpdate",e,!1),(0,N.Wj)("Reference.transaction","onComplete",t,!0),function(n,e,t,r){if(void 0!==t&&"boolean"!=typeof t)throw new Error((0,N.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,r);const i=function EH(n,e,t){var r;if(n=(0,N.m9)(n),Fo("Reference.transaction",n._path),".length"===n.key||".keys"===n.key)throw"Reference.transaction failed: "+n.key+" is a read-only object.";const i=null===(r=t?.applyLocally)||void 0===r||r,a=new N.BH,h=Kx(n,()=>{});return function T$(n,e,t,r,i,a){mp(n,"transaction on "+e);const l={path:e,update:t,onComplete:r,status:null,order:yN(),applyLocally:a,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},h=Hx(n,e,void 0);l.currentInputSnapshot=h;const m=l.update(h.val());if(void 0===m)l.unwatcher(),l.currentOutputSnapshotRaw=null,l.currentOutputSnapshotResolved=null,l.onComplete&&l.onComplete(null,!1,l.currentInputSnapshot);else{fw("transaction failed: Data returned ",m,l.path),l.status=0;const v=iD(n.transactionQueueTree_,e),C=gp(v)||[];let T;C.push(l),Lx(v,C),"object"==typeof m&&null!==m&&(0,N.r3)(m,".priority")?(T=(0,N.DV)(m,".priority"),(0,N.hu)(hw(T),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):T=(nD(n.serverSyncTree_,e)||tn.EMPTY_NODE).getPriority().val();const x=mw(n),$=Lr(m,T),Y=kx($,h,x);l.currentOutputSnapshotRaw=$,l.currentOutputSnapshotResolved=Y,l.currentWriteId=uD(n);const Ie=Sx(n.serverSyncTree_,e,Y,l.currentWriteId,l.applyLocally);Uo(n.eventQueue_,e,Ie),lD(n,n.transactionQueueTree_)}}(n._repo,n._path,e,(m,v,C)=>{let T=null;m?a.reject(m):(T=new _p(C,new Vo(n._repo,n._path),sr),a.resolve(new wH(v,T)))},h,i),a.promise}(this._delegate,e,{applyLocally:r}).then(a=>new AH(a.committed,new Zd(this.database,a.snapshot)));return t&&i.then(a=>t(null,a.committed,a.snapshot),a=>t(a,!1,null)),i}setPriority(e,t){(0,N.Dv)("Reference.setPriority",1,2,arguments.length),(0,N.Wj)("Reference.setPriority","onComplete",t,!0);const r=function N$(n,e){n=(0,N.m9)(n),Fo("setPriority",n._path),Vx("setPriority",e,!1);const t=new N.BH;return jx(n._repo,Cr(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){(0,N.Dv)("Reference.push",0,2,arguments.length),(0,N.Wj)("Reference.push","onComplete",t,!0);const r=function P$(n,e){n=(0,N.m9)(n),Fo("push",n._path),Fu("push",e,n._path,!0);const t=t1(n._repo),r=jB(t),i=yp(n,r),a=yp(n,r);let l;return l=null!=e?qx(a,e).then(()=>a):Promise.resolve(a),i.then=l.then.bind(l),i.catch=l.then.bind(l,void 0),i}(this._delegate,e),i=r.then(l=>new ao(this.database,l));t&&i.then(()=>t(null),l=>t(l));const a=new ao(this.database,r);return a.then=i.then.bind(i),a.catch=i.catch.bind(i,void 0),a}onDisconnect(){return Fo("Reference.onDisconnect",this._delegate._path),new SH(new h1(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class yw{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:cH,forceLongPolling:dH}}useEmulator(e,t,r={}){!function hH(n,e,t,r={}){(n=(0,N.m9)(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&Nu("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let a;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Nu('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new Y0(Y0.OWNER);else if(r.mockUserToken){const l="string"==typeof r.mockUserToken?r.mockUserToken:(0,N.Sg)(r.mockUserToken,n.app.options.projectId);a=new Y0(l)}!function sH(n,e,t,r){n.repoInfo_=new qR(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams),r&&(n.authTokenProvider_=r)}(i,e,t,a)}(this._delegate,e,t,r)}ref(e){if((0,N.Dv)("database.ref",0,1,arguments.length),e instanceof ao){const t=p1(this._delegate,e.toString());return new ao(this,t)}{const t=f1(this._delegate,e);return new ao(this,t)}}refFromURL(e){(0,N.Dv)("database.refFromURL",1,1,arguments.length);const r=p1(this._delegate,e);return new ao(this,r)}goOffline(){return(0,N.Dv)("database.goOffline",0,0,arguments.length),function fH(n){(n=(0,N.m9)(n))._checkNotDeleted("goOffline"),s1(n._repo)}(this._delegate)}goOnline(){return(0,N.Dv)("database.goOnline",0,0,arguments.length),function pH(n){(n=(0,N.m9)(n))._checkNotDeleted("goOnline"),function D$(n){n.persistentConnection_&&n.persistentConnection_.resume(e1)}(n._repo)}(this._delegate)}}yw.ServerValue={TIMESTAMP:function yH(){return _H}(),increment:n=>function vH(n){return{".sv":{increment:n}}}(n)};var xH=Object.freeze({__proto__:null,initStandalone:function RH({app:n,url:e,version:t,customAuthImpl:r,namespace:i,nodeAdmin:a=!1}){mN(t);const l=new zi.zt("auth-internal",new zi.H0("database-standalone"));return l.setComponent(new zi.wA("auth-internal",()=>r,"PRIVATE")),{instance:new yw(b1(n,l,void 0,e,a),n),namespace:i}}});const MH=yw.ServerValue;function T1(n){return null==n}function S1(n){return"function"==typeof n.set}function A1(n,e){return S1(e)?e:n.ref(e)}function R1(n,e){if(function kH(n){return"string"==typeof n}(n))return e.stringCase();if(S1(n))return e.firebaseCase();if(function NH(n){return"function"==typeof n.exportVal}(n))return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof n)}function vw(n,e,t="on",r=uu.z){return new $i.y(i=>{let a=null;return a=n[t](e,(l,h)=>{r.schedule(()=>{i.next({snapshot:l,prevKey:h})}),"once"===t&&r.schedule(()=>i.complete())},l=>{r.schedule(()=>i.error(l))}),"on"===t?{unsubscribe(){null!=a&&n.off(e,a)}}:{unsubscribe(){}}}).pipe((0,At.U)(i=>{const{snapshot:a,prevKey:l}=i;let h=null;return a.exists()&&(h=a.key),{type:e,payload:a,prevKey:l,key:h}}),(0,YP.B)())}function x1(n,e){const t=n.length;for(let r=0;r<t;r++)if(n[r].payload.key===e)return r;return-1}function FH(n,e){const{payload:t,prevKey:r,key:i}=e,a=x1(n,i),l=function LH(n,e){if(T1(e))return 0;{const t=x1(n,e);return-1===t?n.length:t+1}}(n,r);switch(e.type){case"value":if(e.payload&&e.payload.exists()){let h=null;e.payload.forEach(m=>{const v={payload:m,type:"value",prevKey:h,key:m.key};return h=m.key,n=[...n,v],!1})}return n;case"child_added":if(a>-1){const h=n[a-1];(h&&h.key||null)!==r&&(n=n.filter(m=>m.payload.key!==t.key)).splice(l,0,e)}else{if(null==r)return[e,...n];(n=n.slice()).splice(l,0,e)}return n;case"child_removed":return n.filter(h=>h.payload.key!==t.key);case"child_changed":return n.map(h=>h.payload.key===i?e:h);case"child_moved":if(a>-1){const h=n.splice(a,1)[0];return(n=n.slice()).splice(l,0,h),n}return n;default:return n}}function M1(n){return(T1(n)||0===n.length)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function P1(n,e,t){return function OH(n,e,t){return vw(n,"value","once",t).pipe(yr(r=>{const i=[ot(r)];return e.forEach(a=>i.push(vw(n,a,"on",t))),(0,eR.T)(...i).pipe(wo(FH,[]))}),pg())}(n,e=M1(e),t)}function k1(n,e,t){const r=(e=M1(e)).map(i=>vw(n,i,"on",t));return(0,eR.T)(...r)}function N1(n,e){return function(r,i){return R1(r,{stringCase:()=>n.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function jH(n){return function(t){return t?R1(t,{stringCase:()=>n.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):n.remove()}}function O1(n,e){return function(){return vw(n,"value","on",e)}}!function PH(n){n.INTERNAL.registerComponent(new zi.wA("database-compat",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new yw(i,r)},"PUBLIC").setServiceProps({Reference:ao,Query:Fi,Database:yw,DataSnapshot:Zd,enableLogging:gH,INTERNAL:xH,ServerValue:MH}).setMultipleInstances(!0)),n.registerVersion("@firebase/database-compat","0.2.3")}(zh.Z);const GH=new g.OlP("angularfire2.realtimeDatabaseURL"),zH=new g.OlP("angularfire2.database.use-emulator");let WH=(()=>{class n{constructor(t,r,i,a,l,h,m,v,C,T,x,$,Y,Ie,Re){this.schedulers=h;const _t=m,Et=(0,$r.on)(t,l,r);v&&TR(Et,l,C,x,$,Y,T,Ie),this.database=(0,$r.cc)(`${Et.name}.database.${i}`,"AngularFireDatabase",Et.name,()=>{const vt=l.runOutsideAngular(()=>Et.database(i||void 0));return _t&&vt.useEmulator(..._t),vt},[_t])}list(t,r){const i=this.schedulers.ngZone.runOutsideAngular(()=>A1(this.database,t));let a=i;return r&&(a=r(i)),function $H(n,e){const t=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>n.ref);return{query:n,update:N1(r,"update"),set:N1(r,"set"),push:i=>r.push(i),remove:jH(r),snapshotChanges:i=>P1(n,i,t).pipe(En.iC),stateChanges:i=>k1(n,i,t).pipe(En.iC),auditTrail:i=>function UH(n,e,t){return function BH(n,e,t){return function VH(n,e){return vw(n,"value","on",e).pipe((0,At.U)(t=>{let r;return t.payload.forEach(i=>(r=i.key,!1)),{data:t,lastKeyToLoad:r}}))}(n,t).pipe(function FV(...n){const e=(0,vo.jO)(n);return(0,Mr.e)((t,r)=>{const i=n.length,a=new Array(i);let l=n.map(()=>!1),h=!1;for(let m=0;m<i;m++)(0,Ja.Xf)(n[m]).subscribe((0,zn.x)(r,v=>{a[m]=v,!h&&!l[m]&&(l[m]=!0,(h=l.every(Hi.y))&&(l=null))},LV.Z));t.subscribe((0,zn.x)(r,m=>{if(h){const v=[m,...a];r.next(e?e(...v):v)}}))})}(e),(0,At.U)(([i,a])=>{const l=i.lastKeyToLoad,h=a.map(m=>m.key);return{actions:a,lastKeyToLoad:l,loadedKeys:h}}),function UV(n){return(0,Mr.e)((e,t)=>{let r=!1,i=0;e.subscribe((0,zn.x)(t,a=>(r||(r=!n(a,i++)))&&t.next(a)))})}(i=>-1===i.loadedKeys.indexOf(i.lastKeyToLoad)),(0,At.U)(i=>i.actions))}(n,k1(n,e).pipe(wo((i,a)=>[...i,a],[])),t)}(n,i,t).pipe(En.iC),valueChanges:(i,a)=>P1(n,i,t).pipe((0,At.U)(h=>h.map(m=>a&&a.idField?Object.assign(Object.assign({},m.payload.val()),{[a.idField]:m.key}):m.payload.val())),En.iC)}}(a,this)}object(t){return function HH(n,e){return{query:n,snapshotChanges:()=>O1(n,e.schedulers.outsideAngular)().pipe(En.iC),update:t=>n.ref.update(t),set:t=>n.ref.set(t),remove:()=>n.ref.remove(),valueChanges:()=>O1(n,e.schedulers.outsideAngular)().pipe(En.iC,(0,At.U)(r=>r.payload.exists()?r.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>A1(this.database,t)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}}return n.\u0275fac=function(t){return new(t||n)(g.LFG($r.Dh),g.LFG($r.xv,8),g.LFG(GH,8),g.LFG(g.Lbi),g.LFG(g.R0b),g.LFG(En.HU),g.LFG(zH,8),g.LFG(O0,8),g.LFG(wR,8),g.LFG(ER,8),g.LFG(IR,8),g.LFG(bR,8),g.LFG(CR,8),g.LFG(DR,8),g.LFG(N0,8))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),qH=(()=>{class n{constructor(){bC.Z.registerVersion("angularfire",En.q4.full,"rtdb-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({providers:[WH]}),n})();var KH=M(6148);const L1_firebase={apiKey:"AIzaSyDs82cPmSJyx2LYOrkprdcU0JItVrnT_uk",authDomain:"proiect-isi-28b18.firebaseapp.com",projectId:"proiect-isi-28b18",storageBucket:"proiect-isi-28b18.appspot.com",messagingSenderId:"1051352894411",appId:"1:1051352894411:web:ea1c2cd65112cd08b6044e",measurementId:"G-1JYQXFFEKE"},ZH=(0,nR.ZF)(L1_firebase);(0,KH.IH)(ZH);class n_{}n_.\u0275fac=function(e){return new(e||n_)},n_.\u0275mod=g.oAB({type:n_,bootstrap:[j0]}),n_.\u0275inj=g.cJS({providers:[so],imports:[Ku,Sa,$r.hO.initializeApp(L1_firebase),kU,jU,OV,qH]}),qu().bootstrapModule(n_).catch(n=>console.error(n))},7082:function(ft,Pe){!function(M){"use strict";var j={Promise:typeof window<"u"?window.Promise:void 0},k="4.25",oe="next";function me(ae){if(ae.toLowerCase()===oe)return oe;var De=ae&&ae.match(/^(\d)\.(\d+)/);return De&&{major:parseInt(De[1],10),minor:parseInt(De[2],10)}}function he(ae){return void 0===ae&&(ae=k),"https://js.arcgis.com/".concat(ae,"/")}function H(ae){return!ae||me(ae)?function we(ae){void 0===ae&&(ae=k);var De=he(ae),q=me(ae);if(q!==oe&&3===q.major){var se=q.minor<=10?"js/":"";return"".concat(De).concat(se,"esri/css/esri.css")}return"".concat(De,"esri/themes/light/main.css")}(ae):ae}function te(ae,De){var q=H(ae),se=function z(ae){return document.querySelector('link[href*="'.concat(ae,'"]'))}(q);return se||function ye(ae,De){if(De){var q=document.querySelector(De);q.parentNode.insertBefore(ae,q)}else document.head.appendChild(ae)}(se=function _e(ae){var De=document.createElement("link");return De.rel="stylesheet",De.href=ae,De}(q),De),se}var Oe={};function Ke(ae,De,q){var se;q&&(se=function Xe(ae,De){var q=function(se){De(se.error||new Error("There was an error attempting to load ".concat(ae.src))),ae.removeEventListener("error",q,!1)};return ae.addEventListener("error",q,!1),q}(ae,q));var Ee=function(){De(ae),ae.removeEventListener("load",Ee,!1),se&&ae.removeEventListener("error",se,!1)};ae.addEventListener("load",Ee,!1)}function xe(){return document.querySelector("script[data-esri-loader]")}function ke(){var ae=window.require;return ae&&ae.on}function Ne(ae){void 0===ae&&(ae={});var De={};[Oe,ae].forEach(function(Ee){for(var Q in Ee)Object.prototype.hasOwnProperty.call(Ee,Q)&&(De[Q]=Ee[Q])});var q=De.version,se=De.url||he(q);return new j.Promise(function(Ee,Q){var X=xe();if(X){var fe=X.getAttribute("src");fe!==se?Q(new Error("The ArcGIS API for JavaScript is already loaded (".concat(fe,")."))):ke()?Ee(X):Ke(X,Ee,Q)}else if(ke())Q(new Error("The ArcGIS API for JavaScript is already loaded."));else{var ue=De.css;ue&&te(!0===ue?q:ue,De.insertCssBefore),Ke(X=function Te(ae){var De=document.createElement("script");return De.type="text/javascript",De.src=ae,De.setAttribute("data-esri-loader","loading"),De}(se),function(){X.setAttribute("data-esri-loader","loaded"),Ee(X)},Q),document.body.appendChild(X)}})}function Ve(ae){return new j.Promise(function(De,q){var se=window.require.on("error",q);window.require(ae,function(){for(var Ee=[],Q=0;Q<arguments.length;Q++)Ee[Q]=arguments[Q];se.remove(),De(Ee)})})}M.utils=j,M.loadModules=function Ue(ae,De){if(void 0===De&&(De={}),ke())return Ve(ae);var q=xe(),se=q&&q.getAttribute("src");return!De.url&&se&&(De.url=se),Ne(De).then(function(){return Ve(ae)})},M.getScript=xe,M.isLoaded=ke,M.loadScript=Ne,M.setDefaultOptions=function ve(ae){void 0===ae&&(ae={}),Oe=ae},M.loadCss=te,Object.defineProperty(M,"__esModule",{value:!0})}(Pe)},6148:(ft,Pe,M)=>{"use strict";M.d(Pe,{IH:()=>Sr,Gb:()=>mr});var g=M(5861),j=M(9681),k=M(1877),oe=M(2090),me=M(4859);M(2833);const we="analytics",_e="firebase_id",H="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",te="https://www.googletagmanager.com/gtag/js",Oe=new k.Yd("@firebase/analytics");function Te(de){return Promise.all(de.map(U=>U.catch(L=>L)))}function Ke(de,U){const L=document.createElement("script");L.src=`${te}?l=${de}&id=${U}`,L.async=!0,document.head.appendChild(L)}function ve(de,U,L,F,ie,be){return xe.apply(this,arguments)}function xe(){return(xe=(0,g.Z)(function*(de,U,L,F,ie,be){const Ze=F[ie];try{if(Ze)yield U[Ze];else{const dt=(yield Te(L)).find(Rt=>Rt.measurementId===ie);dt&&(yield U[dt.appId])}}catch(ze){Oe.error(ze)}de("config",ie,be)})).apply(this,arguments)}function ke(de,U,L,F,ie){return Ne.apply(this,arguments)}function Ne(){return(Ne=(0,g.Z)(function*(de,U,L,F,ie){try{let be=[];if(ie&&ie.send_to){let Ze=ie.send_to;Array.isArray(Ze)||(Ze=[Ze]);const ze=yield Te(L);for(const dt of Ze){const Rt=ze.find(Ln=>Ln.measurementId===dt),cn=Rt&&U[Rt.appId];if(!cn){be=[];break}be.push(cn)}}0===be.length&&(be=Object.values(U)),yield Promise.all(be),de("event",F,ie||{})}catch(be){Oe.error(be)}})).apply(this,arguments)}function ae(){const de=window.document.getElementsByTagName("script");for(const U of Object.values(de))if(U.src&&U.src.includes(te))return U;return null}const q=new oe.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),X=new class Q{constructor(U={},L=1e3){this.throttleMetadata=U,this.intervalMillis=L}getThrottleMetadata(U){return this.throttleMetadata[U]}setThrottleMetadata(U,L){this.throttleMetadata[U]=L}deleteThrottleMetadata(U){delete this.throttleMetadata[U]}};function fe(de){return new Headers({Accept:"application/json","x-goog-api-key":de})}function ue(de){return $e.apply(this,arguments)}function $e(){return($e=(0,g.Z)(function*(de){var U;const{appId:L,apiKey:F}=de,ie={method:"GET",headers:fe(F)},be=H.replace("{app-id}",L),Ze=yield fetch(be,ie);if(200!==Ze.status&&304!==Ze.status){let ze="";try{const dt=yield Ze.json();null!==(U=dt.error)&&void 0!==U&&U.message&&(ze=dt.error.message)}catch{}throw q.create("config-fetch-failed",{httpStatus:Ze.status,responseMessage:ze})}return Ze.json()})).apply(this,arguments)}function He(de){return ut.apply(this,arguments)}function ut(){return(ut=(0,g.Z)(function*(de,U=X,L){const{appId:F,apiKey:ie,measurementId:be}=de.options;if(!F)throw q.create("no-app-id");if(!ie){if(be)return{measurementId:be,appId:F};throw q.create("no-api-key")}const Ze=U.getThrottleMetadata(F)||{backoffCount:0,throttleEndTimeMillis:Date.now()},ze=new xt;return setTimeout((0,g.Z)(function*(){ze.abort()}),void 0!==L?L:6e4),Zt({appId:F,apiKey:ie,measurementId:be},Ze,ze,U)})).apply(this,arguments)}function Zt(de,U,L){return rn.apply(this,arguments)}function rn(){return(rn=(0,g.Z)(function*(de,{throttleEndTimeMillis:U,backoffCount:L},F,ie=X){var be,Ze;const{appId:ze,measurementId:dt}=de;try{yield pt(F,U)}catch(Rt){if(dt)return Oe.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${dt} provided in the "measurementId" field in the local Firebase config. [${null===(be=Rt)||void 0===be?void 0:be.message}]`),{appId:ze,measurementId:dt};throw Rt}try{const Rt=yield ue(de);return ie.deleteThrottleMetadata(ze),Rt}catch(Rt){const cn=Rt;if(!Ut(cn)){if(ie.deleteThrottleMetadata(ze),dt)return Oe.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${dt} provided in the "measurementId" field in the local Firebase config. [${cn?.message}]`),{appId:ze,measurementId:dt};throw Rt}const Ln=503===Number(null===(Ze=cn?.customData)||void 0===Ze?void 0:Ze.httpStatus)?(0,oe.$s)(L,ie.intervalMillis,30):(0,oe.$s)(L,ie.intervalMillis),Tt={throttleEndTimeMillis:Date.now()+Ln,backoffCount:L+1};return ie.setThrottleMetadata(ze,Tt),Oe.debug(`Calling attemptFetch again in ${Ln} millis`),Zt(de,Tt,F,ie)}})).apply(this,arguments)}function pt(de,U){return new Promise((L,F)=>{const ie=Math.max(U-Date.now(),0),be=setTimeout(L,ie);de.addEventListener(()=>{clearTimeout(be),F(q.create("fetch-throttle",{throttleEndTimeMillis:U}))})})}function Ut(de){if(!(de instanceof oe.ZR&&de.customData))return!1;const U=Number(de.customData.httpStatus);return 429===U||500===U||503===U||504===U}class xt{constructor(){this.listeners=[]}addEventListener(U){this.listeners.push(U)}abort(){this.listeners.forEach(U=>U())}}let ln,Hn;function Vt(){return(Vt=(0,g.Z)(function*(de,U,L,F,ie){if(ie&&ie.global)de("event",L,F);else{const be=yield U;de("event",L,Object.assign(Object.assign({},F),{send_to:be}))}})).apply(this,arguments)}function Jn(de){Hn=de}function Dr(de){ln=de}function yn(){return bn.apply(this,arguments)}function bn(){return(bn=(0,g.Z)(function*(){var de;if(!(0,oe.hl)())return Oe.warn(q.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,oe.eu)()}catch(U){return Oe.warn(q.create("indexeddb-unavailable",{errorInfo:null===(de=U)||void 0===de?void 0:de.toString()}).message),!1}return!0})).apply(this,arguments)}function Pn(){return(Pn=(0,g.Z)(function*(de,U,L,F,ie,be,Ze){var ze;const dt=He(de);dt.then(wn=>{L[wn.measurementId]=wn.appId,de.options.measurementId&&wn.measurementId!==de.options.measurementId&&Oe.warn(`The measurement ID in the local Firebase config (${de.options.measurementId}) does not match the measurement ID fetched from the server (${wn.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(wn=>Oe.error(wn)),U.push(dt);const Rt=yn().then(wn=>{if(wn)return F.getId()}),[cn,Ln]=yield Promise.all([dt,Rt]);ae()||Ke(be,cn.measurementId),Hn&&(ie("consent","default",Hn),Jn(void 0)),ie("js",new Date);const Tt=null!==(ze=Ze?.config)&&void 0!==ze?ze:{};return Tt.origin="firebase",Tt.update=!0,null!=Ln&&(Tt[_e]=Ln),ie("config",cn.measurementId,Tt),ln&&(ie("set",ln),Dr(void 0)),cn.measurementId})).apply(this,arguments)}class ar{constructor(U){this.app=U}_delete(){return delete gn[this.app.options.appId],Promise.resolve()}}let gn={},Bn=[];const Tr={};let Dt,Yt,bt="dataLayer",on=!1;function On(de,U,L){!function ur(){const de=[];if((0,oe.ru)()&&de.push("This is a browser extension environment."),(0,oe.zI)()||de.push("Cookies are not available."),de.length>0){const U=de.map((F,ie)=>`(${ie+1}) ${F}`).join(" "),L=q.create("invalid-analytics-context",{errorInfo:U});Oe.warn(L.message)}}();const F=de.options.appId;if(!F)throw q.create("no-app-id");if(!de.options.apiKey){if(!de.options.measurementId)throw q.create("no-api-key");Oe.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${de.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=gn[F])throw q.create("already-exists",{id:F});if(!on){!function Xe(de){let U=[];Array.isArray(window[de])?U=window[de]:window[de]=U}(bt);const{wrappedGtag:be,gtagCore:Ze}=function Ue(de,U,L,F,ie){let be=function(...Ze){window[F].push(arguments)};return window[ie]&&"function"==typeof window[ie]&&(be=window[ie]),window[ie]=function Ve(de,U,L,F){function be(){return(be=(0,g.Z)(function*(Ze,ze,dt){try{"event"===Ze?yield ke(de,U,L,ze,dt):"config"===Ze?yield ve(de,U,L,F,ze,dt):"consent"===Ze?de("consent","update",dt):de("set",ze)}catch(Rt){Oe.error(Rt)}})).apply(this,arguments)}return function ie(Ze,ze,dt){return be.apply(this,arguments)}}(be,de,U,L),{gtagCore:be,wrappedGtag:window[ie]}}(gn,Bn,Tr,bt,"gtag");Yt=be,Dt=Ze,on=!0}return gn[F]=function rt(de,U,L,F,ie,be,Ze){return Pn.apply(this,arguments)}(de,Bn,Tr,U,Dt,bt,L),new ar(de)}function Sr(de=(0,j.getApp)()){de=(0,oe.m9)(de);const U=(0,j._getProvider)(de,we);return U.isInitialized()?U.getImmediate():function Pt(de,U={}){const L=(0,j._getProvider)(de,we);if(L.isInitialized()){const ie=L.getImmediate();if((0,oe.vZ)(U,L.getOptions()))return ie;throw q.create("already-initialized")}return L.initialize({options:U})}(de)}function mr(){return Nt.apply(this,arguments)}function Nt(){return(Nt=(0,g.Z)(function*(){if((0,oe.ru)()||!(0,oe.zI)()||!(0,oe.hl)())return!1;try{return yield(0,oe.eu)()}catch{return!1}})).apply(this,arguments)}const gt="@firebase/analytics";!function an(){(0,j._registerComponent)(new me.wA(we,(U,{options:L})=>On(U.getProvider("app").getImmediate(),U.getProvider("installations-internal").getImmediate(),L),"PUBLIC")),(0,j._registerComponent)(new me.wA("analytics-internal",function de(U){try{const L=U.getProvider(we).getImmediate();return{logEvent:(F,ie,be)=>function Me(de,U,L,F){de=(0,oe.m9)(de),function Wn(de,U,L,F,ie){return Vt.apply(this,arguments)}(Yt,gn[de.app.options.appId],U,L,F).catch(ie=>Oe.error(ie))}(L,F,ie,be)}}catch(L){throw q.create("interop-component-reg-failed",{reason:L})}},"PRIVATE")),(0,j.registerVersion)(gt,"0.8.0"),(0,j.registerVersion)(gt,"0.8.0","esm2017")}()},5867:(ft,Pe,M)=>{"use strict";M.d(Pe,{C6:()=>g.getApps,Mq:()=>g.getApp,ZF:()=>g.initializeApp});var g=M(9681);(0,g.registerVersion)("firebase","9.9.1","app")},127:(ft,Pe,M)=>{"use strict";M.d(Pe,{Z:()=>g.Z});var g=M(3942);g.Z.registerVersion("firebase","9.9.1","app-compat")},5881:(ft,Pe,M)=>{"use strict";M.r(Pe);var g=M(5861),j=M(3942),k=M(6457),oe=M(2090),we=(M(9681),M(1877),M(4859));function _e(){return window}function H(){return(H=(0,g.Z)(function*(U,L,F){var ie;const{BuildInfo:be}=_e();(0,k.aq)(L.sessionId,"AuthEvent did not contain a session ID");const Ze=yield xe(L.sessionId),ze={};return(0,k.ar)()?ze.ibi=be.packageName:(0,k.as)()?ze.apn=be.packageName:(0,k.at)(U,"operation-not-supported-in-this-environment"),be.displayName&&(ze.appDisplayName=be.displayName),ze.sessionId=Ze,(0,k.au)(U,F,L.type,void 0,null!==(ie=L.eventId)&&void 0!==ie?ie:void 0,ze)})).apply(this,arguments)}function Oe(){return(Oe=(0,g.Z)(function*(U){const{BuildInfo:L}=_e(),F={};(0,k.ar)()?F.iosBundleId=L.packageName:(0,k.as)()?F.androidPackageName=L.packageName:(0,k.at)(U,"operation-not-supported-in-this-environment"),yield(0,k.av)(U,F)})).apply(this,arguments)}function Xe(){return(Xe=(0,g.Z)(function*(U,L,F){const{cordova:ie}=_e();let be=()=>{};try{yield new Promise((Ze,ze)=>{let dt=null;function Rt(){var Tt;Ze();const wn=null===(Tt=ie.plugins.browsertab)||void 0===Tt?void 0:Tt.close;"function"==typeof wn&&wn(),"function"==typeof F?.close&&F.close()}function cn(){dt||(dt=window.setTimeout(()=>{ze((0,k.aw)(U,"redirect-cancelled-by-user"))},2e3))}function Ln(){"visible"===document?.visibilityState&&cn()}L.addPassiveListener(Rt),document.addEventListener("resume",cn,!1),(0,k.as)()&&document.addEventListener("visibilitychange",Ln,!1),be=()=>{L.removePassiveListener(Rt),document.removeEventListener("resume",cn,!1),document.removeEventListener("visibilitychange",Ln,!1),dt&&window.clearTimeout(dt)}})}finally{be()}})).apply(this,arguments)}function xe(U){return ke.apply(this,arguments)}function ke(){return(ke=(0,g.Z)(function*(U){const L=Ne(U),F=yield crypto.subtle.digest("SHA-256",L);return Array.from(new Uint8Array(F)).map(be=>be.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}function Ne(U){if((0,k.aq)(/[0-9a-zA-Z]+/.test(U),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(U);const L=new ArrayBuffer(U.length),F=new Uint8Array(L);for(let ie=0;ie<U.length;ie++)F[ie]=U.charCodeAt(ie);return F}class Ue extends k.aA{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(L=>{this.resolveInialized=L})}addPassiveListener(L){this.passiveListeners.add(L)}removePassiveListener(L){this.passiveListeners.delete(L)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(L){return this.resolveInialized(),this.passiveListeners.forEach(F=>F(L)),super.onEvent(L)}initialized(){var L=this;return(0,g.Z)(function*(){yield L.initPromise})()}}function q(U){return se.apply(this,arguments)}function se(){return(se=(0,g.Z)(function*(U){const L=yield X()._get(fe(U));return L&&(yield X()._remove(fe(U))),L})).apply(this,arguments)}function Q(){const U=[],L="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let F=0;F<20;F++){const ie=Math.floor(Math.random()*L.length);U.push(L.charAt(ie))}return U.join("")}function X(){return(0,k.ay)(k.b)}function fe(U){return(0,k.az)("authEvent",U.config.apiKey,U.name)}function He(U){if(!U?.includes("?"))return{};const[L,...F]=U.split("?");return(0,oe.zd)(F.join("?"))}const rn=class Zt{constructor(){this._redirectPersistence=k.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=k.aB,this._overrideRedirectResult=k.aC}_initialize(L){var F=this;return(0,g.Z)(function*(){const ie=L._key();let be=F.eventManagers.get(ie);return be||(be=new Ue(L),F.eventManagers.set(ie,be),F.attachCallbackListeners(L,be)),be})()}_openPopup(L){(0,k.at)(L,"operation-not-supported-in-this-environment")}_openRedirect(L,F,ie,be){var Ze=this;return(0,g.Z)(function*(){!function ve(U){var L,F,ie,be,Ze,ze,dt,Rt,cn,Ln;const Tt=_e();(0,k.ax)("function"==typeof(null===(L=Tt?.universalLinks)||void 0===L?void 0:L.subscribe),U,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,k.ax)(typeof(null===(F=Tt?.BuildInfo)||void 0===F?void 0:F.packageName)<"u",U,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,k.ax)("function"==typeof(null===(Ze=null===(be=null===(ie=Tt?.cordova)||void 0===ie?void 0:ie.plugins)||void 0===be?void 0:be.browsertab)||void 0===Ze?void 0:Ze.openUrl),U,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,k.ax)("function"==typeof(null===(Rt=null===(dt=null===(ze=Tt?.cordova)||void 0===ze?void 0:ze.plugins)||void 0===dt?void 0:dt.browsertab)||void 0===Rt?void 0:Rt.isAvailable),U,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,k.ax)("function"==typeof(null===(Ln=null===(cn=Tt?.cordova)||void 0===cn?void 0:cn.InAppBrowser)||void 0===Ln?void 0:Ln.open),U,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(L);const ze=yield Ze._initialize(L);yield ze.initialized(),ze.resetRedirect(),(0,k.aD)(),yield Ze._originValidation(L);const dt=function ae(U,L,F=null){return{type:L,eventId:F,urlResponse:null,sessionId:Q(),postBody:null,tenantId:U.tenantId,error:(0,k.aw)(U,"no-auth-event")}}(L,ie,be);yield function De(U,L){return X()._set(fe(U),L)}(L,dt);const Rt=yield function z(U,L,F){return H.apply(this,arguments)}(L,dt,F),cn=yield function Te(U){const{cordova:L}=_e();return new Promise(F=>{L.plugins.browsertab.isAvailable(ie=>{let be=null;ie?L.plugins.browsertab.openUrl(U):be=L.InAppBrowser.open(U,(0,k.ap)()?"_blank":"_system","location=yes"),F(be)})})}(Rt);return function Ke(U,L,F){return Xe.apply(this,arguments)}(L,ze,cn)})()}_isIframeWebStorageSupported(L,F){throw new Error("Method not implemented.")}_originValidation(L){const F=L._key();return this.originValidationPromises[F]||(this.originValidationPromises[F]=function te(U){return Oe.apply(this,arguments)}(L)),this.originValidationPromises[F]}attachCallbackListeners(L,F){const{universalLinks:ie,handleOpenURL:be,BuildInfo:Ze}=_e(),ze=setTimeout((0,g.Z)(function*(){yield q(L),F.onEvent(pt())}),500),dt=function(){var Ln=(0,g.Z)(function*(Tt){clearTimeout(ze);const wn=yield q(L);let js=null;wn&&Tt?.url&&(js=function Ee(U,L){var F,ie;const be=function $e(U){const L=He(U),F=L.link?decodeURIComponent(L.link):void 0,ie=He(F).link,be=L.deep_link_id?decodeURIComponent(L.deep_link_id):void 0;return He(be).link||be||ie||F||U}(L);if(be.includes("/__/auth/callback")){const Ze=He(be),ze=Ze.firebaseError?function ue(U){try{return JSON.parse(U)}catch{return null}}(decodeURIComponent(Ze.firebaseError)):null,dt=null===(ie=null===(F=ze?.code)||void 0===F?void 0:F.split("auth/"))||void 0===ie?void 0:ie[1],Rt=dt?(0,k.aw)(dt):null;return Rt?{type:U.type,eventId:U.eventId,tenantId:U.tenantId,error:Rt,urlResponse:null,sessionId:null,postBody:null}:{type:U.type,eventId:U.eventId,tenantId:U.tenantId,sessionId:U.sessionId,urlResponse:be,postBody:null}}return null}(wn,Tt.url)),F.onEvent(js||pt())});return function(wn){return Ln.apply(this,arguments)}}();typeof ie<"u"&&"function"==typeof ie.subscribe&&ie.subscribe(null,dt);const Rt=be,cn=`${Ze.packageName.toLowerCase()}://`;_e().handleOpenURL=function(){var Ln=(0,g.Z)(function*(Tt){if(Tt.toLowerCase().startsWith(cn)&&dt({url:Tt}),"function"==typeof Rt)try{Rt(Tt)}catch(wn){console.error(wn)}});return function(Tt){return Ln.apply(this,arguments)}}()}};function pt(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,k.aw)("no-auth-event")}}function Vt(){var U;return(null===(U=self?.location)||void 0===U?void 0:U.protocol)||null}function Nn(U=(0,oe.z$)()){return!("file:"!==Vt()&&"ionic:"!==Vt()&&"capacitor:"!==Vt()||!U.toLowerCase().match(/iphone|ipad|ipod|android/))}function zr(){try{const U=self.localStorage,L=k.aI();if(U)return U.setItem(L,"1"),U.removeItem(L),!function qn(U=(0,oe.z$)()){return function pr(){return(0,oe.w1)()&&11===document?.documentMode}()||function Tn(U=(0,oe.z$)()){return/Edge\/\d+/.test(U)}(U)}()||(0,oe.hl)()}catch{return gr()&&(0,oe.hl)()}return!1}function gr(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Hn(){return(function at(){return"http:"===Vt()||"https:"===Vt()}()||(0,oe.ru)()||Nn())&&!function Gr(){return(0,oe.b$)()||(0,oe.UG)()}()&&zr()&&!gr()}function Jn(){return Nn()&&typeof document<"u"}function yn(){return(yn=(0,g.Z)(function*(){return!!Jn()&&new Promise(U=>{const L=setTimeout(()=>{U(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(L),U(!0)})})})).apply(this,arguments)}const rt={LOCAL:"local",NONE:"none",SESSION:"session"},Pn=k.ax,ar="persistence";function Bn(U){return Tr.apply(this,arguments)}function Tr(){return(Tr=(0,g.Z)(function*(U){yield U._initializationPromise;const L=lt(),F=k.az(ar,U.config.apiKey,U.name);L&&L.setItem(F,U._getPersistence())})).apply(this,arguments)}function lt(){var U;try{return(null===(U=function bn(){return typeof window<"u"?window:null}())||void 0===U?void 0:U.sessionStorage)||null}catch{return null}}const Dt=k.ax;class Yt{constructor(){this.browserResolver=k.ay(k.k),this.cordovaResolver=k.ay(rn),this.underlyingResolver=null,this._redirectPersistence=k.a,this._completeRedirectFn=k.aB,this._overrideRedirectResult=k.aC}_initialize(L){var F=this;return(0,g.Z)(function*(){return yield F.selectUnderlyingResolver(),F.assertedUnderlyingResolver._initialize(L)})()}_openPopup(L,F,ie,be){var Ze=this;return(0,g.Z)(function*(){return yield Ze.selectUnderlyingResolver(),Ze.assertedUnderlyingResolver._openPopup(L,F,ie,be)})()}_openRedirect(L,F,ie,be){var Ze=this;return(0,g.Z)(function*(){return yield Ze.selectUnderlyingResolver(),Ze.assertedUnderlyingResolver._openRedirect(L,F,ie,be)})()}_isIframeWebStorageSupported(L,F){this.assertedUnderlyingResolver._isIframeWebStorageSupported(L,F)}_originValidation(L){return this.assertedUnderlyingResolver._originValidation(L)}get _shouldInitProactively(){return Jn()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return Dt(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var L=this;return(0,g.Z)(function*(){if(L.underlyingResolver)return;const F=yield function Dr(){return yn.apply(this,arguments)}();L.underlyingResolver=F?L.cordovaResolver:L.browserResolver})()}}function on(U){return U.unwrap()}function ur(U){return Sr(U)}function Sr(U){const{_tokenResponse:L}=U instanceof oe.ZR?U.customData:U;if(!L)return null;if(!(U instanceof oe.ZR)&&"temporaryProof"in L&&"phoneNumber"in L)return k.P.credentialFromResult(U);const F=L.providerId;if(!F||F===k.o.PASSWORD)return null;let ie;switch(F){case k.o.GOOGLE:ie=k.Q;break;case k.o.FACEBOOK:ie=k.N;break;case k.o.GITHUB:ie=k.T;break;case k.o.TWITTER:ie=k.W;break;default:const{oauthIdToken:be,oauthAccessToken:Ze,oauthTokenSecret:ze,pendingToken:dt,nonce:Rt}=L;return Ze||ze||be||dt?dt?F.startsWith("saml.")?k.aL._create(F,dt):k.J._fromParams({providerId:F,signInMethod:F,pendingToken:dt,idToken:be,accessToken:Ze}):new k.U(F).credential({idToken:be,accessToken:Ze,rawNonce:Rt}):null}return U instanceof oe.ZR?ie.credentialFromError(U):ie.credentialFromResult(U)}function Pt(U,L){return L.catch(F=>{throw F instanceof oe.ZR&&function On(U,L){var F,ie;const be=null===(F=L.customData)||void 0===F?void 0:F._tokenResponse;if("auth/multi-factor-auth-required"===(null===(ie=L)||void 0===ie?void 0:ie.code))L.resolver=new J(U,k.an(U,L));else if(be){const Ze=Sr(L),ze=L;Ze&&(ze.credential=Ze,ze.tenantId=be.tenantId||void 0,ze.email=be.email||void 0,ze.phoneNumber=be.phoneNumber||void 0)}}(U,F),F}).then(F=>{const be=F.user;return{operationType:F.operationType,credential:ur(F),additionalUserInfo:k.al(F),user:G.getOrCreate(be)}})}function mr(U,L){return Nt.apply(this,arguments)}function Nt(){return(Nt=(0,g.Z)(function*(U,L){const F=yield L;return{verificationId:F.verificationId,confirm:ie=>Pt(U,F.confirm(ie))}})).apply(this,arguments)}class J{constructor(L,F){this.resolver=F,this.auth=function Kn(U){return U.wrapped()}(L)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(L){return Pt(on(this.auth),this.resolver.resolveSignIn(L))}}class G{constructor(L){this._delegate=L,this.multiFactor=k.ao(L)}static getOrCreate(L){return G.USER_MAP.has(L)||G.USER_MAP.set(L,new G(L)),G.USER_MAP.get(L)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(L){return this._delegate.getIdTokenResult(L)}getIdToken(L){return this._delegate.getIdToken(L)}linkAndRetrieveDataWithCredential(L){return this.linkWithCredential(L)}linkWithCredential(L){var F=this;return(0,g.Z)(function*(){return Pt(F.auth,k.Z(F._delegate,L))})()}linkWithPhoneNumber(L,F){var ie=this;return(0,g.Z)(function*(){return mr(ie.auth,k.l(ie._delegate,L,F))})()}linkWithPopup(L){var F=this;return(0,g.Z)(function*(){return Pt(F.auth,k.d(F._delegate,L,Yt))})()}linkWithRedirect(L){var F=this;return(0,g.Z)(function*(){return yield Bn(k.aE(F.auth)),k.g(F._delegate,L,Yt)})()}reauthenticateAndRetrieveDataWithCredential(L){return this.reauthenticateWithCredential(L)}reauthenticateWithCredential(L){var F=this;return(0,g.Z)(function*(){return Pt(F.auth,k._(F._delegate,L))})()}reauthenticateWithPhoneNumber(L,F){return mr(this.auth,k.r(this._delegate,L,F))}reauthenticateWithPopup(L){return Pt(this.auth,k.e(this._delegate,L,Yt))}reauthenticateWithRedirect(L){var F=this;return(0,g.Z)(function*(){return yield Bn(k.aE(F.auth)),k.h(F._delegate,L,Yt)})()}sendEmailVerification(L){return k.ab(this._delegate,L)}unlink(L){var F=this;return(0,g.Z)(function*(){return yield k.ak(F._delegate,L),F})()}updateEmail(L){return k.ag(this._delegate,L)}updatePassword(L){return k.ah(this._delegate,L)}updatePhoneNumber(L){return k.u(this._delegate,L)}updateProfile(L){return k.af(this._delegate,L)}verifyBeforeUpdateEmail(L,F){return k.ac(this._delegate,L,F)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}G.USER_MAP=new WeakMap;const B=k.ax;let W=(()=>{class U{constructor(F,ie){if(this.app=F,ie.isInitialized())return this._delegate=ie.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:be}=F.options;B(be,"invalid-api-key",{appName:F.name}),B(be,"invalid-api-key",{appName:F.name});const Ze=typeof window<"u"?Yt:void 0;this._delegate=ie.initialize({options:{persistence:Me(be,F.name),popupRedirectResolver:Ze}}),this._delegate._updateErrorMap(k.B),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?G.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(F){this._delegate.languageCode=F}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(F){this._delegate.tenantId=F}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(F,ie){k.G(this._delegate,F,ie)}applyActionCode(F){return k.a2(this._delegate,F)}checkActionCode(F){return k.a3(this._delegate,F)}confirmPasswordReset(F,ie){return k.a1(this._delegate,F,ie)}createUserWithEmailAndPassword(F,ie){var be=this;return(0,g.Z)(function*(){return Pt(be._delegate,k.a5(be._delegate,F,ie))})()}fetchProvidersForEmail(F){return this.fetchSignInMethodsForEmail(F)}fetchSignInMethodsForEmail(F){return k.aa(this._delegate,F)}isSignInWithEmailLink(F){return k.a8(this._delegate,F)}getRedirectResult(){var F=this;return(0,g.Z)(function*(){B(Hn(),F._delegate,"operation-not-supported-in-this-environment");const ie=yield k.j(F._delegate,Yt);return ie?Pt(F._delegate,Promise.resolve(ie)):{credential:null,user:null}})()}addFrameworkForLogging(F){!function Ut(U,L){(0,k.aE)(U)._logFramework(L)}(this._delegate,F)}onAuthStateChanged(F,ie,be){const{next:Ze,error:ze,complete:dt}=K(F,ie,be);return this._delegate.onAuthStateChanged(Ze,ze,dt)}onIdTokenChanged(F,ie,be){const{next:Ze,error:ze,complete:dt}=K(F,ie,be);return this._delegate.onIdTokenChanged(Ze,ze,dt)}sendSignInLinkToEmail(F,ie){return k.a7(this._delegate,F,ie)}sendPasswordResetEmail(F,ie){return k.a0(this._delegate,F,ie||void 0)}setPersistence(F){var ie=this;return(0,g.Z)(function*(){let be;switch(function gn(U,L){Pn(Object.values(rt).includes(L),U,"invalid-persistence-type"),(0,oe.b$)()?Pn(L!==rt.SESSION,U,"unsupported-persistence-type"):(0,oe.UG)()?Pn(L===rt.NONE,U,"unsupported-persistence-type"):gr()?Pn(L===rt.NONE||L===rt.LOCAL&&(0,oe.hl)(),U,"unsupported-persistence-type"):Pn(L===rt.NONE||zr(),U,"unsupported-persistence-type")}(ie._delegate,F),F){case rt.SESSION:be=k.a;break;case rt.LOCAL:be=(yield k.ay(k.i)._isAvailable())?k.i:k.b;break;case rt.NONE:be=k.L;break;default:return k.at("argument-error",{appName:ie._delegate.name})}return ie._delegate.setPersistence(be)})()}signInAndRetrieveDataWithCredential(F){return this.signInWithCredential(F)}signInAnonymously(){return Pt(this._delegate,k.X(this._delegate))}signInWithCredential(F){return Pt(this._delegate,k.Y(this._delegate,F))}signInWithCustomToken(F){return Pt(this._delegate,k.$(this._delegate,F))}signInWithEmailAndPassword(F,ie){return Pt(this._delegate,k.a6(this._delegate,F,ie))}signInWithEmailLink(F,ie){return Pt(this._delegate,k.a9(this._delegate,F,ie))}signInWithPhoneNumber(F,ie){return mr(this._delegate,k.s(this._delegate,F,ie))}signInWithPopup(F){var ie=this;return(0,g.Z)(function*(){return B(Hn(),ie._delegate,"operation-not-supported-in-this-environment"),Pt(ie._delegate,k.c(ie._delegate,F,Yt))})()}signInWithRedirect(F){var ie=this;return(0,g.Z)(function*(){return B(Hn(),ie._delegate,"operation-not-supported-in-this-environment"),yield Bn(ie._delegate),k.f(ie._delegate,F,Yt)})()}updateCurrentUser(F){return this._delegate.updateCurrentUser(F)}verifyPasswordResetCode(F){return k.a4(this._delegate,F)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return U.Persistence=rt,U})();function K(U,L,F){let ie=U;"function"!=typeof U&&({next:ie,error:L,complete:F}=U);const be=ie;return{next:ze=>be(ze&&G.getOrCreate(ze)),error:L,complete:F}}function Me(U,L){const F=function bt(U,L){const F=lt();if(!F)return[];const ie=k.az(ar,U,L);switch(F.getItem(ie)){case rt.NONE:return[k.L];case rt.LOCAL:return[k.i,k.a];case rt.SESSION:return[k.a];default:return[]}}(U,L);if(typeof self<"u"&&!F.includes(k.i)&&F.push(k.i),typeof window<"u")for(const ie of[k.b,k.a])F.includes(ie)||F.push(ie);return F.includes(k.L)||F.push(k.L),F}class Qe{constructor(){this.providerId="phone",this._delegate=new k.P(on(j.Z.auth()))}static credential(L,F){return k.P.credential(L,F)}verifyPhoneNumber(L,F){return this._delegate.verifyPhoneNumber(L,F)}unwrap(){return this._delegate}}Qe.PHONE_SIGN_IN_METHOD=k.P.PHONE_SIGN_IN_METHOD,Qe.PROVIDER_ID=k.P.PROVIDER_ID;const gt=k.ax;class en{constructor(L,F,ie=j.Z.app()){var be;gt(null===(be=ie.options)||void 0===be?void 0:be.apiKey,"invalid-api-key",{appName:ie.name}),this._delegate=new k.R(L,F,ie.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function de(U){U.INTERNAL.registerComponent(new we.wA("auth-compat",L=>{const F=L.getProvider("app-compat").getImmediate(),ie=L.getProvider("auth");return new W(F,ie)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:k.A.EMAIL_SIGNIN,PASSWORD_RESET:k.A.PASSWORD_RESET,RECOVER_EMAIL:k.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:k.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:k.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:k.A.VERIFY_EMAIL}},EmailAuthProvider:k.M,FacebookAuthProvider:k.N,GithubAuthProvider:k.T,GoogleAuthProvider:k.Q,OAuthProvider:k.U,SAMLAuthProvider:k.V,PhoneAuthProvider:Qe,PhoneMultiFactorGenerator:k.m,RecaptchaVerifier:en,TwitterAuthProvider:k.W,Auth:W,AuthCredential:k.H,Error:oe.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),U.registerVersion("@firebase/auth-compat","0.2.18")}(j.Z)},9751:(ft,Pe,M)=>{"use strict";M.d(Pe,{y:()=>_e});var g=M(930),j=M(727),k=M(8822),oe=M(9635),me=M(2416),he=M(576),we=M(2806);let _e=(()=>{class te{constructor(Te){Te&&(this._subscribe=Te)}lift(Te){const Ke=new te;return Ke.source=this,Ke.operator=Te,Ke}subscribe(Te,Ke,Xe){const ve=function H(te){return te&&te instanceof g.Lv||function z(te){return te&&(0,he.m)(te.next)&&(0,he.m)(te.error)&&(0,he.m)(te.complete)}(te)&&(0,j.Nn)(te)}(Te)?Te:new g.Hp(Te,Ke,Xe);return(0,we.x)(()=>{const{operator:xe,source:ke}=this;ve.add(xe?xe.call(ve,ke):ke?this._subscribe(ve):this._trySubscribe(ve))}),ve}_trySubscribe(Te){try{return this._subscribe(Te)}catch(Ke){Te.error(Ke)}}forEach(Te,Ke){return new(Ke=ye(Ke))((Xe,ve)=>{const xe=new g.Hp({next:ke=>{try{Te(ke)}catch(Ne){ve(Ne),xe.unsubscribe()}},error:ve,complete:Xe});this.subscribe(xe)})}_subscribe(Te){var Ke;return null===(Ke=this.source)||void 0===Ke?void 0:Ke.subscribe(Te)}[k.L](){return this}pipe(...Te){return(0,oe.U)(Te)(this)}toPromise(Te){return new(Te=ye(Te))((Ke,Xe)=>{let ve;this.subscribe(xe=>ve=xe,xe=>Xe(xe),()=>Ke(ve))})}}return te.create=Oe=>new te(Oe),te})();function ye(te){var Oe;return null!==(Oe=te??me.v.Promise)&&void 0!==Oe?Oe:Promise}},7579:(ft,Pe,M)=>{"use strict";M.d(Pe,{x:()=>we});var g=M(9751),j=M(727);const oe=(0,M(3888).d)(ye=>function(){ye(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var me=M(8737),he=M(2806);let we=(()=>{class ye extends g.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(H){const te=new _e(this,this);return te.operator=H,te}_throwIfClosed(){if(this.closed)throw new oe}next(H){(0,he.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const te of this.currentObservers)te.next(H)}})}error(H){(0,he.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=H;const{observers:te}=this;for(;te.length;)te.shift().error(H)}})}complete(){(0,he.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:H}=this;for(;H.length;)H.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var H;return(null===(H=this.observers)||void 0===H?void 0:H.length)>0}_trySubscribe(H){return this._throwIfClosed(),super._trySubscribe(H)}_subscribe(H){return this._throwIfClosed(),this._checkFinalizedStatuses(H),this._innerSubscribe(H)}_innerSubscribe(H){const{hasError:te,isStopped:Oe,observers:Te}=this;return te||Oe?j.Lc:(this.currentObservers=null,Te.push(H),new j.w0(()=>{this.currentObservers=null,(0,me.P)(Te,H)}))}_checkFinalizedStatuses(H){const{hasError:te,thrownError:Oe,isStopped:Te}=this;te?H.error(Oe):Te&&H.complete()}asObservable(){const H=new g.y;return H.source=this,H}}return ye.create=(z,H)=>new _e(z,H),ye})();class _e extends we{constructor(z,H){super(),this.destination=z,this.source=H}next(z){var H,te;null===(te=null===(H=this.destination)||void 0===H?void 0:H.next)||void 0===te||te.call(H,z)}error(z){var H,te;null===(te=null===(H=this.destination)||void 0===H?void 0:H.error)||void 0===te||te.call(H,z)}complete(){var z,H;null===(H=null===(z=this.destination)||void 0===z?void 0:z.complete)||void 0===H||H.call(z)}_subscribe(z){var H,te;return null!==(te=null===(H=this.source)||void 0===H?void 0:H.subscribe(z))&&void 0!==te?te:j.Lc}}},930:(ft,Pe,M)=>{"use strict";M.d(Pe,{Hp:()=>Xe,Lv:()=>te});var g=M(576),j=M(727),k=M(2416),oe=M(7849),me=M(5032);const he=ye("C",void 0,void 0);function ye(Ve,Ue,ae){return{kind:Ve,value:Ue,error:ae}}var z=M(3410),H=M(2806);class te extends j.w0{constructor(Ue){super(),this.isStopped=!1,Ue?(this.destination=Ue,(0,j.Nn)(Ue)&&Ue.add(this)):this.destination=Ne}static create(Ue,ae,De){return new Xe(Ue,ae,De)}next(Ue){this.isStopped?ke(function _e(Ve){return ye("N",Ve,void 0)}(Ue),this):this._next(Ue)}error(Ue){this.isStopped?ke(function we(Ve){return ye("E",void 0,Ve)}(Ue),this):(this.isStopped=!0,this._error(Ue))}complete(){this.isStopped?ke(he,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Ue){this.destination.next(Ue)}_error(Ue){try{this.destination.error(Ue)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Oe=Function.prototype.bind;function Te(Ve,Ue){return Oe.call(Ve,Ue)}class Ke{constructor(Ue){this.partialObserver=Ue}next(Ue){const{partialObserver:ae}=this;if(ae.next)try{ae.next(Ue)}catch(De){ve(De)}}error(Ue){const{partialObserver:ae}=this;if(ae.error)try{ae.error(Ue)}catch(De){ve(De)}else ve(Ue)}complete(){const{partialObserver:Ue}=this;if(Ue.complete)try{Ue.complete()}catch(ae){ve(ae)}}}class Xe extends te{constructor(Ue,ae,De){let q;if(super(),(0,g.m)(Ue)||!Ue)q={next:Ue??void 0,error:ae??void 0,complete:De??void 0};else{let se;this&&k.v.useDeprecatedNextContext?(se=Object.create(Ue),se.unsubscribe=()=>this.unsubscribe(),q={next:Ue.next&&Te(Ue.next,se),error:Ue.error&&Te(Ue.error,se),complete:Ue.complete&&Te(Ue.complete,se)}):q=Ue}this.destination=new Ke(q)}}function ve(Ve){k.v.useDeprecatedSynchronousErrorHandling?(0,H.O)(Ve):(0,oe.h)(Ve)}function ke(Ve,Ue){const{onStoppedNotification:ae}=k.v;ae&&z.z.setTimeout(()=>ae(Ve,Ue))}const Ne={closed:!0,next:me.Z,error:function xe(Ve){throw Ve},complete:me.Z}},727:(ft,Pe,M)=>{"use strict";M.d(Pe,{Lc:()=>he,w0:()=>me,Nn:()=>we});var g=M(576);const k=(0,M(3888).d)(ye=>function(H){ye(this),this.message=H?`${H.length} errors occurred during unsubscription:\n${H.map((te,Oe)=>`${Oe+1}) ${te.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=H});var oe=M(8737);class me{constructor(z){this.initialTeardown=z,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let z;if(!this.closed){this.closed=!0;const{_parentage:H}=this;if(H)if(this._parentage=null,Array.isArray(H))for(const Te of H)Te.remove(this);else H.remove(this);const{initialTeardown:te}=this;if((0,g.m)(te))try{te()}catch(Te){z=Te instanceof k?Te.errors:[Te]}const{_finalizers:Oe}=this;if(Oe){this._finalizers=null;for(const Te of Oe)try{_e(Te)}catch(Ke){z=z??[],Ke instanceof k?z=[...z,...Ke.errors]:z.push(Ke)}}if(z)throw new k(z)}}add(z){var H;if(z&&z!==this)if(this.closed)_e(z);else{if(z instanceof me){if(z.closed||z._hasParent(this))return;z._addParent(this)}(this._finalizers=null!==(H=this._finalizers)&&void 0!==H?H:[]).push(z)}}_hasParent(z){const{_parentage:H}=this;return H===z||Array.isArray(H)&&H.includes(z)}_addParent(z){const{_parentage:H}=this;this._parentage=Array.isArray(H)?(H.push(z),H):H?[H,z]:z}_removeParent(z){const{_parentage:H}=this;H===z?this._parentage=null:Array.isArray(H)&&(0,oe.P)(H,z)}remove(z){const{_finalizers:H}=this;H&&(0,oe.P)(H,z),z instanceof me&&z._removeParent(this)}}me.EMPTY=(()=>{const ye=new me;return ye.closed=!0,ye})();const he=me.EMPTY;function we(ye){return ye instanceof me||ye&&"closed"in ye&&(0,g.m)(ye.remove)&&(0,g.m)(ye.add)&&(0,g.m)(ye.unsubscribe)}function _e(ye){(0,g.m)(ye)?ye():ye.unsubscribe()}},2416:(ft,Pe,M)=>{"use strict";M.d(Pe,{v:()=>g});const g={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(ft,Pe,M)=>{"use strict";M.d(Pe,{E:()=>j});const j=new(M(9751).y)(me=>me.complete())},8996:(ft,Pe,M)=>{"use strict";M.d(Pe,{D:()=>Ue});var g=M(8421),j=M(5363),k=M(9468),he=M(9751),_e=M(2202),ye=M(576),z=M(9672);function te(ae,De){if(!ae)throw new Error("Iterable cannot be null");return new he.y(q=>{(0,z.f)(q,De,()=>{const se=ae[Symbol.asyncIterator]();(0,z.f)(q,De,()=>{se.next().then(Ee=>{Ee.done?q.complete():q.next(Ee.value)})},0,!0)})})}var Oe=M(3670),Te=M(8239),Ke=M(1144),Xe=M(6495),ve=M(2206),xe=M(4532),ke=M(3260);function Ue(ae,De){return De?function Ve(ae,De){if(null!=ae){if((0,Oe.c)(ae))return function oe(ae,De){return(0,g.Xf)(ae).pipe((0,k.R)(De),(0,j.Q)(De))}(ae,De);if((0,Ke.z)(ae))return function we(ae,De){return new he.y(q=>{let se=0;return De.schedule(function(){se===ae.length?q.complete():(q.next(ae[se++]),q.closed||this.schedule())})})}(ae,De);if((0,Te.t)(ae))return function me(ae,De){return(0,g.Xf)(ae).pipe((0,k.R)(De),(0,j.Q)(De))}(ae,De);if((0,ve.D)(ae))return te(ae,De);if((0,Xe.T)(ae))return function H(ae,De){return new he.y(q=>{let se;return(0,z.f)(q,De,()=>{se=ae[_e.h](),(0,z.f)(q,De,()=>{let Ee,Q;try{({value:Ee,done:Q}=se.next())}catch(X){return void q.error(X)}Q?q.complete():q.next(Ee)},0,!0)}),()=>(0,ye.m)(se?.return)&&se.return()})}(ae,De);if((0,ke.L)(ae))return function Ne(ae,De){return te((0,ke.Q)(ae),De)}(ae,De)}throw(0,xe.z)(ae)}(ae,De):(0,g.Xf)(ae)}},8421:(ft,Pe,M)=>{"use strict";M.d(Pe,{Xf:()=>Oe});var g=M(655),j=M(1144),k=M(8239),oe=M(9751),me=M(3670),he=M(2206),we=M(4532),_e=M(6495),ye=M(3260),z=M(576),H=M(7849),te=M(8822);function Oe(Ve){if(Ve instanceof oe.y)return Ve;if(null!=Ve){if((0,me.c)(Ve))return function Te(Ve){return new oe.y(Ue=>{const ae=Ve[te.L]();if((0,z.m)(ae.subscribe))return ae.subscribe(Ue);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Ve);if((0,j.z)(Ve))return function Ke(Ve){return new oe.y(Ue=>{for(let ae=0;ae<Ve.length&&!Ue.closed;ae++)Ue.next(Ve[ae]);Ue.complete()})}(Ve);if((0,k.t)(Ve))return function Xe(Ve){return new oe.y(Ue=>{Ve.then(ae=>{Ue.closed||(Ue.next(ae),Ue.complete())},ae=>Ue.error(ae)).then(null,H.h)})}(Ve);if((0,he.D)(Ve))return xe(Ve);if((0,_e.T)(Ve))return function ve(Ve){return new oe.y(Ue=>{for(const ae of Ve)if(Ue.next(ae),Ue.closed)return;Ue.complete()})}(Ve);if((0,ye.L)(Ve))return function ke(Ve){return xe((0,ye.Q)(Ve))}(Ve)}throw(0,we.z)(Ve)}function xe(Ve){return new oe.y(Ue=>{(function Ne(Ve,Ue){var ae,De,q,se;return(0,g.mG)(this,void 0,void 0,function*(){try{for(ae=(0,g.KL)(Ve);!(De=yield ae.next()).done;)if(Ue.next(De.value),Ue.closed)return}catch(Ee){q={error:Ee}}finally{try{De&&!De.done&&(se=ae.return)&&(yield se.call(ae))}finally{if(q)throw q.error}}Ue.complete()})})(Ve,Ue).catch(ae=>Ue.error(ae))})}},6451:(ft,Pe,M)=>{"use strict";M.d(Pe,{T:()=>he});var g=M(8189),j=M(8421),k=M(515),oe=M(7669),me=M(8996);function he(...we){const _e=(0,oe.yG)(we),ye=(0,oe._6)(we,1/0),z=we;return z.length?1===z.length?(0,j.Xf)(z[0]):(0,g.J)(ye)((0,me.D)(z,_e)):k.E}},5403:(ft,Pe,M)=>{"use strict";M.d(Pe,{x:()=>j});var g=M(930);function j(oe,me,he,we,_e){return new k(oe,me,he,we,_e)}class k extends g.Lv{constructor(me,he,we,_e,ye,z){super(me),this.onFinalize=ye,this.shouldUnsubscribe=z,this._next=he?function(H){try{he(H)}catch(te){me.error(te)}}:super._next,this._error=_e?function(H){try{_e(H)}catch(te){me.error(te)}finally{this.unsubscribe()}}:super._error,this._complete=we?function(){try{we()}catch(H){me.error(H)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var me;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:he}=this;super.unsubscribe(),!he&&(null===(me=this.onFinalize)||void 0===me||me.call(this))}}}},4004:(ft,Pe,M)=>{"use strict";M.d(Pe,{U:()=>k});var g=M(4482),j=M(5403);function k(oe,me){return(0,g.e)((he,we)=>{let _e=0;he.subscribe((0,j.x)(we,ye=>{we.next(oe.call(me,ye,_e++))}))})}},8189:(ft,Pe,M)=>{"use strict";M.d(Pe,{J:()=>k});var g=M(5577),j=M(4671);function k(oe=1/0){return(0,g.z)(j.y,oe)}},5577:(ft,Pe,M)=>{"use strict";M.d(Pe,{z:()=>_e});var g=M(4004),j=M(8421),k=M(4482),oe=M(9672),me=M(5403),we=M(576);function _e(ye,z,H=1/0){return(0,we.m)(z)?_e((te,Oe)=>(0,g.U)((Te,Ke)=>z(te,Te,Oe,Ke))((0,j.Xf)(ye(te,Oe))),H):("number"==typeof z&&(H=z),(0,k.e)((te,Oe)=>function he(ye,z,H,te,Oe,Te,Ke,Xe){const ve=[];let xe=0,ke=0,Ne=!1;const Ve=()=>{Ne&&!ve.length&&!xe&&z.complete()},Ue=De=>xe<te?ae(De):ve.push(De),ae=De=>{Te&&z.next(De),xe++;let q=!1;(0,j.Xf)(H(De,ke++)).subscribe((0,me.x)(z,se=>{Oe?.(se),Te?Ue(se):z.next(se)},()=>{q=!0},void 0,()=>{if(q)try{for(xe--;ve.length&&xe<te;){const se=ve.shift();Ke?(0,oe.f)(z,Ke,()=>ae(se)):ae(se)}Ve()}catch(se){z.error(se)}}))};return ye.subscribe((0,me.x)(z,Ue,()=>{Ne=!0,Ve()})),()=>{Xe?.()}}(te,Oe,ye,H)))}},5363:(ft,Pe,M)=>{"use strict";M.d(Pe,{Q:()=>oe});var g=M(9672),j=M(4482),k=M(5403);function oe(me,he=0){return(0,j.e)((we,_e)=>{we.subscribe((0,k.x)(_e,ye=>(0,g.f)(_e,me,()=>_e.next(ye),he),()=>(0,g.f)(_e,me,()=>_e.complete(),he),ye=>(0,g.f)(_e,me,()=>_e.error(ye),he)))})}},3099:(ft,Pe,M)=>{"use strict";M.d(Pe,{B:()=>me});var g=M(8421),j=M(7579),k=M(930),oe=M(4482);function me(we={}){const{connector:_e=(()=>new j.x),resetOnError:ye=!0,resetOnComplete:z=!0,resetOnRefCountZero:H=!0}=we;return te=>{let Oe,Te,Ke,Xe=0,ve=!1,xe=!1;const ke=()=>{Te?.unsubscribe(),Te=void 0},Ne=()=>{ke(),Oe=Ke=void 0,ve=xe=!1},Ve=()=>{const Ue=Oe;Ne(),Ue?.unsubscribe()};return(0,oe.e)((Ue,ae)=>{Xe++,!xe&&!ve&&ke();const De=Ke=Ke??_e();ae.add(()=>{Xe--,0===Xe&&!xe&&!ve&&(Te=he(Ve,H))}),De.subscribe(ae),!Oe&&Xe>0&&(Oe=new k.Hp({next:q=>De.next(q),error:q=>{xe=!0,ke(),Te=he(Ne,ye,q),De.error(q)},complete:()=>{ve=!0,ke(),Te=he(Ne,z),De.complete()}}),(0,g.Xf)(Ue).subscribe(Oe))})(te)}}function he(we,_e,...ye){if(!0===_e)return void we();if(!1===_e)return;const z=new k.Hp({next:()=>{z.unsubscribe(),we()}});return _e(...ye).subscribe(z)}},9468:(ft,Pe,M)=>{"use strict";M.d(Pe,{R:()=>j});var g=M(4482);function j(k,oe=0){return(0,g.e)((me,he)=>{he.add(k.schedule(()=>me.subscribe(he),oe))})}},8505:(ft,Pe,M)=>{"use strict";M.d(Pe,{b:()=>me});var g=M(576),j=M(4482),k=M(5403),oe=M(4671);function me(he,we,_e){const ye=(0,g.m)(he)||we||_e?{next:he,error:we,complete:_e}:he;return ye?(0,j.e)((z,H)=>{var te;null===(te=ye.subscribe)||void 0===te||te.call(ye);let Oe=!0;z.subscribe((0,k.x)(H,Te=>{var Ke;null===(Ke=ye.next)||void 0===Ke||Ke.call(ye,Te),H.next(Te)},()=>{var Te;Oe=!1,null===(Te=ye.complete)||void 0===Te||Te.call(ye),H.complete()},Te=>{var Ke;Oe=!1,null===(Ke=ye.error)||void 0===Ke||Ke.call(ye,Te),H.error(Te)},()=>{var Te,Ke;Oe&&(null===(Te=ye.unsubscribe)||void 0===Te||Te.call(ye)),null===(Ke=ye.finalize)||void 0===Ke||Ke.call(ye)}))}):oe.y}},4408:(ft,Pe,M)=>{"use strict";M.d(Pe,{o:()=>me});var g=M(727);class j extends g.w0{constructor(we,_e){super()}schedule(we,_e=0){return this}}const k={setInterval(he,we,..._e){const{delegate:ye}=k;return ye?.setInterval?ye.setInterval(he,we,..._e):setInterval(he,we,..._e)},clearInterval(he){const{delegate:we}=k;return(we?.clearInterval||clearInterval)(he)},delegate:void 0};var oe=M(8737);class me extends j{constructor(we,_e){super(we,_e),this.scheduler=we,this.work=_e,this.pending=!1}schedule(we,_e=0){var ye;if(this.closed)return this;this.state=we;const z=this.id,H=this.scheduler;return null!=z&&(this.id=this.recycleAsyncId(H,z,_e)),this.pending=!0,this.delay=_e,this.id=null!==(ye=this.id)&&void 0!==ye?ye:this.requestAsyncId(H,this.id,_e),this}requestAsyncId(we,_e,ye=0){return k.setInterval(we.flush.bind(we,this),ye)}recycleAsyncId(we,_e,ye=0){if(null!=ye&&this.delay===ye&&!1===this.pending)return _e;null!=_e&&k.clearInterval(_e)}execute(we,_e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const ye=this._execute(we,_e);if(ye)return ye;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(we,_e){let z,ye=!1;try{this.work(we)}catch(H){ye=!0,z=H||new Error("Scheduled action threw falsy error")}if(ye)return this.unsubscribe(),z}unsubscribe(){if(!this.closed){const{id:we,scheduler:_e}=this,{actions:ye}=_e;this.work=this.state=this.scheduler=null,this.pending=!1,(0,oe.P)(ye,this),null!=we&&(this.id=this.recycleAsyncId(_e,we,null)),this.delay=null,super.unsubscribe()}}}},7565:(ft,Pe,M)=>{"use strict";M.d(Pe,{v:()=>k});var g=M(6063);class j{constructor(me,he=j.now){this.schedulerActionCtor=me,this.now=he}schedule(me,he=0,we){return new this.schedulerActionCtor(this,me).schedule(we,he)}}j.now=g.l.now;class k extends j{constructor(me,he=j.now){super(me,he),this.actions=[],this._active=!1}flush(me){const{actions:he}=this;if(this._active)return void he.push(me);let we;this._active=!0;do{if(we=me.execute(me.state,me.delay))break}while(me=he.shift());if(this._active=!1,we){for(;me=he.shift();)me.unsubscribe();throw we}}}},4986:(ft,Pe,M)=>{"use strict";M.d(Pe,{z:()=>k});var g=M(4408);const k=new(M(7565).v)(g.o)},6063:(ft,Pe,M)=>{"use strict";M.d(Pe,{l:()=>g});const g={now:()=>(g.delegate||Date).now(),delegate:void 0}},3410:(ft,Pe,M)=>{"use strict";M.d(Pe,{z:()=>g});const g={setTimeout(j,k,...oe){const{delegate:me}=g;return me?.setTimeout?me.setTimeout(j,k,...oe):setTimeout(j,k,...oe)},clearTimeout(j){const{delegate:k}=g;return(k?.clearTimeout||clearTimeout)(j)},delegate:void 0}},2202:(ft,Pe,M)=>{"use strict";M.d(Pe,{h:()=>j});const j=function g(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(ft,Pe,M)=>{"use strict";M.d(Pe,{L:()=>g});const g="function"==typeof Symbol&&Symbol.observable||"@@observable"},7669:(ft,Pe,M)=>{"use strict";M.d(Pe,{_6:()=>he,jO:()=>oe,yG:()=>me});var g=M(576);function k(we){return we[we.length-1]}function oe(we){return(0,g.m)(k(we))?we.pop():void 0}function me(we){return function j(we){return we&&(0,g.m)(we.schedule)}(k(we))?we.pop():void 0}function he(we,_e){return"number"==typeof k(we)?we.pop():_e}},8737:(ft,Pe,M)=>{"use strict";function g(j,k){if(j){const oe=j.indexOf(k);0<=oe&&j.splice(oe,1)}}M.d(Pe,{P:()=>g})},3888:(ft,Pe,M)=>{"use strict";function g(j){const oe=j(me=>{Error.call(me),me.stack=(new Error).stack});return oe.prototype=Object.create(Error.prototype),oe.prototype.constructor=oe,oe}M.d(Pe,{d:()=>g})},2806:(ft,Pe,M)=>{"use strict";M.d(Pe,{O:()=>oe,x:()=>k});var g=M(2416);let j=null;function k(me){if(g.v.useDeprecatedSynchronousErrorHandling){const he=!j;if(he&&(j={errorThrown:!1,error:null}),me(),he){const{errorThrown:we,error:_e}=j;if(j=null,we)throw _e}}else me()}function oe(me){g.v.useDeprecatedSynchronousErrorHandling&&j&&(j.errorThrown=!0,j.error=me)}},9672:(ft,Pe,M)=>{"use strict";function g(j,k,oe,me=0,he=!1){const we=k.schedule(function(){oe(),he?j.add(this.schedule(null,me)):this.unsubscribe()},me);if(j.add(we),!he)return we}M.d(Pe,{f:()=>g})},4671:(ft,Pe,M)=>{"use strict";function g(j){return j}M.d(Pe,{y:()=>g})},1144:(ft,Pe,M)=>{"use strict";M.d(Pe,{z:()=>g});const g=j=>j&&"number"==typeof j.length&&"function"!=typeof j},2206:(ft,Pe,M)=>{"use strict";M.d(Pe,{D:()=>j});var g=M(576);function j(k){return Symbol.asyncIterator&&(0,g.m)(k?.[Symbol.asyncIterator])}},576:(ft,Pe,M)=>{"use strict";function g(j){return"function"==typeof j}M.d(Pe,{m:()=>g})},3670:(ft,Pe,M)=>{"use strict";M.d(Pe,{c:()=>k});var g=M(8822),j=M(576);function k(oe){return(0,j.m)(oe[g.L])}},6495:(ft,Pe,M)=>{"use strict";M.d(Pe,{T:()=>k});var g=M(2202),j=M(576);function k(oe){return(0,j.m)(oe?.[g.h])}},8239:(ft,Pe,M)=>{"use strict";M.d(Pe,{t:()=>j});var g=M(576);function j(k){return(0,g.m)(k?.then)}},3260:(ft,Pe,M)=>{"use strict";M.d(Pe,{L:()=>oe,Q:()=>k});var g=M(655),j=M(576);function k(me){return(0,g.FC)(this,arguments,function*(){const we=me.getReader();try{for(;;){const{value:_e,done:ye}=yield(0,g.qq)(we.read());if(ye)return yield(0,g.qq)(void 0);yield yield(0,g.qq)(_e)}}finally{we.releaseLock()}})}function oe(me){return(0,j.m)(me?.getReader)}},4482:(ft,Pe,M)=>{"use strict";M.d(Pe,{A:()=>j,e:()=>k});var g=M(576);function j(oe){return(0,g.m)(oe?.lift)}function k(oe){return me=>{if(j(me))return me.lift(function(he){try{return oe(he,this)}catch(we){this.error(we)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(ft,Pe,M)=>{"use strict";function g(){}M.d(Pe,{Z:()=>g})},9635:(ft,Pe,M)=>{"use strict";M.d(Pe,{U:()=>k,z:()=>j});var g=M(4671);function j(...oe){return k(oe)}function k(oe){return 0===oe.length?g.y:1===oe.length?oe[0]:function(he){return oe.reduce((we,_e)=>_e(we),he)}}},7849:(ft,Pe,M)=>{"use strict";M.d(Pe,{h:()=>k});var g=M(2416),j=M(3410);function k(oe){j.z.setTimeout(()=>{const{onUnhandledError:me}=g.v;if(!me)throw oe;me(oe)})}},4532:(ft,Pe,M)=>{"use strict";function g(j){return new TypeError(`You provided ${null!==j&&"object"==typeof j?"an invalid object":`'${j}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}M.d(Pe,{z:()=>g})},655:(ft,Pe,M)=>{"use strict";function oe(Q,X){var fe={};for(var ue in Q)Object.prototype.hasOwnProperty.call(Q,ue)&&X.indexOf(ue)<0&&(fe[ue]=Q[ue]);if(null!=Q&&"function"==typeof Object.getOwnPropertySymbols){var $e=0;for(ue=Object.getOwnPropertySymbols(Q);$e<ue.length;$e++)X.indexOf(ue[$e])<0&&Object.prototype.propertyIsEnumerable.call(Q,ue[$e])&&(fe[ue[$e]]=Q[ue[$e]])}return fe}function _e(Q,X,fe,ue){return new(fe||(fe=Promise))(function(He,ut){function Zt(Ut){try{pt(ue.next(Ut))}catch(xt){ut(xt)}}function rn(Ut){try{pt(ue.throw(Ut))}catch(xt){ut(xt)}}function pt(Ut){Ut.done?He(Ut.value):function $e(He){return He instanceof fe?He:new fe(function(ut){ut(He)})}(Ut.value).then(Zt,rn)}pt((ue=ue.apply(Q,X||[])).next())})}function ve(Q){return this instanceof ve?(this.v=Q,this):new ve(Q)}function xe(Q,X,fe){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var $e,ue=fe.apply(Q,X||[]),He=[];return $e={},ut("next"),ut("throw"),ut("return"),$e[Symbol.asyncIterator]=function(){return this},$e;function ut(ln){ue[ln]&&($e[ln]=function(Wn){return new Promise(function(Vt,at){He.push([ln,Wn,Vt,at])>1||Zt(ln,Wn)})})}function Zt(ln,Wn){try{!function rn(ln){ln.value instanceof ve?Promise.resolve(ln.value.v).then(pt,Ut):xt(He[0][2],ln)}(ue[ln](Wn))}catch(Vt){xt(He[0][3],Vt)}}function pt(ln){Zt("next",ln)}function Ut(ln){Zt("throw",ln)}function xt(ln,Wn){ln(Wn),He.shift(),He.length&&Zt(He[0][0],He[0][1])}}function Ne(Q){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var fe,X=Q[Symbol.asyncIterator];return X?X.call(Q):(Q=function te(Q){var X="function"==typeof Symbol&&Symbol.iterator,fe=X&&Q[X],ue=0;if(fe)return fe.call(Q);if(Q&&"number"==typeof Q.length)return{next:function(){return Q&&ue>=Q.length&&(Q=void 0),{value:Q&&Q[ue++],done:!Q}}};throw new TypeError(X?"Object is not iterable.":"Symbol.iterator is not defined.")}(Q),fe={},ue("next"),ue("throw"),ue("return"),fe[Symbol.asyncIterator]=function(){return this},fe);function ue(He){fe[He]=Q[He]&&function(ut){return new Promise(function(Zt,rn){!function $e(He,ut,Zt,rn){Promise.resolve(rn).then(function(pt){He({value:pt,done:Zt})},ut)}(Zt,rn,(ut=Q[He](ut)).done,ut.value)})}}}M.d(Pe,{FC:()=>xe,KL:()=>Ne,_T:()=>oe,mG:()=>_e,qq:()=>ve})},4650:(ft,Pe,M)=>{"use strict";M.d(Pe,{$8M:()=>Bp,$Z:()=>wT,AFp:()=>s0,AaK:()=>_e,CHM:()=>i_,CRH:()=>Jt,CZH:()=>gm,CqO:()=>nd,D6c:()=>Am,EJc:()=>_m,EpF:()=>rv,F4k:()=>ZE,FYo:()=>cE,FiY:()=>Hi,Gf:()=>db,GfV:()=>hE,JOm:()=>Ei,KtG:()=>s_,LFG:()=>B,LSH:()=>rg,Lbi:()=>a0,Lck:()=>VI,MAs:()=>kg,MMx:()=>om,NdJ:()=>Lg,OlP:()=>Rn,Oqu:()=>vf,P3R:()=>rE,PXZ:()=>bm,Q6J:()=>rf,QGY:()=>Og,QP$:()=>Wr,Qsj:()=>WD,R0b:()=>ps,RDi:()=>CD,Rgc:()=>ba,SBq:()=>Bh,Sil:()=>Tb,Suo:()=>hb,TTD:()=>Wo,TgZ:()=>du,X6Q:()=>RS,XFs:()=>rt,Xpm:()=>Es,Xts:()=>ty,Y36:()=>Gc,YKP:()=>Uv,YNc:()=>Jy,Yjl:()=>Cn,Yz7:()=>at,Z0I:()=>Tn,ZZ4:()=>Sm,_UZ:()=>ev,_Vd:()=>jc,_c5:()=>Yb,_uU:()=>_v,aQg:()=>w0,c2e:()=>Db,cJS:()=>Gr,cg1:()=>If,dDg:()=>wm,dqk:()=>bt,eFA:()=>Au,eoX:()=>Mb,f3M:()=>K,g9A:()=>ti,h0i:()=>wa,hGG:()=>I0,iGM:()=>Id,ifc:()=>be,ip1:()=>r0,jDz:()=>jI,kL8:()=>Lt,lG2:()=>Ct,lqb:()=>pl,lri:()=>xb,n5z:()=>uh,oAB:()=>re,q4F:()=>fE,qLn:()=>jh,qZA:()=>af,rWj:()=>vm,s9C:()=>Ug,sBO:()=>Bb,sIi:()=>Jh,s_b:()=>Lf,soG:()=>Wf,tb:()=>mm,tp0:()=>Xu,uIk:()=>Pg,vHH:()=>ve,vpe:()=>fs,wAp:()=>ne,xp6:()=>_y,z2F:()=>zl,zSh:()=>ry,zs3:()=>ml});var g=M(7579),j=M(727),k=M(9751),oe=M(6451),me=M(3099);function he(s){for(let o in s)if(s[o]===he)return o;throw Error("Could not find renamed property on target object.")}function _e(s){if("string"==typeof s)return s;if(Array.isArray(s))return"["+s.map(_e).join(", ")+"]";if(null==s)return""+s;if(s.overriddenName)return`${s.overriddenName}`;if(s.name)return`${s.name}`;const o=s.toString();if(null==o)return""+o;const u=o.indexOf("\n");return-1===u?o:o.substring(0,u)}function ye(s,o){return null==s||""===s?null===o?"":o:null==o||""===o?s:s+" "+o}const z=he({__forward_ref__:he});function H(s){return s.__forward_ref__=H,s.toString=function(){return _e(this())},s}function te(s){return Oe(s)?s():s}function Oe(s){return"function"==typeof s&&s.hasOwnProperty(z)&&s.__forward_ref__===H}function Te(s){return s&&!!s.\u0275providers}const Xe="https://g.co/ng/security#xss";class ve extends Error{constructor(o,u){super(function xe(s,o){return`NG0${Math.abs(s)}${o?": "+o.trim():""}`}(o,u)),this.code=o}}function ke(s){return"string"==typeof s?s:null==s?"":String(s)}function De(s,o){throw new ve(-201,!1)}function Ut(s,o){null==s&&function xt(s,o,u,c){throw new Error(`ASSERTION ERROR: ${s}`+(null==c?"":` [Expected=> ${u} ${c} ${o} <=Actual]`))}(o,s,null,"!=")}function at(s){return{token:s.token,providedIn:s.providedIn||null,factory:s.factory,value:void 0}}function Gr(s){return{providers:s.providers||[],imports:s.imports||[]}}function pr(s){return qn(s,Jn)||qn(s,yn)}function Tn(s){return null!==pr(s)}function qn(s,o){return s.hasOwnProperty(o)?s[o]:null}function Hn(s){return s&&(s.hasOwnProperty(Dr)||s.hasOwnProperty(bn))?s[Dr]:null}const Jn=he({\u0275prov:he}),Dr=he({\u0275inj:he}),yn=he({ngInjectableDef:he}),bn=he({ngInjectorDef:he});var rt=(()=>((rt=rt||{})[rt.Default=0]="Default",rt[rt.Host=1]="Host",rt[rt.Self=2]="Self",rt[rt.SkipSelf=4]="SkipSelf",rt[rt.Optional=8]="Optional",rt))();let Pn;function gn(s){const o=Pn;return Pn=s,o}function Bn(s,o,u){const c=pr(s);return c&&"root"==c.providedIn?void 0===c.value?c.value=c.factory():c.value:u&rt.Optional?null:void 0!==o?o:void De(_e(s))}const bt=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),on={},Kn="__NG_DI_FLAG__",ur="ngTempTokenPath",Sr=/\n/gm,mr="__source";let Nt;function J(s){const o=Nt;return Nt=s,o}function G(s,o=rt.Default){if(void 0===Nt)throw new ve(-203,!1);return null===Nt?Bn(s,void 0,o):Nt.get(s,o&rt.Optional?null:void 0,o)}function B(s,o=rt.Default){return(function ar(){return Pn}()||G)(te(s),o)}function K(s,o=rt.Default){return B(s,Me(o))}function Me(s){return typeof s>"u"||"number"==typeof s?s:0|(s.optional&&8)|(s.host&&1)|(s.self&&2)|(s.skipSelf&&4)}function Qe(s){const o=[];for(let u=0;u<s.length;u++){const c=te(s[u]);if(Array.isArray(c)){if(0===c.length)throw new ve(900,!1);let d,f=rt.Default;for(let y=0;y<c.length;y++){const E=c[y],b=en(E);"number"==typeof b?-1===b?d=E.token:f|=b:d=E}o.push(B(d,f))}else o.push(B(c))}return o}function gt(s,o){return s[Kn]=o,s.prototype[Kn]=o,s}function en(s){return s[Kn]}function U(s){return{toString:s}.toString()}var L=(()=>((L=L||{})[L.OnPush=0]="OnPush",L[L.Default=1]="Default",L))(),be=(()=>{return(s=be||(be={}))[s.Emulated=0]="Emulated",s[s.None=2]="None",s[s.ShadowDom=3]="ShadowDom",be;var s})();const Ze={},ze=[],dt=he({\u0275cmp:he}),Rt=he({\u0275dir:he}),cn=he({\u0275pipe:he}),Ln=he({\u0275mod:he}),Tt=he({\u0275fac:he}),wn=he({__NG_ELEMENT_ID__:he});let js=0;function Es(s){return U(()=>{const u=!0===s.standalone,c={},d={type:s.type,providersResolver:null,decls:s.decls,vars:s.vars,factory:null,template:s.template||null,consts:s.consts||null,ngContentSelectors:s.ngContentSelectors,hostBindings:s.hostBindings||null,hostVars:s.hostVars||0,hostAttrs:s.hostAttrs||null,contentQueries:s.contentQueries||null,declaredInputs:c,inputs:null,outputs:null,exportAs:s.exportAs||null,onPush:s.changeDetection===L.OnPush,directiveDefs:null,pipeDefs:null,standalone:u,dependencies:u&&s.dependencies||null,getStandaloneInjector:null,selectors:s.selectors||ze,viewQuery:s.viewQuery||null,features:s.features||null,data:s.data||{},encapsulation:s.encapsulation||be.Emulated,id:"c"+js++,styles:s.styles||ze,_:null,setInput:null,schemas:s.schemas||null,tView:null,findHostDirectiveDefs:null,hostDirectives:null},f=s.dependencies,y=s.features;return d.inputs=We(s.inputs,c),d.outputs=We(s.outputs),y&&y.forEach(E=>E(d)),d.directiveDefs=f?()=>("function"==typeof f?f():f).map(jo).filter(Zn):null,d.pipeDefs=f?()=>("function"==typeof f?f():f).map(vn).filter(Zn):null,d})}function jo(s){return yt(s)||nn(s)}function Zn(s){return null!==s}function re(s){return U(()=>({type:s.type,bootstrap:s.bootstrap||ze,declarations:s.declarations||ze,imports:s.imports||ze,exports:s.exports||ze,transitiveCompileScopes:null,schemas:s.schemas||null,id:s.id||null}))}function We(s,o){if(null==s)return Ze;const u={};for(const c in s)if(s.hasOwnProperty(c)){let d=s[c],f=d;Array.isArray(d)&&(f=d[1],d=d[0]),u[d]=c,o&&(o[d]=f)}return u}const Ct=Es;function Cn(s){return{type:s.type,name:s.name,factory:null,pure:!1!==s.pure,standalone:!0===s.standalone,onDestroy:s.type.prototype.ngOnDestroy||null}}function yt(s){return s[dt]||null}function nn(s){return s[Rt]||null}function vn(s){return s[cn]||null}function Wr(s){const o=yt(s)||nn(s)||vn(s);return null!==o&&o.standalone}function Sn(s,o){const u=s[Ln]||null;if(!u&&!0===o)throw new Error(`Type ${_e(s)} does not have '\u0275mod' property.`);return u}function Zr(s){return Array.isArray(s)&&"object"==typeof s[1]}function vi(s){return Array.isArray(s)&&!0===s[1]}function Ds(s){return 0!=(4&s.flags)}function Ho(s){return s.componentOffset>-1}function Fa(s){return 1==(1&s.flags)}function Yr(s){return null!==s.template}function vp(s){return 0!=(256&s[2])}function wi(s,o){return s.hasOwnProperty(Tt)?s[Tt]:null}class uc{constructor(o,u,c){this.previousValue=o,this.currentValue=u,this.firstChange=c}isFirstChange(){return this.firstChange}}function Wo(){return qo}function qo(s){return s.type.prototype.ngOnChanges&&(s.setInput=Uu),ns}function ns(){const s=lc(this),o=s?.current;if(o){const u=s.previous;if(u===Ze)s.previous=o;else for(let c in o)u[c]=o[c];s.current=null,this.ngOnChanges(o)}}function Uu(s,o,u,c){const d=this.declaredInputs[u],f=lc(s)||function ja(s,o){return s[Bi]=o}(s,{previous:Ze,current:null}),y=f.current||(f.current={}),E=f.previous,b=E[d];y[d]=new uc(b&&b.currentValue,o,E===Ze),s[c]=o}Wo.ngInherit=!0;const Bi="__ngSimpleChanges__";function lc(s){return s[Bi]||null}function P(s){for(;Array.isArray(s);)s=s[0];return s}function Fe(s,o){return P(o[s.index])}function It(s,o){return s.data[o]}function dn(s,o){const u=o[s];return Zr(u)?u:u[0]}function Dn(s){return 64==(64&s[2])}function Ar(s,o){return null==o?null:s[o]}function Ko(s){s[18]=0}function Ts(s,o){s[5]+=o;let u=s,c=s[3];for(;null!==c&&(1===o&&1===u[5]||-1===o&&0===u[5]);)c[5]+=o,u=c,c=c[3]}const kt={lFrame:Dw(null),bindingsEnabled:!0};function zs(){return kt.bindingsEnabled}function je(){return kt.lFrame.lView}function hn(){return kt.lFrame.tView}function i_(s){return kt.lFrame.contextLView=s,s[8]}function s_(s){return kt.lFrame.contextLView=null,s}function Ur(){let s=Cp();for(;null!==s&&64===s.type;)s=s.parent;return s}function Cp(){return kt.lFrame.currentTNode}function Ws(s,o){const u=kt.lFrame;u.currentTNode=s,u.isParent=o}function cc(){return kt.lFrame.isParent}function qs(){return kt.lFrame.bindingIndex++}function Jd(s,o){const u=kt.lFrame;u.bindingIndex=u.bindingRootIndex=s,Qo(o)}function Qo(s){kt.lFrame.currentDirectiveIndex=s}function a_(){return kt.lFrame.currentQueryIndex}function Sp(s){kt.lFrame.currentQueryIndex=s}function bw(s){const o=s[1];return 2===o.type?o.declTNode:1===o.type?s[6]:null}function u_(s,o,u){if(u&rt.SkipSelf){let d=o,f=s;for(;!(d=d.parent,null!==d||u&rt.Host||(d=bw(f),null===d||(f=f[15],10&d.type))););if(null===d)return!1;o=d,s=f}const c=kt.lFrame=Cw();return c.currentTNode=o,c.lView=s,!0}function Ap(s){const o=Cw(),u=s[1];kt.lFrame=o,o.currentTNode=u.firstChild,o.lView=s,o.tView=u,o.contextLView=s,o.bindingIndex=u.bindingStartIndex,o.inI18n=!1}function Cw(){const s=kt.lFrame,o=null===s?null:s.child;return null===o?Dw(s):o}function Dw(s){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:s,child:null,inI18n:!1};return null!==s&&(s.child=o),o}function Tw(){const s=kt.lFrame;return kt.lFrame=s.parent,s.currentTNode=null,s.lView=null,s}const l_=Tw;function c_(){const s=Tw();s.isParent=!0,s.tView=null,s.selectedIndex=-1,s.contextLView=null,s.elementDepthCount=0,s.currentDirectiveIndex=-1,s.currentNamespace=null,s.bindingRootIndex=-1,s.bindingIndex=-1,s.currentQueryIndex=0}function xi(){return kt.lFrame.selectedIndex}function ho(s){kt.lFrame.selectedIndex=s}function An(){const s=kt.lFrame;return It(s.tView,s.selectedIndex)}function fo(s,o){for(let u=o.directiveStart,c=o.directiveEnd;u<c;u++){const f=s.data[u].type.prototype,{ngAfterContentInit:y,ngAfterContentChecked:E,ngAfterViewInit:b,ngAfterViewChecked:D,ngOnDestroy:A}=f;y&&(s.contentHooks||(s.contentHooks=[])).push(-u,y),E&&((s.contentHooks||(s.contentHooks=[])).push(u,E),(s.contentCheckHooks||(s.contentCheckHooks=[])).push(u,E)),b&&(s.viewHooks||(s.viewHooks=[])).push(-u,b),D&&((s.viewHooks||(s.viewHooks=[])).push(u,D),(s.viewCheckHooks||(s.viewCheckHooks=[])).push(u,D)),null!=A&&(s.destroyHooks||(s.destroyHooks=[])).push(u,A)}}function po(s,o,u){xp(s,o,3,u)}function Xo(s,o,u,c){(3&s[2])===u&&xp(s,o,u,c)}function Jo(s,o){let u=s[2];(3&u)===o&&(u&=2047,u+=1,s[2]=u)}function xp(s,o,u,c){const f=c??-1,y=o.length-1;let E=0;for(let b=void 0!==c?65535&s[18]:0;b<y;b++)if("number"==typeof o[b+1]){if(E=o[b],null!=c&&E>=c)break}else o[b]<0&&(s[18]+=65536),(E<f||-1==f)&&(Mp(s,u,o,b),s[18]=(4294901760&s[18])+b+2),b++}function Mp(s,o,u,c){const d=u[c]<0,f=u[c+1],E=s[d?-u[c]:u[c]];if(d){if(s[2]>>11<s[18]>>16&&(3&s[2])===o){s[2]+=2048;try{f.call(E)}finally{}}}else try{f.call(E)}finally{}}class hc{constructor(o,u,c){this.factory=o,this.resolving=!1,this.canSeeViewProviders=u,this.injectImpl=c}}function ju(s,o,u){let c=0;for(;c<u.length;){const d=u[c];if("number"==typeof d){if(0!==d)break;c++;const f=u[c++],y=u[c++],E=u[c++];s.setAttribute(o,y,E,f)}else{const f=d,y=u[++c];rh(f)?s.setProperty(o,f,y):s.setAttribute(o,f,y),c++}}return c}function qa(s){return 3===s||4===s||6===s}function rh(s){return 64===s.charCodeAt(0)}function mo(s,o){if(null!==o&&0!==o.length)if(null===s||0===s.length)s=o.slice();else{let u=-1;for(let c=0;c<o.length;c++){const d=o[c];"number"==typeof d?u=d:0===u||Np(s,u,d,null,-1===u||2===u?o[++c]:null)}}return s}function Np(s,o,u,c,d){let f=0,y=s.length;if(-1===o)y=-1;else for(;f<s.length;){const E=s[f++];if("number"==typeof E){if(E===o){y=-1;break}if(E>o){y=f-1;break}}}for(;f<s.length;){const E=s[f];if("number"==typeof E)break;if(E===u){if(null===c)return void(null!==d&&(s[f+1]=d));if(c===s[f+1])return void(s[f+2]=d)}f++,null!==c&&f++,null!==d&&f++}-1!==y&&(s.splice(y,0,o),f=y+1),s.splice(f++,0,u),null!==c&&s.splice(f++,0,c),null!==d&&s.splice(f++,0,d)}function Op(s){return-1!==s}function $u(s){return 32767&s}function Ks(s,o){let u=function d_(s){return s>>16}(s),c=o;for(;u>0;)c=c[15],u--;return c}let Hu=!0;function ea(s){const o=Hu;return Hu=s,o}let ih=0;const Mi={};function Ka(s,o){const u=sh(s,o);if(-1!==u)return u;const c=o[1];c.firstCreatePass&&(s.injectorIndex=o.length,mc(c.data,s),mc(o,null),mc(c.blueprint,null));const d=oh(s,o),f=s.injectorIndex;if(Op(d)){const y=$u(d),E=Ks(d,o),b=E[1].data;for(let D=0;D<8;D++)o[f+D]=E[y+D]|b[y+D]}return o[f+8]=d,f}function mc(s,o){s.push(0,0,0,0,0,0,0,0,o)}function sh(s,o){return-1===s.injectorIndex||s.parent&&s.parent.injectorIndex===s.injectorIndex||null===o[s.injectorIndex+8]?-1:s.injectorIndex}function oh(s,o){if(s.parent&&-1!==s.parent.injectorIndex)return s.parent.injectorIndex;let u=0,c=null,d=o;for(;null!==d;){if(c=Vp(d),null===c)return-1;if(u++,d=d[15],-1!==c.injectorIndex)return c.injectorIndex|u<<16}return-1}function Lp(s,o,u){!function h_(s,o,u){let c;"string"==typeof u?c=u.charCodeAt(0)||0:u.hasOwnProperty(wn)&&(c=u[wn]),null==c&&(c=u[wn]=ih++);const d=255&c;o.data[s+(d>>5)]|=1<<d}(s,o,u)}function _c(s,o,u){if(u&rt.Optional||void 0!==s)return s;De()}function f_(s,o,u,c){if(u&rt.Optional&&void 0===c&&(c=null),0==(u&(rt.Self|rt.Host))){const d=s[9],f=gn(void 0);try{return d?d.get(o,c,u&rt.Optional):Bn(o,c,u&rt.Optional)}finally{gn(f)}}return _c(c,0,u)}function p_(s,o,u,c=rt.Default,d){if(null!==s){if(1024&o[2]){const y=function Nw(s,o,u,c,d){let f=s,y=o;for(;null!==f&&null!==y&&1024&y[2]&&!(256&y[2]);){const E=zu(f,y,u,c|rt.Self,Mi);if(E!==Mi)return E;let b=f.parent;if(!b){const D=y[21];if(D){const A=D.get(u,Mi,c);if(A!==Mi)return A}b=Vp(y),y=y[15]}f=b}return d}(s,o,u,c,Mi);if(y!==Mi)return y}const f=zu(s,o,u,c,Mi);if(f!==Mi)return f}return f_(o,u,c,d)}function zu(s,o,u,c,d){const f=function g_(s){if("string"==typeof s)return s.charCodeAt(0)||0;const o=s.hasOwnProperty(wn)?s[wn]:void 0;return"number"==typeof o?o>=0?255&o:Up:o}(u);if("function"==typeof f){if(!u_(o,s,c))return c&rt.Host?_c(d,0,c):f_(o,u,c,d);try{const y=f(c);if(null!=y||c&rt.Optional)return y;De()}finally{l_()}}else if("number"==typeof f){let y=null,E=sh(s,o),b=-1,D=c&rt.Host?o[16][6]:null;for((-1===E||c&rt.SkipSelf)&&(b=-1===E?oh(s,o):o[E+8],-1!==b&&qu(c,!1)?(y=o[1],E=$u(b),o=Ks(b,o)):E=-1);-1!==E;){const A=o[1];if(ah(f,E,A.data)){const V=kw(E,o,u,y,c,D);if(V!==Mi)return V}b=o[E+8],-1!==b&&qu(c,o[1].data[E+8]===D)&&ah(f,E,o)?(y=A,E=$u(b),o=Ks(b,o)):E=-1}}return d}function kw(s,o,u,c,d,f){const y=o[1],E=y.data[s+8],A=Wu(E,y,u,null==c?Ho(E)&&Hu:c!=y&&0!=(3&E.type),d&rt.Host&&f===E);return null!==A?_o(o,y,A,E):Mi}function Wu(s,o,u,c,d){const f=s.providerIndexes,y=o.data,E=1048575&f,b=s.directiveStart,A=f>>20,ee=d?E+A:s.directiveEnd;for(let ce=c?E:E+A;ce<ee;ce++){const Ae=y[ce];if(ce<b&&u===Ae||ce>=b&&Ae.type===u)return ce}if(d){const ce=y[b];if(ce&&Yr(ce)&&ce.type===u)return b}return null}function _o(s,o,u,c){let d=s[u];const f=o.data;if(function Pp(s){return s instanceof hc}(d)){const y=d;y.resolving&&function Ve(s,o){const u=o?`. Dependency path: ${o.join(" > ")} > ${s}`:"";throw new ve(-200,`Circular dependency in DI detected for ${s}${u}`)}(function Ne(s){return"function"==typeof s?s.name||s.toString():"object"==typeof s&&null!=s&&"function"==typeof s.type?s.type.name||s.type.toString():ke(s)}(f[u]));const E=ea(y.canSeeViewProviders);y.resolving=!0;const b=y.injectImpl?gn(y.injectImpl):null;u_(s,c,rt.Default);try{d=s[u]=y.factory(void 0,f,s,c),o.firstCreatePass&&u>=c.directiveStart&&function th(s,o,u){const{ngOnChanges:c,ngOnInit:d,ngDoCheck:f}=o.type.prototype;if(c){const y=qo(o);(u.preOrderHooks||(u.preOrderHooks=[])).push(s,y),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(s,y)}d&&(u.preOrderHooks||(u.preOrderHooks=[])).push(0-s,d),f&&((u.preOrderHooks||(u.preOrderHooks=[])).push(s,f),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(s,f))}(u,f[u],o)}finally{null!==b&&gn(b),ea(E),y.resolving=!1,l_()}}return d}function ah(s,o,u){return!!(u[o+(s>>5)]&1<<s)}function qu(s,o){return!(s&rt.Self||s&rt.Host&&o)}class ta{constructor(o,u){this._tNode=o,this._lView=u}get(o,u,c){return p_(this._tNode,this._lView,o,Me(c),u)}}function Up(){return new ta(Ur(),je())}function uh(s){return U(()=>{const o=s.prototype.constructor,u=o[Tt]||Ku(o),c=Object.prototype;let d=Object.getPrototypeOf(s.prototype).constructor;for(;d&&d!==c;){const f=d[Tt]||Ku(d);if(f&&f!==u)return f;d=Object.getPrototypeOf(d)}return f=>new f})}function Ku(s){return Oe(s)?()=>{const o=Ku(te(s));return o&&o()}:wi(s)}function Vp(s){const o=s[1],u=o.type;return 2===u?o.declTNode:1===u?s[6]:null}function Bp(s){return function Fp(s,o){if("class"===o)return s.classes;if("style"===o)return s.styles;const u=s.attrs;if(u){const c=u.length;let d=0;for(;d<c;){const f=u[d];if(qa(f))break;if(0===f)d+=2;else if("number"==typeof f)for(d++;d<c&&"string"==typeof u[d];)d++;else{if(f===o)return u[d+1];d+=2}}}return null}(Ur(),s)}const na="__parameters__";function Zu(s,o,u){return U(()=>{const c=function $p(s){return function(...u){if(s){const c=s(...u);for(const d in c)this[d]=c[d]}}}(o);function d(...f){if(this instanceof d)return c.apply(this,f),this;const y=new d(...f);return E.annotation=y,E;function E(b,D,A){const V=b.hasOwnProperty(na)?b[na]:Object.defineProperty(b,na,{value:[]})[na];for(;V.length<=A;)V.push(null);return(V[A]=V[A]||[]).push(y),b}}return u&&(d.prototype=Object.create(u.prototype)),d.prototype.ngMetadataName=s,d.annotationCls=d,d})}class Rn{constructor(o,u){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof u?this.__NG_ELEMENT_ID__=u:void 0!==u&&(this.\u0275prov=at({token:this,providedIn:u.providedIn||"root",factory:u.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function ia(s,o){s.forEach(u=>Array.isArray(u)?ia(u,o):o(u))}function v_(s,o,u){o>=s.length?s.push(u):s.splice(o,0,u)}function ch(s,o){return o>=s.length-1?s.pop():s.splice(o,1)[0]}const Hi=gt(Zu("Optional"),8),Xu=gt(Zu("SkipSelf"),4);var Ei=(()=>((Ei=Ei||{})[Ei.Important=1]="Important",Ei[Ei.DashCase=2]="DashCase",Ei))();const Gi=new Map;let Dc=0;const Sc="__ngContext__";function ri(s,o){Zr(o)?(s[Sc]=o[20],function Ih(s){Gi.set(s[20],s)}(o)):s[Sc]=o}function xn(s,o){return undefined(s,o)}function pi(s){const o=s[3];return vi(o)?o[3]:o}function bo(s){return rl(s[13])}function Ac(s){return rl(s[4])}function rl(s){for(;null!==s&&!vi(s);)s=s[4];return s}function os(s,o,u,c,d){if(null!=c){let f,y=!1;vi(c)?f=c:Zr(c)&&(y=!0,c=c[0]);const E=P(c);0===s&&null!==u?null==d?Hw(o,u,E):ol(o,u,E,d||null,!0):1===s&&null!==u?ol(o,u,E,d||null,!0):2===s?function Mh(s,o,u){const c=xh(s,o);c&&function Ah(s,o,u,c){s.removeChild(o,u,c)}(s,c,o,u)}(o,E,y):3===s&&o.destroyNode(E),null!=f&&function U_(s,o,u,c,d){const f=u[7];f!==P(u)&&os(o,s,c,f,d);for(let E=10;E<u.length;E++){const b=u[E];Nc(b[1],b,s,o,c,f)}}(o,s,f,u,d)}}function xc(s,o,u){return s.createElement(o,u)}function jw(s,o){const u=s[9],c=u.indexOf(o),d=o[3];512&o[2]&&(o[2]&=-513,Ts(d,-1)),u.splice(c,1)}function Th(s,o){if(s.length<=10)return;const u=10+o,c=s[u];if(c){const d=c[17];null!==d&&d!==s&&jw(d,c),o>0&&(s[u-1][4]=c[4]);const f=ch(s,10+o);!function R_(s,o){Nc(s,o,o[11],2,null,null),o[0]=null,o[6]=null}(c[1],c);const y=f[19];null!==y&&y.detachView(f[1]),c[3]=null,c[4]=null,c[2]&=-65}return c}function Sh(s,o){if(!(128&o[2])){const u=o[11];u.destroyNode&&Nc(s,o,u,3,null,null),function _D(s){let o=s[13];if(!o)return M_(s[1],s);for(;o;){let u=null;if(Zr(o))u=o[13];else{const c=o[10];c&&(u=c)}if(!u){for(;o&&!o[4]&&o!==s;)Zr(o)&&M_(o[1],o),o=o[3];null===o&&(o=s),Zr(o)&&M_(o[1],o),u=o&&o[4]}o=u}}(o)}}function M_(s,o){if(!(128&o[2])){o[2]&=-65,o[2]|=128,function P_(s,o){let u;if(null!=s&&null!=(u=s.destroyHooks))for(let c=0;c<u.length;c+=2){const d=o[u[c]];if(!(d instanceof hc)){const f=u[c+1];if(Array.isArray(f))for(let y=0;y<f.length;y+=2){const E=d[f[y]],b=f[y+1];try{b.call(E)}finally{}}else try{f.call(d)}finally{}}}}(s,o),function sl(s,o){const u=s.cleanup,c=o[7];let d=-1;if(null!==u)for(let f=0;f<u.length-1;f+=2)if("string"==typeof u[f]){const y=u[f+3];y>=0?c[d=y]():c[d=-y].unsubscribe(),f+=2}else{const y=c[d=u[f+1]];u[f].call(y)}if(null!==c){for(let f=d+1;f<c.length;f++)(0,c[f])();o[7]=null}}(s,o),1===o[1].type&&o[11].destroy();const u=o[17];if(null!==u&&vi(o[3])){u!==o[3]&&jw(u,o);const c=o[19];null!==c&&c.detachView(s)}!function Pr(s){Gi.delete(s[20])}(o)}}function wD(s,o,u){return function $w(s,o,u){let c=o;for(;null!==c&&40&c.type;)c=(o=c).parent;if(null===c)return u[0];{const{componentOffset:d}=c;if(d>-1){const{encapsulation:f}=s.data[c.directiveStart+d];if(f===be.None||f===be.Emulated)return null}return Fe(c,u)}}(s,o.parent,u)}function ol(s,o,u,c,d){s.insertBefore(o,u,c,d)}function Hw(s,o,u){s.appendChild(o,u)}function Mc(s,o,u,c,d){null!==c?ol(s,o,u,c,d):Hw(s,o,u)}function xh(s,o){return s.parentNode(o)}let j_,Ph,zw=function al(s,o,u){return 40&s.type?Fe(s,u):null};function Xp(s,o,u,c){const d=wD(s,c,o),f=o[11],E=function k_(s,o,u){return zw(s,o,u)}(c.parent||o[6],c,o);if(null!=d)if(Array.isArray(u))for(let b=0;b<u.length;b++)Mc(f,d,u[b],E,!1);else Mc(f,d,u,E,!1)}function Pc(s,o){if(null!==o){const u=o.type;if(3&u)return Fe(o,s);if(4&u)return L_(-1,s[o.index]);if(8&u){const c=o.child;if(null!==c)return Pc(s,c);{const d=s[o.index];return vi(d)?L_(-1,d):P(d)}}if(32&u)return xn(o,s)()||P(s[o.index]);{const c=kc(s,o);return null!==c?Array.isArray(c)?c[0]:Pc(pi(s[16]),c):Pc(s,o.next)}}return null}function kc(s,o){return null!==o?s[16][6].projection[o.projection]:null}function L_(s,o){const u=10+s+1;if(u<o.length){const c=o[u],d=c[1].firstChild;if(null!==d)return Pc(c,d)}return o[7]}function F_(s,o,u,c,d,f,y){for(;null!=u;){const E=c[u.index],b=u.type;if(y&&0===o&&(E&&ri(P(E),c),u.flags|=2),32!=(32&u.flags))if(8&b)F_(s,o,u.child,c,d,f,!1),os(o,s,d,E,f);else if(32&b){const D=xn(u,c);let A;for(;A=D();)os(o,s,d,A,f);os(o,s,d,E,f)}else 16&b?Co(s,o,c,u,d,f):os(o,s,d,E,f);u=y?u.projectionNext:u.next}}function Nc(s,o,u,c,d,f){F_(u,c,s.firstChild,o,d,f,!1)}function Co(s,o,u,c,d,f){const y=u[16],b=y[6].projection[c.projection];if(Array.isArray(b))for(let D=0;D<b.length;D++)os(o,s,d,b[D],f);else F_(s,o,b,y[3],d,f,!0)}function V_(s,o,u){""===u?s.removeAttribute(o,"class"):s.setAttribute(o,"class",u)}function qw(s,o,u){const{mergedAttrs:c,classes:d,styles:f}=u;null!==c&&ju(s,o,c),null!==d&&V_(s,o,d),null!==f&&function Jp(s,o,u){s.setAttribute(o,"style",u)}(s,o,f)}function CD(s){j_=s}function TD(s){return function $_(){if(void 0===Ph&&(Ph=null,bt.trustedTypes))try{Ph=bt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:s=>s,createScript:s=>s,createScriptURL:s=>s})}catch{}return Ph}()?.createScriptURL(s)||s}class Yw{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Xe})`}}function ua(s){return s instanceof Yw?s.changingThisBreaksApplicationSecurity:s}function Lc(s,o){const u=function SD(s){return s instanceof Yw&&s.getTypeName()||null}(s);if(null!=u&&u!==o){if("ResourceURL"===u&&"URL"===o)return!0;throw new Error(`Required a safe ${o}, got a ${u} (see ${Xe})`)}return u===o}const xD=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;var jr=(()=>((jr=jr||{})[jr.NONE=0]="NONE",jr[jr.HTML=1]="HTML",jr[jr.STYLE=2]="STYLE",jr[jr.SCRIPT=3]="SCRIPT",jr[jr.URL=4]="URL",jr[jr.RESOURCE_URL=5]="RESOURCE_URL",jr))();function rg(s){const o=ca();return o?o.sanitize(jr.URL,s)||"":Lc(s,"URL")?ua(s):function cl(s){return(s=String(s)).match(xD)?s:"unsafe:"+s}(ke(s))}function Uc(s){const o=ca();if(o)return TD(o.sanitize(jr.RESOURCE_URL,s)||"");if(Lc(s,"ResourceURL"))return TD(ua(s));throw new ve(904,!1)}function rE(s,o,u){return function ig(s,o){return"src"===o&&("embed"===s||"frame"===s||"iframe"===s||"media"===s||"script"===s)||"href"===o&&("base"===s||"link"===s)?Uc:rg}(o,u)(s)}function ca(){const s=je();return s&&s[12]}const ty=new Rn("ENVIRONMENT_INITIALIZER"),iE=new Rn("INJECTOR",-1),Vc=new Rn("INJECTOR_DEF_TYPES");class Bc{get(o,u=on){if(u===on){const c=new Error(`NullInjectorError: No provider for ${_e(o)}!`);throw c.name="NullInjectorError",c}return u}}function FD(...s){return{\u0275providers:sE(0,s),\u0275fromNgModule:!0}}function sE(s,...o){const u=[],c=new Set;let d;return ia(o,f=>{const y=f;ny(y,u,[],c)&&(d||(d=[]),d.push(y))}),void 0!==d&&oE(d,u),u}function oE(s,o){for(let u=0;u<s.length;u++){const{providers:d}=s[u];aE(d,f=>{o.push(f)})}}function ny(s,o,u,c){if(!(s=te(s)))return!1;let d=null,f=Hn(s);const y=!f&&yt(s);if(f||y){if(y&&!y.standalone)return!1;d=s}else{const b=s.ngModule;if(f=Hn(b),!f)return!1;d=b}const E=c.has(d);if(y){if(E)return!1;if(c.add(d),y.dependencies){const b="function"==typeof y.dependencies?y.dependencies():y.dependencies;for(const D of b)ny(D,o,u,c)}}else{if(!f)return!1;{if(null!=f.imports&&!E){let D;c.add(d);try{ia(f.imports,A=>{ny(A,o,u,c)&&(D||(D=[]),D.push(A))})}finally{}void 0!==D&&oE(D,o)}if(!E){const D=wi(d)||(()=>new d);o.push({provide:d,useFactory:D,deps:ze},{provide:Vc,useValue:d,multi:!0},{provide:ty,useValue:()=>B(d),multi:!0})}const b=f.providers;null==b||E||aE(b,A=>{o.push(A)})}}return d!==s&&void 0!==s.providers}function aE(s,o){for(let u of s)Te(u)&&(u=u.\u0275providers),Array.isArray(u)?aE(u,o):o(u)}const UD=he({provide:String,useValue:he});function Lh(s){return null!==s&&"object"==typeof s&&UD in s}function fl(s){return"function"==typeof s}const ry=new Rn("Set Injector scope."),sg={},BD={};let iy;function og(){return void 0===iy&&(iy=new Bc),iy}class pl{}class uE extends pl{constructor(o,u,c,d){super(),this.parent=u,this.source=c,this.scopes=d,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,ay(o,y=>this.processProvider(y)),this.records.set(iE,ou(void 0,this)),d.has("environment")&&this.records.set(pl,ou(void 0,this));const f=this.records.get(ry);null!=f&&"string"==typeof f.value&&this.scopes.add(f.value),this.injectorDefTypes=new Set(this.get(Vc.multi,ze,rt.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const o of this._ngOnDestroyHooks)o.ngOnDestroy();for(const o of this._onDestroyHooks)o()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(o){this._onDestroyHooks.push(o)}runInContext(o){this.assertNotDestroyed();const u=J(this),c=gn(void 0);try{return o()}finally{J(u),gn(c)}}get(o,u=on,c=rt.Default){this.assertNotDestroyed(),c=Me(c);const d=J(this),f=gn(void 0);try{if(!(c&rt.SkipSelf)){let E=this.records.get(o);if(void 0===E){const b=function HD(s){return"function"==typeof s||"object"==typeof s&&s instanceof Rn}(o)&&pr(o);E=b&&this.injectableDefInScope(b)?ou(ag(o),sg):null,this.records.set(o,E)}if(null!=E)return this.hydrate(o,E)}return(c&rt.Self?og():this.parent).get(o,u=c&rt.Optional&&u===on?null:u)}catch(y){if("NullInjectorError"===y.name){if((y[ur]=y[ur]||[]).unshift(_e(o)),d)throw y;return function an(s,o,u,c){const d=s[ur];throw o[mr]&&d.unshift(o[mr]),s.message=function de(s,o,u,c=null){s=s&&"\n"===s.charAt(0)&&"\u0275"==s.charAt(1)?s.slice(2):s;let d=_e(o);if(Array.isArray(o))d=o.map(_e).join(" -> ");else if("object"==typeof o){let f=[];for(let y in o)if(o.hasOwnProperty(y)){let E=o[y];f.push(y+":"+("string"==typeof E?JSON.stringify(E):_e(E)))}d=`{${f.join(", ")}}`}return`${u}${c?"("+c+")":""}[${d}]: ${s.replace(Sr,"\n  ")}`}("\n"+s.message,d,u,c),s.ngTokenPath=d,s[ur]=null,s}(y,o,"R3InjectorError",this.source)}throw y}finally{gn(f),J(d)}}resolveInjectorInitializers(){const o=J(this),u=gn(void 0);try{const c=this.get(ty.multi,ze,rt.Self);for(const d of c)d()}finally{J(o),gn(u)}}toString(){const o=[],u=this.records;for(const c of u.keys())o.push(_e(c));return`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ve(205,!1)}processProvider(o){let u=fl(o=te(o))?o:te(o&&o.provide);const c=function sy(s){return Lh(s)?ou(void 0,s.useValue):ou(function oy(s,o,u){let c;if(fl(s)){const d=te(s);return wi(d)||ag(d)}if(Lh(s))c=()=>te(s.useValue);else if(function hl(s){return!(!s||!s.useFactory)}(s))c=()=>s.useFactory(...Qe(s.deps||[]));else if(function Fh(s){return!(!s||!s.useExisting)}(s))c=()=>B(te(s.useExisting));else{const d=te(s&&(s.useClass||s.provide));if(!function ug(s){return!!s.deps}(s))return wi(d)||ag(d);c=()=>new d(...Qe(s.deps))}return c}(s),sg)}(o);if(fl(o)||!0!==o.multi)this.records.get(u);else{let d=this.records.get(u);d||(d=ou(void 0,sg,!0),d.factory=()=>Qe(d.multi),this.records.set(u,d)),u=o,d.multi.push(o)}this.records.set(u,c)}hydrate(o,u){return u.value===sg&&(u.value=BD,u.value=u.factory()),"object"==typeof u.value&&u.value&&function $D(s){return null!==s&&"object"==typeof s&&"function"==typeof s.ngOnDestroy}(u.value)&&this._ngOnDestroyHooks.add(u.value),u.value}injectableDefInScope(o){if(!o.providedIn)return!1;const u=te(o.providedIn);return"string"==typeof u?"any"===u||this.scopes.has(u):this.injectorDefTypes.has(u)}}function ag(s){const o=pr(s),u=null!==o?o.factory:wi(s);if(null!==u)return u;if(s instanceof Rn)throw new ve(204,!1);if(s instanceof Function)return function jD(s){const o=s.length;if(o>0)throw function Qa(s,o){const u=[];for(let c=0;c<s;c++)u.push(o);return u}(o,"?"),new ve(204,!1);const u=function zr(s){const o=s&&(s[Jn]||s[yn]);if(o){const u=function gr(s){if(s.hasOwnProperty("name"))return s.name;const o=(""+s).match(/^function\s*([^\s(]+)/);return null===o?"":o[1]}(s);return console.warn(`DEPRECATED: DI is instantiating a token "${u}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${u}" class.`),o}return null}(s);return null!==u?()=>u.factory(s):()=>new s}(s);throw new ve(204,!1)}function ou(s,o,u=!1){return{factory:s,value:o,multi:u?[]:void 0}}function ay(s,o){for(const u of s)Array.isArray(u)?ay(u,o):u&&Te(u)?ay(u.\u0275providers,o):o(u)}class GD{}class Uh{}class lg{resolveComponentFactory(o){throw function lE(s){const o=Error(`No component factory found for ${_e(s)}. Did you add it to @NgModule.entryComponents?`);return o.ngComponent=s,o}(o)}}let jc=(()=>{class s{}return s.NULL=new lg,s})();function Vh(){return gl(Ur(),je())}function gl(s,o){return new Bh(Fe(s,o))}let Bh=(()=>{class s{constructor(u){this.nativeElement=u}}return s.__NG_ELEMENT_ID__=Vh,s})();function zD(s){return s instanceof Bh?s.nativeElement:s}class cE{}let WD=(()=>{class s{}return s.__NG_ELEMENT_ID__=()=>function qD(){const s=je(),u=dn(Ur().index,s);return(Zr(u)?u:s)[11]}(),s})(),dE=(()=>{class s{}return s.\u0275prov=at({token:s,providedIn:"root",factory:()=>null}),s})();class hE{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const fE=new hE("15.0.4"),cy={};function hy(s){return s.ngOriginalError}class jh{constructor(){this._console=console}handleError(o){const u=this._findOriginalError(o);this._console.error("ERROR",o),u&&this._console.error("ORIGINAL ERROR",u)}_findOriginalError(o){let u=o&&hy(o);for(;u&&hy(u);)u=hy(u);return u||null}}function da(s){return s instanceof Function?s():s}function wE(s,o,u){let c=s.length;for(;;){const d=s.indexOf(o,u);if(-1===d)return d;if(0===d||s.charCodeAt(d-1)<=32){const f=o.length;if(d+f===c||s.charCodeAt(d+f)<=32)return d}u=d+1}}const py="ng-template";function Hc(s,o,u){let c=0;for(;c<s.length;){let d=s[c++];if(u&&"class"===d){if(d=s[c],-1!==wE(d.toLowerCase(),o,0))return!0}else if(1===d){for(;c<s.length&&"string"==typeof(d=s[c++]);)if(d.toLowerCase()===o)return!0;return!1}}return!1}function cg(s){return 4===s.type&&s.value!==py}function XD(s,o,u){return o===(4!==s.type||u?s.value:py)}function EE(s,o,u){let c=4;const d=s.attrs||[],f=function JD(s){for(let o=0;o<s.length;o++)if(qa(s[o]))return o;return s.length}(d);let y=!1;for(let E=0;E<o.length;E++){const b=o[E];if("number"!=typeof b){if(!y)if(4&c){if(c=2|1&c,""!==b&&!XD(s,b,u)||""===b&&1===o.length){if(ks(c))return!1;y=!0}}else{const D=8&c?b:o[++E];if(8&c&&null!==s.attrs){if(!Hc(s.attrs,D,u)){if(ks(c))return!1;y=!0}continue}const V=gy(8&c?"class":b,d,cg(s),u);if(-1===V){if(ks(c))return!1;y=!0;continue}if(""!==D){let ee;ee=V>f?"":d[V+1].toLowerCase();const ce=8&c?ee:null;if(ce&&-1!==wE(ce,D,0)||2&c&&D!==ee){if(ks(c))return!1;y=!0}}}}else{if(!y&&!ks(c)&&!ks(b))return!1;if(y&&ks(b))continue;y=!1,c=b|1&c}}return ks(c)||y}function ks(s){return 0==(1&s)}function gy(s,o,u,c){if(null===o)return-1;let d=0;if(c||!u){let f=!1;for(;d<o.length;){const y=o[d];if(y===s)return d;if(3===y||6===y)f=!0;else{if(1===y||2===y){let E=o[++d];for(;"string"==typeof E;)E=o[++d];continue}if(4===y)break;if(0===y){d+=4;continue}}d+=f?1:2}return-1}return function eT(s,o){let u=s.indexOf(4);if(u>-1)for(u++;u<s.length;){const c=s[u];if("number"==typeof c)return-1;if(c===o)return u;u++}return-1}(o,s)}function my(s,o,u=!1){for(let c=0;c<o.length;c++)if(EE(s,o[c],u))return!0;return!1}function bE(s,o){return s?":not("+o.trim()+")":o}function nT(s){let o=s[0],u=1,c=2,d="",f=!1;for(;u<s.length;){let y=s[u];if("string"==typeof y)if(2&c){const E=s[++u];d+="["+y+(E.length>0?'="'+E+'"':"")+"]"}else 8&c?d+="."+y:4&c&&(d+=" "+y);else""!==d&&!ks(y)&&(o+=bE(f,d),d=""),c=y,f=f||!ks(c);u++}return""!==d&&(o+=bE(f,d)),o}const Kt={};function _y(s){CE(hn(),je(),xi()+s,!1)}function CE(s,o,u,c){if(!c)if(3==(3&o[2])){const f=s.preOrderCheckHooks;null!==f&&po(o,f,u)}else{const f=s.preOrderHooks;null!==f&&Xo(o,f,0,u)}ho(u)}function cT(s,o=null,u=null,c){const d=dT(s,o,u,c);return d.resolveInjectorInitializers(),d}function dT(s,o=null,u=null,c,d=new Set){const f=[u||ze,FD(s)];return c=c||("object"==typeof s?void 0:_e(s)),new uE(f,o||og(),c||null,d)}let ml=(()=>{class s{static create(u,c){if(Array.isArray(u))return cT({name:""},c,u,"");{const d=u.name??"";return cT({name:d},u.parent,u.providers,d)}}}return s.THROW_IF_NOT_FOUND=on,s.NULL=new Bc,s.\u0275prov=at({token:s,providedIn:"any",factory:()=>B(iE)}),s.__NG_ELEMENT_ID__=-1,s})();function Gc(s,o=rt.Default){const u=je();return null===u?B(s,o):p_(Ur(),u,te(s),o)}function wT(){throw new Error("invalid")}function N(s,o){const u=s.contentQueries;if(null!==u)for(let c=0;c<u.length;c+=2){const d=u[c],f=u[c+1];if(-1!==f){const y=s.data[f];Sp(d),y.contentQueries(2,o[f],f)}}}function zi(s,o,u,c,d,f,y,E,b,D,A){const V=o.blueprint.slice();return V[0]=d,V[2]=76|c,(null!==A||s&&1024&s[2])&&(V[2]|=1024),Ko(V),V[3]=V[15]=s,V[8]=u,V[10]=y||s&&s[10],V[11]=E||s&&s[11],V[12]=b||s&&s[12]||null,V[9]=D||s&&s[9]||null,V[6]=f,V[20]=function Qp(){return Dc++}(),V[21]=A,V[16]=2==o.type?s[16]:V,V}function uu(s,o,u,c,d){let f=s.data[o];if(null===f)f=function En(s,o,u,c,d){const f=Cp(),y=cc(),b=s.data[o]=function mg(s,o,u,c,d,f){return{type:u,index:c,insertBeforeIndex:null,injectorIndex:o?o.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:d,attrs:f,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,y?f:f&&f.parent,u,o,c,d);return null===s.firstChild&&(s.firstChild=b),null!==f&&(y?null==f.child&&null!==b.parent&&(f.child=b):null===f.next&&(f.next=b)),b}(s,o,u,c,d),function Iw(){return kt.lFrame.inI18n}()&&(f.flags|=32);else if(64&f.type){f.type=u,f.value=c,f.attrs=d;const y=function Ha(){const s=kt.lFrame,o=s.currentTNode;return s.isParent?o:o.parent}();f.injectorIndex=null===y?-1:y.injectorIndex}return Ws(f,!0),f}function yl(s,o,u,c){if(0===u)return-1;const d=o.length;for(let f=0;f<u;f++)o.push(c),s.blueprint.push(c),s.data.push(null);return d}function pg(s,o,u){Ap(o);try{const c=s.viewQuery;null!==c&&Eg(1,c,u);const d=s.template;null!==d&&$r(s,o,d,1,u),s.firstCreatePass&&(s.firstCreatePass=!1),s.staticContentQueries&&N(s,o),s.staticViewQueries&&Eg(2,s.viewQuery,u);const f=s.components;null!==f&&function Qs(s,o){for(let u=0;u<o.length;u++)ST(s,o[u])}(o,f)}catch(c){throw s.firstCreatePass&&(s.incompleteFirstPass=!0,s.firstCreatePass=!1),c}finally{o[2]&=-5,c_()}}function gg(s,o,u,c){const d=o[2];if(128!=(128&d)){Ap(o);try{Ko(o),function o_(s){return kt.lFrame.bindingIndex=s}(s.bindingStartIndex),null!==u&&$r(s,o,u,2,c);const y=3==(3&d);if(y){const D=s.preOrderCheckHooks;null!==D&&po(o,D,null)}else{const D=s.preOrderHooks;null!==D&&Xo(o,D,0,null),Jo(o,0)}if(function VE(s){for(let o=bo(s);null!==o;o=Ac(o)){if(!o[2])continue;const u=o[9];for(let c=0;c<u.length;c++){const d=u[c],f=d[3];0==(512&d[2])&&Ts(f,1),d[2]|=512}}}(o),function UE(s){for(let o=bo(s);null!==o;o=Ac(o))for(let u=10;u<o.length;u++){const c=o[u],d=c[1];Dn(c)&&gg(d,c,d.template,c[8])}}(o),null!==s.contentQueries&&N(s,o),y){const D=s.contentCheckHooks;null!==D&&po(o,D)}else{const D=s.contentHooks;null!==D&&Xo(o,D,1),Jo(o,1)}!function ET(s,o){const u=s.hostBindingOpCodes;if(null!==u)try{for(let c=0;c<u.length;c++){const d=u[c];if(d<0)ho(~d);else{const f=d,y=u[++c],E=u[++c];Jd(y,f),E(2,o[f])}}}finally{ho(-1)}}(s,o);const E=s.components;null!==E&&function ki(s,o){for(let u=0;u<o.length;u++)My(s,o[u])}(o,E);const b=s.viewQuery;if(null!==b&&Eg(2,b,c),y){const D=s.viewCheckHooks;null!==D&&po(o,D)}else{const D=s.viewHooks;null!==D&&Xo(o,D,2),Jo(o,2)}!0===s.firstUpdatePass&&(s.firstUpdatePass=!1),o[2]&=-41,512&o[2]&&(o[2]&=-513,Ts(o[3],-1))}finally{c_()}}}function $r(s,o,u,c,d){const f=xi(),y=2&c;try{ho(-1),y&&o.length>22&&CE(s,o,22,!1),u(c,d)}finally{ho(f)}}function PE(s,o,u){if(Ds(o)){const d=o.directiveEnd;for(let f=o.directiveStart;f<d;f++){const y=s.data[f];y.contentQueries&&y.contentQueries(1,u[f],f)}}}function zh(s,o,u){!zs()||(function DT(s,o,u,c){const d=u.directiveStart,f=u.directiveEnd;Ho(u)&&function Ay(s,o,u){const c=Fe(o,s),d=kE(u),f=s[10],y=Wh(s,zi(s,d,null,u.onPush?32:16,c,o,f,f.createRenderer(c,u),null,null,null));s[o.index]=y}(o,u,s.data[d+u.componentOffset]),s.firstCreatePass||Ka(u,o),ri(c,o);const y=u.initialInputs;for(let E=d;E<f;E++){const b=s.data[E],D=_o(o,s,E,u);ri(D,o),null!==y&&FE(0,E-d,D,b,0,y),Yr(b)&&(dn(u.index,o)[8]=_o(o,s,E,u))}}(s,o,u,Fe(u,o)),64==(64&u.flags)&&Ty(s,o,u))}function Ce(s,o,u=Fe){const c=o.localNames;if(null!==c){let d=o.index+1;for(let f=0;f<c.length;f+=2){const y=c[f+1],E=-1===y?u(o,s):s[y];s[d++]=E}}}function kE(s){const o=s.tView;return null===o||o.incompleteFirstPass?s.tView=Xs(1,null,s.template,s.decls,s.vars,s.directiveDefs,s.pipeDefs,s.viewQuery,s.schemas,s.consts):o}function Xs(s,o,u,c,d,f,y,E,b,D){const A=22+c,V=A+d,ee=function ht(s,o){const u=[];for(let c=0;c<o;c++)u.push(c<s?null:Kt);return u}(A,V),ce="function"==typeof D?D():D;return ee[1]={type:s,blueprint:ee,template:u,queries:null,viewQuery:E,declTNode:o,data:ee.slice().fill(null,A),bindingStartIndex:A,expandoStartIndex:V,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof f?f():f,pipeRegistry:"function"==typeof y?y():y,firstChild:null,schemas:b,consts:ce,incompleteFirstPass:!1}}function Gt(s,o,u,c){const d=Ig(o);null===u?d.push(c):(d.push(u),s.firstCreatePass&&bg(s).push(c,d.length-1))}function _g(s,o,u,c){for(let d in s)if(s.hasOwnProperty(d)){u=null===u?{}:u;const f=s[d];null===c?zc(u,o,d,f):c.hasOwnProperty(d)&&zc(u,o,c[d],f)}return u}function zc(s,o,u,c){s.hasOwnProperty(u)?s[u].push(o,c):s[u]=[o,c]}function as(s,o,u,c,d,f,y,E){const b=Fe(o,u);let A,D=o.inputs;!E&&null!=D&&(A=D[c])?(Ny(s,u,A,c,d),Ho(o)&&NE(u,o.index)):3&o.type&&(c=function Dy(s){return"class"===s?"className":"for"===s?"htmlFor":"formaction"===s?"formAction":"innerHtml"===s?"innerHTML":"readonly"===s?"readOnly":"tabindex"===s?"tabIndex":s}(c),d=null!=y?y(d,o.value||"",c):d,f.setProperty(b,c,d))}function NE(s,o){const u=dn(o,s);16&u[2]||(u[2]|=32)}function Wc(s,o,u,c){let d=!1;if(zs()){const f=null===c?null:{"":-1},y=function TT(s,o){const u=s.directiveRegistry;let c=null,d=null;if(u)for(let f=0;f<u.length;f++){const y=u[f];if(my(o,y.selectors,!1))if(c||(c=[]),Yr(y))if(null!==y.findHostDirectiveDefs){const E=[];d=d||new Map,y.findHostDirectiveDefs(y,E,d),c.unshift(...E,y),yg(s,o,E.length)}else c.unshift(y),yg(s,o,0);else d=d||new Map,y.findHostDirectiveDefs?.(y,c,d),c.push(y)}return null===c?null:[c,d]}(s,u);let E,b;null===y?E=b=null:[E,b]=y,null!==E&&(d=!0,ii(s,o,u,E,f,b)),f&&function Sy(s,o,u){if(o){const c=s.localNames=[];for(let d=0;d<o.length;d+=2){const f=u[o[d+1]];if(null==f)throw new ve(-301,!1);c.push(o[d],f)}}}(u,c,f)}return u.mergedAttrs=mo(u.mergedAttrs,u.attrs),d}function ii(s,o,u,c,d,f){for(let D=0;D<c.length;D++)Lp(Ka(u,o),s,c[D].type);!function LE(s,o,u){s.flags|=1,s.directiveStart=o,s.directiveEnd=o+u,s.providerIndexes=o}(u,s.data.length,c.length);for(let D=0;D<c.length;D++){const A=c[D];A.providersResolver&&A.providersResolver(A)}let y=!1,E=!1,b=yl(s,o,c.length,null);for(let D=0;D<c.length;D++){const A=c[D];u.mergedAttrs=mo(u.mergedAttrs,A.hostAttrs),Ni(s,u,o,b,A),vg(b,A,d),null!==A.contentQueries&&(u.flags|=4),(null!==A.hostBindings||null!==A.hostAttrs||0!==A.hostVars)&&(u.flags|=64);const V=A.type.prototype;!y&&(V.ngOnChanges||V.ngOnInit||V.ngDoCheck)&&((s.preOrderHooks||(s.preOrderHooks=[])).push(u.index),y=!0),!E&&(V.ngOnChanges||V.ngDoCheck)&&((s.preOrderCheckHooks||(s.preOrderCheckHooks=[])).push(u.index),E=!0),b++}!function IT(s,o,u){const d=o.directiveEnd,f=s.data,y=o.attrs,E=[];let b=null,D=null;for(let A=o.directiveStart;A<d;A++){const V=f[A],ee=u?u.get(V):null,Ae=ee?ee.outputs:null;b=_g(V.inputs,A,b,ee?ee.inputs:null),D=_g(V.outputs,A,D,Ae);const Ye=null===b||null===y||cg(o)?null:Ry(b,A,y);E.push(Ye)}null!==b&&(b.hasOwnProperty("class")&&(o.flags|=8),b.hasOwnProperty("style")&&(o.flags|=16)),o.initialInputs=E,o.inputs=b,o.outputs=D}(s,u,f)}function Ty(s,o,u){const c=u.directiveStart,d=u.directiveEnd,f=u.index,y=function Tp(){return kt.lFrame.currentDirectiveIndex}();try{ho(f);for(let E=c;E<d;E++){const b=s.data[E],D=o[E];Qo(E),(null!==b.hostBindings||0!==b.hostVars||null!==b.hostAttrs)&&OE(b,D)}}finally{ho(-1),Qo(y)}}function OE(s,o){null!==s.hostBindings&&s.hostBindings(1,o)}function yg(s,o,u){o.componentOffset=u,(s.components||(s.components=[])).push(o.index)}function vg(s,o,u){if(u){if(o.exportAs)for(let c=0;c<o.exportAs.length;c++)u[o.exportAs[c]]=s;Yr(o)&&(u[""]=s)}}function Ni(s,o,u,c,d){s.data[c]=d;const f=d.factory||(d.factory=wi(d.type)),y=new hc(f,Yr(d),Gc);s.blueprint[c]=y,u[c]=y,function lu(s,o,u,c,d){const f=d.hostBindings;if(f){let y=s.hostBindingOpCodes;null===y&&(y=s.hostBindingOpCodes=[]);const E=~o.index;(function CT(s){let o=s.length;for(;o>0;){const u=s[--o];if("number"==typeof u&&u<0)return u}return 0})(y)!=E&&y.push(E),y.push(u,c,f)}}(s,o,c,yl(s,u,d.hostVars,Kt),d)}function tr(s,o,u,c,d,f){const y=Fe(s,o);!function wg(s,o,u,c,d,f,y){if(null==f)s.removeAttribute(o,d,u);else{const E=null==y?ke(f):y(f,c||"",d);s.setAttribute(o,d,E,u)}}(o[11],y,f,s.value,u,c,d)}function FE(s,o,u,c,d,f){const y=f[o];if(null!==y){const E=c.setInput;for(let b=0;b<y.length;){const D=y[b++],A=y[b++],V=y[b++];null!==E?c.setInput(u,V,D,A):u[A]=V}}}function Ry(s,o,u){let c=null,d=0;for(;d<u.length;){const f=u[d];if(0!==f)if(5!==f){if("number"==typeof f)break;if(s.hasOwnProperty(f)){null===c&&(c=[]);const y=s[f];for(let E=0;E<y.length;E+=2)if(y[E]===o){c.push(f,y[E+1],u[d+1]);break}}d+=2}else d+=2;else d+=4}return c}function xy(s,o,u,c){return[s,!0,!1,o,null,0,c,u,null,null]}function My(s,o){const u=dn(o,s);if(Dn(u)){const c=u[1];48&u[2]?gg(c,u,c.template,u[8]):u[5]>0&&Py(u)}}function Py(s){for(let c=bo(s);null!==c;c=Ac(c))for(let d=10;d<c.length;d++){const f=c[d];if(Dn(f))if(512&f[2]){const y=f[1];gg(y,f,y.template,f[8])}else f[5]>0&&Py(f)}const u=s[1].components;if(null!==u)for(let c=0;c<u.length;c++){const d=dn(u[c],s);Dn(d)&&d[5]>0&&Py(d)}}function ST(s,o){const u=dn(o,s),c=u[1];(function qc(s,o){for(let u=o.length;u<s.blueprint.length;u++)o.push(s.blueprint[u])})(c,u),pg(c,u,u[8])}function Wh(s,o){return s[13]?s[14][4]=o:s[13]=o,s[14]=o,o}function qh(s){for(;s;){s[2]|=32;const o=pi(s);if(vp(s)&&!o)return s;s=o}return null}function Kh(s,o,u,c=!0){const d=o[10];d.begin&&d.begin();try{gg(s,o,s.template,u)}catch(y){throw c&&BE(o,y),y}finally{d.end&&d.end()}}function Eg(s,o,u){Sp(0),o(s,u)}function Ig(s){return s[7]||(s[7]=[])}function bg(s){return s.cleanup||(s.cleanup=[])}function BE(s,o){const u=s[9],c=u?u.get(jh,null):null;c&&c.handleError(o)}function Ny(s,o,u,c,d){for(let f=0;f<u.length;){const y=u[f++],E=u[f++],b=o[y],D=s.data[y];null!==D.setInput?D.setInput(b,d,c,E):b[E]=d}}function Js(s,o,u){const c=function pe(s,o){return P(o[s])}(o,s);!function Rc(s,o,u){s.setValue(o,u)}(s[11],c,u)}function Zh(s,o,u){let c=u?s.styles:null,d=u?s.classes:null,f=0;if(null!==o)for(let y=0;y<o.length;y++){const E=o[y];"number"==typeof E?f=E:1==f?d=ye(d,E):2==f&&(c=ye(c,E+": "+o[++y]+";"))}u?s.styles=c:s.stylesWithoutHost=c,u?s.classes=d:s.classesWithoutHost=d}function Dg(s,o,u,c,d=!1){for(;null!==u;){const f=o[u.index];if(null!==f&&c.push(P(f)),vi(f))for(let E=10;E<f.length;E++){const b=f[E],D=b[1].firstChild;null!==D&&Dg(b[1],b,D,c)}const y=u.type;if(8&y)Dg(s,o,u.child,c);else if(32&y){const E=xn(u,o);let b;for(;b=E();)c.push(b)}else if(16&y){const E=kc(o,u);if(Array.isArray(E))c.push(...E);else{const b=pi(o[16]);Dg(b[1],b,E,c,!0)}}u=d?u.projectionNext:u.next}return c}class Yh{constructor(o,u){this._lView=o,this._cdRefInjectingView=u,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const o=this._lView,u=o[1];return Dg(u,o,u.firstChild,[])}get context(){return this._lView[8]}set context(o){this._lView[8]=o}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[3];if(vi(o)){const u=o[8],c=u?u.indexOf(this):-1;c>-1&&(Th(o,c),ch(u,c))}this._attachedToViewContainer=!1}Sh(this._lView[1],this._lView)}onDestroy(o){Gt(this._lView[1],this._lView,null,o)}markForCheck(){qh(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){Kh(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ve(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function x_(s,o){Nc(s,o,o[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new ve(902,!1);this._appRef=o}}class bi extends Yh{constructor(o){super(o),this._view=o}detectChanges(){const o=this._view;Kh(o[1],o,o[8],!1)}checkNoChanges(){}get context(){return null}}class Kc extends jc{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const u=yt(o);return new Xh(u,this.ngModule)}}function jE(s){const o=[];for(let u in s)s.hasOwnProperty(u)&&o.push({propName:s[u],templateName:u});return o}class AT{constructor(o,u){this.injector=o,this.parentInjector=u}get(o,u,c){c=Me(c);const d=this.injector.get(o,cy,c);return d!==cy||u===cy?d:this.parentInjector.get(o,u,c)}}class Xh extends Uh{constructor(o,u){super(),this.componentDef=o,this.ngModule=u,this.componentType=o.type,this.selector=function dg(s){return s.map(nT).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!u}get inputs(){return jE(this.componentDef.inputs)}get outputs(){return jE(this.componentDef.outputs)}create(o,u,c,d){let f=(d=d||this.ngModule)instanceof pl?d:d?.injector;f&&null!==this.componentDef.getStandaloneInjector&&(f=this.componentDef.getStandaloneInjector(f)||f);const y=f?new AT(o,f):o,E=y.get(cE,null);if(null===E)throw new ve(407,!1);const b=y.get(dE,null),D=E.createRenderer(null,this.componentDef),A=this.componentDef.selectors[0][0]||"div",V=c?function Cy(s,o,u){return s.selectRootElement(o,u===be.ShadowDom)}(D,c,this.componentDef.encapsulation):xc(D,A,function Qh(s){const o=s.toLowerCase();return"svg"===o?"svg":"math"===o?"math":null}(A)),ee=this.componentDef.onPush?288:272,ce=Xs(0,null,null,1,0,null,null,null,null,null),Ae=zi(null,ce,null,ee,null,null,E,D,b,y,null);let Ye,nt;Ap(Ae);try{const ct=this.componentDef;let Mt,Be=null;ct.findHostDirectiveDefs?(Mt=[],Be=new Map,ct.findHostDirectiveDefs(ct,Mt,Be),Mt.push(ct)):Mt=[ct];const zt=function Ly(s,o){const u=s[1];return s[22]=o,uu(u,22,2,"#host",null)}(Ae,V),ir=function Fy(s,o,u,c,d,f,y,E){const b=d[1];!function Uy(s,o,u,c){for(const d of s)o.mergedAttrs=mo(o.mergedAttrs,d.hostAttrs);null!==o.mergedAttrs&&(Zh(o,o.mergedAttrs,!0),null!==u&&qw(c,u,o))}(c,s,o,y);const D=f.createRenderer(o,u),A=zi(d,kE(u),null,u.onPush?32:16,d[s.index],s,f,D,E||null,null,null);return b.firstCreatePass&&yg(b,s,c.length-1),Wh(d,A),d[s.index]=A}(zt,V,ct,Mt,Ae,E,D);nt=It(ce,22),V&&function $E(s,o,u,c){if(c)ju(s,u,["ng-version",fE.full]);else{const{attrs:d,classes:f}=function rT(s){const o=[],u=[];let c=1,d=2;for(;c<s.length;){let f=s[c];if("string"==typeof f)2===d?""!==f&&o.push(f,s[++c]):8===d&&u.push(f);else{if(!ks(d))break;d=f}c++}return{attrs:o,classes:u}}(o.selectors[0]);d&&ju(s,u,d),f&&f.length>0&&V_(s,u,f.join(" "))}}(D,ct,V,c),void 0!==u&&function HE(s,o,u){const c=s.projection=[];for(let d=0;d<o.length;d++){const f=u[d];c.push(null!=f?Array.from(f):null)}}(nt,this.ngContentSelectors,u),Ye=function Vy(s,o,u,c,d,f){const y=Ur(),E=d[1],b=Fe(y,d);ii(E,d,y,u,null,c);for(let A=0;A<u.length;A++)ri(_o(d,E,y.directiveStart+A,y),d);Ty(E,d,y),b&&ri(b,d);const D=_o(d,E,y.directiveStart+y.componentOffset,y);if(s[8]=d[8]=D,null!==f)for(const A of f)A(D,o);return PE(E,y,s),D}(ir,ct,Mt,Be,Ae,[RT]),pg(ce,Ae,null)}finally{c_()}return new Tg(this.componentType,Ye,gl(nt,Ae),Ae,nt)}}class Tg extends GD{constructor(o,u,c,d,f){super(),this.location=c,this._rootLView=d,this._tNode=f,this.instance=u,this.hostView=this.changeDetectorRef=new bi(d),this.componentType=o}setInput(o,u){const c=this._tNode.inputs;let d;if(null!==c&&(d=c[o])){const f=this._rootLView;Ny(f[1],f,d,o,u),NE(f,this._tNode.index)}}get injector(){return new ta(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}function RT(){const s=Ur();fo(je()[1],s)}let xg=null;function ha(){if(!xg){const s=bt.Symbol;if(s&&s.iterator)xg=s.iterator;else{const o=Object.getOwnPropertyNames(Map.prototype);for(let u=0;u<o.length;++u){const c=o[u];"entries"!==c&&"size"!==c&&Map.prototype[c]===Map.prototype.entries&&(xg=c)}}}return xg}function Jh(s){return!!qy(s)&&(Array.isArray(s)||!(s instanceof Map)&&ha()in s)}function qy(s){return null!==s&&("function"==typeof s||"object"==typeof s)}function mi(s,o,u){return!Object.is(s[o],u)&&(s[o]=u,!0)}function Pg(s,o,u,c){const d=je();return mi(d,qs(),o)&&(hn(),tr(An(),d,s,o,u,c)),Pg}function fa(s,o,u,c){return mi(s,qs(),u)?o+ke(u)+c:Kt}function Jy(s,o,u,c,d,f,y,E){const b=je(),D=hn(),A=s+22,V=D.firstCreatePass?function KE(s,o,u,c,d,f,y,E,b){const D=o.consts,A=uu(o,s,4,y||null,Ar(D,E));Wc(o,u,A,Ar(D,b)),fo(o,A);const V=A.tViews=Xs(2,A,c,d,f,o.directiveRegistry,o.pipeRegistry,null,o.schemas,D);return null!==o.queries&&(o.queries.template(o,A),V.queries=o.queries.embeddedTView(A)),A}(A,D,b,o,u,c,d,f,y):D.data[A];Ws(V,!1);const ee=b[11].createComment("");Xp(D,b,ee,V),ri(ee,b),Wh(b,b[A]=xy(ee,b,ee,V)),Fa(V)&&zh(D,b,V),null!=y&&Ce(b,V,E)}function kg(s){return function $t(s,o){return s[o]}(function Xd(){return kt.lFrame.contextLView}(),22+s)}function rf(s,o,u){const c=je();return mi(c,qs(),o)&&as(hn(),An(),c,s,o,c[11],u,!1),rf}function sf(s,o,u,c,d){const y=d?"class":"style";Ny(s,u,o.inputs[y],y,c)}function du(s,o,u,c){const d=je(),f=hn(),y=22+s,E=d[11],b=d[y]=xc(E,o,function Pw(){return kt.lFrame.currentNamespace}()),D=f.firstCreatePass?function Ng(s,o,u,c,d,f,y){const E=o.consts,D=uu(o,s,2,d,Ar(E,f));return Wc(o,u,D,Ar(E,y)),null!==D.attrs&&Zh(D,D.attrs,!1),null!==D.mergedAttrs&&Zh(D,D.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,D),D}(y,f,d,0,o,u,c):f.data[y];return Ws(D,!0),qw(E,b,D),32!=(32&D.flags)&&Xp(f,d,b,D),0===function Zo(){return kt.lFrame.elementDepthCount}()&&ri(b,d),function Yo(){kt.lFrame.elementDepthCount++}(),Fa(D)&&(zh(f,d,D),PE(f,D,d)),null!==c&&Ce(d,D),du}function af(){let s=Ur();cc()?function dc(){kt.lFrame.isParent=!1}():(s=s.parent,Ws(s,!1));const o=s;!function Ss(){kt.lFrame.elementDepthCount--}();const u=hn();return u.firstCreatePass&&(fo(u,s),Ds(s)&&u.queries.elementEnd(s)),null!=o.classesWithoutHost&&function kp(s){return 0!=(8&s.flags)}(o)&&sf(u,o,je(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function Wa(s){return 0!=(16&s.flags)}(o)&&sf(u,o,je(),o.stylesWithoutHost,!1),af}function ev(s,o,u,c){return du(s,o,u,c),af(),ev}function rv(){return je()}function Og(s){return!!s&&"function"==typeof s.then}function ZE(s){return!!s&&"function"==typeof s.subscribe}const nd=ZE;function Lg(s,o,u,c){const d=je(),f=hn(),y=Ur();return function hu(s,o,u,c,d,f,y){const E=Fa(c),D=s.firstCreatePass&&bg(s),A=o[8],V=Ig(o);let ee=!0;if(3&c.type||y){const Ye=Fe(c,o),nt=y?y(Ye):Ye,ct=V.length,Mt=y?zt=>y(P(zt[c.index])):c.index;let Be=null;if(!y&&E&&(Be=function cf(s,o,u,c){const d=s.cleanup;if(null!=d)for(let f=0;f<d.length-1;f+=2){const y=d[f];if(y===u&&d[f+1]===c){const E=o[7],b=d[f+2];return E.length>b?E[b]:null}"string"==typeof y&&(f+=2)}return null}(s,o,d,c.index)),null!==Be)(Be.__ngLastListenerFn__||Be).__ngNextListenerFn__=f,Be.__ngLastListenerFn__=f,ee=!1;else{f=YE(c,o,A,f,!1);const zt=u.listen(nt,d,f);V.push(f,zt),D&&D.push(d,Mt,ct,ct+1)}}else f=YE(c,o,A,f,!1);const ce=c.outputs;let Ae;if(ee&&null!==ce&&(Ae=ce[d])){const Ye=Ae.length;if(Ye)for(let nt=0;nt<Ye;nt+=2){const ir=o[Ae[nt]][Ae[nt+1]].subscribe(f),hr=V.length;V.push(f,ir),D&&D.push(d,c.index,hr,-(hr+1))}}}(f,d,d[11],y,s,o,c),Lg}function Fg(s,o,u,c){try{return!1!==u(c)}catch(d){return BE(s,d),!1}}function YE(s,o,u,c,d){return function f(y){if(y===Function)return c;qh(s.componentOffset>-1?dn(s.index,o):o);let b=Fg(o,0,c,y),D=f.__ngNextListenerFn__;for(;D;)b=Fg(o,0,D,y)&&b,D=D.__ngNextListenerFn__;return d&&!1===b&&(y.preventDefault(),y.returnValue=!1),b}}function Ug(s,o,u){return ov(s,"",o,"",u),Ug}function ov(s,o,u,c,d){const f=je(),y=fa(f,o,u,c);return y!==Kt&&as(hn(),An(),f,s,y,f[11],d,!1),ov}function _v(s,o=""){const u=je(),c=hn(),d=s+22,f=c.firstCreatePass?uu(c,d,1,o,null):c.data[d],y=u[d]=function il(s,o){return s.createText(o)}(u[11],o);Xp(c,u,y,f),Ws(f,!1)}function vf(s){return ad("",s,""),vf}function ad(s,o,u){const c=je(),d=fa(c,s,o,u);return d!==Kt&&Js(c,xi(),d),ad}const ga=void 0;var qe=["en",[["a","p"],["AM","PM"],ga],[["AM","PM"],ga,ga],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ga,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ga,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ga,"{1} 'at' {0}",ga],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function $T(s){const u=Math.floor(Math.abs(s)),c=s.toString().replace(/^[^.]*\.?/,"").length;return 1===u&&0===c?1:5}];let Qn={};function If(s){const o=function Ge(s){return s.toLowerCase().replace(/_/g,"-")}(s);let u=bI(o);if(u)return u;const c=o.split("-")[0];if(u=bI(c),u)return u;if("en"===c)return qe;throw new ve(701,!1)}function Lt(s){return If(s)[ne.PluralCase]}function bI(s){return s in Qn||(Qn[s]=bt.ng&&bt.ng.common&&bt.ng.common.locales&&bt.ng.common.locales[s]),Qn[s]}var ne=(()=>((ne=ne||{})[ne.LocaleId=0]="LocaleId",ne[ne.DayPeriodsFormat=1]="DayPeriodsFormat",ne[ne.DayPeriodsStandalone=2]="DayPeriodsStandalone",ne[ne.DaysFormat=3]="DaysFormat",ne[ne.DaysStandalone=4]="DaysStandalone",ne[ne.MonthsFormat=5]="MonthsFormat",ne[ne.MonthsStandalone=6]="MonthsStandalone",ne[ne.Eras=7]="Eras",ne[ne.FirstDayOfWeek=8]="FirstDayOfWeek",ne[ne.WeekendRange=9]="WeekendRange",ne[ne.DateFormat=10]="DateFormat",ne[ne.TimeFormat=11]="TimeFormat",ne[ne.DateTimeFormat=12]="DateTimeFormat",ne[ne.NumberSymbols=13]="NumberSymbols",ne[ne.NumberFormats=14]="NumberFormats",ne[ne.CurrencyCode=15]="CurrencyCode",ne[ne.CurrencySymbol=16]="CurrencySymbol",ne[ne.CurrencyName=17]="CurrencyName",ne[ne.Currencies=18]="Currencies",ne[ne.Directionality=19]="Directionality",ne[ne.PluralCase=20]="PluralCase",ne[ne.ExtraData=21]="ExtraData",ne))();const cd="en-US";let DI=cd;class wa{}class Uv{}function VI(s,o){return new BI(s,o??null)}class BI extends wa{constructor(o,u){super(),this._parent=u,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Kc(this);const c=Sn(o);this._bootstrapComponents=da(c.bootstrap),this._r3Injector=dT(o,u,[{provide:wa,useValue:this},{provide:jc,useValue:this.componentFactoryResolver}],_e(o),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(o)}get injector(){return this._r3Injector}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(u=>u()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class Vv extends Uv{constructor(o){super(),this.moduleType=o}create(o){return new BI(this.moduleType,o)}}class JT extends wa{constructor(o,u,c){super(),this.componentFactoryResolver=new Kc(this),this.instance=null;const d=new uE([...o,{provide:wa,useValue:this},{provide:jc,useValue:this.componentFactoryResolver}],u||og(),c,new Set(["environment"]));this.injector=d,d.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(o){this.injector.onDestroy(o)}}function om(s,o,u=null){return new JT(s,o,u).injector}let eS=(()=>{class s{constructor(u){this._injector=u,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(u){if(!u.standalone)return null;if(!this.cachedInjectors.has(u.id)){const c=sE(0,u.type),d=c.length>0?om([c],this._injector,`Standalone[${u.type.name}]`):null;this.cachedInjectors.set(u.id,d)}return this.cachedInjectors.get(u.id)}ngOnDestroy(){try{for(const u of this.cachedInjectors.values())null!==u&&u.destroy()}finally{this.cachedInjectors.clear()}}}return s.\u0275prov=at({token:s,providedIn:"environment",factory:()=>new s(B(pl))}),s})();function jI(s){s.getStandaloneInjector=o=>o.get(eS).getOrCreateStandaloneInjector(s)}function wd(s){return o=>{setTimeout(s,void 0,o)}}const fs=class dr extends g.x{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,u,c){let d=o,f=u||(()=>null),y=c;if(o&&"object"==typeof o){const b=o;d=b.next?.bind(b),f=b.error?.bind(b),y=b.complete?.bind(b)}this.__isAsync&&(f=wd(f),d&&(d=wd(d)),y&&(y=wd(y)));const E=super.subscribe({next:d,error:f,complete:y});return o instanceof j.w0&&o.add(E),E}};function sb(){return this._results[ha()]()}class Wv{constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const u=ha(),c=Wv.prototype;c[u]||(c[u]=sb)}get changes(){return this._changes||(this._changes=new fs)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,u){return this._results.reduce(o,u)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,u){const c=this;c.dirty=!1;const d=function Pi(s){return s.flat(Number.POSITIVE_INFINITY)}(o);(this._changesDetected=!function Fw(s,o,u){if(s.length!==o.length)return!1;for(let c=0;c<s.length;c++){let d=s[c],f=o[c];if(u&&(d=u(d),f=u(f)),f!==d)return!1}return!0}(c._results,d,u))&&(c._results=d,c.length=d.length,c.last=d[this.length-1],c.first=d[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let ba=(()=>{class s{}return s.__NG_ELEMENT_ID__=Ed,s})();const iS=ba,ob=class extends iS{constructor(o,u,c){super(),this._declarationLView=o,this._declarationTContainer=u,this.elementRef=c}createEmbeddedView(o,u){const c=this._declarationTContainer.tViews,d=zi(this._declarationLView,c,o,16,null,c.declTNode,null,null,null,null,u||null);d[17]=this._declarationLView[this._declarationTContainer.index];const y=this._declarationLView[19];return null!==y&&(d[19]=y.createEmbeddedView(c)),pg(c,d,o),new Yh(d)}};function Ed(){return Fs(Ur(),je())}function Fs(s,o){return 4&s.type?new ob(o,s,gl(s,o)):null}let Lf=(()=>{class s{}return s.__NG_ELEMENT_ID__=ab,s})();function ab(){return Or(Ur(),je())}const ub=Lf,Ll=class extends ub{constructor(o,u,c){super(),this._lContainer=o,this._hostTNode=u,this._hostLView=c}get element(){return gl(this._hostTNode,this._hostLView)}get injector(){return new ta(this._hostTNode,this._hostLView)}get parentInjector(){const o=oh(this._hostTNode,this._hostLView);if(Op(o)){const u=Ks(o,this._hostLView),c=$u(o);return new ta(u[1].data[c+8],u)}return new ta(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const u=um(this._lContainer);return null!==u&&u[o]||null}get length(){return this._lContainer.length-10}createEmbeddedView(o,u,c){let d,f;"number"==typeof c?d=c:null!=c&&(d=c.index,f=c.injector);const y=o.createEmbeddedView(u||{},f);return this.insert(y,d),y}createComponent(o,u,c,d,f){const y=o&&!function Qu(s){return"function"==typeof s}(o);let E;if(y)E=u;else{const V=u||{};E=V.index,c=V.injector,d=V.projectableNodes,f=V.environmentInjector||V.ngModuleRef}const b=y?o:new Xh(yt(o)),D=c||this.parentInjector;if(!f&&null==b.ngModule){const ee=(y?D:this.parentInjector).get(pl,null);ee&&(f=ee)}const A=b.create(D,d,void 0,f);return this.insert(A.hostView,E),A}insert(o,u){const c=o._lView,d=c[1];if(function Ht(s){return vi(s[3])}(c)){const A=this.indexOf(o);if(-1!==A)this.detach(A);else{const V=c[3],ee=new Ll(V,V[6],V[3]);ee.detach(ee.indexOf(o))}}const f=this._adjustIndex(u),y=this._lContainer;!function yD(s,o,u,c){const d=10+c,f=u.length;c>0&&(u[d-1][4]=o),c<f-10?(o[4]=u[d],v_(u,10+c,o)):(u.push(o),o[4]=null),o[3]=u;const y=o[17];null!==y&&u!==y&&function vD(s,o){const u=s[9];o[16]!==o[3][3][16]&&(s[2]=!0),null===u?s[9]=[o]:u.push(o)}(y,o);const E=o[19];null!==E&&E.insertView(s),o[2]|=64}(d,c,y,f);const E=L_(f,y),b=c[11],D=xh(b,y[7]);return null!==D&&function su(s,o,u,c,d,f){c[0]=d,c[6]=o,Nc(s,c,u,1,d,f)}(d,y[6],b,c,D,E),o.attachToViewContainerRef(),v_(qv(y),f,o),o}move(o,u){return this.insert(o,u)}indexOf(o){const u=um(this._lContainer);return null!==u?u.indexOf(o):-1}remove(o){const u=this._adjustIndex(o,-1),c=Th(this._lContainer,u);c&&(ch(qv(this._lContainer),u),Sh(c[1],c))}detach(o){const u=this._adjustIndex(o,-1),c=Th(this._lContainer,u);return c&&null!=ch(qv(this._lContainer),u)?new Yh(c):null}_adjustIndex(o,u=0){return o??this.length+u}};function um(s){return s[8]}function qv(s){return s[8]||(s[8]=[])}function Or(s,o){let u;const c=o[s.index];if(vi(c))u=c;else{let d;if(8&s.type)d=P(c);else{const f=o[11];d=f.createComment("");const y=Fe(s,o);ol(f,xh(f,y),d,function Gw(s,o){return s.nextSibling(o)}(f,y),!1)}o[s.index]=u=xy(c,o,d,s),Wh(o,u)}return new Ll(u,s,o)}class mn{constructor(o){this.queryList=o,this.matches=null}clone(){return new mn(this.queryList)}setDirty(){this.queryList.setDirty()}}class lm{constructor(o=[]){this.queries=o}createEmbeddedView(o){const u=o.queries;if(null!==u){const c=null!==o.contentQueries?o.contentQueries[0]:u.length,d=[];for(let f=0;f<c;f++){const y=u.getByIndex(f);d.push(this.queries[y.indexInDeclarationView].clone())}return new lm(d)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let u=0;u<this.queries.length;u++)null!==Bf(o,u).matches&&this.queries[u].setDirty()}}class Kv{constructor(o,u,c=null){this.predicate=o,this.flags=u,this.read=c}}class Ao{constructor(o=[]){this.queries=o}elementStart(o,u){for(let c=0;c<this.queries.length;c++)this.queries[c].elementStart(o,u)}elementEnd(o){for(let u=0;u<this.queries.length;u++)this.queries[u].elementEnd(o)}embeddedTView(o){let u=null;for(let c=0;c<this.length;c++){const d=null!==u?u.length:0,f=this.getByIndex(c).embeddedTView(o,d);f&&(f.indexInDeclarationView=c,null!==u?u.push(f):u=[f])}return null!==u?new Ao(u):null}template(o,u){for(let c=0;c<this.queries.length;c++)this.queries[c].template(o,u)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class Zv{constructor(o,u=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=u}elementStart(o,u){this.isApplyingToNode(u)&&this.matchTNode(o,u)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,u){this.elementStart(o,u)}embeddedTView(o,u){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,u),new Zv(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const u=this._declarationNodeIndex;let c=o.parent;for(;null!==c&&8&c.type&&c.index!==u;)c=c.parent;return u===(null!==c?c.index:-1)}return this._appliesToNextNode}matchTNode(o,u){const c=this.metadata.predicate;if(Array.isArray(c))for(let d=0;d<c.length;d++){const f=c[d];this.matchTNodeWithReadOption(o,u,Ki(u,f)),this.matchTNodeWithReadOption(o,u,Wu(u,o,f,!1,!1))}else c===ba?4&u.type&&this.matchTNodeWithReadOption(o,u,-1):this.matchTNodeWithReadOption(o,u,Wu(u,o,c,!1,!1))}matchTNodeWithReadOption(o,u,c){if(null!==c){const d=this.metadata.read;if(null!==d)if(d===Bh||d===Lf||d===ba&&4&u.type)this.addMatch(u.index,-2);else{const f=Wu(u,o,d,!1,!1);null!==f&&this.addMatch(u.index,f)}else this.addMatch(u.index,c)}}addMatch(o,u){null===this.matches?this.matches=[o,u]:this.matches.push(o,u)}}function Ki(s,o){const u=s.localNames;if(null!==u)for(let c=0;c<u.length;c+=2)if(u[c]===o)return u[c+1];return null}function Ff(s,o,u,c){return-1===u?function lb(s,o){return 11&s.type?gl(s,o):4&s.type?Fs(s,o):null}(o,s):-2===u?function cb(s,o,u){return u===Bh?gl(o,s):u===ba?Fs(o,s):u===Lf?Or(o,s):void 0}(s,o,c):_o(s,s[1],u,o)}function ro(s,o,u,c){const d=o[19].queries[c];if(null===d.matches){const f=s.data,y=u.matches,E=[];for(let b=0;b<y.length;b+=2){const D=y[b];E.push(D<0?null:Ff(o,f[D],y[b+1],u.metadata.read))}d.matches=E}return d.matches}function cm(s,o,u,c){const d=s.queries.getByIndex(u),f=d.matches;if(null!==f){const y=ro(s,o,d,u);for(let E=0;E<f.length;E+=2){const b=f[E];if(b>0)c.push(y[E/2]);else{const D=f[E+1],A=o[-b];for(let V=10;V<A.length;V++){const ee=A[V];ee[17]===ee[3]&&cm(ee[1],ee,D,c)}if(null!==A[9]){const V=A[9];for(let ee=0;ee<V.length;ee++){const ce=V[ee];cm(ce[1],ce,D,c)}}}}}return c}function Id(s){const o=je(),u=hn(),c=a_();Sp(c+1);const d=Bf(u,c);if(s.dirty&&function Xr(s){return 4==(4&s[2])}(o)===(2==(2&d.metadata.flags))){if(null===d.matches)s.reset([]);else{const f=d.crossesNgTemplate?cm(u,o,c,[]):ro(u,o,d,c);s.reset(f,zD),s.notifyOnChanges()}return!0}return!1}function db(s,o,u){const c=hn();c.firstCreatePass&&(bd(c,new Kv(s,o,u),-1),2==(2&o)&&(c.staticViewQueries=!0)),Uf(c,je(),o)}function hb(s,o,u,c){const d=hn();if(d.firstCreatePass){const f=Ur();bd(d,new Kv(o,u,c),f.index),function Vf(s,o){const u=s.contentQueries||(s.contentQueries=[]);o!==(u.length?u[u.length-1]:-1)&&u.push(s.queries.length-1,o)}(d,s),2==(2&u)&&(d.staticContentQueries=!0)}Uf(d,je(),u)}function Jt(){return function sS(s,o){return s[19].queries[o].queryList}(je(),a_())}function Uf(s,o,u){const c=new Wv(4==(4&u));Gt(s,o,c,c.destroy),null===o[19]&&(o[19]=new lm),o[19].queries.push(new mn(c))}function bd(s,o,u){null===s.queries&&(s.queries=new Ao),s.queries.track(new Zv(o,u))}function Bf(s,o){return s.queries.getByIndex(o)}function pm(...s){}const r0=new Rn("Application Initializer");let gm=(()=>{class s{constructor(u){this.appInits=u,this.resolve=pm,this.reject=pm,this.initialized=!1,this.done=!1,this.donePromise=new Promise((c,d)=>{this.resolve=c,this.reject=d})}runInitializers(){if(this.initialized)return;const u=[],c=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let d=0;d<this.appInits.length;d++){const f=this.appInits[d]();if(Og(f))u.push(f);else if(nd(f)){const y=new Promise((E,b)=>{f.subscribe({complete:E,error:b})});u.push(y)}}Promise.all(u).then(()=>{c()}).catch(d=>{this.reject(d)}),0===u.length&&c(),this.initialized=!0}}return s.\u0275fac=function(u){return new(u||s)(B(r0,8))},s.\u0275prov=at({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();const s0=new Rn("AppId",{providedIn:"root",factory:function o0(){return`${zf()}${zf()}${zf()}`}});function zf(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const ti=new Rn("Platform Initializer"),a0=new Rn("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),mm=new Rn("appBootstrapListener");let Db=(()=>{class s{log(u){console.log(u)}warn(u){console.warn(u)}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=at({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();const Wf=new Rn("LocaleId",{providedIn:"root",factory:()=>K(Wf,rt.Optional|rt.SkipSelf)||function wS(){return typeof $localize<"u"&&$localize.locale||cd}()}),_m=new Rn("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class qf{constructor(o,u){this.ngModuleFactory=o,this.componentFactories=u}}let Tb=(()=>{class s{compileModuleSync(u){return new Vv(u)}compileModuleAsync(u){return Promise.resolve(this.compileModuleSync(u))}compileModuleAndAllComponentsSync(u){const c=this.compileModuleSync(u),f=da(Sn(u).declarations).reduce((y,E)=>{const b=yt(E);return b&&y.push(new Xh(b)),y},[]);return new qf(c,f)}compileModuleAndAllComponentsAsync(u){return Promise.resolve(this.compileModuleAndAllComponentsSync(u))}clearCache(){}clearCacheFor(u){}getModuleId(u){}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=at({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();const ym=(()=>Promise.resolve(0))();function Bl(s){typeof Zone>"u"?ym.then(()=>{s&&s.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",s)}class ps{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:u=!1,shouldCoalesceRunChangeDetection:c=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new fs(!1),this.onMicrotaskEmpty=new fs(!1),this.onStable=new fs(!1),this.onError=new fs(!1),typeof Zone>"u")throw new ve(908,!1);Zone.assertZonePatched();const d=this;d._nesting=0,d._outer=d._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(d._inner=d._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(d._inner=d._inner.fork(Zone.longStackTraceZoneSpec)),d.shouldCoalesceEventChangeDetection=!c&&u,d.shouldCoalesceRunChangeDetection=c,d.lastRequestAnimationFrameId=-1,d.nativeRequestAnimationFrame=function jl(){let s=bt.requestAnimationFrame,o=bt.cancelAnimationFrame;if(typeof Zone<"u"&&s&&o){const u=s[Zone.__symbol__("OriginalDelegate")];u&&(s=u);const c=o[Zone.__symbol__("OriginalDelegate")];c&&(o=c)}return{nativeRequestAnimationFrame:s,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function Kf(s){const o=()=>{!function bS(s){s.isCheckStableRunning||-1!==s.lastRequestAnimationFrameId||(s.lastRequestAnimationFrameId=s.nativeRequestAnimationFrame.call(bt,()=>{s.fakeTopEventTask||(s.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{s.lastRequestAnimationFrameId=-1,Da(s),s.isCheckStableRunning=!0,c0(s),s.isCheckStableRunning=!1},void 0,()=>{},()=>{})),s.fakeTopEventTask.invoke()}),Da(s))}(s)};s._inner=s._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(u,c,d,f,y,E)=>{try{return Tu(s),u.invokeTask(d,f,y,E)}finally{(s.shouldCoalesceEventChangeDetection&&"eventTask"===f.type||s.shouldCoalesceRunChangeDetection)&&o(),d0(s)}},onInvoke:(u,c,d,f,y,E,b)=>{try{return Tu(s),u.invoke(d,f,y,E,b)}finally{s.shouldCoalesceRunChangeDetection&&o(),d0(s)}},onHasTask:(u,c,d,f)=>{u.hasTask(d,f),c===d&&("microTask"==f.change?(s._hasPendingMicrotasks=f.microTask,Da(s),c0(s)):"macroTask"==f.change&&(s.hasPendingMacrotasks=f.macroTask))},onHandleError:(u,c,d,f)=>(u.handleError(d,f),s.runOutsideAngular(()=>s.onError.emit(f)),!1)})}(d)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!ps.isInAngularZone())throw new ve(909,!1)}static assertNotInAngularZone(){if(ps.isInAngularZone())throw new ve(909,!1)}run(o,u,c){return this._inner.run(o,u,c)}runTask(o,u,c,d){const f=this._inner,y=f.scheduleEventTask("NgZoneEvent: "+d,o,IS,pm,pm);try{return f.runTask(y,u,c)}finally{f.cancelTask(y)}}runGuarded(o,u,c){return this._inner.runGuarded(o,u,c)}runOutsideAngular(o){return this._outer.run(o)}}const IS={};function c0(s){if(0==s._nesting&&!s.hasPendingMicrotasks&&!s.isStable)try{s._nesting++,s.onMicrotaskEmpty.emit(null)}finally{if(s._nesting--,!s.hasPendingMicrotasks)try{s.runOutsideAngular(()=>s.onStable.emit(null))}finally{s.isStable=!0}}}function Da(s){s.hasPendingMicrotasks=!!(s._hasPendingMicrotasks||(s.shouldCoalesceEventChangeDetection||s.shouldCoalesceRunChangeDetection)&&-1!==s.lastRequestAnimationFrameId)}function Tu(s){s._nesting++,s.isStable&&(s.isStable=!1,s.onUnstable.emit(null))}function d0(s){s._nesting--,c0(s)}class CS{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new fs,this.onMicrotaskEmpty=new fs,this.onStable=new fs,this.onError=new fs}run(o,u,c){return o.apply(u,c)}runGuarded(o,u,c){return o.apply(u,c)}runOutsideAngular(o){return o()}runTask(o,u,c,d){return o.apply(u,c)}}const xb=new Rn(""),vm=new Rn("");let $l,wm=(()=>{class s{constructor(u,c,d){this._ngZone=u,this.registry=c,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,$l||(function Pb(s){$l=s}(d),d.addToWindow(c)),this._watchAngularEvents(),u.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ps.assertNotInAngularZone(),Bl(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Bl(()=>{for(;0!==this._callbacks.length;){let u=this._callbacks.pop();clearTimeout(u.timeoutId),u.doneCb(this._didWork)}this._didWork=!1});else{let u=this.getPendingTasks();this._callbacks=this._callbacks.filter(c=>!c.updateCb||!c.updateCb(u)||(clearTimeout(c.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(u=>({source:u.source,creationLocation:u.creationLocation,data:u.data})):[]}addCallback(u,c,d){let f=-1;c&&c>0&&(f=setTimeout(()=>{this._callbacks=this._callbacks.filter(y=>y.timeoutId!==f),u(this._didWork,this.getPendingTasks())},c)),this._callbacks.push({doneCb:u,timeoutId:f,updateCb:d})}whenStable(u,c,d){if(d&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(u,c,d),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(u){this.registry.registerApplication(u,this)}unregisterApplication(u){this.registry.unregisterApplication(u)}findProviders(u,c,d){return[]}}return s.\u0275fac=function(u){return new(u||s)(B(ps),B(Mb),B(vm))},s.\u0275prov=at({token:s,factory:s.\u0275fac}),s})(),Mb=(()=>{class s{constructor(){this._applications=new Map}registerApplication(u,c){this._applications.set(u,c)}unregisterApplication(u){this._applications.delete(u)}unregisterAllApplications(){this._applications.clear()}getTestability(u){return this._applications.get(u)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(u,c=!0){return $l?.findTestabilityInTree(this,u,c)??null}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=at({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})(),io=null;const xd=new Rn("AllowMultipleToken"),Em=new Rn("PlatformDestroyListeners");class bm{constructor(o,u){this.name=o,this.token=u}}function Au(s,o,u=[]){const c=`Platform: ${o}`,d=new Rn(c);return(f=[])=>{let y=Po();if(!y||y.injector.get(xd,!1)){const E=[...u,...f,{provide:d,useValue:!0}];s?s(E):function kb(s){if(io&&!io.get(xd,!1))throw new ve(400,!1);io=s;const o=s.get(h0);(function Hl(s){const o=s.get(ti,null);o&&o.forEach(u=>u())})(s)}(function Gl(s=[],o){return ml.create({name:o,providers:[{provide:ry,useValue:"platform"},{provide:Em,useValue:new Set([()=>io=null])},...s]})}(E,c))}return function SS(s){const o=Po();if(!o)throw new ve(401,!1);return o}()}}function Po(){return io?.get(h0)??null}let h0=(()=>{class s{constructor(u){this._injector=u,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(u,c){const d=function Ob(s,o){let u;return u="noop"===s?new CS:("zone.js"===s?void 0:s)||new ps(o),u}(c?.ngZone,function Nb(s){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!s||!s.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!s||!s.ngZoneRunCoalescing)||!1}}(c)),f=[{provide:ps,useValue:d}];return d.run(()=>{const y=ml.create({providers:f,parent:this.injector,name:u.moduleType.name}),E=u.create(y),b=E.injector.get(jh,null);if(!b)throw new ve(402,!1);return d.runOutsideAngular(()=>{const D=d.onError.subscribe({next:A=>{b.handleError(A)}});E.onDestroy(()=>{Zf(this._modules,E),D.unsubscribe()})}),function Lb(s,o,u){try{const c=u();return Og(c)?c.catch(d=>{throw o.runOutsideAngular(()=>s.handleError(d)),d}):c}catch(c){throw o.runOutsideAngular(()=>s.handleError(c)),c}}(b,d,()=>{const D=E.injector.get(gm);return D.runInitializers(),D.donePromise.then(()=>(function zT(s){Ut(s,"Expected localeId to be defined"),"string"==typeof s&&(DI=s.toLowerCase().replace(/_/g,"-"))}(E.injector.get(Wf,cd)||cd),this._moduleDoBootstrap(E),E))})})}bootstrapModule(u,c=[]){const d=Fb({},c);return function Zi(s,o,u){const c=new Vv(u);return Promise.resolve(c)}(0,0,u).then(f=>this.bootstrapModuleFactory(f,d))}_moduleDoBootstrap(u){const c=u.injector.get(zl);if(u._bootstrapComponents.length>0)u._bootstrapComponents.forEach(d=>c.bootstrap(d));else{if(!u.instance.ngDoBootstrap)throw new ve(403,!1);u.instance.ngDoBootstrap(c)}this._modules.push(u)}onDestroy(u){this._destroyListeners.push(u)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ve(404,!1);this._modules.slice().forEach(c=>c.destroy()),this._destroyListeners.forEach(c=>c());const u=this._injector.get(Em,null);u&&(u.forEach(c=>c()),u.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return s.\u0275fac=function(u){return new(u||s)(B(ml))},s.\u0275prov=at({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();function Fb(s,o){return Array.isArray(o)?o.reduce(Fb,s):{...s,...o}}let zl=(()=>{class s{constructor(u,c,d){this._zone=u,this._injector=c,this._exceptionHandler=d,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const f=new k.y(E=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{E.next(this._stable),E.complete()})}),y=new k.y(E=>{let b;this._zone.runOutsideAngular(()=>{b=this._zone.onStable.subscribe(()=>{ps.assertNotInAngularZone(),Bl(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,E.next(!0))})})});const D=this._zone.onUnstable.subscribe(()=>{ps.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{E.next(!1)}))});return()=>{b.unsubscribe(),D.unsubscribe()}});this.isStable=(0,oe.T)(f,y.pipe((0,me.B)()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(u,c){const d=u instanceof Uh;if(!this._injector.get(gm).done)throw!d&&Wr(u),new ve(405,false);let y;y=d?u:this._injector.get(jc).resolveComponentFactory(u),this.componentTypes.push(y.componentType);const E=function Im(s){return s.isBoundToModule}(y)?void 0:this._injector.get(wa),D=y.create(ml.NULL,[],c||y.selector,E),A=D.location.nativeElement,V=D.injector.get(xb,null);return V?.registerApplication(A),D.onDestroy(()=>{this.detachView(D.hostView),Zf(this.components,D),V?.unregisterApplication(A)}),this._loadComponent(D),D}tick(){if(this._runningTick)throw new ve(101,!1);try{this._runningTick=!0;for(let u of this._views)u.detectChanges()}catch(u){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(u))}finally{this._runningTick=!1}}attachView(u){const c=u;this._views.push(c),c.attachToAppRef(this)}detachView(u){const c=u;Zf(this._views,c),c.detachFromAppRef()}_loadComponent(u){this.attachView(u.hostView),this.tick(),this.components.push(u);const c=this._injector.get(mm,[]);c.push(...this._bootstrapListeners),c.forEach(d=>d(u))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(u=>u()),this._views.slice().forEach(u=>u.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(u){return this._destroyListeners.push(u),()=>Zf(this._destroyListeners,u)}destroy(){if(this._destroyed)throw new ve(406,!1);const u=this._injector;u.destroy&&!u.destroyed&&u.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return s.\u0275fac=function(u){return new(u||s)(B(ps),B(pl),B(jh))},s.\u0275prov=at({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();function Zf(s,o){const u=s.indexOf(o);u>-1&&s.splice(u,1)}function RS(){return!1}let Bb=(()=>{class s{}return s.__NG_ELEMENT_ID__=MS,s})();function MS(s){return function jb(s,o,u){if(Ho(s)&&!u){const c=dn(s.index,o);return new Yh(c,c)}return 47&s.type?new Yh(o[16],o):null}(Ur(),je(),16==(16&s))}class g0{constructor(){}supports(o){return Jh(o)}create(o){return new LS(o)}}const m0=(s,o)=>o;class LS{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||m0}forEachItem(o){let u;for(u=this._itHead;null!==u;u=u._next)o(u)}forEachOperation(o){let u=this._itHead,c=this._removalsHead,d=0,f=null;for(;u||c;){const y=!c||u&&u.currentIndex<Kb(c,d,f)?u:c,E=Kb(y,d,f),b=y.currentIndex;if(y===c)d--,c=c._nextRemoved;else if(u=u._next,null==y.previousIndex)d++;else{f||(f=[]);const D=E-d,A=b-d;if(D!=A){for(let ee=0;ee<D;ee++){const ce=ee<f.length?f[ee]:f[ee]=0,Ae=ce+ee;A<=Ae&&Ae<D&&(f[ee]=ce+1)}f[y.previousIndex]=A-D}}E!==b&&o(y,E,b)}}forEachPreviousItem(o){let u;for(u=this._previousItHead;null!==u;u=u._nextPrevious)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachMovedItem(o){let u;for(u=this._movesHead;null!==u;u=u._nextMoved)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}forEachIdentityChange(o){let u;for(u=this._identityChangesHead;null!==u;u=u._nextIdentityChange)o(u)}diff(o){if(null==o&&(o=[]),!Jh(o))throw new ve(900,!1);return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let d,f,y,u=this._itHead,c=!1;if(Array.isArray(o)){this.length=o.length;for(let E=0;E<this.length;E++)f=o[E],y=this._trackByFn(E,f),null!==u&&Object.is(u.trackById,y)?(c&&(u=this._verifyReinsertion(u,f,y,E)),Object.is(u.item,f)||this._addIdentityChange(u,f)):(u=this._mismatch(u,f,y,E),c=!0),u=u._next}else d=0,function qE(s,o){if(Array.isArray(s))for(let u=0;u<s.length;u++)o(s[u]);else{const u=s[ha()]();let c;for(;!(c=u.next()).done;)o(c.value)}}(o,E=>{y=this._trackByFn(d,E),null!==u&&Object.is(u.trackById,y)?(c&&(u=this._verifyReinsertion(u,E,y,d)),Object.is(u.item,E)||this._addIdentityChange(u,E)):(u=this._mismatch(u,E,y,d),c=!0),u=u._next,d++}),this.length=d;return this._truncate(u),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,u,c,d){let f;return null===o?f=this._itTail:(f=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._reinsertAfter(o,f,d)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(c,d))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._moveAfter(o,f,d)):o=this._addAfter(new qb(u,c),f,d),o}_verifyReinsertion(o,u,c,d){let f=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null);return null!==f?o=this._reinsertAfter(f,o._prev,d):o.currentIndex!=d&&(o.currentIndex=d,this._addToMoves(o,d)),o}_truncate(o){for(;null!==o;){const u=o._next;this._addToRemovals(this._unlink(o)),o=u}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,u,c){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const d=o._prevRemoved,f=o._nextRemoved;return null===d?this._removalsHead=f:d._nextRemoved=f,null===f?this._removalsTail=d:f._prevRemoved=d,this._insertAfter(o,u,c),this._addToMoves(o,c),o}_moveAfter(o,u,c){return this._unlink(o),this._insertAfter(o,u,c),this._addToMoves(o,c),o}_addAfter(o,u,c){return this._insertAfter(o,u,c),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,u,c){const d=null===u?this._itHead:u._next;return o._next=d,o._prev=u,null===d?this._itTail=o:d._prev=o,null===u?this._itHead=o:u._next=o,null===this._linkedRecords&&(this._linkedRecords=new _0),this._linkedRecords.put(o),o.currentIndex=c,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const u=o._prev,c=o._next;return null===u?this._itHead=c:u._next=c,null===c?this._itTail=u:c._prev=u,o}_addToMoves(o,u){return o.previousIndex===u||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new _0),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,u){return o.item=u,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class qb{constructor(o,u){this.item=o,this.trackById=u,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class FS{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,u){let c;for(c=this._head;null!==c;c=c._nextDup)if((null===u||u<=c.currentIndex)&&Object.is(c.trackById,o))return c;return null}remove(o){const u=o._prevDup,c=o._nextDup;return null===u?this._head=c:u._nextDup=c,null===c?this._tail=u:c._prevDup=u,null===this._head}}class _0{constructor(){this.map=new Map}put(o){const u=o.trackById;let c=this.map.get(u);c||(c=new FS,this.map.set(u,c)),c.add(o)}get(o,u){const d=this.map.get(o);return d?d.get(o,u):null}remove(o){const u=o.trackById;return this.map.get(u).remove(o)&&this.map.delete(u),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Kb(s,o,u){const c=s.previousIndex;if(null===c)return c;let d=0;return u&&c<u.length&&(d=u[c]),c+o+d}class ql{constructor(){}supports(o){return o instanceof Map||qy(o)}create(){return new Nd}}class Nd{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let u;for(u=this._mapHead;null!==u;u=u._next)o(u)}forEachPreviousItem(o){let u;for(u=this._previousMapHead;null!==u;u=u._nextPrevious)o(u)}forEachChangedItem(o){let u;for(u=this._changesHead;null!==u;u=u._nextChanged)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}diff(o){if(o){if(!(o instanceof Map||qy(o)))throw new ve(900,!1)}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let u=this._mapHead;if(this._appendAfter=null,this._forEach(o,(c,d)=>{if(u&&u.key===d)this._maybeAddToChanges(u,c),this._appendAfter=u,u=u._next;else{const f=this._getOrCreateRecordForKey(d,c);u=this._insertBeforeOrAppend(u,f)}}),u){u._prev&&(u._prev._next=null),this._removalsHead=u;for(let c=u;null!==c;c=c._nextRemoved)c===this._mapHead&&(this._mapHead=null),this._records.delete(c.key),c._nextRemoved=c._next,c.previousValue=c.currentValue,c.currentValue=null,c._prev=null,c._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,u){if(o){const c=o._prev;return u._next=o,u._prev=c,o._prev=u,c&&(c._next=u),o===this._mapHead&&(this._mapHead=u),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=u,u._prev=this._appendAfter):this._mapHead=u,this._appendAfter=u,null}_getOrCreateRecordForKey(o,u){if(this._records.has(o)){const d=this._records.get(o);this._maybeAddToChanges(d,u);const f=d._prev,y=d._next;return f&&(f._next=y),y&&(y._prev=f),d._next=null,d._prev=null,d}const c=new y0(o);return this._records.set(o,c),c.currentValue=u,this._addToAdditions(c),c}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,u){Object.is(u,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=u,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,u){o instanceof Map?o.forEach(u):Object.keys(o).forEach(c=>u(o[c],c))}}class y0{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Qf(){return new Sm([new g0])}let Sm=(()=>{class s{constructor(u){this.factories=u}static create(u,c){if(null!=c){const d=c.factories.slice();u=u.concat(d)}return new s(u)}static extend(u){return{provide:s,useFactory:c=>s.create(u,c||Qf()),deps:[[s,new Xu,new Hi]]}}find(u){const c=this.factories.find(d=>d.supports(u));if(null!=c)return c;throw new ve(901,!1)}}return s.\u0275prov=at({token:s,providedIn:"root",factory:Qf}),s})();function v0(){return new w0([new ql])}let w0=(()=>{class s{constructor(u){this.factories=u}static create(u,c){if(c){const d=c.factories.slice();u=u.concat(d)}return new s(u)}static extend(u){return{provide:s,useFactory:c=>s.create(u,c||v0()),deps:[[s,new Xu,new Hi]]}}find(u){const c=this.factories.find(d=>d.supports(u));if(c)return c;throw new ve(901,!1)}}return s.\u0275prov=at({token:s,providedIn:"root",factory:v0}),s})();const Yb=Au(null,"core",[]);let I0=(()=>{class s{constructor(u){}}return s.\u0275fac=function(u){return new(u||s)(B(zl))},s.\u0275mod=re({type:s}),s.\u0275inj=Gr({}),s})();function Am(s){return"boolean"==typeof s?s:null!=s&&"false"!==s}},3942:(ft,Pe,M)=>{"use strict";M.d(Pe,{Z:()=>Ke});var g=M(2090),j=M(4859),k=M(9681),oe=M(1877);class me{constructor(ve,xe){this._delegate=ve,this.firebase=xe,(0,k._addComponent)(ve,new j.wA("app-compat",()=>this,"PUBLIC")),this.container=ve.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(ve){this._delegate.automaticDataCollectionEnabled=ve}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(ve=>{this._delegate.checkDestroyed(),ve()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,k.deleteApp)(this._delegate)))}_getService(ve,xe=k._DEFAULT_ENTRY_NAME){var ke;this._delegate.checkDestroyed();const Ne=this._delegate.container.getProvider(ve);return!Ne.isInitialized()&&"EXPLICIT"===(null===(ke=Ne.getComponent())||void 0===ke?void 0:ke.instantiationMode)&&Ne.initialize(),Ne.getImmediate({identifier:xe})}_removeServiceInstance(ve,xe=k._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(ve).clearInstance(xe)}_addComponent(ve){(0,k._addComponent)(this._delegate,ve)}_addOrOverwriteComponent(ve){(0,k._addOrOverwriteComponent)(this._delegate,ve)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const we=new g.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),z=function ye(){const Xe=function _e(Xe){const ve={},xe={__esModule:!0,initializeApp:function Ve(q,se={}){const Ee=k.initializeApp(q,se);if((0,g.r3)(ve,Ee.name))return ve[Ee.name];const Q=new Xe(Ee,xe);return ve[Ee.name]=Q,Q},app:Ne,registerVersion:k.registerVersion,setLogLevel:k.setLogLevel,onLog:k.onLog,apps:null,SDK_VERSION:k.SDK_VERSION,INTERNAL:{registerComponent:function ae(q){const se=q.name,Ee=se.replace("-compat","");if(k._registerComponent(q)&&"PUBLIC"===q.type){const Q=(X=Ne())=>{if("function"!=typeof X[Ee])throw we.create("invalid-app-argument",{appName:se});return X[Ee]()};void 0!==q.serviceProps&&(0,g.ZB)(Q,q.serviceProps),xe[Ee]=Q,Xe.prototype[Ee]=function(...X){return this._getService.bind(this,se).apply(this,q.multipleInstances?X:[])}}return"PUBLIC"===q.type?xe[Ee]:null},removeApp:function ke(q){delete ve[q]},useAsService:function De(q,se){return"serverAuth"===se?null:se},modularAPIs:k}};function Ne(q){if(!(0,g.r3)(ve,q=q||k._DEFAULT_ENTRY_NAME))throw we.create("no-app",{appName:q});return ve[q]}return xe.default=xe,Object.defineProperty(xe,"apps",{get:function Ue(){return Object.keys(ve).map(q=>ve[q])}}),Ne.App=Xe,xe}(me);return Xe.INTERNAL=Object.assign(Object.assign({},Xe.INTERNAL),{createFirebaseNamespace:ye,extendNamespace:function ve(xe){(0,g.ZB)(Xe,xe)},createSubscribe:g.ne,ErrorFactory:g.LL,deepExtend:g.ZB}),Xe}(),H=new oe.Yd("@firebase/app-compat");if((0,g.jU)()&&void 0!==self.firebase){H.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Xe=self.firebase.SDK_VERSION;Xe&&Xe.indexOf("LITE")>=0&&H.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const Ke=z;!function Te(Xe){(0,k.registerVersion)("@firebase/app-compat","0.1.30",Xe)}()},9681:(ft,Pe,M)=>{"use strict";M.r(Pe),M.d(Pe,{FirebaseError:()=>oe.ZR,SDK_VERSION:()=>zr,_DEFAULT_ENTRY_NAME:()=>rn,_addComponent:()=>ln,_addOrOverwriteComponent:()=>Wn,_apps:()=>Ut,_clearComponents:()=>Gr,_components:()=>xt,_getProvider:()=>at,_registerComponent:()=>Vt,_removeServiceInstance:()=>Nn,deleteApp:()=>Dr,getApp:()=>Hn,getApps:()=>Jn,initializeApp:()=>gr,onLog:()=>rt,registerVersion:()=>bn,setLogLevel:()=>Pn});var g=M(5861),j=M(4859),k=M(1877),oe=M(2090),me=M(8766);class he{constructor(W){this.container=W}getPlatformInfoString(){return this.container.getProviders().map(K=>{if(function we(B){return"VERSION"===B.getComponent()?.type}(K)){const Me=K.getImmediate();return`${Me.library}/${Me.version}`}return null}).filter(K=>K).join(" ")}}const _e="@firebase/app",z=new k.Yd("@firebase/app"),rn="[DEFAULT]",pt={[_e]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Ut=new Map,xt=new Map;function ln(B,W){try{B.container.addComponent(W)}catch(K){z.debug(`Component ${W.name} failed to register with FirebaseApp ${B.name}`,K)}}function Wn(B,W){B.container.addOrOverwriteComponent(W)}function Vt(B){const W=B.name;if(xt.has(W))return z.debug(`There were multiple attempts to register component ${W}.`),!1;xt.set(W,B);for(const K of Ut.values())ln(K,B);return!0}function at(B,W){const K=B.container.getProvider("heartbeat").getImmediate({optional:!0});return K&&K.triggerHeartbeat(),B.container.getProvider(W)}function Nn(B,W,K=rn){at(B,W).clearInstance(K)}function Gr(){xt.clear()}const Tn=new oe.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."});class qn{constructor(W,K,Me){this._isDeleted=!1,this._options=Object.assign({},W),this._config=Object.assign({},K),this._name=K.name,this._automaticDataCollectionEnabled=K.automaticDataCollectionEnabled,this._container=Me,this.container.addComponent(new j.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(W){this.checkDestroyed(),this._automaticDataCollectionEnabled=W}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(W){this._isDeleted=W}checkDestroyed(){if(this.isDeleted)throw Tn.create("app-deleted",{appName:this._name})}}const zr="9.9.1";function gr(B,W={}){"object"!=typeof W&&(W={name:W});const K=Object.assign({name:rn,automaticDataCollectionEnabled:!1},W),Me=K.name;if("string"!=typeof Me||!Me)throw Tn.create("bad-app-name",{appName:String(Me)});const Qe=Ut.get(Me);if(Qe){if((0,oe.vZ)(B,Qe.options)&&(0,oe.vZ)(K,Qe.config))return Qe;throw Tn.create("duplicate-app",{appName:Me})}const gt=new j.H0(Me);for(const an of xt.values())gt.addComponent(an);const en=new qn(B,K,gt);return Ut.set(Me,en),en}function Hn(B=rn){const W=Ut.get(B);if(!W)throw Tn.create("no-app",{appName:B});return W}function Jn(){return Array.from(Ut.values())}function Dr(B){return yn.apply(this,arguments)}function yn(){return(yn=(0,g.Z)(function*(B){const W=B.name;Ut.has(W)&&(Ut.delete(W),yield Promise.all(B.container.getProviders().map(K=>K.delete())),B.isDeleted=!0)})).apply(this,arguments)}function bn(B,W,K){var Me;let Qe=null!==(Me=pt[B])&&void 0!==Me?Me:B;K&&(Qe+=`-${K}`);const gt=Qe.match(/\s|\//),en=W.match(/\s|\//);if(gt||en){const an=[`Unable to register library "${Qe}" with version "${W}":`];return gt&&an.push(`library name "${Qe}" contains illegal characters (whitespace or "/")`),gt&&en&&an.push("and"),en&&an.push(`version name "${W}" contains illegal characters (whitespace or "/")`),void z.warn(an.join(" "))}Vt(new j.wA(`${Qe}-version`,()=>({library:Qe,version:W}),"VERSION"))}function rt(B,W){if(null!==B&&"function"!=typeof B)throw Tn.create("invalid-log-argument");(0,k.Am)(B,W)}function Pn(B){(0,k.Ub)(B)}const Bn="firebase-heartbeat-store";let Tr=null;function bt(){return Tr||(Tr=(0,me.X3)("firebase-heartbeat-database",1,{upgrade:(B,W)=>{0===W&&B.createObjectStore(Bn)}}).catch(B=>{throw Tn.create("storage-open",{originalErrorMessage:B.message})})),Tr}function Dt(){return(Dt=(0,g.Z)(function*(B){var W;try{return(yield bt()).transaction(Bn).objectStore(Bn).get(Kn(B))}catch(K){throw Tn.create("storage-get",{originalErrorMessage:null===(W=K)||void 0===W?void 0:W.message})}})).apply(this,arguments)}function Yt(B,W){return on.apply(this,arguments)}function on(){return(on=(0,g.Z)(function*(B,W){var K;try{const Qe=(yield bt()).transaction(Bn,"readwrite");return yield Qe.objectStore(Bn).put(W,Kn(B)),Qe.done}catch(Me){throw Tn.create("storage-set",{originalErrorMessage:null===(K=Me)||void 0===K?void 0:K.message})}})).apply(this,arguments)}function Kn(B){return`${B.name}!${B.options.appId}`}class Sr{constructor(W){this.container=W,this._heartbeatsCache=null;const K=this.container.getProvider("app").getImmediate();this._storage=new Nt(K),this._heartbeatsCachePromise=this._storage.read().then(Me=>(this._heartbeatsCache=Me,Me))}triggerHeartbeat(){var W=this;return(0,g.Z)(function*(){const Me=W.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),Qe=Pt();if(null===W._heartbeatsCache&&(W._heartbeatsCache=yield W._heartbeatsCachePromise),W._heartbeatsCache.lastSentHeartbeatDate!==Qe&&!W._heartbeatsCache.heartbeats.some(gt=>gt.date===Qe))return W._heartbeatsCache.heartbeats.push({date:Qe,agent:Me}),W._heartbeatsCache.heartbeats=W._heartbeatsCache.heartbeats.filter(gt=>{const en=new Date(gt.date).valueOf();return Date.now()-en<=2592e6}),W._storage.overwrite(W._heartbeatsCache)})()}getHeartbeatsHeader(){var W=this;return(0,g.Z)(function*(){if(null===W._heartbeatsCache&&(yield W._heartbeatsCachePromise),null===W._heartbeatsCache||0===W._heartbeatsCache.heartbeats.length)return"";const K=Pt(),{heartbeatsToSend:Me,unsentEntries:Qe}=function mr(B,W=1024){const K=[];let Me=B.slice();for(const Qe of B){const gt=K.find(en=>en.agent===Qe.agent);if(gt){if(gt.dates.push(Qe.date),J(K)>W){gt.dates.pop();break}}else if(K.push({agent:Qe.agent,dates:[Qe.date]}),J(K)>W){K.pop();break}Me=Me.slice(1)}return{heartbeatsToSend:K,unsentEntries:Me}}(W._heartbeatsCache.heartbeats),gt=(0,oe.L)(JSON.stringify({version:2,heartbeats:Me}));return W._heartbeatsCache.lastSentHeartbeatDate=K,Qe.length>0?(W._heartbeatsCache.heartbeats=Qe,yield W._storage.overwrite(W._heartbeatsCache)):(W._heartbeatsCache.heartbeats=[],W._storage.overwrite(W._heartbeatsCache)),gt})()}}function Pt(){return(new Date).toISOString().substring(0,10)}class Nt{constructor(W){this.app=W,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,g.Z)(function*(){return!!(0,oe.hl)()&&(0,oe.eu)().then(()=>!0).catch(()=>!1)})()}read(){var W=this;return(0,g.Z)(function*(){return(yield W._canUseIndexedDBPromise)&&(yield function lt(B){return Dt.apply(this,arguments)}(W.app))||{heartbeats:[]}})()}overwrite(W){var K=this;return(0,g.Z)(function*(){var Me;if(yield K._canUseIndexedDBPromise){const gt=yield K.read();return Yt(K.app,{lastSentHeartbeatDate:null!==(Me=W.lastSentHeartbeatDate)&&void 0!==Me?Me:gt.lastSentHeartbeatDate,heartbeats:W.heartbeats})}})()}add(W){var K=this;return(0,g.Z)(function*(){var Me;if(yield K._canUseIndexedDBPromise){const gt=yield K.read();return Yt(K.app,{lastSentHeartbeatDate:null!==(Me=W.lastSentHeartbeatDate)&&void 0!==Me?Me:gt.lastSentHeartbeatDate,heartbeats:[...gt.heartbeats,...W.heartbeats]})}})()}}function J(B){return(0,oe.L)(JSON.stringify({version:2,heartbeats:B})).length}!function G(B){Vt(new j.wA("platform-logger",W=>new he(W),"PRIVATE")),Vt(new j.wA("heartbeat",W=>new Sr(W),"PRIVATE")),bn(_e,"0.7.29",B),bn(_e,"0.7.29","esm2017"),bn("fire-js","")}("")},4859:(ft,Pe,M)=>{"use strict";M.d(Pe,{H0:()=>_e,wA:()=>k,zt:()=>me});var g=M(5861),j=M(2090);class k{constructor(z,H,te){this.name=z,this.instanceFactory=H,this.type=te,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(z){return this.instantiationMode=z,this}setMultipleInstances(z){return this.multipleInstances=z,this}setServiceProps(z){return this.serviceProps=z,this}setInstanceCreatedCallback(z){return this.onInstanceCreated=z,this}}const oe="[DEFAULT]";class me{constructor(z,H){this.name=z,this.container=H,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(z){const H=this.normalizeInstanceIdentifier(z);if(!this.instancesDeferred.has(H)){const te=new j.BH;if(this.instancesDeferred.set(H,te),this.isInitialized(H)||this.shouldAutoInitialize())try{const Oe=this.getOrInitializeService({instanceIdentifier:H});Oe&&te.resolve(Oe)}catch{}}return this.instancesDeferred.get(H).promise}getImmediate(z){var H;const te=this.normalizeInstanceIdentifier(z?.identifier),Oe=null!==(H=z?.optional)&&void 0!==H&&H;if(!this.isInitialized(te)&&!this.shouldAutoInitialize()){if(Oe)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:te})}catch(Te){if(Oe)return null;throw Te}}getComponent(){return this.component}setComponent(z){if(z.name!==this.name)throw Error(`Mismatching Component ${z.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=z,this.shouldAutoInitialize()){if(function we(ye){return"EAGER"===ye.instantiationMode}(z))try{this.getOrInitializeService({instanceIdentifier:oe})}catch{}for(const[H,te]of this.instancesDeferred.entries()){const Oe=this.normalizeInstanceIdentifier(H);try{const Te=this.getOrInitializeService({instanceIdentifier:Oe});te.resolve(Te)}catch{}}}}clearInstance(z=oe){this.instancesDeferred.delete(z),this.instancesOptions.delete(z),this.instances.delete(z)}delete(){var z=this;return(0,g.Z)(function*(){const H=Array.from(z.instances.values());yield Promise.all([...H.filter(te=>"INTERNAL"in te).map(te=>te.INTERNAL.delete()),...H.filter(te=>"_delete"in te).map(te=>te._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(z=oe){return this.instances.has(z)}getOptions(z=oe){return this.instancesOptions.get(z)||{}}initialize(z={}){const{options:H={}}=z,te=this.normalizeInstanceIdentifier(z.instanceIdentifier);if(this.isInitialized(te))throw Error(`${this.name}(${te}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const Oe=this.getOrInitializeService({instanceIdentifier:te,options:H});for(const[Te,Ke]of this.instancesDeferred.entries())te===this.normalizeInstanceIdentifier(Te)&&Ke.resolve(Oe);return Oe}onInit(z,H){var te;const Oe=this.normalizeInstanceIdentifier(H),Te=null!==(te=this.onInitCallbacks.get(Oe))&&void 0!==te?te:new Set;Te.add(z),this.onInitCallbacks.set(Oe,Te);const Ke=this.instances.get(Oe);return Ke&&z(Ke,Oe),()=>{Te.delete(z)}}invokeOnInitCallbacks(z,H){const te=this.onInitCallbacks.get(H);if(te)for(const Oe of te)try{Oe(z,H)}catch{}}getOrInitializeService({instanceIdentifier:z,options:H={}}){let te=this.instances.get(z);if(!te&&this.component&&(te=this.component.instanceFactory(this.container,{instanceIdentifier:(ye=z,ye===oe?void 0:ye),options:H}),this.instances.set(z,te),this.instancesOptions.set(z,H),this.invokeOnInitCallbacks(te,z),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,z,te)}catch{}var ye;return te||null}normalizeInstanceIdentifier(z=oe){return this.component?this.component.multipleInstances?z:oe:z}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class _e{constructor(z){this.name=z,this.providers=new Map}addComponent(z){const H=this.getProvider(z.name);if(H.isComponentSet())throw new Error(`Component ${z.name} has already been registered with ${this.name}`);H.setComponent(z)}addOrOverwriteComponent(z){this.getProvider(z.name).isComponentSet()&&this.providers.delete(z.name),this.addComponent(z)}getProvider(z){if(this.providers.has(z))return this.providers.get(z);const H=new me(z,this);return this.providers.set(z,H),H}getProviders(){return Array.from(this.providers.values())}}},2833:(ft,Pe,M)=>{"use strict";var g=M(5861),j=M(9681),k=M(4859),oe=M(2090),me=M(8766);const he="@firebase/installations",we="0.5.12",ye=`w:${we}`,z="FIS_v2",Xe=new oe.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function ve(re){return re instanceof oe.ZR&&re.code.includes("request-failed")}function xe({projectId:re}){return`https://firebaseinstallations.googleapis.com/v1/projects/${re}/installations`}function ke(re){return{token:re.token,requestStatus:2,expiresIn:se(re.expiresIn),creationTime:Date.now()}}function Ne(re,Se){return Ve.apply(this,arguments)}function Ve(){return(Ve=(0,g.Z)(function*(re,Se){const Ct=(yield Se.json()).error;return Xe.create("request-failed",{requestName:re,serverCode:Ct.code,serverMessage:Ct.message,serverStatus:Ct.status})})).apply(this,arguments)}function Ue({apiKey:re}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":re})}function ae(re,{refreshToken:Se}){const We=Ue(re);return We.append("Authorization",function Ee(re){return`${z} ${re}`}(Se)),We}function De(re){return q.apply(this,arguments)}function q(){return(q=(0,g.Z)(function*(re){const Se=yield re();return Se.status>=500&&Se.status<600?re():Se})).apply(this,arguments)}function se(re){return Number(re.replace("s","000"))}function Q(re,Se){return X.apply(this,arguments)}function X(){return(X=(0,g.Z)(function*({appConfig:re,heartbeatServiceProvider:Se},{fid:We}){const Ct=xe(re),Cn=Ue(re),yt=Se.getImmediate({optional:!0});if(yt){const Sn=yield yt.getHeartbeatsHeader();Sn&&Cn.append("x-firebase-client",Sn)}const vn={method:"POST",headers:Cn,body:JSON.stringify({fid:We,authVersion:z,appId:re.appId,sdkVersion:ye})},Wr=yield De(()=>fetch(Ct,vn));if(Wr.ok){const Sn=yield Wr.json();return{fid:Sn.fid||We,registrationStatus:2,refreshToken:Sn.refreshToken,authToken:ke(Sn.authToken)}}throw yield Ne("Create Installation",Wr)})).apply(this,arguments)}function fe(re){return new Promise(Se=>{setTimeout(Se,re)})}const $e=/^[cdef][\w-]{21}$/;function ut(){try{const re=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(re),re[0]=112+re[0]%16;const We=function Zt(re){return function ue(re){return btoa(String.fromCharCode(...re)).replace(/\+/g,"-").replace(/\//g,"_")}(re).substr(0,22)}(re);return $e.test(We)?We:""}catch{return""}}function rn(re){return`${re.appName}!${re.appId}`}const pt=new Map;function Ut(re,Se){const We=rn(re);Wn(We,Se),function Vt(re,Se){const We=function Nn(){return!at&&"BroadcastChannel"in self&&(at=new BroadcastChannel("[Firebase] FID Change"),at.onmessage=re=>{Wn(re.data.key,re.data.fid)}),at}();We&&We.postMessage({key:re,fid:Se}),function Gr(){0===pt.size&&at&&(at.close(),at=null)}()}(We,Se)}function Wn(re,Se){const We=pt.get(re);if(We)for(const Ct of We)Ct(Se)}let at=null;const qn="firebase-installations-store";let zr=null;function gr(){return zr||(zr=(0,me.X3)("firebase-installations-database",1,{upgrade:(re,Se)=>{0===Se&&re.createObjectStore(qn)}})),zr}function Hn(re,Se){return Jn.apply(this,arguments)}function Jn(){return(Jn=(0,g.Z)(function*(re,Se){const We=rn(re),Cn=(yield gr()).transaction(qn,"readwrite"),yt=Cn.objectStore(qn),nn=yield yt.get(We);return yield yt.put(Se,We),yield Cn.done,(!nn||nn.fid!==Se.fid)&&Ut(re,Se.fid),Se})).apply(this,arguments)}function Dr(re){return yn.apply(this,arguments)}function yn(){return(yn=(0,g.Z)(function*(re){const Se=rn(re),Ct=(yield gr()).transaction(qn,"readwrite");yield Ct.objectStore(qn).delete(Se),yield Ct.done})).apply(this,arguments)}function bn(re,Se){return rt.apply(this,arguments)}function rt(){return(rt=(0,g.Z)(function*(re,Se){const We=rn(re),Cn=(yield gr()).transaction(qn,"readwrite"),yt=Cn.objectStore(qn),nn=yield yt.get(We),vn=Se(nn);return void 0===vn?yield yt.delete(We):yield yt.put(vn,We),yield Cn.done,vn&&(!nn||nn.fid!==vn.fid)&&Ut(re,vn.fid),vn})).apply(this,arguments)}function Pn(re){return ar.apply(this,arguments)}function ar(){return(ar=(0,g.Z)(function*(re){let Se;const We=yield bn(re.appConfig,Ct=>{const Cn=gn(Ct),yt=Bn(re,Cn);return Se=yt.registrationPromise,yt.installationEntry});return""===We.fid?{installationEntry:yield Se}:{installationEntry:We,registrationPromise:Se}})).apply(this,arguments)}function gn(re){return on(re||{fid:ut(),registrationStatus:0})}function Bn(re,Se){if(0===Se.registrationStatus){if(!navigator.onLine)return{installationEntry:Se,registrationPromise:Promise.reject(Xe.create("app-offline"))};const We={fid:Se.fid,registrationStatus:1,registrationTime:Date.now()},Ct=function Tr(re,Se){return bt.apply(this,arguments)}(re,We);return{installationEntry:We,registrationPromise:Ct}}return 1===Se.registrationStatus?{installationEntry:Se,registrationPromise:lt(re)}:{installationEntry:Se}}function bt(){return(bt=(0,g.Z)(function*(re,Se){try{const We=yield Q(re,Se);return Hn(re.appConfig,We)}catch(We){throw ve(We)&&409===We.customData.serverCode?yield Dr(re.appConfig):yield Hn(re.appConfig,{fid:Se.fid,registrationStatus:0}),We}})).apply(this,arguments)}function lt(re){return Dt.apply(this,arguments)}function Dt(){return(Dt=(0,g.Z)(function*(re){let Se=yield Yt(re.appConfig);for(;1===Se.registrationStatus;)yield fe(100),Se=yield Yt(re.appConfig);if(0===Se.registrationStatus){const{installationEntry:We,registrationPromise:Ct}=yield Pn(re);return Ct||We}return Se})).apply(this,arguments)}function Yt(re){return bn(re,Se=>{if(!Se)throw Xe.create("installation-not-found");return on(Se)})}function on(re){return function Kn(re){return 1===re.registrationStatus&&re.registrationTime+1e4<Date.now()}(re)?{fid:re.fid,registrationStatus:0}:re}function ur(re,Se){return On.apply(this,arguments)}function On(){return(On=(0,g.Z)(function*({appConfig:re,heartbeatServiceProvider:Se},We){const Ct=Sr(re,We),Cn=ae(re,We),yt=Se.getImmediate({optional:!0});if(yt){const Sn=yield yt.getHeartbeatsHeader();Sn&&Cn.append("x-firebase-client",Sn)}const vn={method:"POST",headers:Cn,body:JSON.stringify({installation:{sdkVersion:ye,appId:re.appId}})},Wr=yield De(()=>fetch(Ct,vn));if(Wr.ok)return ke(yield Wr.json());throw yield Ne("Generate Auth Token",Wr)})).apply(this,arguments)}function Sr(re,{fid:Se}){return`${xe(re)}/${Se}/authTokens:generate`}function Pt(re){return mr.apply(this,arguments)}function mr(){return(mr=(0,g.Z)(function*(re,Se=!1){let We;const Ct=yield bn(re.appConfig,yt=>{if(!K(yt))throw Xe.create("not-registered");const nn=yt.authToken;if(!Se&&Me(nn))return yt;if(1===nn.requestStatus)return We=Nt(re,Se),yt;{if(!navigator.onLine)throw Xe.create("app-offline");const vn=gt(yt);return We=B(re,vn),vn}});return We?yield We:Ct.authToken})).apply(this,arguments)}function Nt(re,Se){return J.apply(this,arguments)}function J(){return(J=(0,g.Z)(function*(re,Se){let We=yield G(re.appConfig);for(;1===We.authToken.requestStatus;)yield fe(100),We=yield G(re.appConfig);const Ct=We.authToken;return 0===Ct.requestStatus?Pt(re,Se):Ct})).apply(this,arguments)}function G(re){return bn(re,Se=>{if(!K(Se))throw Xe.create("not-registered");return function en(re){return 1===re.requestStatus&&re.requestTime+1e4<Date.now()}(Se.authToken)?Object.assign(Object.assign({},Se),{authToken:{requestStatus:0}}):Se})}function B(re,Se){return W.apply(this,arguments)}function W(){return(W=(0,g.Z)(function*(re,Se){try{const We=yield ur(re,Se),Ct=Object.assign(Object.assign({},Se),{authToken:We});return yield Hn(re.appConfig,Ct),We}catch(We){if(!ve(We)||401!==We.customData.serverCode&&404!==We.customData.serverCode){const Ct=Object.assign(Object.assign({},Se),{authToken:{requestStatus:0}});yield Hn(re.appConfig,Ct)}else yield Dr(re.appConfig);throw We}})).apply(this,arguments)}function K(re){return void 0!==re&&2===re.registrationStatus}function Me(re){return 2===re.requestStatus&&!function Qe(re){const Se=Date.now();return Se<re.creationTime||re.creationTime+re.expiresIn<Se+36e5}(re)}function gt(re){const Se={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},re),{authToken:Se})}function de(){return(de=(0,g.Z)(function*(re){const Se=re,{installationEntry:We,registrationPromise:Ct}=yield Pn(Se);return Ct?Ct.catch(console.error):Pt(Se).catch(console.error),We.fid})).apply(this,arguments)}function L(){return(L=(0,g.Z)(function*(re,Se=!1){const We=re;return yield F(We),(yield Pt(We,Se)).token})).apply(this,arguments)}function F(re){return ie.apply(this,arguments)}function ie(){return(ie=(0,g.Z)(function*(re){const{registrationPromise:Se}=yield Pn(re);Se&&(yield Se)})).apply(this,arguments)}function wn(re){return Xe.create("missing-app-config-values",{valueName:re})}const js="installations",Bo=re=>{const Se=re.getProvider("app").getImmediate(),We=function Tt(re){if(!re||!re.options)throw wn("App Configuration");if(!re.name)throw wn("App Name");const Se=["projectId","apiKey","appId"];for(const We of Se)if(!re.options[We])throw wn(We);return{appName:re.name,projectId:re.options.projectId,apiKey:re.options.apiKey,appId:re.options.appId}}(Se);return{app:Se,appConfig:We,heartbeatServiceProvider:(0,j._getProvider)(Se,"heartbeat"),_delete:()=>Promise.resolve()}},jo=re=>{const Se=re.getProvider("app").getImmediate(),We=(0,j._getProvider)(Se,js).getImmediate();return{getId:()=>function an(re){return de.apply(this,arguments)}(We),getToken:Cn=>function U(re){return L.apply(this,arguments)}(We,Cn)}};(function Zn(){(0,j._registerComponent)(new k.wA(js,Bo,"PUBLIC")),(0,j._registerComponent)(new k.wA("installations-internal",jo,"PRIVATE"))})(),(0,j.registerVersion)(he,we),(0,j.registerVersion)(he,we,"esm2017")},1877:(ft,Pe,M)=>{"use strict";M.d(Pe,{Am:()=>ye,Ub:()=>_e,Yd:()=>we,in:()=>j});const g=[];var j=(()=>{return(z=j||(j={}))[z.DEBUG=0]="DEBUG",z[z.VERBOSE=1]="VERBOSE",z[z.INFO=2]="INFO",z[z.WARN=3]="WARN",z[z.ERROR=4]="ERROR",z[z.SILENT=5]="SILENT",j;var z})();const k={debug:j.DEBUG,verbose:j.VERBOSE,info:j.INFO,warn:j.WARN,error:j.ERROR,silent:j.SILENT},oe=j.INFO,me={[j.DEBUG]:"log",[j.VERBOSE]:"log",[j.INFO]:"info",[j.WARN]:"warn",[j.ERROR]:"error"},he=(z,H,...te)=>{if(H<z.logLevel)return;const Oe=(new Date).toISOString(),Te=me[H];if(!Te)throw new Error(`Attempted to log a message with an invalid logType (value: ${H})`);console[Te](`[${Oe}]  ${z.name}:`,...te)};class we{constructor(H){this.name=H,this._logLevel=oe,this._logHandler=he,this._userLogHandler=null,g.push(this)}get logLevel(){return this._logLevel}set logLevel(H){if(!(H in j))throw new TypeError(`Invalid value "${H}" assigned to \`logLevel\``);this._logLevel=H}setLogLevel(H){this._logLevel="string"==typeof H?k[H]:H}get logHandler(){return this._logHandler}set logHandler(H){if("function"!=typeof H)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=H}get userLogHandler(){return this._userLogHandler}set userLogHandler(H){this._userLogHandler=H}debug(...H){this._userLogHandler&&this._userLogHandler(this,j.DEBUG,...H),this._logHandler(this,j.DEBUG,...H)}log(...H){this._userLogHandler&&this._userLogHandler(this,j.VERBOSE,...H),this._logHandler(this,j.VERBOSE,...H)}info(...H){this._userLogHandler&&this._userLogHandler(this,j.INFO,...H),this._logHandler(this,j.INFO,...H)}warn(...H){this._userLogHandler&&this._userLogHandler(this,j.WARN,...H),this._logHandler(this,j.WARN,...H)}error(...H){this._userLogHandler&&this._userLogHandler(this,j.ERROR,...H),this._logHandler(this,j.ERROR,...H)}}function _e(z){g.forEach(H=>{H.setLogLevel(z)})}function ye(z,H){for(const te of g){let Oe=null;H&&H.level&&(Oe=k[H.level]),te.userLogHandler=null===z?null:(Te,Ke,...Xe)=>{const ve=Xe.map(xe=>{if(null==xe)return null;if("string"==typeof xe)return xe;if("number"==typeof xe||"boolean"==typeof xe)return xe.toString();if(xe instanceof Error)return xe.message;try{return JSON.stringify(xe)}catch{return null}}).filter(xe=>xe).join(" ");Ke>=(Oe??Te.logLevel)&&z({level:j[Ke].toLowerCase(),message:ve,args:Xe,type:Te.name})}}}},8766:(ft,Pe,M)=>{"use strict";M.d(Pe,{Lj:()=>Ve,X3:()=>Ne});var g=M(5861);let k,oe;const we=new WeakMap,_e=new WeakMap,ye=new WeakMap,z=new WeakMap,H=new WeakMap;let Te={get(se,Ee,Q){if(se instanceof IDBTransaction){if("done"===Ee)return _e.get(se);if("objectStoreNames"===Ee)return se.objectStoreNames||ye.get(se);if("store"===Ee)return Q.objectStoreNames[1]?void 0:Q.objectStore(Q.objectStoreNames[0])}return xe(se[Ee])},set:(se,Ee,Q)=>(se[Ee]=Q,!0),has:(se,Ee)=>se instanceof IDBTransaction&&("done"===Ee||"store"===Ee)||Ee in se};function ve(se){return"function"==typeof se?function Xe(se){return se!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function he(){return oe||(oe=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(se)?function(...Ee){return se.apply(ke(this),Ee),xe(we.get(this))}:function(...Ee){return xe(se.apply(ke(this),Ee))}:function(Ee,...Q){const X=se.call(ke(this),Ee,...Q);return ye.set(X,Ee.sort?Ee.sort():[Ee]),xe(X)}}(se):(se instanceof IDBTransaction&&function Oe(se){if(_e.has(se))return;const Ee=new Promise((Q,X)=>{const fe=()=>{se.removeEventListener("complete",ue),se.removeEventListener("error",$e),se.removeEventListener("abort",$e)},ue=()=>{Q(),fe()},$e=()=>{X(se.error||new DOMException("AbortError","AbortError")),fe()};se.addEventListener("complete",ue),se.addEventListener("error",$e),se.addEventListener("abort",$e)});_e.set(se,Ee)}(se),((se,Ee)=>Ee.some(Q=>se instanceof Q))(se,function me(){return k||(k=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(se,Te):se)}function xe(se){if(se instanceof IDBRequest)return function te(se){const Ee=new Promise((Q,X)=>{const fe=()=>{se.removeEventListener("success",ue),se.removeEventListener("error",$e)},ue=()=>{Q(xe(se.result)),fe()},$e=()=>{X(se.error),fe()};se.addEventListener("success",ue),se.addEventListener("error",$e)});return Ee.then(Q=>{Q instanceof IDBCursor&&we.set(Q,se)}).catch(()=>{}),H.set(Ee,se),Ee}(se);if(z.has(se))return z.get(se);const Ee=ve(se);return Ee!==se&&(z.set(se,Ee),H.set(Ee,se)),Ee}const ke=se=>H.get(se);function Ne(se,Ee,{blocked:Q,upgrade:X,blocking:fe,terminated:ue}={}){const $e=indexedDB.open(se,Ee),He=xe($e);return X&&$e.addEventListener("upgradeneeded",ut=>{X(xe($e.result),ut.oldVersion,ut.newVersion,xe($e.transaction))}),Q&&$e.addEventListener("blocked",()=>Q()),He.then(ut=>{ue&&ut.addEventListener("close",()=>ue()),fe&&ut.addEventListener("versionchange",()=>fe())}).catch(()=>{}),He}function Ve(se,{blocked:Ee}={}){const Q=indexedDB.deleteDatabase(se);return Ee&&Q.addEventListener("blocked",()=>Ee()),xe(Q).then(()=>{})}const Ue=["get","getKey","getAll","getAllKeys","count"],ae=["put","add","delete","clear"],De=new Map;function q(se,Ee){if(!(se instanceof IDBDatabase)||Ee in se||"string"!=typeof Ee)return;if(De.get(Ee))return De.get(Ee);const Q=Ee.replace(/FromIndex$/,""),X=Ee!==Q,fe=ae.includes(Q);if(!(Q in(X?IDBIndex:IDBObjectStore).prototype)||!fe&&!Ue.includes(Q))return;const ue=function(){var $e=(0,g.Z)(function*(He,...ut){const Zt=this.transaction(He,fe?"readwrite":"readonly");let rn=Zt.store;return X&&(rn=rn.index(ut.shift())),(yield Promise.all([rn[Q](...ut),fe&&Zt.done]))[0]});return function(ut){return $e.apply(this,arguments)}}();return De.set(Ee,ue),ue}!function Ke(se){Te=se(Te)}(se=>({...se,get:(Ee,Q,X)=>q(Ee,Q)||se.get(Ee,Q,X),has:(Ee,Q)=>!!q(Ee,Q)||se.has(Ee,Q)}))},5861:(ft,Pe,M)=>{"use strict";function g(k,oe,me,he,we,_e,ye){try{var z=k[_e](ye),H=z.value}catch(te){return void me(te)}z.done?oe(H):Promise.resolve(H).then(he,we)}function j(k){return function(){var oe=this,me=arguments;return new Promise(function(he,we){var _e=k.apply(oe,me);function ye(H){g(_e,he,we,ye,z,"next",H)}function z(H){g(_e,he,we,ye,z,"throw",H)}ye(void 0)})}}M.d(Pe,{Z:()=>j})}},ft=>{ft(ft.s=3123)}]);